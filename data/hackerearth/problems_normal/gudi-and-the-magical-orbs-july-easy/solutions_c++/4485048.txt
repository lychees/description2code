#include <bits/stdc++.h>
using namespace std;
#define ll long long
#define pii pair<int,int>
#define pll pair<ll,ll>
#define mp make_pair
#define ff first
#define ss second
#define pb push_back
#define pf pop_front
#define IOS ios::sync_with_stdio(false)
int t , n , m , K ;
int a[105][105];
int dp[105][105][502];
int dx[] ={0,-1,-1};
int dy[] ={-1,0,-1};
bool check(int x , int y){
    if(x >= 1 && x <= n && y >= 1 && y <= m)
        return true;
    else return false;
}
int main(){

    int i , j , k ;
	cin >> t;
	while(t--){
        cin >> n >> m >> K;
        for(i = 1 ; i <= n ; i++){
            for(j = 1 ; j <= m ; j++)
                cin >> a[i][j];
        }
        memset(dp,0,sizeof(dp));
        dp[1][1][a[1][1]] = 1;
        for(j = 2 ; j <= m ; j++){
            for(k = 1 ; k <= 500 ; k++){
                if(a[1][j] <= k){
                    dp[1][j][k]=dp[1][j][k]||dp[1][j-1][k-a[1][j]];
                }
            }
        }
        for(i = 2 ; i <= n ; i++){
            for(k = 1 ; k <= 500 ; k++){
                if(a[i][1] <= k){
                    dp[i][1][k]=dp[i][1][k]||dp[i-1][1][k-a[i][1]];
                }
            }
        }
        for(i = 2 ; i <= n ; i++){
            for(j = 2 ; j <= m ; j++){
                for(int val = a[i][j] ; val <= 500 ; val++){
                    for(k = 0 ; k < 3 ; k++){
                        int newx = i + dx[k];
                        int newy = j + dy[k];
                        if(check(newx,newy)){
                            dp[i][j][val]=dp[i][j][val]||dp[newx][newy][val-a[i][j]];
                        }
                    }
                }
            }
        }
        int ans = 0;
        for(i = K ; i >= 1 ; i--){
            if(dp[n][m][i]==1){
                ans = i;
                break;
            }
        }
        if(ans)cout << ans << endl;
        else cout << -1 << endl;


    }

    return 0;

}