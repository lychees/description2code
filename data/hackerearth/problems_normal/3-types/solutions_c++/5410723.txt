#include <bits/stdc++.h>
using namespace std;
#define s(x) scanf("%d",&x)
#define p(x) printf("%d",x)
#define MOD 1000000007
#define sl(x) scanf("%lld",&x)
#define pl(x) printf("%lld",x)
#define pnew printf("\n")
//int a[1<<20],b[1<<20],c[1<<20];

int get(int par[],int x)
{
	if(x==par[x]) return x;
	return par[x]=get(par,par[x]);
}

void unio(int par[],int x,int y)
{
	par[x]=y;
}

int main()
{
	int n,m;
	cin>>n>>m;
	vector<pair<int,int>> v1,v2,v3;
	int x,y,z;
	for(int i=0;i<m;i++)
	{
		cin>>x>>y>>z;
		if(z==3) v3.push_back(make_pair(x,y));
		if(z==2) v2.push_back(make_pair(x,y));
		if(z==1) v1.push_back(make_pair(x,y));
	}
	int len1=v1.size(),len2=v2.size(),len3=v3.size();
	int par[n+1];
	for(int i=0;i<=n;i++) par[i]=i;
	int coun1=0,coun2=0,coun3=0;
	for(int i=0;i<len3;i++)
	{
		int r=get(par,v3[i].first);
		int s=get(par,v3[i].second);
		if(r!=s)
		{
			unio(par,r,s);
			coun3++;
		}
	}
	int cop[n+1];
	for(int i=0;i<=n;i++) cop[i]=par[i];
	for(int i=0;i<len2;i++)
	{
		int r=get(par,v2[i].first);
		int s=get(par,v2[i].second);
		if(r!=s)
		{
			unio(par,r,s);
			coun2++;
		}
	}
	for(int i=0;i<len1;i++)
	{
		int r=get(cop,v1[i].first);
		int s=get(cop,v1[i].second);
		if(r!=s)
		{
			unio(cop,r,s);
			coun1++;
		}
	}
//	cout<<coun3+coun2<<" "<<coun3+coun1<<"\n";
	if((coun3+coun2)!=n-1 || (coun3+coun1)!=n-1) cout<<"-1";
	else
	{
		cout<<m-coun3-coun1-coun2;
	}
    return 0;
}
