#include <bits/stdc++.h>
#define ll long long
using namespace std;
ll int a[1010][1010],b[1010][1010];
ll int n,m;
ll int  myfindr(ll int r,ll int t)
{
	ll int i,j,mymax=0,ans;
	if(t==0)
	{
		for(j=0;j<m;j++)
		{
			if(a[r][j]>mymax)
			{
				mymax=a[r][j];
				ans=j;
			}
		}
	}
	else
	{
		for(j=0;j<m;j++)
		{
			if(b[r][j]>mymax)
			{
				mymax=b[r][j];
				ans=j;
			}
		}
	}
	return mymax;
}
ll int  myfindc(ll int c,ll int t)
{
	ll int i,j,mymax=0,ans;
	if(t==0)
	{
		for(i=0;i<n;i++)
		{
			if(a[i][c]>mymax)
			{
				mymax=a[i][c];
				ans=i;
			}
		}
	}
	else
	{
		for(i=0;i<n;i++)
		{
			if(b[i][c]>mymax)
			{
				mymax=b[i][c];
				ans=i;
			}
		}
	}
	return mymax;
}
int main()
{
	ios_base::sync_with_stdio(false);
	cin.tie(NULL);
	ll int test;
	cin>>test;
	while(test--)
	{
		map<ll int,ll int> mra,mrb,mca,mcb;
		cin>>n>>m;
		ll int i,j;
		for(i=0;i<n;i++)
		{
			for(j=0;j<m;j++)
			cin>>a[i][j];
		}
		for(i=0;i<n;i++)
		{
			for(j=0;j<m;j++)
			cin>>b[i][j];
		}
		for(i=0;i<n;i++)
		{
			mra[i]=myfindr(i,0);
			//~ cout<<mra[i]<<endl;
		}
		for(j=0;j<m;j++)
		{
			mca[j]=myfindc(j,0);
		}
		for(i=0;i<n;i++)
		{
			mrb[i]=myfindr(i,1);
		}
		for(j=0;j<m;j++)
		{
			mcb[j]=myfindc(j,1);
		}
		ll int ans=0;
		for(i=0;i<n;i++)
		{
			for(j=0;j<m;j++)
			{
				if( mrb[i]==b[i][j] && mca[j]==a[i][j] )
				ans++;
			}
		}
		cout<<ans<<endl;
	}
	return 0;
}
