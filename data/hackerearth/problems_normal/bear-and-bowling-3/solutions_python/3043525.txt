m, n = 10 ** 9 + 7, int(raw_input())
if n == 1:
	print int(raw_input())
else:
	print pow(2, n - 2, m) * sum((i + 2) * x for i, x in enumerate(map(int, raw_input().split()))) % m