#include <bits/stdc++.h>
using namespace std;

int main()
{
	ios::sync_with_stdio(0);
    int t;
    cin>>t;
    while(t--){
    	int n,q;
    	cin>>n>>q;
    	string a[n];
    	int ans[n];
    	for(int i=0;i<n;++i)
    	  {cin>>a[i];
    	   ans[i]=0;
    	  }
    	while(q--){
    		string na;
    		int amt,m;
    		cin>>na>>amt>>m;
    	
    	    for(int i=0;i<n;++i){
    	    	if(na==a[i])
    	    	 {ans[i]+=amt-amt/(m+1)-amt%(m+1);
    	    	   //	cout<<"j"<<ans[i]<<" ";
    	    	 }
    	    }
    	    amt/=(m+1);
    	    
    	    for(int i=0;i<m;++i){
    	    	cin>>na;
    	    	for(int j=0;j<n;++j)
    	    	  if(na==a[j])
    	    	   {ans[j]-=amt; break;
    	    	   	//	cout<<"i"<<ans[i]<<" ";
    	    	   }
    	    }
    	}
      for(int i=0;i<n;++i){
      	if(ans[i]<0)
      	  cout<<a[i]<<" owes "<<-1*ans[i];
      	else if(ans[i]>0)
      	 cout<<a[i]<<" is owed "<<ans[i];
      	 else cout<<a[i]<<" neither owes nor is owed ";
      	cout<<"\n";
      }
    }
    return 0;
}
