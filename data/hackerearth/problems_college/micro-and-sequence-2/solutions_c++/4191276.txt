#include<bits/stdc++.h>
#define MAX 1000000000
#define MOD 1000000007
#define siz 1000005
#define ll long long
using namespace std;
ll arr[siz],temp[siz];
long long power(long long n,long long exp)
{
        long long prod=1,prod2;
        if(exp==1)
                return n;
        else
        {
                prod=prod*power(n,exp/2);
                if(exp%2==0)
                        prod2=prod;
                else
                        prod2=prod*n;
                return ((prod%MOD)*(prod2%MOD))%MOD;
        }
}
int main()
{
	ll t;
	scanf("%lld",&t);
	while(t--)
	{
		ll n,q;
		for(int i=0;i<siz;i++){temp[i]=0;}
//		memset(arr,0,siz);
//		memset(temp,0,siz);
		ll a,b,c,d,e,f;
		scanf("%lld%lld",&n,&q);
		scanf("%lld%lld%lld%lld%lld%lld",&a,&b,&c,&d,&e,&f);
		a%=n;b%=n;c%=n;d%=n;e%=MAX;f%=MAX;
		ll x=0,y=0,v=0,x1,y1,v1;
		for(int i=1;i<=q;i++)
		{
			x1=(((x*a)%n)+b)%n+1;
			y1=(((y*c)%n)+d)%n+1;
			v1=(((v*e)%MAX)+f)%MAX+1;
			if(x1>y1){ll tt=y1;y1=x1;x1=tt;}
			temp[x1]+=v1;
			temp[y1+1]-=v1;
			x1%=n;y1%=n;v1%=MAX;
			x=x1;y=y1;v=v1;
		}
		ll count=0,sum=0;
		for(int i=1;i<=n;i++)
		{
			count=count+temp[i];
			if(count>=MOD)count%=MOD;
			else if(count<0)count=(count+MOD)%MOD;
			sum=(sum+count)%MOD;
		}
		ll val=power(2,n-1);
		printf("%lld\n",(sum*val)%MOD);//<<endl;
	}	
	return 0;
}