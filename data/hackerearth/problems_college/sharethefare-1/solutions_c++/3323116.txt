#include <bits/stdc++.h>
using namespace std;

int main()
{
	long long T,N,Q,M,A;string a;
 	scanf("%lld",&T);
	while(T--){
		vector<string> s; 
		map<string,long long > m;
		scanf("%lld %lld",&N,&Q);
		for(int i=0;i<N;i++){
			cin>>a;
			s.push_back(a);
			m.insert(make_pair(a,0));
			
		}
		for(int i=0;i<Q;i++){
			cin>>a;
			scanf("%lld %lld",&A,&M);
			long long n1=A/(M+1);
			m[a]+=n1*M;
			while(M--){
				cin>>a;
				m[a]-=n1;
				
			}
			
		}
		for(int i=0;i<s.size();i++){
			if(m[s[i]]<0){
				cout<<s[i]<<" owes "<<m[s[i]]*-1<<endl;;
			}
			else if(m[s[i]]>0){
				cout<<s[i]<<" is owed "<<m[s[i]]<<endl;
			}
			else{
				cout<<s[i]<<" neither owes nor is owed"<<endl;;
			}
		}
	}
    
}
