#include<bits/stdc++.h>
using namespace std;
#define pb push_back
#define mp make_pair
int bit[5*100*1000+9];
int n;
inline void upd(int at,int by){
    for(;at<=n;at+=at&-at)
        bit[at]+=by;
    return;
}
inline int qry(int at){
    int sum=0;
    for(;at>=1;at-=at&-at)
        sum+=bit[at];
    return sum;
}
vector<pair<string,int> >elemts;
int main(){
    int tc;
    scanf("%d",&tc);
    while(tc--){
        elemts.clear();
        memset(bit,0,sizeof bit);
        scanf("%d",&n);
        for(int i=1;i<=n;++i){
            string name;
            cin>>name;
            elemts.pb(mp(name,1));
        }
        for(int i=1;i<=n;++i){
            int tim;
            scanf("%d",&tim);
            elemts[i-1].second=tim;
            upd(i,1);
        }
        int curr_max=-900;
        for(int i=1;i<=n-1;++i){
            int k;
            scanf("%d",&k);
            int l=1,r=n;
            int mid=0;
            int pos=0;
            while(l<=r){
                mid=(l+r)>>1;
                if(qry(mid)==k ){
                    if(qry(mid-1)==k-1){
                        pos=mid;
                        goto POR; 
                    }
                    r=mid-1;
                }
                else if(qry(mid)<k){
                    l=mid+1;
                }
                else if(qry(mid)>k){
                    r=mid-1;
                }
            }
POR:{}
    //printf("i is %d pos is %d\n",i,pos );
    curr_max=max(curr_max,elemts[pos-1].second);
    cout<<elemts[pos-1].first<<" "<<curr_max<<"\n";
    upd(pos,-1);
        }
        for(int i=1;i<=n;++i){
            if(qry(i)==1){
                curr_max=max(curr_max,elemts[i-1].second);
                cout<<elemts[i-1].first<<" "<<curr_max<<"\n";
                break;
            }
        }
    }
    return 0;
}
