#include<iostream>
#include<set>
#include<string>
using namespace std;
#define llu long long int
llu ma[100][100],no[100];
int n,m,x1,y1,x2,y2,d,c;
string s[100][100];
#define M 1000000007
bool palin(string s,int i,int j)
{
	while(i<j)
	{
		if(s[i]!=s[j])return 0;
		i++;j--;
	}
	return 1;
}
int np(string s)
{
	set<string> st;
	for(int i=0;i<s.size();i++)
	{
		for(int j=i;j<s.size();j++)
		{
			if(palin(s,i,j))
			{
				st.insert(s.substr(i,j-i+1));
			}
		}
	}
	//for(set<string>::iterator it=st.begin();it!=st.end();it++)cout<<(*it)<<endl;
	return st.size();
}
void mul(llu a[][100],llu b[][100])
{
	llu c[100][100]={0};
	for(int i=0;i<n*m;i++)
	{
		for(int j=0;j<n*m;j++)
		{
			for(int k=0;k<n*m;k++)
			{
				c[i][j]=(c[i][j]+a[i][k]*b[k][j])%M;
			}
		}
	}
	for(int i=0;i<n*m;i++)for(int j=0;j<n*m;j++)a[i][j]=c[i][j];
}
void multiply(llu ma[][100],llu d)
{
	llu t[100][100];
	for(int i=0;i<n*m;i++)for(int j=0;j<n*m;j++)t[i][j]=ma[i][j];
	while(d!=0)
	{
		if(d%2)mul(ma,t);
		d/=2;
		mul(t,t);
	}
}
int main()
{
	cin>>n>>m;
	//cout<<np("abab")<<endl;
	//cout<<np("aaaa")<<endl;
	//while(1);
	for(int i=0;i<n;i++)for(int j=0;j<m;j++)
	{
		cin>>s[i][j];
		no[i*(m)+j]=np(s[i][j]);
	}
	//for(int i=0;i<n*m;i++)cout<<no[i]<<endl;
	cin>>c;
	for(int i=0;i<c;i++)
	{
		cin>>x1>>y1>>x2>>y2;
		ma[x1*m+y1][(x2)*(m)+y2]++;
		ma[x2*m+y2][(x1)*(m)+y1]++;
	}
	for(int i=0;i<n*m;i++)ma[i][i]=1;
	cin>>d;
		d--;
		multiply(ma,d);
		for(int i=0;i<n;i++)
		{
			for(int j=0;j<m;j++)
			{
				int in=i*m+j;
				llu ans=0;
				for(int k=0;k<n*m;k++)
				{
					ans=(ans+ma[in][k]*no[k])%M;
				}
				cout<<ans<<" ";
			}
			cout<<endl;
		}
}