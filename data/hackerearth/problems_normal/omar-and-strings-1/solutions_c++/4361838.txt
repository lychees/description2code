#include<bits/stdc++.h>
using namespace std;
#define MOD 1000000007

typedef long long ll;
const int maxn = 1e5+5;
void Zfunction(char *S, int *Z){
    int L, R, N;
    N = strlen(S);
    L = R = 0;
    for (int i = 1; i < N; i++){
        if (i > R){
            L = R = i;
            while (R < N && S[R - L] == S[R]) R++;
            Z[i] = R - L;
            R--;
        } else {
            int k = i - L;
            if (Z[k] < R - i + 1) Z[i] = Z[k];
            else {
                L = i;
                while (R < N && S[R - L] == S[R]) R++;
                Z[i] = R - L;
                R--;
            }
        }
    }
}

char s[maxn],t[2*maxn];
ll p[maxn],f[maxn],g[maxn];
int z[maxn],cnt[2*maxn];
int main() {
 //   freopen("input.txt","r",stdin);
    p[0]=1;
    scanf("%s",s);
    int n = strlen(s);
    for(int i = 1; i <= n; ++i) p[i]=p[i-1]*27%MOD;
    f[0]=s[0]-'a'+1;
    g[n-1]=s[n-1]-'a'+1;
    for(int i = 1; i < n; ++i) {
        f[i]=(f[i-1]*27%MOD+s[i]-'a'+1)%MOD;
        g[n-1-i]=(g[n-i]*27%MOD+s[n-i-1]-'a'+1)%MOD;
    }
    int left = n-1, right = 0;
    for(int i = 0; i < n-1; ++i) {
        if((f[i]+g[i+1]*p[i+1]%MOD)%MOD==g[0]) right = i;
        if((g[n-1-i]+f[n-i-2]*p[i+1]%MOD)%MOD==f[n-1]) left = n-1-i;
    }
    if(g[0]==f[n-1]) left = 0, right = n-1;
    for(int i = left; i < n; ++i) t[i-left] = s[i];
    for(int i = 0; i <= right; ++i) t[i+n-left] = s[i];
    puts(t);
    Zfunction(t,z);
    int szt = strlen(t);
    z[0] = szt;
    for(int i = 0; i < szt; ++i) {
        ++cnt[1];
        --cnt[z[i]+1];
    }
    for(int i = 1; i <= szt; ++i) {
        cnt[i]+=cnt[i-1];
        printf("%d ",cnt[i]);
    }
}
