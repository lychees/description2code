#include <stdio.h>
#include <iostream>
#include <map>
#include <string>

using namespace std;

int main()
{
	int T,N,Q,j,i;

	map<string,int> payments;
    cin>>T;
    for(i=0;i<T;i++)
    {
    	cin>>N;
    	string names[N] ;
    	cin>>Q;
    		string name;
    	for(j=0;j<N;j++)
    	{

       		cin>>names[j];
    		payments[names[j]]=0;
    	}
    	for(j=0;j<Q;j++)
    	{
    		int amount;
    		int to_pay;
    		int parts;
    		string name;
    		cin>>name;
    		cin>>amount;
    		cin>>parts;
    		payments[name]+=amount;
    		to_pay=amount/(parts+1);
    		payments[name]-=(amount-(parts*(to_pay)));
    		for(int k=0;k<parts;k++)
    		{
    			string payers;
    			cin>>payers;
    			payments[payers]-= (to_pay);
    		}
       	}
       	for(j=0;j<N;j++)
       	{
       		if(payments[names[j]]<0)
       		cout<<names[j]<<" owes "<<-(payments[names[j]])<<"\n";
       		else if(payments[names[j]]>0)
       		cout<<names[j]<<" is owed "<<payments[names[j]]<<"\n";
       		else
       		cout<<names[j]<<" neither owes nor is owed"<<"\n";
       	}
    }
}

