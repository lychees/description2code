#include <iostream>
#include <cstdio>
#include <cstring>
#include <cmath>
using namespace std;
#define mod 1000000007
#define ll long long
#define MAXN 200005
#define pow powe
ll a[MAXN];
ll pow[MAXN];
ll ans;
inline ll add(ll a,ll b)
{
   ll ret=a+b;
   if(ret>=mod)ret%=mod;
   return ret;       
          }
inline ll mul(ll a,ll b)
{
  ll ret=a*b;
  if(ret>=mod)
  ret%=mod;
  return ret;        
          }          

int main()
{
    ios_base::sync_with_stdio(false);
    cin.tie(NULL);
    
    int n;
    cin>>n;
    for(int i=1;i<=n;i++)
    cin>>a[i];
    ans=0;
    pow[0]=1;
    for(int i=1;i<=n;i++)
    pow[i]=mul(pow[i-1],2LL);
    
    for(int i=1;i<=n;i++)
    {
      ll i1=i-1;      
      ll tans=add(mul(i1,pow[i1-1]),pow[i1]);
     // tans-=(i+1);
      while(tans<0)tans+=mod;
      tans%=mod;
      tans=mul(tans,pow[n-i]);
     // cout<<tans<<endl;
      tans=mul(tans,a[i]);
      ans=add(ans,tans);    
           }
    cout<<ans<<endl;
//    system("pause");
    
    return 0;
}
