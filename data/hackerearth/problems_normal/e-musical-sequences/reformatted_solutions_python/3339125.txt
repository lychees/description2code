T = input()
for _ in range(T):
    n, m, z = map(long, raw_input().split())
    a = map(int, raw_input().split())
    a.append(0)
    tmp = 1
    for j in range(n - 1, -1, -1):
        a[n] += a[j] * tmp
        tmp *= -1
    a[n] %= m
    i = z % (n + 1)
    r = z / (n + 1)
    ans = a[i]
    if n % 2 == 0:
        ans *= (-1) ** r
    ans %= m
    print ans
