/* Man Mohan Mishra
   IIIT Allahabad
*/
#include <bits/stdc++.h>

using namespace std;

int a[100005];

int main()
{
	//freopen("input.txt","r",stdin);
	//freopen("output.txt","w",stdout);
	int t;
	scanf("%d",&t);
	while (t --) {
		int n,m,i;
		long long z,y,ans;
		scanf("%d%d",&n,&m);
		scanf("%lld",&z);
		for (i = 0; i < n; i++) {
			scanf("%d",&a[i]);
		}
		z = z - n;
		y = z / (n + 1);
		z = z % (n + 1);
		if (n % 2 == 1) {
			if (z == 0) {
				ans = 0;
				for (i = 0; i < n; i++) {
					if (i % 2 == 0) ans = ans + a[n - i - 1];
					else ans = ans - a[n - i - 1];
				}
			} else {
				ans = a[z - 1];
			}
		} else {
			if (z == 0) {
				ans = 0;
				for (i = 0; i < n; i++) {
					if (i % 2 == 0) ans = ans + a[n - i - 1];
					else ans = ans - a[n - i - 1];
				}
				if (y % 2 == 1) ans = ans * -1LL;
			} else {
				ans = a[z - 1];
				if (y % 2 == 0) ans = ans * -1LL;
			}
		}
		ans = ((ans % m) + m) % m;
		printf("%lld\n",ans);
	}
	return 0;
}
