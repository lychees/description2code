#include <iostream>
#include<set>
using namespace std;
multiset<int> s,m;
int a[4000][4000],t,n,k,x,sum,y,sc[100000],sr[100000];

int main()
{
    cin>>t;
    while(t--)
    {s.clear();
    m.clear();
    	cin>>n>>k;
      for(int i=0;i<n;i++)
      {sum=0;
        for(int j=0;j<n;j++)
          {cin>>a[i][j];
           sum+=a[i][j];
          }
          s.insert(sum);
      }
      
      for(int i=0;i<n;i++)
        {sum=0;
        	for(int j=0;j<n;j++)
        	  sum+=a[j][i];
        	 m.insert(sum);
        }
        multiset<int>::iterator it,ij;
        sum=0;
        sr[0]=0;
		sc[0]=0;
        for(int i=1;i<=k;i++)
        {it=s.begin();
         ij=m.begin();
         x=*it;
         y=*ij;
          sr[i]=sr[i-1]+x;
          sc[i]=sc[i-1]+y;
          y+=n;
          x+=n;
          s.erase(it);
          m.erase(ij);
          s.insert(x);
          m.insert(y);
        }
        int ans=100000007;
		for(int i=0;i<=k;i++)
		{
			ans=min(ans,sr[i]+sc[k-i]+i*(k-i));
		}
        
    
        cout<<ans<<endl;
    }
         
        
    return 0;
}
