#include<bits/stdc++.h>
using namespace std;
typedef long long int LL;
#define MOD 1000000007
LL aa[5];;
LL n;
LL a[31][31];
LL res[31][31];

void mat(){
    //i=0
    for(int i=0;i<10;i++) for(int j=0;j<10;j++) a[i][j]=0;
    a[0][0] = 1;
    a[0][1] = 1;
    a[0][2] = 1;
    a[0][4] = 1;
    a[0][3] = 2;
    a[1][0] = 1;
    a[2][1] = 1;
    a[3][2] = 1;
    a[4][3] = 1;
}
void matmult(LL X[][31],LL Y[][31],LL m){
    LL temp[31][31];
    for(int i=0;i<m;i++){
        for(int j=0;j<m;j++){
            temp[i][j] =0;
            for(int k=0;k<m;k++)
                temp[i][j] = (temp[i][j] + LL(X[i][k])*Y[k][j])%MOD;
        }
    }
    for(int i=0;i<m;i++) for(int j=0;j<m;j++) X[i][j] = temp[i][j];
} 
 
void compute(int n,int m){
    for(int i=0;i<m;i++) for(int j=0;j<m;j++) res[i][j] = (i==j);
    while(n){
        if(n&1){
            matmult(&res[0],&a[0],m);
        }
        matmult(a,a,m);
        n = n>>1;
    }
} 

int main(){
    int test;
    cin >> test;
    while(test--){
        mat();
        for(int i=4;i>=0;i--) cin >> aa[i];
        cin >> n;
        if(n<5) cout << aa[5-n-1] << endl;
        else{
            compute(n-4,5);
            LL ans=0;
            for(int i=0;i<5;i++)
                ans = (ans + (aa[i]*res[0][i])%MOD)%MOD;
                cout << ans << endl;
        }
    
    }
}



