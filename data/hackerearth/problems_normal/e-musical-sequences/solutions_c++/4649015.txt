// E - Musical Sequences, by Errichto
#include<bits/stdc++.h>
using namespace std;
const int nax = 1e6 + 5;
int t[nax];
void te() {
	// read the input
	int n, mod;
	long long z;
	scanf("%d%d%lld", &n, &mod, &z);
	for(int i = 0; i < n; ++i) scanf("%d", &t[i]);
	// we know t[0], t[1], ..., t[n-1]
	// now, find t[n]
	t[n] = 0;
	for(int i = 1; i <= n; ++i) {
		if(i%2) t[n] += t[n-i];
		else t[n] -= t[n-i];
		t[n] %= mod;
	}
	if(t[n] < 0) t[n] += mod;
	// and the main part
	int ans = t[z % (n + 1)];
	if(z % (2 * (n + 1)) >= n + 1 && n % 2 == 0)
		ans = (mod - ans) % mod;
	printf("%d\n", ans);
}
	
int main() {
	int T;
	scanf("%d", &T);
	while(T--) te();
	return 0;
}