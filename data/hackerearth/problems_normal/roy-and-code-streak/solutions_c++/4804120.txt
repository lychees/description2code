#include <bits/stdc++.h>
using namespace std;

int main()
{
    long long t;
    cin>>t;
    while(t--)
    {
    	long long n;
    	cin>>n;
    	vector< pair<long long,int> >v(n);
    	for(int i=0;i<n;i++)
    	   cin>>v[i].first>>v[i].second;
    	   int ans=0,res=0;
    	   unordered_map<long long ,bool> m;
    	   for(int i=0;i<n;i++)
    	   {
    	   	
    	   	   if(v[i].second==0)
    	   	   	   ans=0;
    	   	   	   else 
    	   	   	   {
    	   	   	   	    if(!m[v[i].first])
    	   	   	   	      {
    	   	   	   	      	ans++;
    	   	   	   	      	m[v[i].first]=true;
    	   	   	   	      }
    	   	   	   	
    	   	   	   	  res=max(res,ans);
    	   	   	   }
    	   	
    	   }
    	
    	    cout<<res<<"\n";
    }
    return 0;
}
