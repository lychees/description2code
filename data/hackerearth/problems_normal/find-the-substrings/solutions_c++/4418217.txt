#include <bits/stdc++.h>
using namespace std;
 
#define endl "\n"
#define forn(i, n) for (int i = 0; i < n; ++i)
#define forl(i, a, b) for (int i = a; i < b; ++i)
#define fore(i, a, b) for (int i = a; i <= b; ++i)
#define ul unsigned long
#define ll long long
#define pii std::pair<int, int>
#define vpii vector<pii >
#define all(x) x.begin(), x.end()
#define INF 1000000011
const int MOD = 1e9 + 7;
const long double PI = 3.14159265358979323846;
struct myCompare {
	bool operator() (const pii &l, const pii &r) const {
		return l.first < r.first;
	}
};
 
 
const int MAXN = 1e6 + 3;
char s[MAXN];
int n;
char a = 'a', b = 'b', c = 'c';
int dp[MAXN][3];
int cas[3][2] = {1, 2, 0, 2, 0, 1};
void solve() {
	int T, val;
	cin >> T; cin.ignore();
	while (T--) {
		ll res = 1;
		gets(s);
		n = strlen(s);
		dp[0][0] = dp[0][1] = dp[0][2] = 1;
		dp[0][s[0] - 'a'] = 0;
		forl(i, 1, n) {
			val = s[i] - 'a';
			res += max(dp[i - 1][cas[val][0]], dp[i - 1][cas[val][1]]);
			dp[i][val] = 0;
			dp[i][cas[val][0]] = dp[i - 1][cas[val][0]] + 1;
			dp[i][cas[val][1]] = dp[i - 1][cas[val][1]] + 1;
		}
		cout << res + n - 1 << endl;
	}
}
 
int main() {
	#ifndef ONLINE_JUDGE
		//freopen("input.txt", "rt", stdin);
		//freopen("output.txt", "wt", stdout);
	#endif
	//cout << fixed << setprecision(10);	
 
	solve();
 
	return 0;
}