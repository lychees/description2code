#include<iostream>
#include<cmath>
using namespace std;

int prime(int n){
	int i,flag=0;
	
	for(i=2;i<=sqrt(n);i++){
		if(n%i==0){
			flag=1;
			break;
		}
	}
if(flag==0 && n!=1){
	return 1;
	//cout<<"Error"<<endl;
}
else
	return 0;
}

int main()
{
    int t,i;
    cin>>t;
    
    for(i=0;i<t;i++){
    	int n,j;
    	cin>>n;
    	int a[n+1];
    	int b[n+1];
    	for(j=0;j<=n;j++)
    		b[j]=0;
    	
    	for(j=1;j<=n;j++){
    		cin>>a[j];
    	
    		if(prime(a[j])==1){
    			b[j] = b[j-1] + 1;
    		}
    		else{
    			b[j] = b[j-1];
    		}
    	}
    	int q;
    	cin>>q;
    	
    	for(j=0;j<q;j++){
    		char ch;
    		int x,y;
    		cin>>ch>>x>>y;
    		
    		if(ch=='A'){
    			cout<<b[y]-b[x-1]<<endl;
    		}
    		else{
    			if(b[x]-b[x-1]==1){
    				if(prime(y)==0){
    					for(int k=x;k<=n;k++){
    						b[k]--;
    					}
    				}
    			}
    			else{
    				if(prime(y)==1){
    					for(int k=x;k<=n;k++){
    						b[k]++;
    					}
    				}
    			}
    		}
    		}
    }
    return 0;
}
