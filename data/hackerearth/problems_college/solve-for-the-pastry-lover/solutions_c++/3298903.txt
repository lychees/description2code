#include <bits/stdc++.h>
using namespace std;

int main()
{
    int t;
    cin>>t;
    int n;
    
    while(t--){
    	cin>>n;
    	vector<int>vec;
    map<int,int>mp;
    string temp;
    map<int,pair<int,int>>val;
    	int c = 0;
    	cin>>temp;
    //	pair<int,int>qq;
    		for(int i = 0; i < n; i++){
    	
    	
    		
    		(mp[temp[i]-'0'])++;
    	//	cout<<mp[temp[i]-'0']<<endl;
    		if(mp[temp[i]-'0'] > 1){
    			c = 1;
    				
    		}
    		if(mp[temp[i]-'0'] == 1){
					    		
    			val[temp[i]-'0'].first = i;
    			val[temp[i] - '0'].second =INT_MAX;    			//cout<<val[temp]<<endl;
    		}
    		else if(mp[temp[i]-'0'] > 1){
    			if(val[temp[i]-'0'].second >abs(val[temp[i]-'0'].first-i) )
    			val[temp[i]-'0'].second = abs(val[temp[i]-'0'].first-i);
    			
    			//cout<<abs(val[temp]-i)<<endl;
    			val[temp[i]-'0'].first = i;
    			if(mp[temp[i]-'0'] == 2){
    			vec.push_back(temp[i]-'0');
    			}
    		}
    		}
    	if(c == 0){
    		cout<<"-1"<<endl;
    		continue;
    	}
    	else{
    		int max1 = val[vec[0]].second;
    		for(int i = 1; i < vec.size(); i++){
    			if(max1 > val[vec[i]].second){
    				max1 = val[vec[i]].second;
    			}
    		}
    		cout<<max1<<endl;
    	}
    	
    }
    return 0;
}
