#include <bits/stdc++.h>
using namespace std ;
#define LL long long int
#define ft first
#define sd second
#define PII pair<int,int>
#define MAXN 111111
#define mp make_pair
#define f_in(st) freopen(st,"r",stdin)
#define f_out(st) freopen(st,"w",stdout)
#define sc(x) scanf("%d",&x)
#define scll(x) scanf("%lld",&x)
#define pr(x) printf("%lld\n",x)
#define prll(x) printf("%lld\n",x)
#define pb push_back
#define MOD 1000000007
#define inf INT_MAX/2
#define ASST(X,L,R) assert(X >= L && X <= R)
int N,D,T;
LL A[MAXN];
LL mn;

int check(LL x){
    int ans = 0 , idx = 1 , cnt = 0 ;
    while(idx <= N){
        LL sum ;
        sum = 0 ;
        while(idx <= N && sum < x){
            sum += A[idx] ;
            idx ++ ;
        }
        if(sum >= x){
            cnt ++ ;
        }else{
            if(cnt >= D)
                return 1 ;
            return 0 ;
        }
    }
    return (cnt >= D) ;
}
LL solve(){
    LL low , high , mid ;
    low = 1 ;
    high = 1000000000000000LL ;
    while(low <= high){
        mid = (low + high) / 2 ;
        bool f = check(mid) ;
        if(f && check(mid+1) == 0)
            return mid ;
        else if(f)
            low = mid + 1 ;
        else
            high = mid - 1 ;
    }
    return -1 ;
}
int main(){
    sc(T) ;
    while(T--){
        sc(N) ;sc(D) ;
        for(int i=1;i<=N;i++){
            scll(A[i]) ;
        }
        LL ans = solve() ;
        pr(ans) ;
    }
    return 0 ;
}
