#include <iostream>
using namespace std;
int arr[1000001];
int pref[1000001]; int b;
int ans=0; 
void match()
{
	int L=0, R=0; 
	for (int g=2; g<=b; g++)
	{
		if (g>R)
		{
			L=g; R=g; 
			while (R<=b && arr[R]==arr[R-g+1]) R++; 
			R--; 
			pref[g]=R-L+1; 
		}
		else
		{
			int z=g-L; 
			if (pref[z]<(R-g+1))
			{
				pref[g]=pref[z]; 
			}
			else
			{
				L=g; 
				while (R<=b && arr[R-L+1]==arr[R]) R++; 
				R--; 
				pref[g]=R-L+1; 
			}
		}
		ans=max(ans, pref[g]); 
	}
}
int main()
{
    int a; scanf("%d", &a); 
    for (int g=0; g<a; g++)
    {
    	ans=0; 
    	scanf("%d", &b); 
    	for (int y=1; y<=b; y++)
    	{
    		scanf("%d", &arr[y]); 
    	}
    	match();
    	printf("%d\n", ans); 
    }
    return 0;
}
