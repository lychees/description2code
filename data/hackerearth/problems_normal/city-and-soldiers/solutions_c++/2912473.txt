#include <iostream>
using namespace std;
#include<bits/stdc++.h>
int ancestor(int a, vector<int> &parent){
	if(parent[a]!=a){
		parent[a]=ancestor(parent[a],parent);
	}
	return parent[a];
}
void merge(int a, int b,vector<int> &parent){
	int a1=ancestor(a,parent);
	int a2=ancestor(b,parent);
	if(a1!=a2){
		parent[a1]=a2;
	}
}
void set_parent(int a, vector<int> &parent){
	int pa=ancestor(a,parent);
	parent[pa]=parent[a]=a;
}
int main()
{
	int n, q;
	cin>>n>>q;
	vector<int> parent(n+1,0);
	for(int i=1;i<=n;i++){
		parent[i]=i;
	}
	while(q--){
		int t;
		cin>>t;
		if(t==1){
			int a,b;
			cin>>a>>b;
			merge(a,b,parent);
		}
		else if(t==2){
			int a;
			cin>>a;
			set_parent(a,parent);
		}
		else if(t==3){
			int a;
			cin>>a;
			cout<<ancestor(a,parent)<<endl;
		}
	}
    //cout << "Hello World!" << endl;
    return 0;
}
