#include <iostream>  
#include <cstdio>  
#include <cstring>  
#include <cstring>  
#include <vector>  
#include <stack>  
using namespace std;  
//  
struct Card {  
    char val;//  
    char suit;//  
};  
Card c[52];//52  
vector<stack<Card> >v;//vectorstack? stackCard  
string str;  
  
//  
int judge(Card x, Card y) {  
    if (x.val == y.val || x.suit == y.suit)  
        return 1;  
    return 0;  
}  
  
//  
void solve() {  
    v.clear();//  
    for (int i = 0; i < 52; i++) {  
        stack<Card>s;  
        s.push(c[i]);  
        v.push_back(s);//  
        Card temp;  
        //printf("%d:  size: %d\n", i, v.size());  
        for (int j = v.size() - 1 ; j < v.size() ; j++) {  
            temp = v[j].top();//  
            if (j >= 3) {//3?  
                if (judge(temp, v[j-3].top())) {//  
                    v[j-3].push(temp);//  
                    v[j].pop();//j  
                    if (v[j].empty()) //j  
                        v.erase(v.begin() + j);  
                    j -= 4;//4,  
                }  
                else {//?  
                    if (judge(temp, v[j-1].top())) {  
                        v[j-1].push(temp);//temp  
                        v[j].pop();//  
                        if (v[j].empty()) //?  
                            v.erase(v.begin() + j);  
                        j -= 2;//2?  
                    }  
                }  
            }  
            else if (j > 0 && j < 3) {//0-3  
                if (judge(temp, v[j-1].top())) {//  
                    v[j-1].push(temp);//  
                    v[j].pop();//  
                    if (v[j].empty())   
                        v.erase(v.begin() + j);  
                    j -= 2;//2?  
                }  
            }  
  
        }  
    }  
}  
  
//  
void output() {  
    int ans = v.size();//  
    if (ans == 1)//1  
        printf("1");  
    else  
        printf("%d", ans);  
    for (int i = 0; i < ans; i++)  
        printf(" %d", v[i].size());  
    printf("\n");  
}  
  
//  
int main() {  
    //freopen("input.txt", "r", stdin);  
    int i;  
    while (cin >> str && str != "#") {  
        i = 0;  
        c[i].val = str[0];  
        c[i].suit = str[1];  
        for (i = 1; i < 52; i++) {  
            cin >> str;  
            c[i].val = str[0];  
            c[i].suit = str[1];  
        }  
        solve();  
        output();  
    }  
}  



