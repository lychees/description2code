//its not how good you are...its how good you want to be
#include <iostream>
#include<bits/stdc++.h>
using namespace std;
#define ll long long int
#define inf 1000000000000
#define mod 1000000007
#define pb push_back
#define mp make_pair
#define all(v) v.begin(),v.end()
#define S second
#define F first
#define boost1 ios::sync_with_stdio(false);
#define boost2 cin.tie(0);
#define mem(a,val) memset(a,val,sizeof a)

ll bit[1000001];
ll bpow(ll x,ll n)
{
	ll ans=1;
	while(n>0)
	{
	    if(n&1) ans*=x;
	    x*=x;
	    ans%=mod;
	    x%=mod;
	    n/=2;
	}
	return ans;
}
void update(ll ind,ll val) 
{
    while(ind<=100000)
    {
        bit[ind]+=val;
        ind+=(ind&-ind);
    }
}
ll query(ll ind)
{
    ll sum=0;
    while(ind>0)
    {
        sum+=bit[ind];
        ind-=(ind&-ind);
    }
    return sum;
}
ll a[1000001];
int main()
{
	ll i,j,n,ans=0,equal,greater,smaller;
	cin>>n;
	for(i=1;i<=2*n;i++)
	cin>>a[i];
	for(i=2*n;i>=1;i--)
	{
		smaller=query(a[i]-1);
		equal=query(a[i])-query(a[i]-1);
		greater=2*n-i-smaller-equal;
		ans+=greater*bpow(2,n-2);
		ans%=mod;
		ans+=equal*bpow(2,n-1);
		ans%=mod;
		ans+=smaller*3*bpow(2,n-2);
		ans%=mod;
		update(a[i],1);
	}
	cout<<ans;
	return 0;
}
