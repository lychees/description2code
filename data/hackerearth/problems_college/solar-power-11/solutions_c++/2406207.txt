#include <iostream>
using namespace std;

int main()
{
	long long i,j,k,l,m,n,d,a;
	cin>>d;
	while(d--)
	{
		cin>>n>>k;
		long long b[n+1][n+1];
		for(i=1;i<=n;i++)
		{
			for(j=1;j<=n;j++)
			b[i][j]=k;
		}
		cin>>a;
		while(a--)
		{
			char x;
			long long x1,y1,x2,y2,z;
			cin>>x;
				if(x=='m')
			{
				long long c=0;
			cin>>x1>>y1>>x2>>y2;
			for(i=x1;i<=x2;i++)
			for(j=y1;j<=y2;j++)
			c=c+b[i][j];
			c=c%1000000007;
			cout<<c<<endl;
			}
			else
			{
			cin>>x1>>y1>>z;
			b[x1][y1]=b[x1][y1]*z;
			b[x1][y1]=b[x1][y1]%1000000007;
			}
		}
	}
    //cout << "Hello World!" << endl;
    return 0;
}
