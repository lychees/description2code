t = input()
for _ in range(t):
	n, m, z = map(int, raw_input().split())
	a = map(int, raw_input().split())
	ans = 0
	for i in xrange(1, n + 1):
		if (i % 2) == 1:
			ans += a[-i]
		else:
			ans -= a[-i]
	a.append((ans + m * m) % m)
	z = (z % (2 * (n + 1)))
	if z >= n + 1:
		if n % 2 == 0:
			print (m - a[z - n - 1]) % m
		else:
			print a[z - n - 1]
	else:
		print a[z]
