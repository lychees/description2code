#include <bits/stdc++.h>

using namespace std;

#define pb push_back
#define mp make_pair
#define ll long long int
#define s(x) scanf("%d", &x)
#define sl(x) scanf("%lld", &x)
#define sd(x) scanf("%lf", &x)
#define mod 1000000007
#define get getchar_unlocked

int m[1000005];

int main()
{
    int t, x, y, i, q, n, ind;
    s(t);
    ll ans;
    while (t--) {
        s(n);
        for (i = 1; i <= n; ++i) {
            s(x);
            m[x] = i;
        }
        s(q);
        vector <int> v;
        while (q--) {
            s(x);
            s(y);
            x = m[x];
            y = m[y];
            if (x > y)
                swap(x, y);
            if (y-x == 1)
                v.pb(y);
        }
        ans = 0;
        sort(v.begin(), v.end());
        for (i = 1; i < n; ++i) {
            ind = lower_bound(v.begin(), v.end(), i+1) - v.begin();
            if (ind != v.size())
                ans += (n - v[ind] + 1);
        }
        printf("%lld\n", ans);
    }
    return 0;
}
