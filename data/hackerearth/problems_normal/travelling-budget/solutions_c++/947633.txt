#include <bits/stdc++.h>
using namespace std;

#define ll long long int
#define pb push_back
#define mp make_pair
#define INF 1000000005
const int N=505;

int dp[N][2000],mark[N][2000];
vector<pair<int,pair<int,int> > > v[N];
int c,d,l,x,y,b,n,m,t;

int main(){
	scanf("%d",&t);
	while(t--){
		for(int i=0;i<=501;i++) v[i].clear();

		scanf("%d %d %d",&n,&m,&b);
		for(int i=0;i<m;i++){
			scanf("%d %d %d %d",&x,&y,&c,&l);
			v[x].pb(mp(y,mp(c,l)));
		} 	
		
		for(int i=1;i<=n;i++){
			for(int j=0;j<=b;j++){
				mark[i][j]=0;
				dp[i][j]=INF;
			}
		}

		dp[1][0]=0;
		priority_queue<pair<int,pair<int,int> > > q;	
		q.push(mp(-dp[1][0],mp(1,0)));

		while(!q.empty()){
			pair<int,pair<int,int> > pp=q.top();
			q.pop();
			int rlen=-pp.first;
			int rcost=pp.second.second;
			int from=pp.second.first;

			if(mark[from][rcost]==1) continue;
			mark[from][rcost]=1;

			for(int i=0;i<v[from].size();i++){
				int to=v[from][i].first;
				int cc=v[from][i].second.first;
				int length=v[from][i].second.second;
				//cout<<from<<" "<<to<<" "<<rcost<<" "<<cc<<" "<<dp[from][rcost]<<" "<<length<<" "<<b<<" "<<dp[rcost+cc]<<'\n';
				if( rcost+cc<=b && dp[from][rcost]+length < dp[to][rcost+cc] ){
					dp[to][rcost+cc]=dp[from][rcost]+length;
					//cout<<from<<" "<<to<<" "<<rcost<<" "<<cc<<dp[from][rcost]<<" "<<dp[to][rcost+cc]<<'\n';
					q.push(mp(-dp[to][rcost+cc],mp(to,rcost+cc)));
				}			
			}
		}

		for(int i=1;i<=n;i++){
			int maxi=INF;
			for(int j=0;j<=b;j++){
				//if(i!=j){
					maxi=min(maxi,dp[i][j]);
					dp[i][j]=maxi;
					//cout<<dp[i][j]<<" "<<i<<" "<<j<<'\n';
				//} 
			}
		}

		int qq;
		scanf("%d",&qq);
		while(qq--){
			scanf("%d %d",&x,&y);
			if(dp[x][y]==INF) dp[x][y]=-1;
			printf("%d\n",dp[x][y]);
		}
	}
		return 0;
}
