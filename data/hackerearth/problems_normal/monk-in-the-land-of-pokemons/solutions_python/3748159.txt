def func(n):
    inventory = {}
    counter = 0
    for each in range(n):
        food_type, pokemon = map(int, raw_input().split())
        if pokemon != food_type:
            if pokemon in inventory and inventory[pokemon] > 0:
                if food_type in inventory:
                    inventory[food_type] += 1
                else:
                    inventory[food_type] = 1

                if inventory[pokemon] == 1:
                    inventory.pop(pokemon, None)
                else:
                    inventory[pokemon] -= 1
            else:
                if food_type in inventory:
                    inventory[food_type] += 1
                else:
                    inventory[food_type] = 1
                counter += 1
    print counter

if __name__ == '__main__':
    t = int(raw_input())
    for each in range(t):
        func(int(raw_input()))
