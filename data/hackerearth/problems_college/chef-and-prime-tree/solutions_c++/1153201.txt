#include <bits/stdc++.h>

typedef long long li;
 
using namespace std;
 
#define F(i, n) for(i = 0;i < n; ++i)
#define FI(i, st, ft) for(i = st;i <= ft; ++i)
#define pb(a, b) a.push_back(b)
//#define s second
//#define f first
#define MAXN 5000015
#define mk make_pair
#define mod 1000000007
#define inf 1000000000000ll

int vis[2 * MAXN];
 
void prime()
{
    li i, j;
    li sq = MAXN;
    FI(i, 2, sq){
        if(!vis[i]){
            for(j = 2 * i; j <= MAXN; j += i){
                vis[j] = 1;        
            }
        }
    }
}

int main()
{
	li t;
	prime();
	vis[1] = 1;
	cin >> t;
	while(t--){
		li t1, t2, ans = 0;
		cin >> t1 >> t2;
		while(1){
			if(t1 == t2) break;
			if(t1 < t2){
				if(vis[t2] == 1) ans += t2;
				else ans -= t2;
				t2 /= 2;
			}
			else{
				if(vis[t1] == 1) ans += t1;
				else ans -= t1;
				t1 /= 2;
			}
		}
		if(vis[t1] == 1) ans += t1;
		else ans -= t1;
		cout << ans << "\n";
	}
	return 0;
}