#include<stdio.h>
#include<stdlib.h>
#define mod 1000000007
typedef struct arr
{
	int value;
	int index;
}arr;
int compare(const void *a,const void *b)
{
	return (*((arr*)a)).value-(*((arr*)b)).value;
}
int main()
{
	arr a[1000001];
	long long int t;
	scanf("%lld",&t);
	for(long long int itr=0;itr<t;itr++){
	long long int q,k;
	scanf("%lld %lld",&q,&k);
	long long int b[k+1];
	long long int c[k+1];
	c[0]=-1;
	b[0]=-1;
	a[0].value=-1;
	for(long long int i=1;i<=k;i++)
	scanf("%lld",&b[i]);
	for(long long int i=1;i<=k;i++)
	scanf("%lld",&c[i]);
	for(long long int i=1;i<=k;i++)
	{
		a[i].value=b[i];
		a[i].index=i;
	}
	for(long long int i=k+1;i<1000001;i++)
	{
		long long int value=0;
		for(long long int j=1;j<=k;j++)
		{
			value = (value + a[i-j].value*c[j]);
		}
		a[i].value=value%mod;
		a[i].index=i;
	}
	qsort(a,1000001,sizeof(arr),compare);
	for(int i=0;i<q;i++)
	{
		int l,r;
		scanf("%d%d",&l,&r);
		int count=r-l+1;
		if(count > 100)
		count=100;
		int count_1=0;
		for(int j=0;j<1000001;j++)
		{
			int ind=a[j].index;
			if(count==count_1)
			{
				break;
			}	
			if((ind>=l)&&(ind<=r))
			{
				printf("%d ",a[j].value);
				count_1++;
			}
		}
		printf("\n");
	}
	}
}
		
		
		
			
	
	
	
	