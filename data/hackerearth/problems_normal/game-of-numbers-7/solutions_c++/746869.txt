#include <stdio.h>
#include <iostream>
#define ll long long
using namespace std;
int main()
{
    int cases;
    scanf("%d",&cases);
    while(cases--)
    {
    	ll a,b;
    	scanf("%lld %lld",&a,&b);
    	bool arr[1000001]={false};
    	int index=4;
    	for(int i=2;index<b;i++,index=i*i)
    	{
    		index=i*i;
    		int count=a/index;
    		if(a%index!=0)
    		{
    			count++;
    		}
    		ll num=count*index;
    		while(num<=b)
    		{
    			//printf("%d\n",num);
    			arr[num-a]=true;
    			count++;
    			num=count*index;
    		}   
    	}
    	int cnt=0;
        for(int i=0;i<=b-a;i++)
     	{
     		//printf("%d",arr[i]);
   			if(arr[i]==false)
    			cnt++;
   		}
   		cout<<cnt<<endl;
    }
    return 0;
}