# include<bits/stdc++.h>
# define lli long long int
# define ma 1000001

using namespace std;

lli primes[ma];

void Fill()
{
	primes[0]=primes[1]=1;
    primes[2]=0;
}
void Sieve() 
{
	for (lli i=2;i<=ma;i++)
	{
		if (!primes[i])
		{
			for (lli j=2;j*i<=ma;j++)
			{
				primes[j*i]=1;
			}
		}
	}
}

int main(void)
{
	Fill();
	Sieve();
	lli test,n,q;
	char ch;
	long long int prime[ma],x,y;
	cin>>test;
	while (test--)
	{
		cin>>n;
		for (lli i=0;i<n;i++)
			cin>>prime[i];
		cin>>q;
		for (lli i=0;i<q;i++)
		{
			lli answer=0;
			cin>>ch>>x>>y;
			if (ch=='C')
				prime[x-1]=y;
			else if (ch=='A')
			{
				for (lli i=x-1;i<y;i++)
				{
					if (!primes[prime[i]])
						answer++;
				}
				cout<<answer<<endl;
			}
		}
	}
	return (0);
}