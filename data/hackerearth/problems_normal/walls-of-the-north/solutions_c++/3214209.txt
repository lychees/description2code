#include <bits/stdc++.h>
#define ll long long
using namespace std;
//~ ll int dp[100010][2];           //1 means ith element its >= (i-1)th element 
                               //0 means ith element its <= (i-1)th element 
ll int b1[100010],b0[100010];
ll int a[100010],b[100010];
ll int a2[100010];
pair<ll int,ll int> p[100010];
void update(ll int *bit,ll int index,ll int v)
{
	while(index<=100008)
	{
		bit[index]=max(v,bit[index]);
		index+=(index & -index);
	}
}
ll int query(ll int *bit,ll int index)
{
	ll int ans=0;
	while(index>0)
	{
		ans=max(ans,bit[index]);
		index-=(index & -index);
	}
	return ans;
}
int main()
{
	ios_base::sync_with_stdio(false);
	cin.tie(NULL);
	ll int test;
	cin>>test;
	while(test--)
	{
		ll int n;
		cin>>n;
		memset(b0,0,sizeof(b0));
		memset(b1,0,sizeof(b1));
		ll int i,j,t1,t2,v=2,ans=1;
		for(i=0;i<n;i++)
		{
			cin>>p[i].first;
			p[i].second=i;
		}
		sort(p,p+n);
		t1=0;
		for(i=0;i<n;i++)
		{
			if(i==0)
			b[i]=v;
			else
			{
				if(p[i].first>p[i-1].first)
				{
					v++;
					b[i]=v;
				}
				else
				{
					b[i]=v;
				}
			}
			a[p[i].second]=b[i];
			t1=max(t1,v);
		}
		for(i=0;i<n;i++)
		{
			a2[i]=(t1-a[i]+2);
		}
		//~ for(i=0;i<n;i++)
		//~ cout<<a[i]<<" ";
		//~ cout<<endl;
		for(i=0;i<n;i++)
		{
			/*
			dp[i][0]=1;dp[i][1]=1;
			for(j=i-1;j>=0;j--)
			{
				if(a[j]<=a[i])
				{
					dp[i][1]=max(dp[i][1],1+dp[j][0]);
				}
				if(a[j]>=a[i])
				{
					dp[i][0]=max(dp[i][0],1+dp[j][1]);
				}
				ans=max(ans,max(dp[i][0],dp[i][1]));
			}
			*/
			//~ cout<<"here "<<endl;
			t1=query(b0,a[i]);
			t2=query(b1,a2[i]);
			update(b1,a2[i],t1+1);
			update(b0,a[i],t2+1);
			ans=max(ans,max(query(b0,100008),query(b1,100008)));
		}
		cout<<ans<<endl;
	}
	return 0;
}
