#include<bits/stdc++.h>
using namespace std;
#define LL long long int
#define scanInt(x) scanf("%d",&x)
#define scan2Int(x,y) scanf("%d%d",&x,&y)
#define scanll(x) scanf("%lld",&x)
#define scan2ll(x,y) scanf("%lld%lld",&x,&y)
#define fors(i, a, b) for(int i=a; i<=b; i++)
#define forb(i, a, b) for(int i=a; i>=b; i--)
//Testing Harish Garg 
int main(){
	int t;
	scanInt(t);
	while(t--){
		int n,q;
		map<string,int> M;
		scanInt(n);
		scanInt(q);
		string p[50];
		fors(i,0,n-1){
			
			cin>>p[i];
			M[p[i]]=0;
		////	
				
		}
		fors(i,0,q-1){
			string paidBy;
			int amount;
			
			cin>>paidBy;
			scanInt(amount);
			
			
			int m;
			scanInt(m);
			int each;
			each=amount/(m+1);
			M[paidBy]+=amount;
			M[paidBy]-=each;
			M[paidBy]-=amount-(each*(m+1));
			
			
			/////
			fors(j,0,m-1){
				string s;
				cin>>s;
				M[s]-=each;
				//////
			}
			
		}
		
		fors(i,0,n-1){
			
			int no=M[p[i]];
			
			if(no>0)
			cout<<p[i]<<" is owed "<<no;
			else if(no<0)
			cout<<p[i]<<" owes "<<no*-1;
			else
			cout<<p[i]<<" neither owes nor is owed";
			cout<<endl;
			
				
			
			
			
		}
		
	//	cout<<endl;
	}
}
	

