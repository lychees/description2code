#include<bits/stdc++.h>
using namespace std;
#define F(i,p,n) for(i=p;i<n;i++)
#define Ss(x) scanf("%s",x)
#define S(x) scanf("%lld",&x)
#define P(x) printf("%lld\n",x)
#define Ps(x) printf("%lld ",x)
#define LL long long int
const long long int s=1000000007;
LL expo(LL m,LL f0,LL f1,LL x,LL y,LL z)
{
    LL i,j,k;
    LL f[3][3]={{0,0,0},{1,0,0},{0,0,1}},r[3][3]={{1,0,0},{0,1,0},{0,0,1}},temp[3][3],res=0;
    f[0][0]=x;
    f[0][1]=y;
    f[0][2]=z;
    while(m)
    {
        if(m&1)
        {
            memset(temp,0,sizeof(temp));
            for(i=0;i<3;i++)
                for(j=0;j<3;j++)
                    for(k=0;k<3;k++)
                    {
                        temp[i][j]=(temp[i][j]+r[i][k]*f[k][j]);
                        if(temp[i][j]>=s)
                            temp[i][j]%=s;
                    }
             for(i=0;i<3;i++)
                 for(j=0;j<3;j++)
                    r[i][j]=temp[i][j];
        }
        memset(temp,0,sizeof(temp));
        for(i=0;i<3;i++)
            for(j=0;j<3;j++)
                for(k=0;k<3;k++)
                {
                    temp[i][j]=(temp[i][j]+f[i][k]*f[k][j]);
                    if(temp[i][j]>=s)
                            temp[i][j]%=s;
                }
        for(i=0;i<3;i++)
            for(j=0;j<3;j++)
                f[i][j]=temp[i][j];
        m/=2;
    }
        /*f[0][0]=f[0][1]=f[1][0]=1;
        f[1][1]=0;
        memset(temp,0,sizeof(temp));
        F(i,0,2)
            F(j,0,2)
                F(k,0,2)
                temp[i][j]=(temp[i][j]+r[i][k]*f[k][j])%s;
         F(i,0,2)
            F(j,0,2)
            f[i][j]=temp[i][j];
        memset(temp,0,sizeof(temp));
        F(i,0,2)
            F(j,0,2)
                F(k,0,2)
                temp[i][j]=(temp[i][j]+r[i][k]*f[k][j])%s;*/
        /*F(i,0,2)
        {
            F(j,0,2)
                P(f[i][j]);
            printf("\n");
        }*/
        res=(f1*r[0][0]+f0*r[0][1]+r[0][2])%s;
        return res;
}
main()
{
    LL i,j,m,n,ans,t,x,y,z,f0,f1;
    S(t);
    while(t--)
    {
        S(n);
        S(f0);
        S(f1);
        S(x);
        S(y);
        S(z);
        if(n==1)
            printf("%lld\n",f0);
        else
        {
            ans=expo(n-2,f0,f1,x,y,z);
            P(ans);
        }
    }
}
