//#pragma comment(linker, "/STACK:102400000,102400000")
#include <bits/stdc++.h>
//#include <unordered_map>
using namespace std;
#define vi vector<int>
#define pii pair<int,int>
#define pb push_back
#define mp make_pair
#define all(x) x.begin(),x.end()
#define SZ(x) (int)(x.size())
#define rep(i,a,b) for(int i=a;i<b;i++)
#define per(i,a,b) for(int i=b-1;i>=a;i--)
#define inf 1000000007
#define mod 1000000007
#define x first
#define y second
#define pi acos(-1.0)
#define DBG(x) cerr<<(#x)<<"="<<x<<"\n";
//#define dprintf(...) 
#define hash _hash
//#define dprintf(...) fprintf(outFile,__VA_ARGS__)
 
#define FOREACH(it,x) for(__typeof(x.begin()) it=x.begin();it!=x.end();it++)
#define ull unsigned long long
#define ll long long
#define N 1010


template <class T,class U>inline void Max(T &a,U b){if(a<b)a=b;}
template <class T,class U>inline void Min(T &a,U b){if(a>b)a=b;}
 
//FILE* outFile;
 
//inline void add(int &a,int b){a+=b;while(a>=mod)a-=mod;}


int pow(int a,int b){
    int ans=1;
    while(b){
        if(b&1)ans=ans*(ll)a%mod;
        a=(ll)a*a%mod;b>>=1;
    }
    return ans;
}

ll s[1010];
int n,b[110],r;
int solve(ll x,ll y){
    if(x>r){
        ll z=(x-r)/n;
        x-=z*n;
        x-=n;
        while(y>s[x])y-=s[x++];
        return solve(x,y);
    }
    else{
        if(x<=n){if(y!=1)return 0;return x;}
        if(y>s[x])return 0;
        x-=n;
        while(y>s[x])y-=s[x++];
        return solve(x,y);
    }
}
int get(char c){
    if(c>='a'&&c<='z')return c-'a';
    else if(c>='A'&&c<='Z')return c-'A'+26;
    else return c-'0'+52; 
}
int main(){
    //freopen("A.in","r",stdin);
    //freopen("A.out","w",stdout);
    //freopen("1.txt","w",stdout);
    //srand(time(0));
    int T=30,j,k,i,ca=0,m;
    scanf("%d%d",&n,&m);
    rep(i,1,n+1)s[i]=1;
    i=1,j=n+1;
    ll v=n;
    while(1){
        s[j++]=v;
        if(v>=1e15)break;
        v=v*2-s[i++];
    }
    r=j-1;
    //DBG(r)assert(s[r-1]<=1e15);
    memset(b,-1,sizeof(b));
    ll x,y;char c[2];int ok=1,cnt=n;
    while(m--){
        scanf("%lld%lld%s",&x,&y,c);
        //cerr<<x<<" "<<y<<" "<<c<<"\n";
        if(!ok)continue;
        if(x==0){ok=0;continue;}
        k=solve(y,x);
        if(k==0){ok=0;continue;}
        //DBG(k)
        assert(k>=1&&k<=n);
        j=get(c[0]);
        if(b[k]!=-1&&b[k]!=j)ok=0;
        else if(b[k]==-1)cnt--,b[k]=j;
    }
    if(!ok){puts("0");return 0;}
    int ans=1;
    rep(i,0,cnt)ans=ans*62LL%mod;
    printf("%d\n",ans);
    //cerr<<1.*clock()/CLOCKS_PER_SEC<<"s\n";
    return 0;
}