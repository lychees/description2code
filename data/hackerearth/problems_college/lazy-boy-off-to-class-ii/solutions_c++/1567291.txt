#include<bits/stdc++.h>
using namespace std;

int main()
{//freopen("in.txt","r",stdin);

	int t;
	cin>>t;
	while(t--)
	 {int N=0,n,x,y;
//	 vector<vector<int>  > dp(7,vector<int>(24*60*60+1));
	// vector<int> periods(24*60*60*7+1);
	 map<int,int> periods;
	 periods[0]=0;
	 	for(int kk=0;kk<7;kk++)
	 	  {
	 	  	cin>>n;
	 	  	N+=n;
	 	  	vector<pair<int,int> > a;
	 	  	map<int,int> mp;
	 	  	for(int i=0;i<n;i++)
	 	  	 {
	 	  	 	cin>>x>>y;
				a.push_back(make_pair(x,y));	
	 	  	 }
	 	  	
	 	  	for(int i=0;i<n;i++)
	 	  	 {
	 	  	 	for(int j=i;j<n;j++)
	 	  	 	 {
	 	  	 	 	int time=a[j].second-a[i].first;
	 	  	 	 	if(mp.find(j-i+1)!=mp.end())
	 	  	 	 	  mp[j-i+1]=min(mp[j-i+1],time);
	 	  	 	 	else
	 	  	 	 	  mp[j-i+1]=time;
	 	  	 	 	
	 	  	 	 }
	 	  	 	 
	 	  	 }
	 	  	map<int,int> tempPeriods;
	 	  	vector<pair<int,int> > v(mp.size());
	 	  	vector<pair<int,int> > v2(periods.size());
	 	  	
	 	  	int c=0;
	 	  	for(map<int,int>::iterator it=mp.begin();it!=mp.end();it++)
	 	           v[c++]=make_pair(it->first,it->second);
	 	        c=0;
	 	    for(map<int,int>::iterator it=periods.begin();it!=periods.end();it++)
	 	           v2[c++]=make_pair(it->first,it->second);
	 	    
	 //	  	for(map<int,int>::iterator it2=periods.begin();it2!=periods.end();it2++)
	 	  	for(int j=0;j<v2.size();j++)
	      {
	      	for(int i=0;i<v.size();i++)
	 	     //	for(map<int,int>::iterator it=mp.begin();it!=mp.end();it++)
	 	     	  {	if(tempPeriods.find(v2[j].first +v[i].first)!=tempPeriods.end())
					tempPeriods[v2[j].first + v[i].first]=min(tempPeriods[v2[j].first+v[i].first],v2[j].second + v[i].second);
					else
					 tempPeriods[v2[j].first + v[i].first]=v2[j].second + v[i].second;
	 	     	  	
	 	     	  }
	 	     }
	 	    
	 	  	for(map<int,int>::iterator it2=tempPeriods.begin();it2!=tempPeriods.end();it2++)
	 	  	  {if(periods.find(it2->first)!=periods.end())
	 	  	  	periods[it2->first]=min(periods[it2->first],it2->second);
	 	  	  	else
	 	  	  	  	periods[it2->first]=it2->second;
	 	  	  }
	 	  }
	 	int ans=0,periodsR=(3*N+3)/4;
	 //	cout<<periodsR<<endl;
	    for(map<int,int>::iterator it2=periods.begin();it2!=periods.end();it2++)
	      {//cout<<it2->first<<" "<<it2->second<<endl;
	     	if(periodsR<=it2->first)
	      	  {
	      	  ans=it2->second;
	      	  break;
	          } 
	      	
	      }
	  //  cout<<ans<<endl;
	    cout<<7*24*60*60-ans<<endl;
	  //  cout<<ans<<endl;
	      
	 	
	
	 	
	 }
}