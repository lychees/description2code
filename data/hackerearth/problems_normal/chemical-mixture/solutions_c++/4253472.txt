#include <bits/stdc++.h>
using namespace std;

typedef long long LL;

#define PII       pair<int,int>
#define all(c)    c.begin(),c.end()
#define sz(c)     (int)c.size()
#define clr(c)    c.clear()
#define pb        push_back
#define mp        make_pair
#define cin(x)    scanf("%d",&x)
#define MOD		1000000007
#define EPS		1E-10

void solve()
{
	LL reqd;int n1,n2;
	cin >> reqd >> n1 >> n2;
	vector<LL> amulus(n1);
	vector<LL> water(n2);
	for(int i = 0; i < n1; i++)
		cin >> amulus[i];
	for(int i = 0; i < n2; i++)
		cin >> water[i];

	sort(all(amulus));

	LL bestAmulus = 0;
	int poss = 0;

	for(int mask = 0; mask < (1 << n2); mask++)
	{
		LL remaining = reqd;
		for(int a = 0; a < n2; a++)
		{
			if(mask & (1 << a))
				remaining -= water[a];
		}
		if(remaining < 0) continue;
		LL temp = remaining;
		for(int a = n1 - 1; a >= 0; a--)
		{
			if(remaining >= amulus[a])
				remaining -= amulus[a];
		}
		if(!remaining)
		{
			bestAmulus = max(bestAmulus,temp);
			poss = 1;
		}
	}


	if(!poss)
	{
		cout << "NO\n";
	}
	else
	{
		cout << "YES\n";
		vector<LL> ansWala;
		for(int i = sz(amulus) - 1; i >= 0; i--)
		{
			if(bestAmulus >= amulus[i])
			{
				ansWala.pb(amulus[i]);
				bestAmulus -= amulus[i];
			}
		}
		reverse(all(ansWala));
		for(int i = 0; i < sz(ansWala); i++)
			cout << ansWala[i] << " ";
		cout << "\n";
	}
}

int main()
{
	int t;
	cin(t);
	while(t--)
		solve();
	return 0;
}