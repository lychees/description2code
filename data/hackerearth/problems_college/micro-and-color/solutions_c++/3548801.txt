#include <bits/stdc++.h>
#define ll long long
#define pb push_back
#define mk make_pair
#define pi pair<int, int>
#define fi first
#define se second
using namespace std;
const int N = 1005;
const int M = 1e9 + 7;
ll dp[N][N];
int n, k, m, a[N];
ll ex(ll a, ll n) {
	if(n == 0) return 1;
	if(n == 1) return a;
	if(n % 2) return (a * ex((a * a) % M, (n - 1) / 2)) % M;
	return ex((a * a) % M, n / 2);
}
int main() {
	int t;
	cin >> t;
	while(t--) {
		int n, k, m;
		scanf("%d%d%d", &n, &k, &m);
		for(int i = 1; i <= n; i++) {
			scanf("%d", &a[i]);
		}
		for(int i = 0; i <= n; i++) {
			for(int j = 0; j <= m; j++) dp[i][j] = 0;
		}
		dp[1][(1LL * k * a[1]) % m] = 1;
		for(int i = 2; i <= n; i++) {
			dp[i][(1LL * k * a[i]) % m]++;
			if(dp[i][(1LL * k * a[i]) % m] >= M) dp[i][(1LL * k * a[i]) % m] %= M;
			for(int j = 0; j < m; j++) {
				dp[i][j] += dp[i - 1][j];
				dp[i][(1LL * j * a[i]) % m] += dp[i - 1][j];
				if(dp[i][j] >= M) dp[i][j] %= M;
				if(dp[i][(1LL * j * a[i]) % m] >= M) dp[i][(1LL * j * a[i]) % m] %= M;
			}
		}
		ll ans = k;
		ans %= M;
		for(int i = 0; i < m; i++) {
			ans += (i * dp[n][i]) % M;
			if(ans >= M) ans %= M;
		}
		ll val = ex(2, n);
		val = ex(val, M - 2);
		ans = (ans * val) % M;
		printf("%lld\n", ans);
	}
	return 0;
}
