#include <bits/stdc++.h>
using namespace std;

typedef long long ll;
typedef vector<int> vi;
typedef vector<ll> vl;
typedef vector<vi> vvi;
typedef vector<vl> vvl;
typedef vector<double> vd;
typedef vector<vd> vvd;
typedef pair<int, int> pii;
typedef pair<ll, ll> pll;
typedef pair<double, double> pdd;
typedef vector<pii> vpi;
typedef vector<pll> vpl;
typedef vector<string> vs;
#define si(x) scanf("%d", &x)
#define sl(x) scanf("%lld", &x)
#define all(v) v.begin(),v.end()
#define Pi(x) printf("%d", x)
#define Pl(x) printf("%lld", x)
#define os() printf(" ")
#define nl() printf("\n");
#define F first
#define S second
#define MOD 1000000007
#define pb push_back
#define mp make_pair
#define mem(x,i) memset(x,i,sizeof(x))
#define fori(i,s,n) for(int i=(s);i<(n);++i)
#define forl(i,s,n) for(ll i=(s);i<(n);++i)
#define ford(i,s,n) for(int i=(n)-1;i>=(s);--i)
#define forld(i,s,n) for(ll i=(n)-1;i>=(s);--i)
#define INF 8944674407370955161LL
#define debug(i,st,arr) fori(i,0,st){cout<<arr[i]<<" ";}cout<<endl;
#define debugl(i,st,arr) forl(i,0,st){cout<<arr[i]<<" ";}cout<<endl;
#define forci(i,sw) for((i)=(sw).begin();(i)!=(sw).end();(i)++)
#define forcd(i,sw) for((i)=(sw).rbegin();(i)!=(sw).rend();(i)++)
#define debugit(i,sw) forci(i,sw){cout<<i->F<<" " << i->S<<endl;}cout<<endl;
#define sync() ios_base::sync_with_stdio(0)

vi Dijsktra(vpi adj[], int n)
{
    priority_queue<pii,vpi,greater<pii> > Q;
    map<int,bool> f;
    vi D(n+1);
    
    
    fori(i,0,n+1) D[i] = MOD;
    D[1] = 0;
    Q.push(mp(D[1],1));
    
    while (!Q.empty())
    {
        int u = Q.top().S;
        Q.pop();
        if (f[u]) continue;
        int sz = adj[u].size();
        fori(i,0,sz) {
            int v = adj[u][i].F;
            int c = adj[u][i].S;
            if (c+D[u] < D[v]) {
                D[v] = c + D[u];
                Q.push(mp(D[v],v));
            }
        }
        f[u] = 1;
    }
    //fori(i,1,n+1) cout << i << " " << D[i] << endl;
    return D;
}
int main()
{
    ios_base::sync_with_stdio(0);
    cin.tie(NULL);
    
    int t;
    cin >> t;
    while (t--) {
        int n,m;
        cin >> n >> m;
        vpi adj[10004];
        fori(i,0,m) {
            int x,y,c;
            cin >> x >> y >> c;
            adj[x].pb(mp(y,c));
            adj[y].pb(mp(x,c));
        }
        vi D = Dijsktra(adj,n);
        int q;
        cin >> q;
        while (q--) {
            int a,k;
            cin >> a >> k;
            if (k-2*D[a] >= 0) cout << k-2*D[a] << '\n';
            else cout << 0 << '\n';
        }
    }
    return 0;
}
