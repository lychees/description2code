#include<bits/stdc++.h>
#define ll long long int
#define md 1000000007
using namespace std;
ll t,n,m,q,sum,ans;
ll fact[1000006];
bool vis[1003][1003];
bool arr[1003][1003];
int dirc[8][2]={ {2,1}, {2,-1}, {-2,1}, {-2,-1}, {1,2}, {1,-2}, {-1,2}, {-1,-2} };
void precal()
{
	fact[0]=1;
	for(int i=1;i<1000006;i++)
	{
		fact[i]=(i*fact[i-1])%md;
	}
}
void dfs(int x,int y)
{
	vis[x][y]=true;
	sum++;
	for(int i=0;i<8;i++)
	{
		int dx=x+dirc[i][0];
		int dy=y+dirc[i][1];
		if(dx<=0 || dx>n || dy<=0 || dy>m)
		{
			continue;
		}
		if(vis[dx][dy] || !arr[dx][dy])
		{
			continue;
		}
		dfs(dx,dy);
	}
	//printf("breakibg\n");
}

int main()
{
	int a,b;
	precal();
	cin>>t;
	while(t--)
	{
		ans=1;
		cin>>n>>m>>q;
		for(int i=0;i<=n;i++)
		{
			for(int j=0;j<=m;j++)
			{
				vis[i][j]=false;
				arr[i][j]=false;
			}
		}
		
		for(int i=0;i<q;i++)
		{
			cin>>a>>b;
			arr[a][b]=true;
		}
		for(int i=1;i<=n;i++)
		{
			for(int j=1;j<=m;j++)
			{
				if(!vis[i][j] && arr[i][j])
				{
					//printf("i am here\n");
					sum=0;
					dfs(i,j);
					ans=(ans*fact[sum])%md;
				}
			}
		}
		cout<<ans<<endl;
	}
	return 0;
}








