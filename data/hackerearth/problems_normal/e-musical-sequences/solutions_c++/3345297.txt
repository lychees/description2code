#include<stdio.h>
#include<vector>
#include<iostream>


using namespace std;

typedef long long ll;


int main()
{
    int t;
    scanf("%d",&t);

    while(t!=0)
    {
        int n;ll m,z;
        scanf("%d %lld %lld",&n,&m,&z);

        vector<ll> vec(n+1,0);

        for(int i=0;i<n;i++)
            scanf("%lld",&vec[i]);

        int k=1;

        for(int i=n-1;i>=0;i--)
        {
            vec[n]+=(k*vec[i]);
            k=k*(-1);
        }

        //cout << vec[n] << '\n';

        int ctr=1;

        if(n%2==0)
            ctr=-1;

        //cout << "ctr" << ctr << '\n';

        ll ans=0;

        //cout << (z/n+1) << '\n';

        if((z/(n+1))%2!=0)
        {
           ans=ctr*vec[z%(n+1)];
        }
        else
        {
            ans=vec[z%(n+1)];
        }

        //cout << ans << '\n';

        ans=ans%m;

        //cout << ans << '\n';

        if(ans<0)
            ans+=m;

        printf("%lld\n",ans);

        t--;
    }
}
