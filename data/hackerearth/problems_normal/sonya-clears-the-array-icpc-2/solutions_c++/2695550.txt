#include<bits/stdc++.h>
#define prev adsfasdf
using namespace std;
int n,ar[1<<20];
int dp[505][505];
int pr[1<<21];
int nxt[1<<21];
int prev[1<<21];
int cost(int a,int b)
{
	int sub=a+b;
	if (a<=b&&prev[b-1]>=a)
		return nxt[b]+prev[b-1]-a-b;
	a=max(a,b);
	a=nxt[a];
	b=nxt[a+1];
	return a+b-sub;
}
int main(){
ios_base::sync_with_stdio(0);
//cin.tie(0);
pr[1]=1;
for (int i=2;i<=2000000;i++)
{
	if (pr[i])
		continue;
	for (int j=i*2;j<=2000000;j+=i)
		pr[j]=1;
}
cin>>n;
for (int i=2000000;i;--i)
{
	if (pr[i]==0)
		nxt[i]=i;
	else
		nxt[i]=nxt[i+1];
}
for (int i=1;i<=2000000;i++)
{
	if (pr[i]==0)
		prev[i]=i;
	else
		prev[i]=prev[i-1];
}
for (int i=1;i<=n;i++)
{
	cin>>ar[i];
}
for (int r=1;r<=n;r++)
{
	for (int l=r-1;l>=1;l-=2)
	{
		dp[l][r]=1e9;
		for (int ad=l;ad<r;ad+=2)
		{
			dp[l][r]=min(dp[l][r],dp[l][ad-1]+dp[ad+1][r-1]+cost(ar[ad],ar[r]));
		}
	}
}
cout<<dp[1][n]+n/2<<endl;
//cin.get();cin.get();
return 0;
}
