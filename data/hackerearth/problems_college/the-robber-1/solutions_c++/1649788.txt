#include <bits/stdc++.h>
using namespace std;
typedef pair<int,int> PII; 
typedef long long LL; 
const int INF = 1000000007; 
int dp[50][1024]; 
int maxProfit(vector<int> a, vector<string> e){ 
        int n=a.size(); 
        memset(dp,0,sizeof(dp)); 
        dp[0][a[0]]=1; 
        queue<PII> q; 
        q.push(PII(0,a[0])); 
        int ans=0; 
        while(q.size()){ 
            int x=q.front().first; 
            int t=q.front().second; 
            ans=max(ans,t); 
            q.pop(); 
            for(int y=0;y<n;y++){ 
                if(e[x][y]=='N') continue; 
                int r=t^a[y]; 
                if(!dp[y][r]){ 
                    dp[y][r]=1; 
                    q.push(PII(y,r)); 
                } 
            } 
        } 
        return ans; 
    } 
int main() 
{
    int n,i,k;
    cin>>n;
    vector<string>x;
    vector<int>a;
    string str;
    for(i = 0; i < n; i++) {
        cin>>str;
        x.push_back(str);
    }
    for(i = 0; i < n; i++) {
        cin>>k;
        a.push_back(k);
    }
    cout<<maxProfit(a,x)<<endl;
	return 0;
}
