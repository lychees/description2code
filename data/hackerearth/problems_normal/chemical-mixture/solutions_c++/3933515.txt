#include <iostream>
#include<vector>
#include<algorithm>
#include<climits>

#define ll long long int
using namespace std;

int main() {

 
 ll t;
 
cin>>t;

 while(t--)
 {
     ll tot,m,n,z,i;
     ll bestest=LLONG_MIN;
     int solved=0;
     
     
     vector<ll> v,s,res;
     
     cin>>tot>>m>>n;
     
     for(i=0;i<m;i++)
     {
         cin>>z;
         v.push_back(z);
         
     }
     
     for(i=0;i<n;i++)
     {
         cin>>z;
         s.push_back(z);
         
     }
     
     
     sort(v.begin(),v.end());
     
     sort(s.begin(),s.end());
     
     
     
     
     for(i=0;i<(1ll<<n);i++)
     {
     	vector<ll> best;
     	ll p=0;
     	
     	for(ll j=0;j<n;j++)
     	{
     		
     		if(1ll<<j & i)
     		p+=s[j];
     		
     	}
     	
     	ll r = tot-p;
     	
     	for(ll j=m-1;j>=0;j--)
     	{
     		if(v[j]<=r)
     		{
     			best.push_back(v[j]);
     			r-=v[j];
     			if(r==0)break;
     		}
     		
     	}
     	
     	if(r==0)
     	{
     		r=tot-p;
     		
     		if(r>bestest)
     		{bestest=r;
     		res=best;
     		solved=1;}
     		
     	}
     	
     }
     	
     	if(solved)
     	{
     		sort(res.begin(),res.end());
     		cout<<"YES\n";
     		for(ll x=0;x<res.size();x++)
     		cout<<res[x]<<" ";
     		cout<<"\n";
     		
     	}
     	else cout<<"NO\n";
     	
     	
     	
     	
     }
     
     
     
     
     
 	return 0;
}
