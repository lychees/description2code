/** PROBLEM FROM ONLINE JUDGE HACKEREARTH: PROBLEM CODE **/
		   /* Code by Anomitra Saha */
		       /* NIT Durgapur */

#include <bits/stdc++.h>

using namespace std;

typedef long long ll;
typedef vector<int> vi;
typedef vector<vi> vvi;
typedef vector<long long> vll;
typedef vector<vll> vvll;
typedef pair<int,int> intpair;
typedef pair<long long, long long> llpair;

#define sz(a) int((a).size())
#define pb push_back
#define all(c) (c).begin(),(c).end()
#define tr(c,i) for(typeof((c).begin() i = (c).begin(); i != (c).end(); i++)
#define present(c,x) ((c).find(x) != (c).end())
#define cpresent(c,x) (find(all(c),x) != (c).end())
#define ri(x) scanf("%d",&(x))
#define rll(x) scanf("%lld",&(x))
#define nl printf("\n")
#define deb printf("TEST")
#define pi(n) printf("%d",n)
#define pin(n) printf("%d\n",n)
#define piw(n) printf("%d ",n)
#define pll(n) printf("%lld",n)
#define plln(n) printf("%lld\n",n)
#define pllw(n) printf("%lld ",n)

#define MOD 1000000007


int find_min(int x, int b)
{
    return x<=b ? x : b;
}

int main()
{
    int t;
    ri(t);
    while(t--)
    {
        int n;
        ri(n);
        int wengaluru[n];
        for(int i=0;i<n;i++)
        {
            ri(wengaluru[i]);
        }
        ll maxleft[n],maxright[n];
        ll maxval=0;

        for(int i=0;i<n;i++)
        {
            if( wengaluru[i]>=maxval)
            {
                maxval=wengaluru[i];
                maxleft[i]=0;
            }
            else
            {
                maxleft[i]=maxval;
            }
        }
        maxval=0;
        for(int i=n-1; i>=0; i--)
        {
            if( wengaluru[i] >= maxval)
            {
                maxval = wengaluru[i];
                maxright[i] = 0;
            }
            else
                maxright[i] = maxval;
        }
        ll sumwater = 0;
        for(int i=0; i<n; i++)
        {
            if(maxleft[i]!=0 && maxright[i]!=0)
            {
                sumwater+= find_min(maxleft[i],maxright[i]) - wengaluru[i];
                sumwater=sumwater%MOD;
            }
        }
        pin(sumwater);
    }
}
