#include<bits/stdc++.h>
using namespace std;
#define loop(i,L,R) for(int i=(L);i<=(R);i++)
#define rept(i,L,R) for(int i=(L);i<(R);i++)
typedef long long ll;
typedef pair<int,int>PI;
typedef pair<pair<int,int>,int>PII;
const int N=1e6+10;
vector<PI>adj[N];
int ind[N],pre[N],outd[N];
long long int dist[N];
int main()
{
    int i,j,t1,t2,t3,r,p;
    queue<int>node;
    scanf("%d %d",&r,&p);
    rept(i,0,p)
    {
        scanf("%d %d %d",&t1,&t2,&t3);
        outd[t1]++;
        ind[t2]++;
        adj[t1].push_back(make_pair(t2,t3));
    }
    loop(i,1,r)
    {
        if(ind[i]==0)node.push(i);
        pre[i]=1;
    }

    while(!node.empty())
    {
        t1=node.front();
        node.pop();
        //cout<<t1<<endl;
        rept(j,0,outd[t1])
        {
            t2=adj[t1][j].first;
            t3=adj[t1][j].second;
            if(dist[t1]+t3+(pre[t1]*2)>dist[t2])
            {
                dist[t2]=dist[t1]+t3+2;
                pre[t2]=pre[t1]+1;
            }
            ind[t2]--;
            if(ind[t2]==0)node.push(t2);
        }
    }
    long long int ans=0;
    loop(i,1,r)
    {
        if(outd[i]==0)
            {
                if(dist[i]>ans)ans=dist[i];
            }
    }
    cout<<ans<<endl;

    return 0;
}
