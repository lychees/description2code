#include<bits/stdc++.h>
#define inf 100000000
using namespace std;

int a[105][105];
bool vis[105];
int x, y, z;
struct S
{
	int x,y;
};
S make ( int a, int b ) {
	S p;
	p.x = a, p.y = b;
	return p;
}
bool operator< (S a, S b ) {
	return a.y > b.y;
}

int main() {
	int t;
	cin >> t;
	while ( t-- ) {
		int n, m, k;
		scanf("%d%d%d", &n, &m, &k);
		for ( int i = 1; i <= n; i++ ) {
			for ( int j = 1; j <= n; j++ ) {
				a[i][j]=inf;
			}
		}
		memset(vis,0,sizeof vis);
		while(m-- ) {
				scanf("%d%d%d",&x,&y,&z); 
				a[x][y]=min(a[x][y],z);
				a[y][x]=min(a[y][x],z);
			}
			for (int k = 1; k <= n; k++ ) {
				for ( int i = 1; i <= n; i++ ) {
					for ( int j = 1;j <= n; j++ ) {
						a[i][j]=min(a[i][j],a[i][k]+a[k][j]);
					}
				}
			}
			priority_queue<S> q;	
			q.push(make(1,0));
			int ans = 0;
			while (!q.empty() ) {
				S to = q.top();
				q.pop();
				if (!vis[to.x]){
				vis[to.x]=1;
				ans += to.y;
			//	cout << to.y << endl;
				for (int i = 1; i<= k; i++ ) {
					if (!vis[i] ){
						q.push(make(i,a[to.x][i]));
					}	
				}
				}
			}
			printf("%d\n",ans);
	}
}