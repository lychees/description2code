#include<bits/stdc++.h>
using namespace std;
int a,s,d[102],f[102],g,h,j,k,l,i,n,m;
string x;
vector<int> v[102],pas[102];
vector<int>::iterator itt[102];
void dfs(int idx,int par){
    if(f[idx]) return;
    f[idx]=k+1;
    pas[k].push_back(d[idx]);
    for(vector<int>::iterator it=v[idx].begin();it!=v[idx].end();it++){
        if(*it==par) continue;
        dfs(*it,idx);
    }
    return;
}
main(){
    cin>>n;
    for(i=0;i<n;i++){
        cin>>d[i];
    }

    for(i=0;i<n;i++){
        cin>>x;
        for(a=0;a<n;a++){
            if(x[a]=='Y') v[i].push_back(a);
        }
    }

    for(i=0;i<n;i++){
        if(f[i]==0){

            dfs(i,-1);
            sort(pas[k].begin(),pas[k].end());
            itt[k]=pas[k].begin();
            k++;
        }
    }

    for(i=0;i<n;i++){
        //cout<<f[i]<<"* ";
        cout<<*itt[f[i]-1]<<" ";
        itt[f[i]-1]++;
    }
}
