#include <bits/stdc++.h>
using namespace std;
#define ll  long long
ll dp[2][55];
int main()
{
    int t,n;
    ll a;
    char ch;
    cin>>t;
    while(t--){
    	cin>>n;
    	memset(dp,0,sizeof(dp));
    	dp[0][0]=1;
    	dp[1][0]=1;
    	ll max_res=1;
    	for(int i=1;i<=n;++i){
    		cin>>ch;
    		if(ch=='N'){
    			dp[0][i]=max(dp[0][i-1],-dp[1][i-1]);
    			dp[1][i]=min(dp[1][i-1],-dp[0][i-1]);
    		}
    		else if(ch=='+'){
    			cin>>a;
    			dp[0][i]=dp[0][i-1]+a;
    			dp[1][i]=dp[1][i-1];
    		}
    		else if(ch=='-'){
    			cin>>a;
    			dp[1][i]=dp[1][i-1]-a;
    			dp[0][i]=dp[0][i-1];
    		}
    		else if(ch=='*'){
    			cin>>a;
    			dp[1][i]=dp[1][i-1]*a;
    			dp[0][i]=dp[0][i-1]*a;
    		}
    		else{
                cin>>a;
                dp[0][i]=dp[0][i-1];
                dp[1][i]=min(dp[1][i-1],dp[1][i-1]/a);
    		}
    		max_res=max(max_res,dp[0][i]);
    	}
    	cout<<max_res<<endl;
    }
    return 0;
}
