#include <bits/stdc++.h>
#define MOD 1000000007ll

using namespace std;

typedef long long ll;

int n;
ll sxx[800005], sx[800005], o[800005];

int u(int i, int rs, int re, int qs, int qe) {
	if (rs == qs && re == qe) {
		o[i]++;
		if (rs+1 == re) {
			sxx[i] = o[i]*o[i]%MOD;
			sx[i] = o[i];
		} else {
			sxx[i] = (sxx[2*i+1] + sxx[2*i+2] + 2*o[i]*(sx[2*i+1]+sx[2*i+2]) + o[i]*o[i]%MOD*(re-rs)) % MOD;
			sx[i] = sx[2*i+1] + sx[2*i+2] + o[i]*(re-rs);
		}
	} else {
		int md = (rs+re)/2;
		if (qs < md) u(2*i+1, rs, md, qs, min(qe,md));
		if (qe > md) u(2*i+2, md, re, max(qs,md), qe);
		sxx[i] = (sxx[2*i+1] + sxx[2*i+2] + 2*o[i]*(sx[2*i+1]+sx[2*i+2]) + o[i]*o[i]%MOD*(re-rs)) % MOD;
		sx[i] = sx[2*i+1] + sx[2*i+2] + o[i]*(re-rs);
	}
}

map<int,int> m;

int main() {
	scanf("%d", &n);
	ll res = 0;
	for (int i = 1; i <= n; i++) {
		int a; scanf("%d", &a);
		int l = m[a];
		u(0, 0, n+3, l, i);
		res = (res + sxx[0]) % MOD;
		m[a] = i;
	}
	printf("%lld\n", res);
	return 0;
}
