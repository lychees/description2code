#include <cstdio>
#include <utility>
#include <cstring>

using namespace std;

const int NMAX = 40005;

typedef pair<int, int> pii;

bool used[NMAX];

pii e[NMAX];

int main()
{
	int t,n,m,a,b,v1,v2,res;
	scanf("%d", &t);
	while(t--){
		res=0;
		scanf("%d %d", &n, &m);
		memset(used, 0, sizeof(bool)*(n+1));

		for(int i = 1; i <=m; i++){
			scanf("%d %d", &a, &b);
			e[i] = make_pair(a, b);
		}

		for(int i = 1; i <= n-1; i++) {
			scanf("%d", &a);
			int v1 = e[a].first;
			int v2 = e[a].second;
			if(!used[v1]) {
				res++;
				used[v1] = true;
			}

			if(!used[v2]) {
				res++;
				used[v2] = true;
			}
		}

		if(res == n)
			printf("YES\n");
		else
			printf("NO\n");
	}
}
