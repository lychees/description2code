#include<bits/stdc++.h>
using namespace std;
#define rep(i,n) for(i=0;i<n;i++)
#define ll long long
#define elif else if
#define pii pair<int,int>
#define mp make_pair
#define pb push_back
#define gc getchar_unlocked

int kx[20],cc[100],vals[100],tk[10];
bool done[100];
vector<int>adj[20];

int main()
{
    int tt;
    cin>>tt;
    while(tt--)
    {
        int i,j,n,m,k;

        cin>>n>>m>>k;

        rep(i,n) cin>>kx[i];
        rep(i,m) cin>>cc[i];
        rep(i,m) cin>>vals[i];

        for(i=0; i<n; i++)
        {
            for(j=0; j<m; j++)
            {
                int gc=__gcd(kx[i],cc[j]);
                if(gc>1) adj[i].pb(j);
            }
        }

        int t=k,ans=0,tmp=0,cnt=0;

        for(i=(1<<k)-1; i<(1<<n); i++)
        {
            for(cnt=j=0; j < t; j++)
            {
                if(i & (1 << j))
                {
                    tk[cnt]=j;
                    cnt++;
                }
                if(cnt>k) break;
            }

            if(i== (1<<t)-1) t++;
            if(cnt != k) continue;

            memset(done, 0, sizeof(done));

            tmp=0;
            for(j = 0; j < cnt; j++)
            {
                int key=tk[j];
                for( int p=0; p< adj[key].size(); p++)
                {
                    int val=adj[key][p];
                    if(done[val]==0)
                    {
                        done[val]=1;
                        tmp+=  vals[val];
                    }
                }
            }
            ans=max(tmp,ans);
        }
        cout<<ans<<"\n";
        for(int i=0;i<20;i++) adj[i].clear();
    }
    return 0;
}
