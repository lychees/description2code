#include <bits/stdc++.h>

using namespace std;

#define frl(a, b, c) for( (a) = (b);( a) < (c); (a++))
#define fru(a, b, c) for( (a) = (b); (a) <= (c); (a++))
#define frd(a, b, c) for( (a) = (b); (a) >= (c); (a--))
#define mst(a, b) memset(a, b, sizeof(a))
#define si(a) scanf("%d", &a)
#define ss(a) scanf("%s", a)
#define sc(a) scanf("%c", &a)

#define pb(a) push_back(a)
#define mp make_pair
#define nwl puts("");
#define sp << " " <<

#define sz size()
#define bg begin()
#define en end()
#define X first
#define Y second

#define vi vector <int>
#define vs vector <string>
#define ll long long int
#define dec int i = 0, j= 0, k = 0;

#define i(n) cin >> n;
#define p(s) cout << s;
#define pau system("pause");

vector<int> prime;

ll matval[11][11];
ll matadj[111][111];
set<string> set1;

#define mmdd 1000000007

ll r, c;
void fn(string str, int l, int r1){
    int len = str.sz;
    if(l < 0 || r1 >= len)
        return;
    string newstr = "";
    //cout << l << " " << r1 << endl;
    //cout << str[l] << " " << str[r1] << endl;
    if(l == r1)
        newstr += str[l];
    else
        if(str[l] == str[r1] )
            newstr += (str[l] + str[r1]);
        else
        	return;
    //cout << l <<  " " << r1 << " " << newstr << endl;
    if(newstr.size())
        set1.insert(newstr);
    else 
    	return;
    l--; r1++;
    while(l >= 0 && r1 < len){
        if(str[l] != str[r1])
            break;
        newstr = str[l] + newstr + str[r1];
        l--; r1++;
        //cout << newstr << endl;
        set1.insert(newstr);
    }
}

int f(string str){
    set1.clear();
   int len = str.size();
   for(int i = 0; i < len; i++){
        fn(str, i, i);
        fn(str, i, i+1);
   }
   return set1.size();
}

void matmul1(ll a[][111], ll b[][111]){
    ll res[111][111] = {0};
    ll ans = 0;
    for(ll x = 0; x < r*c; x++){
        for(ll y = 0; y < r*c; y++){
            for(ll z = 0; z < r*c; z++){
                ans += a[x][z] * b[z][y];
                ans %= mmdd;
            }
            res[x][y] = ans;
            ans = 0;
        }
    }
    for(int i = 0; i < r*c; i++)
        for(int j = 0; j < r*c; j++)
            a[i][j] = res[i][j];
}

int main(){
    int n, p, q, x, y, d;
    cin >> r >> c;
    for(int i = 0; i < r; i++){
        for(int j = 0; j < c; j++){
            string str;
            cin >> str;
            matval[i][j] = f(str);
//            cout << str << " " << f(str) << endl;
            matadj[i*c + j][i*c +j] = 1;
        }
        //matadj[i*c +i][i*c +i] = 1;
    }
    cin >> n;
    for(int i = 0; i < n; i++) {
        cin >> p >> q >> x >> y;
        matadj[p*c+q][x*c+y]++;
        matadj[x*c+y][p*c+q]++;
    }
    cin >> d;
    ll ident[111][111] = {0};
    for(int i = 0; i < 110; i++)
        //for(int j = 0; j < 110; j++)
            ident[i][i] = 1;
    while(d){
        if(d%2 != 0)
            matmul1(ident, matadj);
        matmul1(matadj, matadj);
        d /= 2;
    }
    ll ans1[11][11] = {0};
    for(int i = 0; i < r; i++){
        for(int j = 0; j < c; j++){
            ll sum = 0;
            for(int x = 0; x < r; x++)
                for(int y = 0; y < c; y++)
                    sum += ident[i*c+j][x*c+y] * matval[x][y], sum %= mmdd;
            cout << sum << " ";
        }
        cout << endl;
    }


}





























