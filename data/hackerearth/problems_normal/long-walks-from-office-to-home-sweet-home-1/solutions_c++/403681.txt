#include<bits/stdc++.h>
using namespace std;
#define S(x) scanf("%lld", &x)
#define ll long long
#define MOD 1000000007

ll s[1000005];
ll c[1000005];
ll g[100][100];
ll n,k;
ll ans[100][100];

void mult1() {
	ll i,j,k;
	ll temp[100][100];
	for(i=  0;i < n;i++ ){
		for(j = 0;j < n;j++) {
			temp[i][j] = ans[i][j];
		}
	}
	for(i = 0;i < n;i++) {
		for(j = 0;j < n;j++) {
			ans[i][j] = 0;
			for(k = 0;k < n;k++) {
				ans[i][j] = (ans[i][j] + (temp[i][k]*g[k][j]) % MOD)%MOD;
			}
		}
	}
	/*for(i=  0;i < n;i++ ) {
			for(j= 0;j < n;j++) {
				cout << ans[i][j] << " ";
			}
			cout << "\n";
		}*/
}

void mult2() {
	ll i,j,k;
	ll temp[100][100];
	for(i=  0;i < n;i++ ){
		for(j = 0;j < n;j++) {
			temp[i][j] = g[i][j];
		}
	}
	for(i = 0;i < n;i++) {
		for(j = 0;j < n;j++) {
			g[i][j] = 0;
			for(k = 0;k < n;k++) {
				g[i][j] = (g[i][j] + (temp[i][k]*temp[k][j]) % MOD) %MOD;
			}
		}
	}
/*	for(i=  0;i < n;i++ ) {
			for(j= 0;j < n;j++) {
				cout << g[i][j] << " ";
			}
			cout << "\n";
		}*/
}

void solve() {
	memset(ans , 0, sizeof(ans));
	ll i,j;
	for(i = 0;i <= n;i++) {
		ans[i][i] = 1;
	}
	while(k) {
		if(k & 1) {
			mult1();
			--k;
		}
		mult2();
		k >>= 1;
	}
}


int main()
{
	ll t;
	S(t);
	while(t--) {
		S(n);
		S(k);
		ll u,v;
		S(u);
		S(v);
		ll i,j;
		for(i=  0;i < n;i++ ) {
			for(j= 0;j < n;j++) {
				S(g[i][j]);
			}
		}
		solve();
		cout << ans[u][v] <<"\n";
		
	}
}
