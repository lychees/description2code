// iostream is too mainstream
#include <cstdio>
// bitch please
#include <iostream>
#include <algorithm>
#include <cstdlib>
#include <vector>
#include <set>
#include <map>
#include <queue>
#include <stack>
#include <list>
#include <cmath>
#include <iomanip>
#define dibs reserve
#define OVER9000 1234567890
#define ALL_THE(CAKE,LIE) for(auto LIE =CAKE.begin(); LIE != CAKE.end(); LIE++)
#define tisic 47
#define soclose 1e-8
#define chocolate win
// so much chocolate
#define patkan 9
#define ff first
#define ss second
#define abs(x) ((x < 0)?-(x):x)
#define uint unsigned int
#define dbl long double
using namespace std;
// mylittledoge

long long count(int H, vector<int> &A) {
	if(H < 0) return 0;
	long long ret =-A.size();
	vector< pair<int,int> > B;
	pair<int,int> p =make_pair(-1,0);
	for(int i =0; i < A.size(); i++) {
		if(p.ff != A[i]) {
			if(p.ff != -1) B.push_back(p);
			p.ff =A[i];
			p.ss =0;}
		if(p.ff == A[i]) p.ss++;}
	B.push_back(p);
	int N =B.size();
	auto C =B;
	for(int i =0; i < N; i++) B[i].ff ^=H;
	sort(B.begin(),B.end());

	int a =0;
	for(int i =0; i < N; i++) {
		while(a < N && B[a].ff < C[i].ff) a++;
		if(a < N && B[a].ff == C[i].ff) ret +=1LL*B[a].ss*C[i].ss;}

	vector< pair<int,int> > Bn,Cn;
	for(int j =0; j < 30; j++) {
		if((H>>j)&1) {
			for(int i =0; i < N; i++) {
				B[i].ff ^=(1<<j);
				if(i > 0 && B[i].ff < B[i-1].ff) swap(B[i],B[i-1]);}
			a =0;
			for(int i =0; i < N; i++) {
				while(a < N && B[a].ff < C[i].ff) a++;
				if(a < N && B[a].ff == C[i].ff) ret +=1LL*B[a].ss*C[i].ss;}
			}
		for(int i =0; i < N; i++) {
			B[i].ff =((B[i].ff)>>(j+1))<<(j+1);
			C[i].ff =((C[i].ff)>>(j+1))<<(j+1);}
		Bn.clear(); Cn.clear();
		a =0;
		while(a < N) {
			if(a < N-1 && B[a].ff == B[a+1].ff) {
				Bn.push_back(make_pair(B[a].ff,B[a+1].ss+B[a].ss));
				a +=2;}
			else {
				Bn.push_back(B[a]);
				a++;}
			}
		a =0;
		while(a < N) {
			if(a < N-1 && C[a].ff == C[a+1].ff) {
				Cn.push_back(make_pair(C[a].ff,C[a+1].ss+C[a].ss));
				a +=2;}
			else {
				Cn.push_back(C[a]);
				a++;}
			}
		B =Bn, C =Cn;
		N =Bn.size();}

	return ret/2;}

int main() {
	srand(time(0));
	cin.sync_with_stdio(0);
	cin.tie(0);
	int T;
	cin >> T;
	for(int t =0; t < T; t++) {
		int N,Q;
		cin >> N;
		vector<int> A(N+1,0);
		for(int i =0; i < N; i++) {
			cin >> A[i+1];
			A[i+1] ^=A[i];}
		sort(A.begin(),A.end());

		cin >> Q;
		for(int q =0; q < Q; q++) {
			int L,R;
			cin >> L >> R;
			L--;
			cout << count(R,A)-count(L,A) << "\n";}
		}
	return 0;}

// look at my code
// my code is amazing