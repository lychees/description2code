// frodoAndTheRing.cpp : Defines the entry point for the console application.
//

#include <iostream>
#define INF 1000000000
using namespace std;

long long int a[202][202];
long long int dp[202][202];
int n, m;

int max(int a, int b)
{
	if (a > b)
		return a;
	return b;
}

int main(int argc, char* argv[])
{
	ios_base::sync_with_stdio(0);
	
	int i, j, t;
	char ch;

	cin >> t;
	while (t--)
	{
		cin >> n >> m;

		for (i = 0; i <= n; i++)
			dp[i][0] = -INF;
		for (j = 0; j <= m; j++)
			dp[0][j] = -INF;

		for (i = 1; i <= n; i++)
		{
			for (j = 1; j <= m; j++)
			{
				cin >> ch;
				if (ch == 'T')
					a[i][j] = 150;
				else if (ch == 'D')
					a[i][j] = -100;
				else
					a[i][j] = 0;
				dp[i][j] = 0;
			}
		}

		for (i = 1; i<=n; i++)
		{
			for (j = 1; j<=m; j++)
			{
				if (i == 1 && j == 1)
				{
					dp[i][j] = a[i][j];
					if (dp[i][j] < 0)
						dp[i][j] = -INF;
				}
				else if (dp[i - 1][j] != -INF && dp[i][j - 1] != -INF)
				{
					dp[i][j] = max(dp[i - 1][j], dp[i][j - 1]) + a[i][j];
					if (dp[i][j] < 0)
						dp[i][j] = -INF;
				}
				else if (dp[i - 1][j] != -INF)
				{
					dp[i][j] = dp[i - 1][j] + a[i][j];
					if (dp[i][j] < 0)
						dp[i][j] = -INF;
				}
				else if (dp[i][j - 1] != -INF)
				{
					dp[i][j] = dp[i][j - 1] + a[i][j];
					if (dp[i][j] < 0)
						dp[i][j] = -INF;
				}
				else
					dp[i][j] = -INF;
			}
		}

		if (dp[n][m]>=0 || (n==1 && m==1))
			cout << dp[n][m] << endl;
		else
			cout << "-1" << endl;
	/*	for (i = 0; i <= n; i++)
		{
			for (j = 0; j <= m; j++)
				cout << dp[i][j] << " ";
			cout << endl;
		}*/

		//cin >> ch;
	}
	return 0;
}

