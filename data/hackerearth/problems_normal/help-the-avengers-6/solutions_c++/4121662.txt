#include <bits/stdc++.h>

using namespace std;

#define maxN 32000
#define maxVal 1000000

int n;
int prime[maxVal+5];
int bit[maxN+5];
int a[maxN+5]; 

void pre()
{
	int i,j;
	fill(prime,prime+maxVal+2,1);
	prime[0]=prime[1]=0;
	for(i=2;i*i<=maxVal;i++)
	{
		if(prime[i])
		{
			for(j=i*i;j<=maxVal;j+=i)
				prime[j]=0;
		}
	}
}

void update(int i,int v)
{
	while(i<=n)
	{
		bit[i]+=v;
		i=i+(i&(-1*i));
	}
}

int query(int i)
{
	int r=0;
	while(i>0)
	{
		r=r+bit[i];
		i=i-(i&(-1*i));
	}
	return r;
}

int main()
{
	pre();
    int t,q,i,x,y;
    char o[5];
    scanf("%d",&t);
    while(t--)
    {
    	scanf("%d",&n);
    	fill(bit,bit+n+2,0);
    	for(i=1;i<=n;i++)
    	{
    		scanf("%d",&a[i]);
    		if(prime[a[i]])
    		{
    			a[i]=1;
    			update(i,1);
    		}
    		else
    			a[i]=0;
		}
		scanf("%d",&q);
		while(q--)
		{
			scanf("%s%d%d",o,&x,&y);
			if(o[0]=='A')
			{
				//query
				printf("%d\n",query(y)-query(x-1));
			}
			else
			{
				//update
				if(prime[y])
					y=1;
				else
					y=0;
				if(a[x]!=y)
				{
					update(x,y-a[x]);
					a[x]=y;
				}
			}
		}
    }
    return 0;
}
