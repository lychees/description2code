
#pragma comment(linker, "/STACK:1024000000,1024000000") 
#include <iostream> 
#include <stdlib.h> 
#include <string>
#include <ctime> 
#include <cmath> 
#include <stdio.h> 
#include <vector> 
#include <algorithm> 
#include <queue> 
#include <string.h> 
#include <map> 
#include <set> 
#include <assert.h>
#include <fstream>
#define x first 
#define y second 
#define pb push_back 
#define mp make_pair 
#define vi vector<int> 
#define pii pair<int,int> 
#define ll long long 
#define inf 1000000007 
#define mod 1000000007 
#define all(x) x.begin(),x.end() 
#define N 100010
#define pi acos(-1.)
#define DBG(x) cerr<<#x<<"="<<x<<"\n"; 
#define FOREACH(it,x) for(__typeof(x.begin()) it=x.begin();it!=x.end();it++) 
using namespace std;

typedef ll arr[32][32];
void copy(arr &a,arr b){
    for(int i=0;i<32;i++)
        for(int j=0;j<32;j++)
            for(int k=0;k<32;k++){
                a[i][j]=b[i][j];
            }
}
void mul(arr &a,arr b){
    arr c;
    memset(c,0,sizeof(c));
    for(int i=0;i<32;i++)
        for(int j=0;j<32;j++)
            for(int k=0;k<32;k++){
                c[i][j]=(c[i][j]+a[i][k]*b[k][j]);
                if(c[i][j]>=mod)c[i][j]%=mod;
            }
    copy(a,c);
}
void mul1(ll f[32],arr b){
    ll a[32]={0};
    for(int i=0;i<32;i++){
        for(int j=0;j<32;j++){
            a[i]+=b[i][j]*f[j]%mod;
        }
        a[i]%=mod;
    }
    for(int i=0;i<32;i++)f[i]=a[i];
}
arr p[66];
int main(){
    int T,i,j,k,m,ca=0;
    memset(p[0],0,sizeof(p[0]));
    for(i=0;i<2;i++)
        for(j=0;j<2;j++)
            for(int l=0;l<2;l++)
                for(int r=0;r<2;r++){
                    int s=(i<<3)+(j<<2)+(l<<1)+r;
                    for(k=0;k<10;k++){
                        int ii=i,jj=j,x=l,y=r;
                        if(k==2)ii^=1;
                        if(k==3)jj^=1;
                        if(k==5)x^=1;
                        if(k==7)y^=1;
                        int st=(ii<<3)+(jj<<2)+(x<<1)+y;
                        p[0][st][s]++;p[0][st+16][s]++;
                    }
                }
    for(i=16;i<32;i++)p[0][i][i]++;
    for(i=1;i<=65;i++){
        copy(p[i],p[i-1]);
        mul(p[i],p[i]);
    }
    scanf("%d",&T);
    while(T--){
        ll n;
        cin>>n;
        //DBG(n)
        int d[4];ll f[32]={0};
        f[0]=f[16]=5;
        for(i=0;i<4;i++)f[1<<(3-i)]=f[16+(1<<(3-i))]=1;
        n--;
        for(i=63;i>=0;i--)if(n&(1LL<<i)){
            mul1(f,p[i]);
        }
        for(i=0;i<4;i++)scanf("%d",&d[i]);
        ll ans=0;
        int s=0;
        for(i=0;i<4;i++)s+=(d[i]<<(3-i));
        ans=f[s+16];
        int ok=1;
        for(i=0;i<4;i++)if(d[i]&1)ok=0;
        if(ok)ans++;
        if(ans>=mod)ans%=mod;
        printf("%lld\n",ans);
    }
    return 0;
}