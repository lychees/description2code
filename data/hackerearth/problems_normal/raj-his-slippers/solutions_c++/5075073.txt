// Raj and his slippers.........
 
#include <iostream>
#include <vector>
#include <stdio.h>
#include <utility>
 
int mx(int a, int b)
{
	if (a > b)
		return a;
	return b;
}
 
using namespace std;
int main()
{
	int T, N, x, y, p, q, a, b, R, S, index, wake, open, hostelin;
	char ch;
 
	cin >> T;
 
	for (int t = 1; t <= T; t++)
	{
		index = -1;
		cin >> N;
		scanf("%d:%d %d:%d %d:%d", &x, &y, &p, &q, &a, &b);
		
		cin >> R >> S;
 
		hostelin = (60 * x) + y;
		open = (60 * a) + b;
		wake = (60 * p) + q;
 
		int earliest = -1; // it is storing the cost
 
		for (int n = 1; n <= N; n++)
		{
			int h1, m1, h2, m2, start, end;
		
			scanf("%d:%d", &h1, &m1);
			scanf("%d:%d", &h2, &m2);
 
			int initial = (mx(wake + R, open) + R + S);
 
			start = (60 * h1) + m1;
			end = (60 * h2) + m2;
 
			if (initial < start && initial < hostelin)
			{
				if (earliest == - 1 || initial < earliest)
				{
					earliest = initial;
					index = n;
				}
			}
 
			int final = (mx(open, mx(end, wake) + R) + R + S);
			if (final < hostelin)
			{
				if (earliest == - 1 || final < earliest)
				{
					earliest = final;
					index = n;
				}
			}
		}
		cout << "Case " << t << ": " << index << endl;
 
	} 
}