#include <bits/stdc++.h>
using namespace std;
#include <stdio.h>
int a[100005],b[200005];
int z[200005];
int min(int a, int b)
{
	if(a<=b)return a;
	return b;
}
int main()
{
   // printf("Hello World!\n");
   int n,m,l,r;
   scanf("%d%d",&n,&m);
   int i;
   for(i=1;i<=n;i++)
   {
   	scanf("%d",&a[i]);
   	b[i+n] = a[i];
   	b[i+2*n] = a[i];
   }
   for(i=0;i<n;i++)
   scanf("%d",&b[i]);
 /*  for(i=0;i<=3*n;i++)
   printf("%d ",b[i]);
   printf("\n");
   */
   for(i=1,l=r=0;i<=3*n;i++)
   {
   	if(i<=r)z[i] = min(z[i-l],r-i+1);
   //	printf("basic %d %d\n",i,z[i]);
   	while(i+z[i]<=3*n && b[z[i]]==b[i+z[i]])z[i]++;
   	if(i + z[i] > r)l = i,r = i+z[i]-1;
   }
  /*   for(i=0;i<=3*n;i++)
   printf("%d ",z[i]);
   printf("\n");
   */
   set<int> ans;
   for(i=n+1;i<=2*n;i++){
   if(z[i]==n){
   	ans.insert(i-n-1);
   	//printf("ans is %d\n",i-n);
   }
   }
   int cur = 0;
   int found = 0;
   for(i=1;i<=m;i++)
   {
   	char s[5];
   	int k;
   	scanf("%s%d",&s,&k);
   	if(s[0]=='L')cur +=k;
   	else cur-=k;
   	cur %=n;
   	if(cur <0)cur +=n;
   //	printf("cur is %d\n",cur);
   	if(ans.find(cur)!=ans.end()){found = 1;
   	printf("%d ",i);
   	break;
   	}
   }
   if(found==0)printf("-1\n");
    return 0;
}
