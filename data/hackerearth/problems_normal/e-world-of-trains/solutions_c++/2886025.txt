#include <bits/stdc++.h>
#define pb push_back
#define sqr(x) (x)*(x)
#define sz(a) int(a.size())
#define reset(a,b) memset(a,b,sizeof(a))
#define oo 1000000007

using namespace std;

typedef pair<int,int> pii;
typedef long long ll;

ll dp[3334][3334];
ll sum1[3334][3334];
ll sum2[3334][3334];

int main(){
//    freopen("input.txt","r",stdin);
    int n,l,t,k;
    cin>>n>>l>>t>>k;
    dp[0][0]=1;
    sum1[0][0]=1;
    sum2[0][0]=1;
    for(int i=1; i<=n; ++i) for(int j=0; j<=t; ++j){
        int kk=k-1;
        if(i==n) kk=k;
        dp[i][j] += (sum1[i-1][j] - ((i-l>=0)?(sum1[i-l][j]):0))*kk;
        dp[i][j] = (dp[i][j]%oo + oo)%oo;
        if(l<=i && j>=1){
            int sub=i-l+1;
            dp[i][j] += sum2[i-l][j-1]*kk;
            if(i-l-sub>=0 && j-1-sub>=0) dp[i][j] -= sum2[i-l-sub][j-1-sub]*kk;
            dp[i][j] = (dp[i][j]%oo + oo)%oo;
        }
        sum1[i][j] = (sum1[i-1][j] + dp[i][j])%oo;
        sum2[i][j] = ((j>0?sum2[i-1][j-1]:0) + dp[i][j])%oo;
    }
    cout<<dp[n][t]<<endl;
}


