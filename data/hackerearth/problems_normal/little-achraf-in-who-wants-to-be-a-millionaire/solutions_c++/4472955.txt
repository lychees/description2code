#include <cstdio>
#include <cstdlib>
#include <cassert>
#include <iostream>
#include <set>
#include <vector>
#include <cstring>
#include <string>
#include <algorithm>
#include <numeric>
#include <cmath>
#include <complex>
#include <map>
#include <queue>
using namespace std;
typedef long long ll;
typedef vector<int> vi;
typedef vector<ll> vl;
typedef vector<vl> vvl;
typedef vector<vi> vvi;
typedef vector<double> vd;
typedef pair<int, int> pii;
typedef pair<double, double> pdd;
typedef vector<pii> vii;
typedef vector<string> vs;
const int mod = 1000000007;

int main() {
  int n, Q;
  cin >> n >> Q;
  vl l(n, 1);
  const ll MAX = 1000000000000009LL;
  while (l.back() < MAX) {
  	ll s = 0;
  	for (int i = 0; i < n; ++i) s = min(s + l[l.size() - i - 1], MAX);
  	l.push_back(s);
  }
  string s(n, '?');
  ll mul = 1;
  for (int test = 1; test <= Q; ++test) {
  	ll ind, x;
  	char c;
  	cin >> ind >> x >> c;
  	--x;
  	if (x > l.size() + n) {
  		x = (x - l.size()) % n + l.size();
  	}
  	while (x >= n) {
  		for (int i = 0; i < n; ++i) {
  			int j = x - n + i;
  			if (j < l.size() && l[j] < ind) {
  				ind -= l[j];
  			} else {
  				x = j;
  				break;
  			}
  		}
  	}
  	if (ind > 1) {
  		mul = 0;
  		break;
  	}
  	if (s[x] != '?' && s[x] != c) {
  		mul = 0;
  		break;
  	}
  	s[x] = c;
  }
  for (int i = 0; i < s.size(); ++i) if (s[i] == '?') mul = mul * (26*2+10) % mod;
  cout << mul << endl;
  return 0;
}