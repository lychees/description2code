
/* Akshat Mathur 
	IIIT Allabahad */
#include <bits/stdc++.h>
using namespace std;
#define FOR(i,a,n) for(int i=a;i<n;i++) //for loop
#define si(x) scanf("%d",&x) // scan int
#define sll(x) scanf("%lld",&x) // scan ll
#define ss(x) scanf("%s",x) // scan string
#define pi(x) printf("%d\n",x) // print int
#define pll(x) printf("%lld\n",x) // print ll
#define ps(x) printf("%s\n",ch) // print string
#define INF 2000000000 // infinity
#define ll long long
#define mp make_pair
#define pb push_back
#define fr first
#define se second
ll neg_mod(ll x, ll m)
{
    while(x<m)
    {
        x+=m;
    }
    return x%m;
}
ll a[10000069];
ll rec(ll i,ll n,ll a[],ll m)
{
    
    if(i<=n){
        //ll k = neg_mod(-1*a[i],m);
        //cout<<k<<endl;
        return a[i];
    }
    if(n%2==0)
        {
            ll k = i - (i/(n+1))*(n+1);
            if(i/(n+1)%2==0)
                return a[k]%m;
            else{
                    
                return neg_mod(-1*a[k],m);
            }
                
           
        }
    else
    {
      ll k = i - (i/(n+1))*(n+1);
      return a[k]%m;  
    }
}

int main()
{
   // cout<<(-4)%10<<endl;
	int t;
	si(t);
	while(t--)
    {
        ll n,m,z;
        sll(n);
        sll(m);
        sll(z);
        
        
        FOR(i,0,n) {
            a[i]=0;
            sll(a[i]);
        }
        ll next=0;
        int s=1;
        for(int i=n-1;i>=0;i--){
            next = (next+s*a[i]);
            if(next<0) next=neg_mod(next,m);
            if(s==1) s=-1;
            else s=1;
        }
       // cout<<next<<endl;
    
        a[n] = next%m;
        
        cout<<rec(z,n,a,m)%m<<endl;
            
    }
	return 0;
}
