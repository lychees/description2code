#include<stdio.h>
int main()
{
	int t;
	int n;
	scanf("%d",&t);
	for(int i=0;i<t;i++)
	{
		scanf("%d",&n);
		long long int arr[n+1];
		bool front[n+1];
		bool end[n+1];
		long long int fval[n+1];
		long long int eval[n+1];
		for(int j=0;j<n;j++)
		{
			scanf("%lld",&arr[j]);
			front[j]=false;
			end[j]=false;
			fval[j]=-1;
			eval[j]=-1;
		}
		long long int max=arr[0];
		for(int j=1;j<n;j++)
		{
			if(arr[j]<max)
			{
				front[j]=true;
				fval[j]=max;
			}
			else
				max=arr[j];
		}
		max=arr[n-1];
		for(int j=n-1;j>=0;j--)
		{
			if(arr[j]<max)
			{
				end[j]=true;
				eval[j]=max;
			}
			else
				max=arr[j];
		}	
		
		long long int count=0;
		for(int j=1;j<n-1;j++)
		{
			if(front[j]&&end[j])
			{
				//printf("Adding for %d",j);
				if(fval[j]<eval[j])
					count=count+(fval[j]-arr[j]);
				else
					count=count+(eval[j]-arr[j]);
			
				count=count%1000000007;
			}
		}
		printf("%lld\n",count);
	}
	return 0;
}	
				
		