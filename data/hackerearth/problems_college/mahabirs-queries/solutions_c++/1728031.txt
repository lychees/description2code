#include <iostream>
using namespace std;
void print(int a[][100], int n) {
	for(int i=0;i<n;i++) {
		for(int j=0;j<n;j++) 
			cout<<a[i][j]<<" ";
		cout<<endl;
	}
}

int main()
{
    int n, q;
    cin>>n>>q;
    int a[100][100];
    int temp[100][100];
    long long a_val;
    for(int i=0;i<n;i++)
    	for(int j=0;j<n;j++) 
    		cin>>a[i][j];
    while(q--) {
    	cin>>a_val;
    	a_val=(a_val/90)%4;
    	if(a_val==0) { print(a,n); cout<<endl; }
    	if(a_val==1) {
    		for(int r=0;r<n;r++)
			{
   				for(int c=0;c<n;c++)
   				{
       				temp[c][n-r-1] = a[r][c];
   				}
			}
    		print(temp,n);
    		cout<<endl;
    	}
    	if(a_val == 2) {
    		for(int r=0;r<n;r++) 
    			for(int c=0;c<n;c++)
    				temp[c][n-r-1] = a[n-c-1][r];
    		print(temp,n);
    		cout<<endl;
    	}
    	if(a_val == 3) {
    		for(int r=0;r<n;r++) 
    			for(int c=0;c<n;c++)
    				temp[n-r-1][c] = a[c][r];
    		print(temp,n);
    		cout<<endl;
    	}
    	
    	
    }
    return 0;
}
