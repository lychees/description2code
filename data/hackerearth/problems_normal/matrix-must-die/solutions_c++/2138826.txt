#include <bits/stdc++.h>
#define bs 1000000007
using namespace std;
vector<vector<long long> > M[100];
long long n,m,q,tests;
vector<vector<long long> > mult(vector<vector<long long> > a,
vector<vector<long long> > b)
{ 
  vector<vector<long long> > res;
  res.resize(a.size());
  for (int i=0;i<a.size();i++)
   res[i].resize(b[0].size());
  for (int i=0;i<a.size();i++)
   for (int j=0;j<b[0].size();j++)
    res[i][j]=0;
  
  for (int i=0;i<a.size();i++)
   for (int k=0;k<a[i].size();k++)
    for (int j=0;j<b[0].size();j++)
     res[i][j]=(res[i][j]+a[i][k]*b[k][j])%bs;
  return res;
}
int main(){
ios_base::sync_with_stdio(0);
vector<vector<long long> > mag;
mag.resize(9);
for (int i=0;i<9;i++)
 mag[i].resize(9);
for (int i=0;i<9;i++) 
 for (int j=0;j<9;j++)
  mag[i][j]=0;
for (int i=0;i<9;i++)
 for (int j=0;j<9;j++)
 {
  long i1,j1,i2,j2;
  i1=i/3;j1=i%3;
  i2=j/3;j2=j%3;
  mag[i][j]=abs(i1-i2)+abs(j1-j2)+abs(i1+j1-i2-j2);   
 }
M[0]=mag;
for (int i=1;i<=47;i++)
{
 M[i]=mult(M[i-1],M[i-1]);
}
cin>>tests;
for (;tests;--tests)
{
    cin>>n;
    vector<vector<long long> > v;
    v.resize(1);
    v[0].resize(9);
    
    for (int i=0;i<9;i++)
     cin>>v[0][i];
     
    for (int i=47;i+1;--i)
     if (n&(1ll<<i))
      v=mult(v,M[i]);
    for (int i=0;i<3;i++)
    {
     for (int j=0;j<3;j++)
     {
         if (j)cout<<" ";
         cout<<v[0][i*3+j]%bs;     
     }
     cout<<endl;
     }
}
return 0;}