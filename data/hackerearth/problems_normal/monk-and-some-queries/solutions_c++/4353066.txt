#include <cstdio>
#include <iostream>
#include <algorithm>
#include <string.h>
#include <vector>
#include <set>
#include <map>
#include <queue>
#include <list>
#include <math.h>

#define ll long long int
#define maxN 200
#define maxVal 1e8
#define minVal -1e8
#define mod1e9+7

#define gcd(a,b) __gcd(a,b)

using namespace std;
priority_queue<int> pq;
priority_queue<int,std::vector<int>, std::greater<int> >pq1;
int arr[100005];
int main()
{
    int i,a,n,ch;
    //ios::sync_with_stdio(false);
    memset(arr,0,sizeof(arr));
    scanf("%d",&n);
    for(i=1;i<=n;i++)
    {
        scanf("%d",&ch);
        if(ch==1)
        {
            scanf("%d",&a);
            arr[a]++;
            pq.push(a);
            pq1.push(a);
        }
        else if(ch==2)
        {
           scanf("%d",&a);
            if(arr[a]<=0)
            {
               printf("-1\n");
            }
            else
                {
                    arr[a]--;
                    if(pq.top()==a)
                        pq.pop();
                    if(pq1.top()==a)
                        pq1.pop();
                }
        }
        else if(ch==3)
           {
              while(pq.size()&&(arr[pq.top()]==0))
                pq.pop();
              if(pq.size())
                printf("%d\n",pq.top());
              else
                printf("-1\n");
           }
        else
        {
             while(pq1.size()&&(arr[pq1.top()]==0))
                pq1.pop();
              if(pq1.size())
                printf("%d\n",pq1.top());
              else
                printf("-1\n");
        }

    }
}
