#include<bits/stdc++.h>
#define sll(n) scanf("%lld",&n)
#define ll long long int
using namespace std;

int bs(vector<ll>& a, ll l,ll r, ll d)
{
	int m;
	

	while(l <= r)
	{
		m = l+(r-l)/2;
		//cout <<"in fn l = "<<l<<" & r = "<<r <<" & m = "<<m<<" "<<a[m]<<" "<< d<<"\n";
		if(a[m] == d)
			return 1;
		else if(a[m] > d)
			r = m - 1;
		else
			l = m + 1;
	}
	return 0;
}
int main()
{
	ll t,n,i,j,k,r;
	std::vector<ll> a(1000000);
    std::vector<ll> s(1000000);
    std::vector<ll> b(1000000);
	sll(t);
	while(t--)
	{
		ll ma = 0,ma1 = 0,c;
		sll(n);
		for(i = 0; i < n; i++)
		{
			sll(a[i]);
			sll(s[i]);
			b[i] = -1;
			//b.insert(b.begin()+i, 0);
		}
		k = 0;j = 0;
		c = 0;
		
		while(j < n)
		{
		//	cout << "before checking r k = "<<k<<"   ";for(i = 0;i <k;i++) cout << "b["<<i<<"]="<<b[i]<<" ";cout<<endl;
			r = bs(b,0,k-1,a[j]);
		//	cout << "r="<<r<<endl;
			if(s[j] == 1 && !r)
			{
				c++;
				b[k] = a[j];k++;
				sort(b.begin(),b.begin()+k);
			//	cout << "after sorting b";for(i = 0;i <k;i++) cout << "b["<<i<<"]="<<b[i]<<" ";cout<<endl;
				if(c>ma)
				ma = c;
			//	k++;
			}
			else if(s[j] == 1 && r)
			{
				
				
			}
			else
			{
				c = 0;
				if(ma>ma1)
				ma1= ma;
				ma=0;
			}
			//cout << ma << endl;
			j++;
		}
		if (ma>ma1)
		ma1=ma;
		cout << ma1 << endl;
		
	}
}
