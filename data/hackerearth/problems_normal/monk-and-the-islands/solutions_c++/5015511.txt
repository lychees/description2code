/*
*
*"@NainwalArun"
*
*/
#include <bits/stdc++.h>
using namespace std ;

#define ft first
#define sd second
#define pb push_back
#define all(x) x.begin(),x.end()

#define ull unsigned long long int
#define ll long long int
#define vi vector<long long int>
#define vii vector<pair<long long int,long long int> >
#define pii pair<long long int,long long int>
#define mp make_pair
#define arun() int main()
#define loop(i, a, b) for(i=a; i<b; i++)
#define pool(i, a, b) for(i=a; i>b; i--)
const int N = 1e5 + 10;
const int mod = 1e9 + 7;
const ll INF = 1LL << 62;
vector<ll> v[100001];
ll dist[10001];
ll visit[10001]={0};
ll bfs(ll s){
	memset(visit,0,sizeof visit);
	queue<ll>q;
	q.push(s);
	dist[s]=0;
	ll k,i;
	while(!q.empty()){
		k=q.front();
		//cout<<k<<endl;
		q.pop();
		visit[k]=1;
		for(i=0;i<v[k].size();i++){
			if(visit[v[k][i]]==0){
				q.push(v[k][i]);
				visit[v[k][i]]=1;
			}
			dist[v[k][i]]=min(dist[v[k][i]],dist[k]+1);
		}
	}
}

arun(){
	ll n,m,t,i,j,k,l,x,y;
	cin>>t;
	while(t--){
		cin>>n>>m;
		loop(i,0,n+1){
			dist[i]=INF;
		}
		while(m--){
			cin>>x>>y;
			v[x].pb(y);
			v[y].pb(x);
		}
		bfs(1); 
		cout<<dist[n]<<endl;
		for(i=0;i<=n;i++){
			v[i].erase(v[i].begin(),v[i].end());
		}
	}
return 0;
}
