#include<bits/stdc++.h>
using namespace std;

int main() {
	int T, list_sp[20002];
	char S[10001], F[10001];
	scanf("%d", &T);
	while(T--)
	{
		int N, K, L, R, i, num_sp = 1;
		long long count=0;
		bool isSp[256] = {false};
		scanf("%d %d %d %d %s %s", &N, &K, &L, &R, S, F);
		for(i=0; i<K; i++)
			isSp[F[i]] = true;
		list_sp[0] = -1;
		for(i=0; i<N; i++)
		{	
			if(isSp[S[i]])
			{
				list_sp[num_sp] = i;
				num_sp++;
			}
		}
		for(int e = num_sp; e<=num_sp+R+1; e++)
			list_sp[e] = N;
		if(L==0)
		{
			for(int e = 1; e<= num_sp; e++)
			{
				int nor_cnt = list_sp[e]-list_sp[e-1]-1;
				//cout<<"e="<<e<< " nor_cnt = "<<nor_cnt<<endl;
				count += (nor_cnt*(nor_cnt+1))/2;
				//cout<<"count="<<count<<endl;
			}
			L = 1;
		}
		if(R!=0)
		{
			for(int first = 1, second = L; second < num_sp && first < num_sp; first++, second++)
			{
				int including_first = list_sp[first] - list_sp[first-1];
				int including_range = list_sp[second+R-L+1] - list_sp[second];
				//cout<<"including_first= "<<including_first<<" including_range="<<including_range<<endl;
				count += including_first*including_range;
			}
		}
		printf("%lld\n", count);
	}
}