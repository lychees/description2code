#include<bits/stdc++.h>
#include<malloc.h>
using namespace std;
int BIT[2000011];
int a[500011];
int total;
int sum(int index)
{
        int s=0;
        while(index>0)
        {
                s=s+(BIT[index]);
                index=index-(index & -index);
        }
        return s;
}
 
void update(int value,int index)
{
        while(index<=total)
        {
                BIT[index]=BIT[index]+value;
                index=index+(index & -index);
        }
       
}

 
int main()
{
        int n,i,j,k,x,l,r,q,temp,t,m;
        char c;
        long long int ans=0;
        scanf("%d",&n);
        scanf("%d",&m);
       	total=n+3*m+5;
        for(i=0;i<n;i++)
        {
   			scanf("%d",&temp);
   			a[temp]=m+i+1;
        	update(1,m+i+1);
        }
        l=m+1;
        r=n+m;
      
        cout<<endl;
       	for(i=0;i<m;i++)
       	{
       		cin>>x;
       		cin>>c;
       		
       		if(c=='l')
       		{
       				t=sum(a[x]);
       		
					ans=ans+(long long int)min(n-t,t-1);
					update(-1,a[x]);
					l--;
					a[x]=l;
				   update(1,a[x]);
       		}
       		else if(c=='r')
       		{
       				t=sum(a[x]);
       			
					ans=ans+(long long int)min(n-t,t-1);
					update(-1,a[x]);
					r++;
					a[x]=r;
				   update(1,a[x]);
       			
       			
       		}
       		
       	}
       
       cout<<ans<<endl;
       
        return 0;
}