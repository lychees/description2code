#include<iostream>
#include<algorithm>
#include<stdlib.h>
#include <stdlib.h>
#include <time.h>
#include<stdio.h>
#include<string.h>
#include<math.h>
#define LL unsigned long long
using namespace std;
int a[3][1000005];
int arr[1000005];
int main()
{
    int t,i,j;
    char s[1000009];
    scanf("%d",&t);
    getchar();
    while(t--)
    {
        scanf("%s",s);
        for(i=0;i<=1000000;i++)
            arr[i]=0;
        int A=0,B=0,C=0,a_pos=0,b_pos=0,c_pos=0;
        int len=strlen(s);
        int last=0;
        for(i=len-1;i>=0;i--)
        {
            if(s[i]=='a'){
                A++;
                a[0][a_pos++]=len-i;
            }
            else if(s[i]=='b'){
                B++;
                a[1][b_pos++]=len-i;
            }
            else if(s[i]=='c'){
                C++;
                a[2][c_pos++]=len-i;
            }
            int temp;
            if(A!=0 && B!=0 && C!=0)
            {
                if(s[i]=='a')
                    last=min(a[1][b_pos-1],a[2][c_pos-1]);
                else if(s[i]=='b')
                    last=min(a[0][a_pos-1],a[2][c_pos-1]);
                else if(s[i]=='c')
                    last=min(a[0][a_pos-1],a[1][b_pos-1]);
                arr[i]=(len-i)-last;
            }
            else
                arr[i]=arr[i+1]+1;
        }
        /*for(i=0;i<3;i++)
        {
            for(j=0;j<3;j++)
                printf("%d ",a[i][j]);
            printf("\n");
        }*/
        LL count=0;
        for(i=len-1;i>=0;i--)
            count+=arr[i];
        printf("%lld\n",count);
    }
    return 0;
}
