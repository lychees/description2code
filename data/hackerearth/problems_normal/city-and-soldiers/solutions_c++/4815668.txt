#include <bits/stdc++.h>

using namespace std;

int p[100001];

int root(int i) {
	/*
    while (p[i] != i) {
		p[i] = p[p[i]];
		i = p[i];
    }
    */
    if (p[i] != i) 
    	p[i] = root(p[i]);
	return p[i];
}
 
void merge(int A, int B) {
    int a = root(A);       
    int b = root(B);  
   	p[a] = b;      
}

int main() {
    int N, Q;
    cin >> N >> Q;
    for (int i = 1; i <= N; i++) {
    	p[i] = i;
    }

    for (int q = 1; q <= Q; q++) {
    	int op, a; 
    	cin >> op >> a;
    	if (op == 1) {
    		int b;
    		cin >> b;
    		merge(a, b);
    	}
    	if (op == 2) {
    		p[root(a)] = a;
    		p[a] = a;
    	}
    	if (op == 3)
    		cout << root(a) << endl;
    }
    
    return 0;
}
