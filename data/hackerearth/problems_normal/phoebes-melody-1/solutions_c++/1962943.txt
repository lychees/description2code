#include<cstdio>
#include<iostream>
#include<algorithm>
#include<cmath>
#include<cstring>
#include<vector>
using namespace std;
#define lim 200001
#define f first
#define s second
#define inf 1000000000
int cs,n,k,i,res,a,b,mn,x;
pair<int,int> A[lim];
int T[lim],B[lim],M[lim];
vector<int> L,R;
void update(int x)
{
  while(x<=n)
  {
    T[x]++;
    x+=x&-x;
  }
}
int f(int x)
{
  while(x>0)
  {
    while(x>0 && !T[x])
      x-=x&-x;
    if(B[x])
      return x;
    x--;
  }
  return inf;
}
vector<int> g()
{
  vector<int> V;
  memset(T,0,sizeof T);
  memset(B,0,sizeof B);
  for(i=0;i<n;i++)
  {
    x=f(M[i]-k);
    if(x==inf)
      a=inf;
    else  
      a=M[i]-x;
    V.push_back(a);
    update(M[i]);
    B[M[i]]=1;
  }
  return V;
}
int main()
{
  scanf("%d",&cs);
  while(cs--)
  {
    scanf("%d%d",&n,&k);
    for(i=0;i<n;i++)
    {
      scanf("%d",&A[i].f);
      A[i].s=i+1;
    }
    sort(A,A+n);
    for(i=0;i<n;i++)
      M[i]=A[i].s;
    L=g();
    for(i=0;i<n;i++)
      M[i]=n+1-A[i].s;
    R=g();
    for(res=i=0;i<n;i++)
    {
      mn=min(L[i],R[i]);
      if(mn<inf)
        res+=mn;
    }
    printf("%d\n",res);
  }
  return 0;
}
