#include <bits/stdc++.h>
using namespace std;
#define ll long long

int a[10];
bool b[10];
int dp[7][2][2][1024];

int go(int x, int y, int z, int p) {
  if(x==-1) {
    for(int i=0; i<10; i++) {
      if(((p>>i)&1) && b[i]) return 1;
    }
    return 0;
  }
  if(dp[x][y][z][p]>=0) return dp[x][y][z][p];
  int &res = dp[x][y][z][p];
  res = 0;
  for(int i=0; i<10; i++) {
    if(y && (i>a[x])) continue;
    if(z && i==0) {
      res+=go(x-1,y&&(i==a[x]),1,p);
    }
    else res+=go(x-1,y&&(i==a[x]),0,p|(1<<i));
  }
  return res;
}
 

int main() {
  ios_base::sync_with_stdio(0);
  int n;
  cin>>n;
  int cur = -1;
  while(n>0){ 
    cur++;
    a[cur] = n%10;
    n/=10;
  }
  int q;
  cin>>q;
  while(q-->0) {
    int m;
    cin>>m;
    for(int i=0; i<10; i++) {
      b[i] = 0;
    }
    while(m-->0){
      int x;
      cin>>x;
      b[x] = 1;
    }
    memset(dp,-1,sizeof(dp));
    cout<<go(cur,1,1,0)<<endl;
  }
  return 0;
}