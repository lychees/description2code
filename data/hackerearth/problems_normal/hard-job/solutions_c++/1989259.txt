#include <bits/stdc++.h>

using namespace std;

int N, M;
const int MAX=(1<<22)+100;
int bit[MAX];
int head=(1<<20)+50, tail=(1<<21)+50;
int pos[1<<20];

void add(int x, int v)
{
    for(; x<MAX; x+=x&-x)
        bit[x]+=v;
}

int sum(int x)
{
    int ret=0;
    for(; x>0; x-=x&-x)
        ret+=bit[x];
    return ret;
}

int main()
{
    scanf("%d%d", &N, &M);
    int a;
    for(int i=0; i<N; i++)
    {
        scanf("%d", &a);
        pos[a]=head+i;
        add(pos[a], 1);
    }
    char c;
    long long ans=0;
    for(int i=0; i<M; i++)
    {
        scanf("%d %c", &a, &c);
        int x=sum(pos[a]-1);
        ans+=min(x, N-x-1);
        add(pos[a], -1);
        if(c=='l')
            pos[a]=--head;
        else
            pos[a]=++tail;
        add(pos[a], 1);
    }
    printf("%lld\n", ans);
    return 0;
}
