#include<bits/stdc++.h>
#define MP make_pair
#define PB push_back
#define PP pop_back()
#define ALL(x) x.begin(),x.end()
#define st first
#define nd second
#define sz(x) (int) x.size()
#define pii pair<int,int>
#define ii int,int
#define ll long long
#define INPUT freopen("inp.in","r",stdin);
#define OUTPUT freopen("oup.out","w",stdout);
#define sag(x) 2*x+1
#define sol(x) 2*x
#define orta ((ll)(bas+son)/2)
#define MIN3(x,y,z) min(min(x,y),z)
#define MAX3(x,y,z) max(max(x,y),z)
#define FOR(i,j,k) for(int i=j;i<=k;i++)
#define ROF(i,j,k) for(int i=j;i>=k;i--)
#define dbgs(x) cerr<<(#x)<<" --> "<<(x)<<" "
#define dbg(x) cerr<<(#x)<<" --> "<<(x)<<endl;getchar()
#define MOD 1000000007
#define inf 1000000000000
#define N 105
using namespace std;
int n,a[N],bs,vis[N],perm[N],val[N],reg[N];
vector<int> v[N];
char w[N][N];
void dfs(int node) {
    if(vis[node]) return ;
    v[bs].PB(node);
    reg[a[node]]=bs;
    vis[node]=1;
    FOR(i,1,n) {
        if(w[node][i]=='Y') {
            dfs(i);
        }
    }
}
int main() {
    scanf("%d",&n);
    FOR(i,1,n) scanf("%d",&a[i]);
    FOR(i,1,n) FOR(j,1,n) scanf(" %c",&w[i][j]);
    FOR(i,1,n) {
        if(!vis[i]) {
            bs++;
            dfs(i);
        }
    }
    FOR(i,1,bs) {
        sort(ALL(v[i]));
    }
    FOR(i,1,n) {
        perm[v[reg[i]][val[reg[i]]]]=i;
        val[reg[i]]++;
    }
    FOR(i,1,n) {
        printf("%d ",perm[i]);
    }
}
