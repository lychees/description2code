#include <bits/stdc++.h>
using namespace std;
long long amulus[65];
long long water[20];
vector<pair<long long,int> >am;
vector<long long>taken;
vector<long long>ans;
int main()
{
	int t,n1,n2;
	long long m,mask,best_sum,have_sum,need_sum;
	cin>>t;
	while(t--)
	{
		cin>>m>>n1>>n2;
		for(int i=0;i<n1;i++)
		cin>>amulus[i];
		for(int i=0;i<n2;i++)
		cin>>water[i];
		am.clear();
		for(int i=0;i<n1;i++)
		am.push_back({amulus[i],i});
		sort(am.rbegin(),am.rend());
		best_sum=2e18;
		for(mask=0;mask<(1<<n2);mask++)
		{
			have_sum=0;
			for(int i=0;i<n2;i++)
			if(mask&(1<<i))
				have_sum+=water[i];
			need_sum=m-have_sum;
			taken.clear();
			for(int i=0;i<int(am.size());i++)
			{
				if(am[i].first<=need_sum)
				{
					need_sum-=am[i].first;
					taken.push_back(amulus[am[i].second]);
				}
			}
			if(need_sum!=0)
			continue;
			if(have_sum<best_sum)
			{
				best_sum=have_sum;
				ans=taken;
			}
		}
		if(best_sum>m)
		cout<<"NO\n";
		else
		{
			cout<<"YES\n";
			sort(ans.begin(),ans.end());
			for(int i=0;i<(int)ans.size();i++)
			cout<<ans[i]<<" ";
			cout<<"\n";
		}
	}
	return 0;	
}