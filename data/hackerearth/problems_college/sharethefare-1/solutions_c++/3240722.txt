#include <iostream>
#include <cstring>
#include <cstdio>
#include <map>
#include <string>
using namespace std;

void Answer()
{
	int iNumberOfPeopleWent, iNumberOfTransactions;
	scanf("%d%d", &iNumberOfPeopleWent, &iNumberOfTransactions);
	map<string, int> table;
	
	string aOrder[51];
	int iNumber = 0;
	while(iNumber < iNumberOfPeopleWent)
	{
		string sName;
		cin>>sName;
		table[sName] = 0;
		aOrder[iNumber++] = sName;
	}
	while(iNumberOfTransactions--)
	{
		string sWhoPaid;
		int iAmountPaid, iNumberOfPeopleIncluded;
		cin>>sWhoPaid;
		scanf("%d%d", &iAmountPaid, &iNumberOfPeopleIncluded);
		
		table[sWhoPaid] -= iAmountPaid;
		
		int iExtraAmount = (iAmountPaid)%(iNumberOfPeopleIncluded+1);
		
		table[sWhoPaid] += iExtraAmount;
				
		iAmountPaid -= iExtraAmount;
		
		int iEqualAmount = (iAmountPaid)/(iNumberOfPeopleIncluded+1);
		
		table[sWhoPaid] += iEqualAmount;
		
		while(iNumberOfPeopleIncluded--)
		{
			string sName;
			cin>>sName;
			table[sName] += iEqualAmount;
		}
	}
	
	for(int iNumber = 0; iNumber < iNumberOfPeopleWent; iNumber++)
	{
		string sName = aOrder[iNumber];
		int iAmount = table[sName];
		
		if(iAmount>0)
		{
			cout<<sName<<" owes "<<iAmount<<endl;
		}
		else if(iAmount<0)
		{
			cout<<sName<<" is owed "<<(-iAmount)<<endl;	
		}
		else if(iAmount == 0)
		{
			cout<<sName<<" neither owes nor is owed"<<endl;
		}
	}
}

int main()
{
    int iTestCases;
    scanf("%d", &iTestCases);
	while(iTestCases--)
	{
		Answer();
	}
    return 0;
}
