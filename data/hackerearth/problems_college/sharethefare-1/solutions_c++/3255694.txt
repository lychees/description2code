#include<map>
#include<iostream>
using namespace std;
int main()
{
    map<string,int>expense;
    map<string,int>paid;
    int t,n,q,m,temp,i,j,a,b,amount,no,r,res;
    string str,name;
    string member[10002];
    cin>>t;
    while(t-->0)
    {
                cin>>n>>q;
                for(i=0;i<n;i++)
                {
                                cin>>member[i];
                                expense[member[i]]=0;
                                paid[member[i]]=0;
                }
                for(i=0;i<q;i++)
                {
                                cin>>name>>amount>>no;
                                temp=amount/(no+1);
                                r=amount%(no+1);
                                if(r==0)
                                {
                                        expense[name]+=temp;
                                        paid[name]+=amount;
                                        for(j=0;j<no;j++)
                                        {
                                                         cin>>name;
                                                         expense[name]+=temp;
                                        }
                                }
                                else
                                {
                                    expense[name]+=temp+r;
                                    paid[name]+=amount;
                                    for(j=0;j<no;j++)
                                    {
                                                     cin>>name;
                                                     expense[name]+=temp;
                                    }
                                }
                }
                for(i=0;i<n;i++)
                {
                        a=expense[member[i]];
                        b=paid[member[i]];
                        if(b>a)
                        {
                               res=b-a;
                               cout<<member[i]<<" is owed "<<res;
                        }
                        else if(b<a)
                        {
                             res=a-b;
                             cout<<member[i]<<" owes "<<res;
                        }
                        else
                        { 
                            cout<<member[i]<<" neither owes nor is owed ";
                            
                        }
                        cout<<endl;
                }
    }
}
                        
                                
                                
    
