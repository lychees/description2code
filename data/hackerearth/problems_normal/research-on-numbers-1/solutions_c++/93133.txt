#include<iostream>
#include<algorithm>
void merge(long long a[],int p,int q,int r)
{
long long c[105];
int i=p;
int j=q+1;
int k=0;
while((i<=q)&&(j<=r) && k<105)
{
if(a[i]<a[j])
{
     c[k]=a[i];
      i=i+1;
     k=k+1;
}
else
{
     c[k]=a[j];
      j=j+1;
      k=k+1;
}
}
while(i<=q && k<105)
{
     c[k] =a[i];
     i=i+1;
     k=k+1;
}
while(j<=r && k<105)
{
     c[k]=a[j];
     j=j+1;
     k=k+1;
}
for(int z=0;z<k;z++)
{
    a[p+z]=c[z];
}
}

void mergesort(long long a[],int p,int r)
{
     if( p < r)
    {
         int q=(p+r)/2;
         mergesort(a,p,q);
         mergesort(a,q+1,r) ;
         merge(a,p,q,r);
     }
}

bool compare(long long a,long long b)
{

    return a<=b;
}
using namespace std;
#define mod 1000000007
long long ans[1000001];
long long ans2[1000001];
long long ans3[2000000];
int main()
{
    //long long a[5]={1,100,2,12312313,3};
    //sort(a,a+4,compare);
    //cout<<a[0]<<a[1]<<a[2]<<a[3]<<a[4]<<endl;

    int t;
    cin>>t;

    while(t--)
    {
        int q,k;
        cin>>q>>k;
        int b[k],c[k];
        for(int i=0;i<k;i++)
        {
            cin>>b[i];
            ans[i+1]=b[i];
        }
        for(int i=0;i<k;i++)
        {
            cin>>c[i];
        }
        for(int i=k+1;i<1000001;i++)
        {
            ans[i]=0;
            for(int j=0;j<k;j++)
            {
                ans[i]+=(long long)(c[j]*ans[i-j-1]);
            }
            ans[i]%=mod;
        }
        int l,r;
        for(int i=0;i<1000000;i+=10000)
        {
            for(int j=0;j<10000;j++)
            {
                ans2[i+j]=ans[i+j];
            }
            mergesort(ans2,i,i+10000-1);
        }
        while(q--)
        {
            cin>>l>>r;
            int count=0;
            for(int i=l;i<l-(l%10000)+10000 && i<=r;i++)
            {
                ans3[count]=ans[i];
                count++;
            }
            int num=l-(l%10000)+10000;
            for(;num+9999<=r;num+=10000)
            {
                for(int i=0;i<100;i++)
                {
                    ans3[count]=ans2[num+i];
                    count++;
                }
            }
            for(;num<=r;num++)
            {
                ans3[count]=ans[num];
                count++;
            }
            //cout<<count<<endl;
            mergesort(ans3,0,count-1);
            if(count<100)
            {
                for(int i=0;i<count;i++)
                {
                    cout<<ans3[i]<<" ";
                }
                cout<<endl;
            }
            else
            {
                for(int i=0;i<100;i++)
                {
                    cout<<ans3[i]<<" ";

                }
                cout<<endl;
            }
        }
    }
}
