#include<iostream>
#include<map>
#include<vector>
#include<cstring>
#include<cmath>
#include<algorithm>
#include<cstdio>
#include<fstream>
using namespace std;
#define abs(x) ((x)>0?(x):-(x))
#define M 100000
#define lld signed long long int
#define pp pop_back()
#define ps(x) push_back(x)
#define tkint(n) scanf("%d",&n)
#define tkchar(ch) scanf("%c",&ch)
#define tklong(n) scanf("%I64d",&n)
int n,d[500];
lld dp[10][201][201];
bool flag[10][201][201];
lld rec(int c,int i,int j)
{
    if(i>j)return 1;
    if(c>=4&&c<=6)return 0;
    if(c==10)
    {
        lld ans=rec(1,i,j)+rec(2,i,j)+rec(3,i,j);
        ans%=M;
        return ans;
    }
    if(i==j+1)
    {
        if(d[i]+3==d[j])return 1;
        else if(d[j]==10)return 1;
        else return 0;
    }
    if(flag[c][i][j])return dp[c][i][j];
    lld ans=0;
    for(int k=i+1;k<=j;k+=2)
    {
        if(c+3==d[k] or d[k]==10)
        {
            ans+=rec(d[i+1],i+1,k-1)*rec(d[k+1],k+1,j);
            ans%=M;
        }
    }
    flag[c][i][j]=1;
    dp[c][i][j]=ans;
    return ans;
}
int main()
{
	cin>>n;char ch;
	for(int i=1;i<=n;++i)
    {
        cin>>ch;
        switch(ch)
        {
            case 'A':d[i]=1;break;
            case 'B':d[i]=2;break;
            case 'C':d[i]=3;break;
            case 'a':d[i]=4;break;
            case 'b':d[i]=5;break;
            case 'c':d[i]=6;break;
            case '?':d[i]=10;break;
        }
    }
    cout<<rec(d[1],1,n);
}
