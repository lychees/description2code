#include<bits/stdc++.h>
using namespace std;
#define LL long long int
#define M 1000000007

LL pow(LL a, LL b,LL m)
	{
		LL x=1,y=a;
		while(b > 0)
			{
				if(b%2 == 1)
					{
						x=(x*y);
						if(x>m) x%=m;
					}
						y = (y*y);
						if(y>m) y%=m;
						b /= 2;
				}
		return x%m;
	}

LL x[1000001];
LL y[1000001];
LL v[1000001];
int main()	
	{
		int t,i,n,q;
		LL a,b,c,d,e,f;
		LL sum = 0;
		cin>>t;
		while(t--)
			{
				x[0] = 0;
				y[0] = 0;
				v[0] = 0;
				sum = 0;
				cin>>n>>q;
				cin>>a>>b>>c>>d>>e>>f;
				//N = n;
				for(i=1;i<=q;i++)
					{
						x[i] = ((x[i-1]*a)%n + b)%n + 1;
						y[i] = ((y[i-1]*c)%n + d)%n + 1;
						if(y[i]<x[i])
							{
								int temp = y[i];
								y[i] = x[i];
								x[i] = temp;
								
							}
						v[i] = ((v[i-1]*e) + f)%1000000000 + 1;
						sum = sum + v[i]*(abs(y[i]-x[i])+1);
						if(sum>=M)
							sum%=M;
					}
				
				sum = sum * pow(2,n-1,M);
				if(sum>=M)
					sum%=M;
				cout<<sum<<endl;
			}
	}