#include <iostream>
#include<algorithm>
#include<queue>
#include<cstdio>
using namespace std;
#define mod 1000000007
#define ll long long int 
void mul(ll A[60][60],ll B[60][60],int n){
	ll c[60][60];
	for(int i = 0;i < n;i++){
		for(int j = 0;j < n;j++){
			c[i][j] = 0;
			for(int k = 0;k < n;k++){
				c[i][j] += (A[i][k]*B[k][j]);
				c[i][j] %= mod;
			}
		}
	}
	for(int i  = 0;i < n;i++){
		for(int j = 0;j < n;j++){
			A[i][j] = c[i][j];
		}
	}
}
int get(long long int k,int n,ll ans[60][60],ll arr[60][60]){
	while(k){
		if(k&1)
			mul(ans,arr,n);
		mul(arr,arr,n);
		k >>= 1;
	}
}
	
int main()
{
	int t;
	ll arr[60][60];
	ll ans[60][60];
	scanf("%d",&t);
	while(t--){
		int n,u,v;
		long long int k;
		scanf("%d%lld%d%d",&n,&k,&u,&v);
		for(int i = 0;i < n;i++){
			for(int j = 0;j < n;j++){
				scanf("%d",&arr[i][j]);
				ans[i][j] = arr[i][j];
			}
		}
		k--;
		get(k,n,ans,arr);
		cout<<ans[u][v]<<endl;
	}
    return 0;
}
