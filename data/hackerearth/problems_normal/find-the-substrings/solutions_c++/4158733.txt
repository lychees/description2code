#include <bits/stdc++.h>
using namespace std;
int a[1000001];
int b[1000001];
int c[1000001];
char str[1000001];

int main()
{
    int t;
    cin>>t;
    while(t--)
    {
    	cin>>str;
    	long long l=strlen(str);
    	
    	long long a1,b1,c1;
    	a1=b1=c1=-1;
    	
    	for(int i=l-1;i>=0;i--)
    	{
    		if(str[i]=='a')
    		a1=i;
    		else if(str[i]=='b')
    		b1=i;
    		else
    		c1=i;
    		a[i]=a1;
    		b[i]=b1;
    		c[i]=c1;
    	}
    	long long ans;
    	ans=l*(l+1)/2;
    	
    	for(long long i=0;i<l;i++)
    	{
    		if(str[i]=='c')
    		{
    			if(a[i]!=-1&&b[i]!=-1)
    			ans=ans-(l-max(a[i],b[i]));
    		}
    		if(str[i]=='b')
    		{
    			if(a[i]!=-1&&c[i]!=-1)
    			ans=ans-(l-max(a[i],c[i]));
    		}
    		if(str[i]=='a')
    		{
    			if(c[i]!=-1&&b[i]!=-1)
    			ans=ans-(l-max(c[i],b[i]));
    		}
    	}
    	cout<<ans<<endl;
    }
    return 0;
}
