import cStringIO

output = cStringIO.StringIO()

n, c = map(int, raw_input().split())
colors = sorted(map(int, raw_input().split()))
match = []
count = 0
size = len(colors)
for i in xrange(size):
    j = (i + size/2) % size
    if colors[i] != colors[j]:
        count += 1
    output.write('\n%d %d' % (colors[i], colors[j]))

print count,
print output.getvalue()
