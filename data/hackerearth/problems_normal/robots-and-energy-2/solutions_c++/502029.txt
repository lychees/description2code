#include <bits/stdc++.h>
using namespace std;

typedef long long ll;
typedef vector<ll> vl;
typedef vector<vl> vvl;
ll M=1000000007;

vvl mm(vvl a,vvl b,ll x,ll y,ll z)
{
    vvl c(x,vl(z,0));
    ll i,j,k;
    for(i=0;i<x;i++)
        for(j=0;j<z;j++)
            for(k=0;k<y;k++)
                c[i][j]=(c[i][j]+a[i][k]*b[k][j])%M;
    return c;
}

vvl mp(vvl m,ll n,ll s)
{
    vvl r=m;
    n--;
    while(n)
    {
        if(n&1) r=mm(r,m,s,s,s);
        m=mm(m,m,s,s,s);
        n>>=1;
    }
    return r;
}

bool ispal(string x)
{
    string::const_iterator i,j;
    for (i=x.begin(),j=-1+x.end();i<j;i++,j--)
    {
        if (*i != *j)
        {
            return 0;
        }
    }
    return 1;
}

ll fin(string st)
{
    map<string,bool> z;
    string tmp;
    ll i,j,k,l=st.size();
    for(i=0;i<l;i++)
    {
        for(j=i;j<l;j++)
        {
            tmp="";
            for(k=i;k<=j;k++)
                tmp+=st[k];
            if(ispal(tmp)) z[tmp]=1;
        }
    }
    return (ll)(z.size());
}

int main()
{
    ll i,j,k,l,x,y,n=0;
    ll num[12][12];
    string st;

    scanf("%lld%lld",&x,&y);

    vvl a(1,vl(x*y,0));
    vvl m(x*y,vl(x*y,0));

    for(i=0;i<x*y;i++)
        m[i][i]=1;

    for(i=0;i<x;i++)
    {
        for(j=0;j<y;j++)
        {
            num[i][j]=n;
            cin>>st;
            a[0][n++]=fin(st);
        }
    }
    scanf("%lld",&n);
    while(n--)
    {
        scanf("%lld%lld%lld%lld",&i,&j,&k,&l);
        m[num[i][j]][num[k][l]]++;
        m[num[k][l]][num[i][j]]++;
    }
    scanf("%lld",&n);
    m=mm(a,mp(m,n,x*y),1,x*y,x*y);
    n=0;
    for(i=0;i<x;i++)
    {
        for(j=0;j<y;j++)
        printf("%lld ",m[0][n++]);
        printf("\n");
    }
    return 0;
}
