#include "bits/stdc++.h"

using namespace std;

#define TEST(T) int T; cin>>T; while(T--)
#define ll long long
#define F first
#define S second
#define mp make_pair
#define pb push_back
#define ins insert
#define pii pair<int,int>
#define all(V) V.begin(),V.end()
#define clr(V,val) memset(V,val,sizeof(V))
#define rep(X,A,N,C) for(X=A;X<=N;X+=C)
#define rept(X,A,N,C) for(X=A;X>=N;X-=C)
#define sci(X) scanf("%d",&X)
#define scl(X) scanf("%lld",&X)
#define scs(X) scanf("%s",&X)
#define pfi(X) printf("%d",X)
#define pfl(X) printf("%lld",X)
#define pfs(X) printf("%s",X)
#define sp printf(" ")
#define nxt printf("\n")

const int MX=1e6 + 5;

const int INF=1e9;

const int M=1000000007;

           /*************************/
           
             
int main()
{
	
	TEST(t)
	{
		int n,m;
		sci(n);
		sci(m);
		
		vector<pair<int,int> > v[n+5];
		
		while(m--)
		{
			int a,b;
			sci(a);
			sci(b);
			
			v[a].pb(mp(b,1));
			v[b].pb(mp(a,1));
		}
		
	//	vector<bool> vi(n+5,false);
		vector<int> d(n+5,INF);
		
		priority_queue<pair<int,int>,vector<pair<int,int>>,greater<pair<int,int>> > pq;
		
		pq.push(mp(0,1));
		d[1]=0;
		
		while(!pq.empty())
		{
			pair<int,int> p=pq.top();
			pq.pop();
			
			int x=p.F;
			int y=p.S;
			
			//if(vi[y]==true) continue;
			
			//vi[y]=true;
			
			//int x;
			
			for(x=0;x<v[y].size();x++)
			{
				if(d[y]+v[y][x].S<d[v[y][x].F])
				{
					d[v[y][x].F]=d[y]+v[y][x].S;
					pq.push(mp(d[v[y][x].F],v[y][x].F));
				}
			}
		}
		
		pfi(d[n]);
		nxt;
	}
	
	return 0;
	
}