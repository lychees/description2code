#include<iostream>
#include<string.h>
using namespace std;
int a[3][1000000 + 5];
int b[1000000 + 5];
int main()
{
int test;
char s[1000000 + 10];
//scanf("%d",&test);
cin>>test;
getchar();
while(test--)
{
scanf("%s",s);
for(int i = 0;i <= 1000000;i++)
b[i] = 0;
int A = 0,B = 0,C = 0;
int pos_a = 0,pos_b = 0,pos_c = 0;
int len = strlen(s);
int prev = 0;
for(int i = len - 1;i >= 0;i--)
{
if(s[i]=='a')
{
 A++;
 a[0][pos_a++]=len-i;
}
else if(s[i]=='b')
{
 B++;
 a[1][pos_b++]=len-i;
}
else if(s[i]=='c')
{
 C++;
 a[2][pos_c++]=len-i;
}
int temp;
if(A!=0 && B!=0 && C!=0)
{
 if(s[i]=='a')  
                prev = min(a[1][pos_b-1],a[2][pos_c-1]);
 else 
 if(s[i]=='b')
                prev = min(a[0][pos_a-1],a[2][pos_c-1]);
 else 
 if(s[i]=='c')
                prev = min(a[0][pos_a-1],a[1][pos_b-1]);
 b[i] = (len-i) - prev;
}
else
b[i] = b[i + 1] + 1;
}
long long int count = 0;
for(int i = len - 1; i >= 0;i--)
        count = count + b[i];
cout<<count<<endl;
}
return 0;
}
