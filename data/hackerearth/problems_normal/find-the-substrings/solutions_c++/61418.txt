// Read inputs from stdin. Write outputs to stdout.

#include <iostream>
#include <map>
#include <cmath>
#include <cstring>
#include <cstdio>

#define debug 0

using namespace std;

char str[1000010];
int score[3];

int main() {
    int cases;
    scanf("%d",&cases);getchar();
    while(cases--) {
        long ans = 0;
        int start=0,end=0;
        char c;
        score[0]=0;
        score[1]=0;
        score[2]=0;
        while(1){
        	if(scanf("%c",&c)==EOF){
        		cout<<ans<<endl;
        		break;
        	}
        	if(debug)cout<<"read "<<c<<endl;
        	if(c=='\n' || c==EOF){
        		cout<<ans<<endl;
        		break;
        	}str[end++]=c;
        	score[c-'a']++;
            if(score[0]==0 || score[1]==0 || score[2]==0)ans+=end-start;
            else {
           	     while(score[0]!=0 && score[1]!=0 && score[2]!=0) {
           	         score[str[start]-'a']--;
           	         start++;
           	     }ans+=end-start;
           	 }if(debug)cout<<"ans till is "<<ans<<endl;
        }
    }
    return 0;
}
