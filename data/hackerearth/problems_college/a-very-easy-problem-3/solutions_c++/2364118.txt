
#include<bits/stdc++.h>

using namespace std;

#define si(x) scanf("%d",&x)
#define pri(x) printf("%d",x)
#define sll(x) scanf("%lld",&x)
#define pll(x) printf("%lld",x)
#define sstr(s) scanf("%s",s)
#define pstr(s) printf("%s",s)
#define nl printf("\n")
#define ll long long int
#define mod 10007

ll val[21],cnt[21],a[21],b[21],c1[21],c2[21];

vector<ll> v1,v2;

void build(int st, int end, ll v) {
    if(st==end) {
	v1.push_back(v);
	return;
    }
    for(int i=0;i<=c1[st];++i) {
	build(st+1,end,v+i*a[st]);
    }
}

void build1(int st, int end, ll v) {
    if(st==end) {
//	cout<<"hi";
	v2.push_back(v);
	return;
    }
    for(int i=0;i<=c2[st];++i) {
//	cout<<"hello"<<i<<endl;;
	build1(st+1,end,v+i*b[st]);
    }
}

int main()
{
    int t,n,k;
    si(t);
    ll K;
    while(t--) {
	v1.clear();
	v2.clear();
	si(n);
	for(int i=0;i<n;++i) {
	    sll(val[i]);
	}
	for(int i=0;i<n;++i) {
	    sll(cnt[i]);
	}
	sll(K);
	k=0;
	for(int i=0;i<n/2;++i,++k) {
	    a[k]=val[i];
	    c1[k]=cnt[i];
	}
	build(0,k,0);
	k=0;
	for(int i=n/2;i<n;++i,++k) {
//	    cout<<"b"<<val[i]<<endl;
	    b[k]=val[i];
	    c2[k]=cnt[i];
	}
//	cout<<"k"<<k;
	build1(0,k,0);
	sort(v2.begin(),v2.end());
	int s1,s2;
	s1=v1.size();
	s2=v2.size();
//	cout<<s1<<" "<<s2<<" ";
	ll ans=0;
	for(int i=0;i<s1;++i) {
//	    cout<<v1[i]<<" ";
	    ll temp=K-v1[i];
	    int x,y;
	    x=lower_bound(v2.begin(),v2.end(),temp)-v2.begin();
	    y=upper_bound(v2.begin(),v2.end(),temp)-v2.begin();
	    ans = (ans+y-x)%mod;
	}
	pll(ans); nl;
    }
    return 0;
}
