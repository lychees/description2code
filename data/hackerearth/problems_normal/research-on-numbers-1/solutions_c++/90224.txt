#include <vector>
#include <list>
#include <map>
#include <set>
#include <deque>
#include <stack>
#include <cstring>
#include <bitset>
#include <algorithm>
#include <functional>
#include <numeric>
#include <utility>
#include <sstream>
#include <iostream>
#include <iomanip>
#include <cstdio>
#include <cmath>
#include <cstdlib>
#include <queue>
#include <ctime>
#define x 1000000007 
using namespace std;
int arr[1000010]={0};
void pre(int k,int b[],int c[])
{
	for(int i=k;i<=1000000;++i)
	{
		 long long int sum=0;
		for(int temp=0;temp<k;++temp)
		{
			long long f=((long long)c[temp]*(long long)arr[i-temp-1]);
			f%=(long long)1000000007;
		/*	if(f<0)
			{
				cout<<f<<" "<<i<<endl;
				system("pause");
			}*/
						sum+=f;
						sum%=(long long)1000000007;
						
						
		}
		sum%=1000000007;
	//	cout<<sum<<endl;
		arr[i]=sum;
	}
}
int main()
{
	int t;
	scanf("%d",&t);
	while(t--)
	{
		int k,q;
		scanf("%d %d",&q,&k);
		int b[k];
		int c[k];
		for(int i=0;i<k;++i)
		{
			scanf("%d",&b[i]);
			arr[i]=b[i];			
		}
		for(int i=0;i<k;++i)
		{
			scanf("%d",&c[i]);
		}
		pre(k,b,c);
		for(int i=0;i<q;++i)
		{
			int l,r;
			scanf("%d %d",&l,&r);
			
			priority_queue <int> pq;
			int s=0;
			for(int j=l-1;j<r;++j)
			{
				if(s<100)
				{
				
				s++;
				pq.push(arr[j]);
				}
				else
				{
					if(arr[j]<=pq.top())
					{
						pq.pop();
						pq.push(arr[j]);
					}
					
				}
			}
			int abc[101];
			int jj=0;
			while(!pq.empty())
			{
				abc[jj++]=pq.top();
				pq.pop();
			}
			for(int i=jj-1;i>=0;i--)
			printf("%d ",abc[i]);
			printf("\n");
			
		}
	}
}