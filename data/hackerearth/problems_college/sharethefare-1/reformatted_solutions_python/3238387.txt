T = int(raw_input())

for T_I in range(T):
    (N, Q) = map(int, str(raw_input()).split())
    amount_owed_to = {}
    persons = []
    for N_I in range(N):
        person = str(raw_input())
        amount_owed_to[person] = 0
        persons.append(person)
    for Q_I in range(Q):
        owed_to = str(raw_input())
        amount = int(raw_input())
        M = int(raw_input())
        amount_owed_by_each = int(amount/(M+1))
        amount_owed_to[owed_to] += M*amount_owed_by_each
        for M_I in range(M):
            owed_by = str(raw_input())
            amount_owed_to[owed_by] -= amount_owed_by_each

    for person in persons:
        if amount_owed_to[person] > 0:
            print person + " is owed " + str(amount_owed_to[person])
        elif amount_owed_to[person] == 0:
            print person + " neither owes nor is owed"
        elif amount_owed_to[person] < 0:
            print person + " owes " + str(-1*amount_owed_to[person])
