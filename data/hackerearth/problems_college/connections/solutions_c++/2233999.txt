#include <iostream>
using namespace std;

int main()
{
    int n,c,c1,c2,q;
    int i,j,k;
    cin >> n;
    cin >> c;
    int arr[n+1];
    
    for(i=0; i<=n; i++)
    	arr[i] = -1;
    
    for(i=0; i<c; i++){
    	cin >> c1 >> c2;
    	
    	if (arr[c1] == -1)
    		arr[c1] = c2;
    	else{
    		while(arr[c1] != -1){
    			c1 = arr[c1];
    		}
    		arr[c1] = c2;
    	}
    }
    
    cin >> q;
    
    for(i=0; i<q; i++){
    	cin >> c1 >> c2;
    	
    	if (arr[c1] == c2)
    		cout << "Direct Connection\n";
    	else if (arr[c1] != -1){
    		while(arr[c1] != -1){
    			c1 = arr[c1];
    			if (arr[c1] == c2){
    				cout << "Indirect Connection\n";
    				break;
    			}
    		}
    		if (arr[c1] == -1)
    			cout << "No Connection\n";
    	}
    	
    }
    return 0;
}
