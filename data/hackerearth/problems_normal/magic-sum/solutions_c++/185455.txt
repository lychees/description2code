#include<iostream>
#include<cstdio>
using namespace std;
#define max1 -99999999
long long nodes[512];
long long sum[512][512];
void calcul(int i, int j)
{
	if(sum[i][j]!=max1)return;
	else if(i==j)sum[i][j]=nodes[i];
	else if(i/2==j/2)sum[i][j]=nodes[i]+nodes[j]+nodes[i/2];
	else 
	{	
		calcul(i/2,j/2);
		sum[i][j]=sum[i/2][j/2]+nodes[i]+nodes[j];
		}
	
	}
int main()
{
	int t,n;
	cin>>t;
	while(t--)
	{
		long long int max2=max1;
		cin>>n;	
		for(int i=1;i<=n;i++)
			cin>>nodes[i];
		for(int i=0;i<512;i++)
		{
			for(int j=0;j<512;j++)
				sum[i][j]=max1;			
			}
		for(int i=(n+1)/2;i<=n;i++)
		{
			for(int j=i;j<=n;j++)
			{
				calcul(i,j);
				if(sum[i][j]>max2)max2=sum[i][j];
				}
			}
		cout<<max2<<endl;
		}
	return 0;
	}
