#include <bits/stdc++.h>
using namespace std;

struct edge{
	int x,y,w,in;
};
typedef struct edge E;
E a[100005];
int fa[100005],si[100005];
int cmp(E fir,E sec)
{
	if(fir.w < sec.w)return 1;
	if(fir.w > sec.w)return 0;
	return fir.in < sec.in;
}
int main()
{
   int t;
   scanf("%d",&t);
   while(t--)
   {
   	int n,m;
   	scanf("%d%d",&n,&m);
   	long long total = 1;
   	int i;
   	for(i=1;i<=n;i++)
   	{
   		fa[i] = -1;
   		si[i] = 1;
   	}
   	E cur;
   	for(i=0;i<m;i++)
   	{
   		scanf("%d%d%d",&cur.x,&cur.y,&cur.w);
   		cur.in = i;
   		a[i] = cur;
   	}
   	sort(a,a+m,cmp);
   	int done = 0;
   	i = 0;
   	while(done<n-1)
   	{
   		if(i>=m)break;
   		cur = a[i];
   		int fa1,fa2,si1,si2;
   		fa1 = cur.x;
   		fa2 = cur.y;
   		while(fa[fa1]!=-1)fa1 = fa[fa1];
   		while(fa[fa2]!=-1)fa2 = fa[fa2];
   		if(fa1!=fa2)
   		{
   			total*=cur.w;
   			total%=(1000000007);
   			si1 = si[fa1];
   			si2 = si[fa2];
   			done++;
   			if(si1 > si2){
   				fa[fa2] = fa1;
   				si[fa1]+=si2;
   			}
   			else {
   				fa[fa1] = fa2;
   				si[fa2] +=si1;
   			}
   		}
   		i++;
   		
   	}
   	printf("%lld\n",total);
   }
    return 0;
}
