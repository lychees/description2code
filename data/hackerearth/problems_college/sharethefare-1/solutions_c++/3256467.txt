#include <iostream>
#include <bits/stdc++.h>
#include <vector>
#define lli long long int
#define size 50
lli N ,q;

using namespace std;

int main() {
	lli t;
	string name[size];
	scanf("%lld",&t);
	while(t--){
		map <string ,lli> M;
		scanf("%lld%lld",&N,&q);
		for(lli i=0;i<N;++i){
			//scanf("%s",name);
			cin>>name[i];
			M[name[i]]=0;
		}

		for(lli i=0;i<q;++i){
			string paidBy;
			lli amount_paid,noOfPeople;
			cin>>paidBy;
			scanf("%lld",&amount_paid);
			scanf("%lld",&noOfPeople);
			lli perhead = amount_paid/(noOfPeople+1);
			for(lli j=0;j<noOfPeople;++j){
				string temp;

				//scanf("%s",temp);
				cin>>temp;
				M[temp]-=perhead;
			}
			M[paidBy]+=(noOfPeople*perhead);
		}
		map<string ,lli> ::iterator ii;
		for(lli i=0 ; i<N ;++i){
			string Name = name[i];
			lli amount = M[Name];
			if(amount<0){
				//printf("%s owes %lld",para1,amt);
				cout<<Name<<" owes "<<amount*(-1)<<endl;
			}else if(amount>0){
				//printf("%s is owed %lld",para1,amt);
				cout<<Name<<" is owed "<<amount<<endl;
			}else{
				//printf("%s neither owes nor is owed",para1);
				cout<<Name<<" neither owes nor is owed"<<endl;
			}
		}

	}
	return 0;
}
