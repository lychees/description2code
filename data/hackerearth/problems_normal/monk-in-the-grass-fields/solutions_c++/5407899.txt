#include <iostream>
#include <cstdio>
#include <algorithm>
#include <cstring>
#include <cstdlib>
#include <climits>
using namespace std;

#define readi(t) scanf("%d",&t)

typedef long long int lld;

int main() {
    int t;
    readi(t);
    while (t--) {
        int n, k;
        scanf("%d %d", &n, &k);
        int a[n][n];
        int row[n], col[n];
        lld defect = INT_MAX;
        
        memset(row,0,sizeof row);
        memset(col,0,sizeof col);
        
        for (int i = 0; i < n; i++) {
            for (int j = 0; j < n; j++) {
                readi(a[i][j]);
                row[i] += a[i][j];
                col[j] += a[i][j];
            }
        }

		int rowMinSum[k+1],colMinSum[k+1];
	
		rowMinSum[0] = 0;
		colMinSum[0] = 0;
        for (int i=1;i<=k;i++) {
        	sort(row,row+n);
        	rowMinSum[i] = rowMinSum[i-1] + row[0];
        	row[0]+=n;
        	sort(col,col+n);
        	colMinSum[i] = colMinSum[i-1] + col[0];
        	col[0]+=n;
        	
       }
       
       for (int i =0;i<=k;i++) {
       	defect= min(defect,(lld)rowMinSum[i]+(lld)colMinSum[k-i]+(lld)(i*(k-i)));
       }
        
       printf("%lld\n", defect);

    }
    return 0;
}
