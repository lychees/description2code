#include <bits/stdc++.h>
using namespace std;
pair <string,int> p[55];
#define mp make_pair
int main()
{
	int t;
	string str,s1;
	int n,q,val,m,own,x;
	cin>>t;
	while(t--)
	{
	cin>>n>>q;
	for(int i=1;i<=n;i++)
	{
		cin>>str;
		p[i]=mp(str,0);
	}
	for(int i=1;i<=q;i++)
	{
		cin>>str;
		cin>>val;
		cin>>m;
		x=floor(val/(m+1));
		own=x*m;
		for(int i=1;i<=m;i++)
		{
			cin>>s1;
			for(int i=1;i<=n;i++)
			{
				if(s1.compare(p[i].first)==0) p[i].second=p[i].second-x;
			}
		}
			for(int i=1;i<=n;i++)
			{
				if(str.compare(p[i].first)==0) p[i].second=p[i].second+own;
			}
	}
	for(int i=1;i<=n;i++)
	{
		if(p[i].second<0)
			cout<<p[i].first<<" owes "<<(-1*p[i].second)<<endl;
		else if(p[i].second>0)
			cout<<p[i].first<<" is owed "<<p[i].second<<endl;
		else
			cout<<p[i].first<<" neither owes nor is owed"<<endl;
	}
	}
	return 0;
}