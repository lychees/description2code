#include <bits/stdc++.h>
using namespace std;
set <pair<int,int> > s;
set <pair<int,int> >:: iterator it;
int a[100005];
int main() {
	int q;cin>>q;
	while(q--)
	{
		int x;cin>>x;
		if(x==1)
		{
			int y;cin>>y;
			if(a[y]!=0){
			s.erase(make_pair(y,a[y]));}
			a[y]++;
			s.insert(make_pair(y,a[y]));
		}
		if(x==2)
		{
			int y;cin>>y;
			if(a[y]==0)
			{cout<<"-1"<<endl;}
			else
			{
				s.erase(make_pair(y,a[y]));
				a[y]--;
				if(a[y]!=0)
				{
					s.insert(make_pair(y,a[y]));
				}
			}
		}
		if(x==3)
		{
			if(!s.empty()){
			it=s.end();
			it--;
			cout<<(*it).first<<endl;}
			else
			{
				cout<<"-1"<<endl;
			}
		}
		if(x==4)
		{
			if(!s.empty()){
			it=s.begin();
			cout<<(*it).first<<endl;}
			else
			{
				cout<<"-1"<<endl;
			}
		}
	}
	return 0;
}