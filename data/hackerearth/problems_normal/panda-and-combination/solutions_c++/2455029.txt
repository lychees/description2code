#include <iostream>
#include<stdio.h>
#include<vector>
using namespace std;

int main()
{
	vector<long long >a;
	long long t,i,j,tmp,ct,n,m,k,rem;
	
	scanf("%lld",&t);
	for(k=0;k<t;k++)
	{
		scanf("%lld%lld",&n,&m);
		tmp=1;
		ct=0;
		rem=n;
		j=0;
		
		while(tmp<=n)
		{
			a.push_back(tmp);
			j++;
			if(m==1)
			break;
			tmp=tmp*m;
			if(tmp<a[j-1])
			break;
		}
		j=a.size();
		j--;
		
		while(j>=0&&rem!=0)
		{
			tmp=rem/a[j];
			ct+=tmp;
			rem=rem-tmp*a[j];
			j--;
		}
		j=a.size()-1;
		while(j>=0)
		{
			a.pop_back();
			j--;
		}
		printf("%lld\n",ct);
	}
    return 0;
}
