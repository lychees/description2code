#include<bits/stdc++.h>
using namespace std;

void prefix(string s) {
	vector<int> p(s.length()+1);
	p[0] = 0;
	for(int i = 1;i < s.length(); i++) {
		int j = p[i-1];
		while(j > 0 && s[i] != s[j]) {
			j = p[j-1];
		}
		if(s[i] == s[j]) {
			p[i] = j + 1;
		} 
	}
	int ans = 0; 
	for(int i = p.size()/2; i < p.size(); i++) {
	   ans =max(ans, p[i]) ;
	}
	printf("%d\n",ans);
}


int main() {
	int t;
	cin>>t;
	int n;
	while(t--) {
		cin>>n;
		int x;
		string start =  "",end = "";
		for(int i = 0 ; i < n; i++) {
			scanf("%d",&x);
			if(i >= 1)
		     start += (char)( x+ '0' );
		    if(i < n - 1) 
		    end += (char)(x+'0');
		}
		string s  = end+'#' +start;
		//cout<<s<<"\n";
		prefix(s);
    }
    return 0;
}