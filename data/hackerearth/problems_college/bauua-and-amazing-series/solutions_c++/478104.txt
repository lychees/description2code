#include<stdio.h>
#define mod 1000000007
void power(long long int a[9],long long int n);
void multiply(long long int a[9],long long int n);
void multiply2(long long int a[9],long long int n);

long long int a[9],c[9],x1,x2,x3,y1,y2,y3,z1,z2,z3,r1,r2,flag;
int main()
{   long long int t,e,n,f0,f1,a1,b1,c1,result=0;
    scanf("%lld",&t);
    while(t--)
    {
      scanf("%lld%lld%lld%lld%lld%lld",&n,&f0,&f1,&a1,&b1,&c1);
      //printf("%lld %lld %lld %lld %lld %lld\n",n,f0,f1,a1,b1,c1);
      c[0]=a[0]=a1;;
      c[1]=a[1]=b1;
      c[2]=a[2]=1;
      c[3]=a[3]=1;
      c[4]=a[4]=0;
      c[5]=a[5]=0;
      c[6]=a[6]=0;
      c[7]=a[7]=0;
      c[8]=a[8]=1;
      int k=0,i;;
      
      if(n==1)
      printf("%lld\n",f0);
      else
      if(n==2)
      printf("%lld\n",f1);
      else
     {    
	 n=n-2; 
	  power(a,n);
	  result=(((a[0]*f1)%mod + (a[1]*f0)%mod )%mod+ ((a[2]*c1)%mod))%mod;
	  printf("%lld\n",result);
     }
    }
    return 0;
}
void power(long long int a[9],long long int n)
{
    if(n==1)
    return ;
    power(a,n>>1);
        multiply(a,n);
    if(n&1)
    multiply2(a,n);
}

void multiply(long long int a[9],long long n)
{
    x1=(((((a[0]*a[0])%mod+(a[1]*a[3])%mod)%mod)+(a[2]*a[6])%mod))%mod;
    x2=(((((a[0]*a[1])%mod+(a[1]*a[4])%mod)%mod)+(a[2]*a[7])%mod))%mod;
    x3=(((((a[0]*a[2])%mod+(a[1]*a[5])%mod)%mod)+(a[2]*a[8])%mod))%mod;
	y1=(((((a[3]*a[0])%mod+(a[4]*a[3])%mod)%mod)+(a[5]*a[6])%mod))%mod;
    y2=(((((a[3]*a[1])%mod+(a[4]*a[4])%mod)%mod)+(a[5]*a[7])%mod))%mod;
    y3=(((((a[3]*a[2])%mod+(a[4]*a[5])%mod)%mod)+(a[5]*a[8])%mod))%mod;
    z1=(((((a[6]*a[0])%mod+(a[7]*a[3])%mod)%mod)+(a[8]*a[6])%mod))%mod;
	z2=(((((a[6]*a[1])%mod+(a[7]*a[4])%mod)%mod)+(a[8]*a[7])%mod))%mod;
    z3=(((((a[6]*a[2])%mod+(a[7]*a[5])%mod)%mod)+(a[8]*a[8])%mod))%mod;
    a[0]=x1;
    a[1]=x2;
    a[2]=x3;
    a[3]=y1;
    a[4]=y2;
    a[5]=y3;
    a[6]=z1;
    a[7]=z2;
    a[8]=z3;
}

void multiply2(long long int a[9],long long int n)

{
    x1=(((((a[0]*c[0])%mod+(a[1]*c[3])%mod)%mod)+(a[2]*c[6])%mod))%mod;
    x2=(((((a[0]*c[1])%mod+(a[1]*c[4])%mod)%mod)+(a[2]*c[7])%mod))%mod;
    x3=(((((a[0]*c[2])%mod+(a[1]*c[5])%mod)%mod)+(a[2]*c[8])%mod))%mod;
	y1=(((((a[3]*c[0])%mod+(a[4]*c[3])%mod)%mod)+(a[5]*c[6])%mod))%mod;
    y2=(((((a[3]*c[1])%mod+(a[4]*c[4])%mod)%mod)+(a[5]*c[7])%mod))%mod;
    y3=(((((a[3]*c[2])%mod+(a[4]*c[5])%mod)%mod)+(a[5]*c[8])%mod))%mod;
    z1=(((((a[6]*c[0])%mod+(a[7]*c[3])%mod)%mod)+(a[8]*c[6])%mod))%mod;
	z2=(((((a[6]*c[1])%mod+(a[7]*c[4])%mod)%mod)+(a[8]*c[7])%mod))%mod;
    z3=(((((a[6]*c[2])%mod+(a[7]*c[5])%mod)%mod)+(a[8]*c[8])%mod))%mod;
    a[0]=x1;
    a[1]=x2;
    a[2]=x3;
    a[3]=y1;
    a[4]=y2;
    a[5]=y3;
    a[6]=z1;
    a[7]=z2;
    a[8]=z3;
}
