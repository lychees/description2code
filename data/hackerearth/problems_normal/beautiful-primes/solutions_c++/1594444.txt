#include <bits/stdc++.h>
using namespace std;
long long int MOD=1000000007;
long long int power(long long int a, int b)
{
	if(b==0)
		return 1;
	if(b==1)
		return a;
	long long int ans=power(a,b/2);
	ans=(ans * ans)%MOD;
	if(b & 1)
	{
		ans=(ans*a)%MOD;
	}
	return ans;
}
long long int gp_sum(long long int x, int a)
{
	long long int ans=(x*(power(x,a)+MOD-1))%MOD;
	ans=(ans*power(x-1,MOD-2))%MOD;
	return ans;
}
int p[100005],a[100005];
int main()
{
	// freopen("input.txt", "r", stdin);
	int t;
	scanf("%d", &t);
	while(t--)
	{
		int n;
		scanf("%d", &n);
		for (int i = 0; i < n; ++i)
		{
			scanf("%d", &p[i]);
		}
		for (int i = 0; i < n; ++i)
		{
			scanf("%d", &a[i]);
		}
		long long int ans=1;
		for (int i = n-1; i >= 0; --i)
		{
			ans=(ans*gp_sum(p[i],a[i]))%MOD;
		}
		printf("%lld\n", ans);
	}
	return 0;
}