M = 10**9 + 7
for t in xrange(input()):
    X = input()
    P = map(int, raw_input().split())
    A = map(int, raw_input().split())

    res = 1
    for i in xrange(len(A)):
        res *= ((pow(P[i], A[i]+1, M)-P[i]+M) % M)*(pow(P[i]-1, M-2, M))
        res %= M
    print res
