#include<bits/stdc++.h>

using namespace std;

#define mod 1000000007
#define INF 1e9
#define MAX INF
#define gcd(a,b) __gcd(a,b)
#define READY ios_base::sync_with_stdio(false);
#define DEBUG if(1)
#define DONE return 0;
#define pb(x) push_back(x)
#define mp(x,y) make_pair((x),(y))
#define pii pair<int, int>
#define pi pair<pair<int,int>,int >
long long ans[1000001];
set<int> v;
map<string,int> ma;
int main(){
    int n,x,i,j,k;
    cin>>n;
    for(int k=1;k<=n;k++){
        x=k;
        v.clear();
        while(x>0){
            v.insert(x%10);
            x/=10;
        }
        int ct=1<<(v.size());

        set<int>::iterator it;
        //cout<<v.size()<<" "<<k<<endl;
        for(i=1;i<ct;i++){
            string s="";
            for(j=0,it=v.begin();j<v.size();j++,it++){

                if((1<<j)&i){
                    x=*it;
                    s+=(x+'0');
                }
            }
            if(ma.count(s)==0)ma[s]=1;
            else ma[s]++;
        }

    }
    int q,m;
    cin>>q;
    while(q--){
        cin>>m;
        int arr[m];
        for(i=0;i<m;i++){
            cin>>arr[i];
        }
        sort(arr,arr+m);
        int ct=1<<m;
        long long ans=0;
          for(i=1;i<ct;i++){
            string s="";
            int co=0;
            for(j=0;j<m;j++){

                if((1<<j)&i){
                    x=arr[j];
                    s+=(x+'0');
                    co++;
                }
            }
            if(co%2==1)ans+=ma[s];
            else ans-=ma[s];


        }
        cout<<ans<<endl;
    }
    DONE
}
