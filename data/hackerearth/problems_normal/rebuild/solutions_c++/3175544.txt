/*
-----------------------------------------------------------------------------
Author :            ---------------------------------------------------------
    UTKAR$H $AXENA  ---------------------------------------------------------
    IIT INDORE      ---------------------------------------------------------
-----------------------------------------------------------------------------
*/
#include<bits/stdc++.h>
#include<iostream>
using namespace std;
#define fre 	freopen("0.in","r",stdin);freopen("0.out","w",stdout)
#define abs(x) ((x)>0?(x):-(x))
#define MOD 1000000007
#define LL signed long long int
#define scan(x) scanf("%d",&x)
#define print(x) printf("%d\n",x)
#define scanll(x) scanf("%lld",&x)
#define printll(x) printf("%lld\n",x)
#define rep(i,from,to) for(int i=from;i <= to; ++i)
#define pii pair<int,int>

vector<int> G[2*100000+5];
#define DSU_SZ 100000
int dad[DSU_SZ+5],rnk[DSU_SZ+5];
struct DSU
{int n;
    void init(int nn)
    {
        n = nn;
        for (int i = 1; i <=n; i++)
        {
            rnk[i] = 0;
            dad[i] = i;
        }
    }
    int root(int v)
    {
        if (v == dad[v]) return v;
        return dad[v] = root(dad[v]);
    }
    void join(int v1, int v2)
    {
        v1 = root(v1), v2 = root(v2);
        if (v1 == v2) return;
        if (rnk[v1] < rnk[v2]) swap(v1, v2);
        dad[v2] = v1;
        if (rnk[v1] == rnk[v2]) rnk[v1]++;
    }
}dsu;
vector<pair<int,pii>>E;
int deg[100000+5];
int main(){
//	fre;
	int T;
	cin>>T;
	while(T--){
		int N,M;
		LL sum = 0;
		int a,b,c;

		cin>>N>>M;
		E.clear();
		rep(i,1,N)deg[i] = 0;
		dsu.init(N);
		for(int i=1;i<=M;++i){
			cin>>a>>b>>c;
			if(a>b)
				swap(a,b);
			E.push_back({c,{-a,-b}});
		}
		sort(E.begin(),E.end());
		for(int i=0;i<E.size();++i){
			a = -E[i].second.first;
			b = -E[i].second.second;
			if(dsu.root(a)!=dsu.root(b)){
				deg[a]++;
				deg[b]++;
				dsu.join(a,b);
				sum += E[i].first;
			}
		}
		cout<<sum<<endl;
		rep(i,1,N)cout<<deg[i]<< ' ';
		cout<<endl;
	}
}
