#include <bits/stdc++.h>

using namespace std;

const int N = 1234567;

int a[N], x[N], y[N];
char foo[N];
bool was[N];

int main() {
  int tt;
  scanf("%d", &tt);
  while (tt--) {
    int h, w;
    scanf("%d %d", &h, &w);
    for (int i = 0; i < h; i++) {
      scanf("%s", foo);
      for (int j = 0; j < w; j++) {
        a[i * w + j] = foo[j] - 'a';
      }
    }
    vector <int> cnt(26, 0);
    for (int i = 0; i < h * w; i++) {
      cnt[a[i]]++;
    }
    bool ok = true;
    for (int who = 0; who < 26; who++) {
      for (int i = 0; i < h * w; i++) {
        was[i] = false;
      }
      int e = 0;
      for (int i = 0; i < h; i++) {
        for (int j = 0; j < w; j++) {
          if (i == 0 || j == 0 || i == h - 1 || j == w - 1) {
            if (a[i * w + j] != who) {
              e++;
              x[e] = i;
              y[e] = j;
              was[i * w + j] = true;
            }
          }
        }
      }
      int b = 1;
      while (b <= e) {
        for (int dx = -1; dx <= 1; dx++) {
          for (int dy = -1; dy <= 1; dy++) {
            int xk = x[b] + dx;
            int yk = y[b] + dy;
            if (xk < 0 || yk < 0 || xk >= h || yk >= w) {
              continue;
            }
            if (a[xk * w + yk] != who && !was[xk * w + yk]) {
              e++;
              x[e] = xk;
              y[e] = yk;
              was[xk * w + yk] = true;
            }
          }
        }
        b++;
      }
      if (e + cnt[who] < h * w) {
        ok = false;
        break;
      }
    }
    puts(ok ? "YES" : "NO");
  }
  return 0;
}
