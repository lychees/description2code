    #include <algorithm>
    #include <assert.h>
    #include <bitset>
    #include <cmath>
    #include <ctype.h>
    #include <deque>
    #include <fstream>
    #include <functional>
    #include <iostream>
    #include <list>
    #include <limits.h>
    #include <map>
    #include <queue>
    #include <set>
    #include <stack>
    #include <stdio.h>
    #include <string>
    #include <string.h>
    #include <time.h>
    #include <utility>
    #include <vector>
     
    using namespace std;
     
    typedef long long ll;
    typedef pair<int,int> ipair;
    typedef vector<int> vi;
     
    #define MAX 1000000007
    #define MOD 1000000007
    #define F first
    #define S second
    #define SZ size()
    #define BG begin()
    #define EN end()
    #define FI freopen("I.txt","r",stdin)
    #define FO freopen("O.txt","w",stdout)
    #define GT(a) int a;scanf("%d",&a)
    #define PT(a) printf("%d\n",a)
    #define MP(a,b) make_pair(a,b)
    #define PB(a) push_back(a)
    #define REP(i,a,b) for(int i=a;i<b;i++)
    #define rep(i,n) REP(i,0,n)
    #define rev(i,n) for(int i=n;i>=0;i--)
    #define take(ar,n) ll ar[n+1]; rep(i,n) cin>>ar[i]
    #define MS(a,b) memset(a,b,sizeof(a))
     
    int main()
    {
        GT(test);
    	while(test--)
    	{
    		ll n,k;
    		cin>>n>>k;
    		take(ar,n);
    		//sort(ar,ar+n);
    		ar[n]=1e10;
    		ll r=0,pt1=0,pt2=0,sum=0;
            /// Binary Search Not working So i Tried Method of two pointers ///
            while(pt1<n && pt2<=n)
            {
                if(k>=ar[pt2]-ar[pt1]) pt2++;
                else r+=(pt2-++pt1)*(pt2-pt1-1)/2;
            }
            cout<<r<<endl;
    	}
        return 0;
    }