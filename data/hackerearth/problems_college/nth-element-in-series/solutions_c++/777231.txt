#include<iostream>
#include<cstring>
#define MOD 1000000007
using namespace std;
long long int m(long long int a)
{
	return a%MOD;
}
long long int f(long long int n,long long int ff[])
{
long long fib[5][5]= {{0,1,0,0,0},{0,0,1,0,0},{0,0,0,1,0},{0,0,0,0,1},{1,2,1,1,1}};
long long int ret[5][5]={{1,0,0,0,0},{0,1,0,0,0},{0,0,1,0,0},{0,0,0,1,0},{0,0,0,0,1}};
long long int tmp[5][5]={{0,0,0,0,0},{0,0,0,0,0},{0,0,0,0,0},{0,0,0,0,0},{0,0,0,0,0}};
    int i,j,k;
    if(n<5)
    return ff[n];
    else
    {
    	n=n-4;
    while(n)
    {
        if(n&1)
        {
            memset(tmp,0,sizeof tmp);
            for(i=0; i<5; i++)
			 for(j=0; j<5; j++) 
			 for(k=0; k<5; k++)
                        tmp[i][j]=m(tmp[i][j]+m(ret[i][k]*fib[k][j]));
            for(i=0; i<5; i++)
			 for(j=0; j<5; j++) 
			 ret[i][j]=tmp[i][j];
        }
        memset(tmp,0,sizeof tmp);
        for(i=0; i<5; i++) 
		for(j=0; j<5; j++) 
		for(k=0; k<5; k++)
                    tmp[i][j]=m(tmp[i][j]+m(fib[i][k]*fib[k][j]));
        for(i=0; i<5; i++) for(j=0; j<5; j++) 
		fib[i][j]=tmp[i][j];
        n=n>>1;
    }
    return m(ff[0]*ret[4][0]+ff[1]*ret[4][1]+ff[2]*ret[4][2]+ff[3]*ret[4][3]+ff[4]*ret[4][4]);
    }
}
int main()
{
	long long int n,t,ff[10],i;
	cin>>t;
	while(t--)
	{
		  for(i=0;i<5;i++)
		  {
  			cin>>ff[i];
  		}
		cin>>n;
		cout<<f(n,ff)<<endl;
		
	}
	return 0;
}
