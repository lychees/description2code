#include <bits/stdc++.h>
using namespace std;

#define rep(i, a, b) for(int i = a; i < int(b); ++i)
#define trav(it, v) for(auto it = v.begin(); \
		it != v.end(); ++it)
#define all(x) x.begin(), x.end()
#define D(x) \
	cerr << #x << " = " << x << endl

typedef long long ll;
typedef pair<int, int> pii;
typedef vector<int> vi;
int cin;

const ll MOD = 1000000007;

struct FT {
	int n;
	vi s;
	FT(int _n) : n(_n) {
		s.assign(n, 0);
	}
	void update(int pos, int dif) {
		for (; pos < n; pos |= pos + 1)
			s[pos] += dif;
	}
	int query(int pos) {
		int count = 0;
		for (; pos >= 0; pos = (pos & (pos + 1)) - 1)
			count += s[pos];
		return count;
	}
};

int main() {
	int N;
	ignore = scanf("%d", &N);
	if(N == 1){
		printf("%d\n", 1);
		return 0;
	}
	ll ans = 0;
	vector<bool> seen(N);
	vector<ll> pows(N);
	pows[0] = 1;
	rep(i,1,N) pows[i] = (pows[i - 1] * 2) % MOD;
	
	FT one(N);
	for(int i = 0; i < 2*N; ++i){
		int x;
		scanf("%d", &x);
		x = N - x;

		ans += pows[N - 2] * (i - one.query(x));
		ans += 3 * pows[N - 2] * one.query(x - 1);
		
		if(seen[x]){
			ans += pows[N - 1];
		} else {
			seen[x] = true;
		}
		one.update(x, 1);
		
		ans %= MOD;
	}
	printf("%lld\n", ans);
}
