#include <bits/stdc++.h>
#define INF 0x7fffffff
#define INFLL 1e17
#define PI 2*acos(0.0)
#define show(x) cout<< #x <<" is "<< x <<"\n"
using namespace std;

#define FS first
#define SC second
#define PB(t) push_back(t)
#define ALL(t) t.begin(),t.end()
#define MP(x, y) make_pair((x), (y))
#define Fill(a,c) memset(&a, c, sizeof(a))

typedef long long LL;
typedef pair<LL, LL> II;
typedef vector<LL> VI;
typedef vector<II> VII;

int main( ){
    ios::sync_with_stdio( false );
    cin.tie( NULL );
    int T, n1, n2;
    LL m;
    VI num1, num2;
    for(cin>>T; T--; ) {
    	cin>>m>>n1>>n2;
    	num1.assign(n1, 0);
    	num2.assign(n2, 0);
    	
    	for (auto& v : num1) {
    		cin>>v;
    	}
    	
    	for (auto& v : num2) {
    		cin>>v;
    	}
    	sort(ALL(num1));
    	sort(ALL(num2));
    	LL res = 0, alc = 0, aux, pv = 1e18;
    	VI sol, best;
    	for (int k = 0; k < (1<<n2); k++) {
    		res = 0;
    		sol.clear();
    		for ( int i = 0; i < n2; i++) {
    			if ( k & (1<<i) ) {
    				res += num2[i];
    			}
    		}
    		aux = res;
	    	for (int i = num1.size() - 1; i >= 0; i--) {
	    		if (res + num1[i] <= m) {
	    			res += num1[i];
	    			sol.PB( num1[i] );
	    		}
	    	}
	    	
	    	if (res == m && aux < pv){
	    		best = sol;
	    		alc = 1;
	    		pv = aux;
	    	}
    	}
    	
    	if (alc) {
    		cout<<"YES\n";
    		for (int i = best.size() - 1; i >= 0; i--) {
    			cout<<best[i]<<" ";
    		}
    		cout<<"\n";
    	} else {
    		cout<<"NO\n";
    	}
    	
    }
return 0;
}
