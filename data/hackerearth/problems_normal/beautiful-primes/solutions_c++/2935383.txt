#include <bits/stdc++.h>
using namespace std;

int Test, X, P[100001], A[100001];

long long Pow(int x, int y)
{
    if (y == 0) return 1;
    long long k = Pow(x, y / 2);
    k = k * k % 1000000007;
    return (y & 1) ? (k * x % 1000000007) : k;
}

long long SumPow(int P, int A) // P^1 + P^2 + ... + P^A
{
    if (A == 1) return P;
    if (A & 1) return (SumPow(P, A - 1) + Pow(P, A)) % 1000000007;
    return SumPow(P, A / 2) * (1 + Pow(P, A / 2)) % 1000000007;
}

main()
{
    for (scanf("%d", &Test); Test--; )
    {
        scanf("%d", &X);
        for (int i = 1; i <= X; i++) scanf("%d", &P[i]);
        for (int i = 1; i <= X; i++) scanf("%d", &A[i]);

        long long ans = 1;
        for (int i = 1; i <= X; i++)
            ans = ans * SumPow(P[i], A[i]) % 1000000007;
        printf("%lld\n", ans);
    }
}
