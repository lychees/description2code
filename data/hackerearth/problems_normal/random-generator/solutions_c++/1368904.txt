#include <bits/stdc++.h>
using namespace std;

#define MOD 1000000007

int main()
{
	int t;
	scanf("%d",&t);
	while(t--)
	{
		int n,k,p,x;
		scanf("%d%d%d",&n,&k,&p);
		int A[n];
		for(int i=0;i<n;++i)
			scanf("%d",A+i);
		sort(A,A+n);
		bool flag = true;
		for(int i=0;i<n;++i)
		{
			int cnt = (upper_bound(A,A+n,A[i]+2*p)-(A+i));
			if(cnt>=k)
				flag = false;
		}
		if(flag)
			printf("YES\n");
		else
			printf("NO\n");
	}
	return 0;
}