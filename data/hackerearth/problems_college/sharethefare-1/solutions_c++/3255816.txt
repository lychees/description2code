#include <bits/stdc++.h>
using namespace std;

int main()
{
    int t,n,q,i,j,p,m;
    scanf("%d",&t);
    string s[55];
    while(t--)
    {
    	scanf("%d%d",&n,&q);
    	map<string,int> mp;
    	string x,y;
    	for(i=0;i<n;i++)
    	{
    		cin>>s[i];
    	}
    	for(i=0;i<q;i++)
    	{
    		cin>>x;
    		cin>>p>>m;
    		mp[x]-=((p)/(m+1))*m;
    		for(j=0;j<m;j++)
    		{
    			cin>>y;
    			mp[y]+=p/(m+1);
    		}
    	}
    	for(i=0;i<n;i++)
    	{
    		if(mp[s[i]]==0)
    		{
    			cout<<s[i]<<" neither owes nor is owed"<<'\n';
    		}
    		else
    		{
    			if(mp[s[i]]>0)
    			{
    				cout<<s[i]<<" owes "<<mp[s[i]]<<'\n';
    			}
    			else
    			{
    				cout<<s[i]<<" is owed "<<-mp[s[i]]<<'\n';
    			}
    		}
    	}
    }
    return 0;
}
