#include<bits/stdc++.h>
using namespace std;
#define gc getchar
inline long long int read()
{
	register char c = gc();
	while(c<'0' || c>'9') c = gc();
	long long int ret = 0;
	while(c>='0' && c<='9')
	{
		ret = 10 * ret + c - 48;
		c = gc();
	}
	return ret;
}
char a[10001][10001];
int b[10001],n;
int sete(int x)
{
	if(!b[x])
	{
	b[x]=1;
	int i;
	for(i=1;i<=n;i++)
	{
		if(a[x][i])
		{		
		sete(i);
		b[i]=1;
	    }
	}
 	 
    }
}
int main()
{
int t;
//scanf("%d",&t);
t=read();
while(t--)
{
	memset(a,'\0',sizeof(a));
	memset(b,0,sizeof(b));
	int i,j,k,l,x,y,z=0,f,s;
	//scanf("%d%d%d",&n,&f,&s);
	n=read();
	f=read();
	s=read();
	while(f--)
	{
		//scanf("%d%d",&x,&y);
		x=read();
		y=read();
		a[x][y]=1;
	}
	while(s--)
	{
		x=read();
	//scanf("%d",&x);
	sete(x);
/*	b[x]=1;
	for(i=1;i<=n;i++)
	{
		if(a[x][i])
		{
		b[i]=1;	
	    }
	}	
	
	*/
	}

	for(i=1;i<=n;i++)
	{
		if(b[i]) z++;
	}
	printf("%d\n",z);
}
	return 0;
}
