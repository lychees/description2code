#include <bits/stdc++.h>
using namespace std;

#define ll long long int
#define mp(i,j) make_pair(i,j)
#define pb(x) push_back(x)
#define MAXN 100010
#define MOD 1000000007

ll a[MAXN];

int main()
{
	ll i,t,n,m,z,which,haha;
	bool flag;

	cin>>t;

	while(t--) {
		memset(a,0,sizeof(a));
		cin>>n>>m>>z;

		for(i=0;i<n;i++) {
			cin>>a[i];
		}

		if(n%2==0) {
			flag = true;
			for(i=0;i<n;i++) {
				if(flag) {
					a[n] = ((a[n] - a[i])%m + m)%m;
					flag = false;
				} else {
					a[n] = (a[n] + a[i])%m;
					flag = true;
				}
			}

			if(z<=n) {
				cout<<(a[z])%m<<endl;
				continue;
			}

			for(i=0;i<=n;i++) {
				if((z-i)%(n+1)==0) break;
			}
			which = i;
			haha = (z-which)/(n+1);
			if(haha%2==0) {
				cout<<(a[which])%m<<endl;
			} else {
				cout<<((-a[which])%m + m)%m<<endl;
			}
		} else {
			flag = false;
			for(i=0;i<n;i++) {
				if(flag) {
					a[n] = ((a[n] - a[i])%m + m)%m;
					flag = false;
				} else {
					a[n] = (a[n] + a[i])%m;
					flag = true;
				}
			}
			if(z<=n) {
				cout<<(a[z])%m<<endl;
				continue;
			}
			for(i=0;i<=n;i++) {
				if((z-i)%(n+1)==0) break;
			}
			which = i;
			cout<<(a[which])%m<<endl;
		}
	}

	return 0;
}
