#include<bits/stdc++.h>
#include<algorithm>
using namespace std;
#define fr(i,a,b) for(int i=a;i<b;i++)
#define frn(i,a,b) for(int i=a;i>b;i--)
#define si(x) scanf("%d",&x)
#define sll(x)  scanf("%lld",&x)
#define pln printf("\n")
#define pi(x) printf("%d",x)
#define pll(x) printf("%lld",x)
#define mp make_pair
#define pb push_back
#define x first
#define y second
typedef long long ll;
ll MOD=1000000007;
ll pw(ll a,ll b){
  ll r=1;
  while(b>0){
     if(b&1){
       r=(r*a)%MOD;
        }
     b=b>>1;
     a=(a*a)%MOD;
  }
return (r)%MOD;
}
vector<int>g[10101];
int colc[2];
int vis[10101];
int dis[10101];
void bfs(int s){
   queue<int>q;
   q.push(s);
   vis[s]=1;
   dis[s]=0;
   int cur;
   while(!q.empty()){
    cur=q.front();
    q.pop();
    fr(i,0,g[cur].size()){
        if(!vis[g[cur][i]]){
            vis[g[cur][i]]=1;
            dis[g[cur][i]]=dis[cur]+1;
            q.push(g[cur][i]);
        }
    }

   }
}

int main(){
  int t;
  si(t);
  fr(tr,1,t+1){
      int n,m;
      si(n);
      si(m);
      fr(i,0,n+1){
         g[i].clear();
      }
      fr(i,0,n+1){
         vis[i]=0;
         dis[i]=0;
       }

      int u,v,s=0;
      fr(i,0,m){
        si(u),si(v);
        g[u].pb(v);
        g[v].pb(u);
      }
      bfs(1);
      pi(dis[n]);pln;
  }
return 0;
}
