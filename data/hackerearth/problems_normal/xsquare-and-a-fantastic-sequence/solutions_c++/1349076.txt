#include<bits/stdc++.h>
using namespace std;
#define ll  long long    int
#define INF 10000
#define mp make_pair
#define f first
#define pi pair<ll,ll>
#define pb emplace_back
#define s second
vector<ll>g[100011];
ll vis[100011];
vector<ll>comp[100011];
ll cnt=0;
void dfs(ll v){
    vis[v]=1;
    comp[cnt].pb(v);
    for(auto x:g[v]){
        if(!vis[x]) dfs(x);
    }
}
int main(){
ll t,n,m,u,v;
cin>>t;
string s1,s2;
while(t--){
    cin>>n>>m;
    cin>>s1>>s2;
    for(int i=0;i<s2.length();i++) g[i].clear(),comp[i].clear(),vis[i]=0;
    while(m--){
        cin>>u>>v;
        u--;
        v--;
        g[u].pb(v);
        g[v].pb(u);
    }
    cnt=0;
    for(int i=0;i<s1.length();i++){
        if(!vis[i]){
            dfs(i);
            cnt++;
        }
    }
    ll f1[26]={0};
    ll f2[26]={0};
    ll ans=0;
    for(int c=0;c<cnt;c++){
        for(auto x:comp[c]){
            f1[s1[x]-'a']++;
            f2[s2[x]-'a']++;
        }
        sort(comp[c].begin(),comp[c].end());
        for(auto x:comp[c]){
            if(f1[s2[x]-'a']>=f2[s2[x]-'a']){
                ans++;
                s1[x]=s2[x];
                //cout<<s2[x]<<" ";
                f1[s2[x]-'a']--;
                f2[s2[x]-'a']--;
            }
            else{
                for(char p='a';p<='z';p++){
                    if(f1[p-'a']==0) continue;
                    if(p==s2[x]){
                        ans++;
                        s1[x]=s2[x];
                        f1[s2[x]-'a']--;
                        f2[s2[x]-'a']--;
                        break;
                    }
                    if(f1[p-'a']>f2[p-'a']){
                        s1[x]=p;
                        f1[p-'a']--;
                        f2[s2[x]-'a']--;
                       // cout<<p<<" ";
                        break;
                    }
                }
            }
        }
            memset(f1,0,sizeof(f1));
            memset(f2,0,sizeof(f2));
        
    }
        cout<<ans<<"\n";
        cout<<s1<<"\n";
    
}

}
