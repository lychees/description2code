#include <iostream>
#include <map>
#include <vector>
using namespace std;

int main()
{
    int testcases,num_of_people,transaction_count,amount,people_per_transaction,share_per_person;
    string giver;
    cin >> testcases;
   	while (testcases!=0)
   	{
   		cin>> num_of_people >> transaction_count;
   		map<string,int> mymap;
   		vector<string> names;
   		string name;
   		for(int i=0;i<num_of_people;i++){
   			cin >> name;
   			names.push_back(name);
   			mymap[name] = 0;
   		}
   		for(int i=0;i<transaction_count;i++){
   			cin >> giver;
   			cin >> amount;
   			cin >> people_per_transaction;
   			int modulo = amount%(people_per_transaction+1);
   			amount = amount - modulo;
   			share_per_person = amount/(people_per_transaction+1);
   			mymap[giver] = mymap[giver] + amount - (share_per_person );
   			for ( int j=0;j<people_per_transaction;j++){
   				cin >> name;
   				mymap[name] = mymap[name] - share_per_person;
   			}
   		}
   		for(int i = 0; i < names.size(); i++){
   			if ( mymap[names[i]] > 0)
   				cout << names[i] << " is owed " << mymap[names[i]] << endl;
   			else if (mymap[names[i]] <0)
   				cout << names[i] << " owes " << -(mymap[names[i]]) << endl;
   			else
   				cout << names[i] << " neither owes nor is owed" << endl;
   		}
		testcases--;
   	}
    return 0;
}
