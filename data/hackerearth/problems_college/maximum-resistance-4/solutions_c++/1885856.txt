#include <bits/stdc++.h>
using namespace std;
string s;
int ind=0;
int gao() {
char type = s[ind++];
if (type == 'X') {
return 1;
} else if (type == 'A') {
return gao() + gao();
} else {
return max(gao(), gao());
}
}
int f(string circuit, vector <int> conductors) {
s = circuit;
sort(conductors.rbegin(), conductors.rend());
ind = 0;
int number = gao();
int ret = 0;
for (int i = 0; i < number; i++) {
ret += conductors[i];
}
return ret;
}
int main() {
	int t;
	cin>>t;
	while(t--){
	    int count=0;
	    string str;
	    cin>>str;
	    for(int i=0;i<str.length();i++){
	        if(str[i]=='X')
	        count++;
	    }
	    vector <int > ar(count);
	   
	    for(int i=0;i<count;i++)
	    cin>>ar[i];
	    cout<<f(str,ar)<<endl;
	}
	return 0;
}
