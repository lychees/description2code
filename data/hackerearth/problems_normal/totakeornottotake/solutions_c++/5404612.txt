#include <bits/stdc++.h>
using namespace std;

int main() {
	// your code goes here
	int T,B,x;
	long long int max,min;
	char c;
	
	cin>>T;
	while(T--){
		cin>>B;	max=1;min=1;
		while(B--){
			cin>>c;
			if(c!='N') cin>>x;
			
			switch(c){
				case '+': max+=x; break;
				case '-': min-=x; break;
				case '*': max*=x; if(min<1) min*=x; break;
				case '/': if(min==1) min/=x; break;
				case 'N': if(-min>max) max=-min; else if(-max<min) min=-max; break;
			}
		}	cout<<max<<endl;
	}
	
	
	return 0;
}
