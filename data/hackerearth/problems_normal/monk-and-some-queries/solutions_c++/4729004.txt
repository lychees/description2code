#include <iostream>
#include <map>
using namespace std;

int main()
{
	int a, n, b;
	map<int, int> mp;
    cin>>n;
    while(n--)
    {
    	cin>>a;
    	if(a == 1)
    	{
    		cin>>b;
    		if(mp.find(b) != mp.end())
    		{
    			mp[b] += 1;
    		}
    		else
    		{
    			mp.emplace(b, 1);
    		}
    	}
    	else if(a == 2)
    	{
    		cin>>b;
    		if(mp.find(b) != mp.end())
    		{
    			mp[b] -= 1;
    			if(mp[b] == 0)
    			{
    				mp.erase(b);
    			}
    		}
    		else
    		{
    			cout<<"-1\n";
    		}
    	}
    	else if(a == 3)
    	{
    		if(mp.size() > 0)
    		{
    			cout<<(--mp.end())->first<<endl;
    		}
    		else
    		{
    			cout<<"-1\n";
    		}
    	}
    	else if(a == 4)
    	{
    		if(mp.size() > 0)
    		{
    			cout<<mp.begin()->first<<endl;
    		}
    		else
    		{
    			cout<<"-1\n";
    		}
    	}
    }
    return 0;
}
