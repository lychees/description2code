#include <bits/stdc++.h>
#define MOD 1000000007LL
using namespace std;

typedef long long ll;

ll graph[50][50];

void multiply(ll a[50][50], ll b[50][50]){

    ll aux[50][50];
    memset(aux, 0, sizeof(aux));

    for(int i = 0 ; i < 50 ; i++)
        for(int j = 0 ; j < 50 ; j++){

            ll sum =0;

            for(int k = 0 ; k < 50 ; k++){

                sum += (a[i][k] * b[k][j]) % MOD;
                sum %= MOD;

            }

            aux[i][j] = sum;
        }


     for(int i = 0 ; i < 50 ; i++)
        for(int j = 0 ; j < 50 ; j++)
            a[i][j] = aux[i][j];


}

void power(ll base[50][50], ll exp){

    ll res[50][50];
    memset(res,0, sizeof(res));
    for(int i = 0 ; i < 50 ; i++)
        res[i][i] = 1;


    while(exp){

        if(exp % 2 == 1) multiply(res, base);
        multiply(base, base);
        exp /= 2;
    }

    for(int i = 0 ; i < 50 ; i++)
        for(int j = 0 ; j < 50 ; j++)
            base[i][j] = res[i][j];


}

int main(){

    int t;
    scanf("%d", &t);

    while(t--){

        memset(graph, 0, sizeof(graph));

        int n,u,v;
        ll k;

        scanf("%d %lld %d %d", &n, &k ,&u, &v);

        for(int i = 0 ; i < n ; i++)
            for(int j = 0 ; j < n ; j++){
                scanf("%lld", &graph[i][j]);
            }

        power(graph, k);
        printf("%lld\n", graph[u][v]);


    }



    return 0;
}
