#include <iostream>
#include <vector>
#include <queue>
#include <map>
using namespace std;
int n,m;
typedef pair<pair<int,int>, int> pii;
typedef pair<int, pair<pair<int,int>, int> > piii;
vector<pii > v;
priority_queue<piii, vector<piii>,greater<piii> > q;
map<pair<int,int> ,int> mp;
map<int, vector<pii> >  mp2;
int main()
{
    scanf("%d%d",&n,&m);
    int x,y,c;
    for(int i=0;i<m;i++){
    	//cin>>x>>y>>c;
    	scanf("%d%d%d",&x,&y,&c);
    //	v.push_back({{x,y},c});
    	mp2[x].push_back({{x,y},c});
    }
   // sort(v.begin(),v.end());
    for(int i=0;i<mp2[1].size();i++)
    	q.push({1,mp2[1][i]});
    int ans = 100000;
    while(!q.empty()){
    	auto it = q.top();
    	q.pop();
    	int d = it.first;
    	int xx = it.second.first.first;
    	int yy = it.second.first.second;
    	int cc = it.second.second;
    	if (mp.count({xx,yy})) continue;
    	mp[{xx,yy}] = 1;
    	//cout << d << " " << xx << " " << yy << " " << cc << endl;
    	for(int i=0;i<mp2[yy].size();i++){
    		
    		if (mp2[yy][i].second!=cc){
    			if (mp2[yy][i].first.second==n){
    				ans = min(ans,d+1);
    				cout << ans;
    				return 0;
    				continue;
    			}    		
    			q.push({d+1,mp2[yy][i]});
    		}
    	}
    }
    if (ans==100000) puts("-1");
    else cout << ans;
    return 0;
}
