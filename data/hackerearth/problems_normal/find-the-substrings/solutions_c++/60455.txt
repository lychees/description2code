#include<iostream>
#include<cstdio>
#include<map>
#include<string>
#include<algorithm>
using namespace std;
#define LL long long
int main()
{
int T;
cin >> T;
while(T--)
{
string s;
cin >> s;
LL  N = s.size();
LL ans = (N*(N+1))/2;
LL i ;
map<char,int> ind;
int init = 0;
for(i=0;i<N;i++)
{
ind[s[i]] = i;
if(ind.size() == 3)
{
int minindex = min(ind['a'],ind['b']);
minindex = min(minindex,ind['c']);

int maxindex = max(ind['a'],ind['b']);
maxindex = max(maxindex,ind['c']);
ans = ans-((minindex-init+1)*(N-maxindex));
ind.erase(s[minindex]);
init = minindex+1;
}
}
cout << ans <<endl;
}
return 0;
}
