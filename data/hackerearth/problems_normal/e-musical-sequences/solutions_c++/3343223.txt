#include <bits/stdc++.h>

using namespace std;
#define sd(x) scanf("%d",&x)
#define sll(x) scanf("%lld",&x)
#define sull(x) scanf("%llu",&x)
#define pd(x) printf("%d",x)
#define pull(x) printf("%llu",x)
#define pll(x) printf("%lld",x)

#define pn() printf("\n")
#define loop(i, a, b) for (int i = int(a); i < int(b); i++)
#define MAXN 1000005
#define MOD 1000000007 //10^9 +7
typedef long long int ll;
typedef unsigned long long int ull;

ll a[100005],m,z,temp,alpha,ans;

int main()
{
    int t,n;
    ll sum;
    sd(t);
    while(t--){
        sd(n);
        sll(m);sll(z);
        sum=0;
        loop(i,0,n){
            sll(temp);
            a[i]=temp;
            sum = sum + ((n-i+1)%2==0?a[i]:-a[i]);
        }
        a[n]=sum;
        alpha = (z-n)/(n+1);
        if((z-n)%(n+1)!=0)alpha++;
        temp  = z-alpha*(n+1);
        //if(temp>n)temp  =temp-(n+1);
        ans = a[temp];
        if(alpha%2==1&&(n+1)%2==1)ans = -ans;
        ans = (ans + 1ll*((abs(ans)/m)+10)*m )%m;

        //while(ans<0)(ans + 1ll*((abs(ans)/m)+1)*m )%m;
       // cout<<"s: "<<sum<<" alpha: "<<alpha<<endl;
        pll(ans);
        pn();
    }





    return 0;
}










