#include <bits/stdc++.h>
using namespace std;

typedef long long ll;

struct comp{
	bool operator()(const ll& a, const ll& b){
		return a>b;
	}
};

map <ll, ll> mp;
priority_queue <ll> maxp;
priority_queue <ll, vector<ll>, comp> minp; 

int main()
{
	ll x, n, q, i;
	cin>>n;
	while(n--){
		cin>>q;
		if(q==1){
			cin>>x;
			if(mp[x]==0){
				maxp.push(x);
				minp.push(x);
			}
			mp[x]++;
		}
		else if(q==2){
			cin>>x;
			if(mp[x]>0){
				mp[x]--;
				while(!maxp.empty()&&mp[maxp.top()]==0){
					maxp.pop();
				}
				while(!minp.empty()&&mp[minp.top()]==0){
					minp.pop();
				}
			}
			else{
				cout<<"-1\n";
			}
		}
		else if(q == 3){
			if(maxp.empty()){
				cout<<"-1\n";
			}
			else{
				cout<<maxp.top()<<endl;
			}
		}
		else{
			if(minp.empty()){
				cout<<"-1\n";
			}
			else{
				cout<<minp.top()<<endl;
			}
		}
	}
    return 0;
}
