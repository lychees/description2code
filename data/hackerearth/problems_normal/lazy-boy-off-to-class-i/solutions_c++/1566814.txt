#include<bits/stdc++.h>
using namespace std;
#define ll long long int
ll arr[100000];
int main()
{
	int t;
	ll sum2,sum3,i,j,cnt,cnt2,cnt3,n,n1,n2,x,y;
	double sum1,k;
	cin>>t;
	while(t--)
	{
	cnt=0;
	sum1=0;
	for(i=1;i<=7;i++)
	{
		cin>>n;
		sum1+=n;
		x=n;
		while(x--)
		{
			cin>>n1>>n2;
			arr[cnt++]=n2-n1;
		}
	}
	k=(ceil)((3*sum1)/4);
//	cout<<k<<endl;
	sort(arr,arr+cnt);
	sum2=0;
	for(i=0;i<(ll)k;i++)
	{
//	cout<<arr[i]<<endl;
		sum2+=arr[i];
	}
//	cout<<sum2<<endl;
	j=604800-sum2;
	cout<<j<<endl;
     }
     return 0;
}