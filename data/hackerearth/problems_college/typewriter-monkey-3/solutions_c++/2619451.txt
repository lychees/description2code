#include <iostream>
#include<vector>
#include<iomanip>
#include<string>
#include<sstream>
using namespace std;
int solve(){
  int k, l, s;
  cin>>k>>l>>s;
  vector<int> keyprob(255,0);
  {
    string keys;
    cin>>keys;
    for(char c:keys)
      keyprob[c]++;
  }
  string target;
  cin>>target;
  int overlap = 1;
  for(int i=1;i<target.size();i++){
    int f = 1;
    for(int j=i;j<target.size();j++){
      if(target[j]!=target[j-i]){
        f = 0;
        break;
      }
    }
    if(f){
      break;
    }
    overlap++;
  }
  int bstart = 1 + (s-l)/overlap;
  double prob = 1;
  for(char c:target){
    prob = prob*keyprob[c]/k;
  }
  ostringstream pp;
  if(prob == 0)
  {
    pp<<setprecision(7)<<0;
  }
  else
  {
  prob = prob*(s-l+1);
  pp<<setprecision(7)<<(bstart-prob);
  }
string str = pp.str();
int f=0;
string anss="";
  for(int i=str.length()-1;i>=0;i--)
  {
  	if( i!=0 && str[i]=='0' && f)
  	{
  		continue;
	}
	 else
  	{
  		f=1;
  		anss=str[i]+anss;
	}
  }
  cout<<anss;
  int fpp=0;
  for(int i=0;i<anss.length();i++)
  {
  	if(anss[i]=='.')
  	fpp=1;
  }
  if(!fpp)
  cout<<".0";
}

int main(){
  int t;
  cin>>t;
  for(int i=1;i<=t;i++)
  {
    printf("Case #%d: ",i);
    solve();
    cout<<endl;
  }
}