#include<iostream>
#include<set>
using namespace std;

int main()
{
	int q;
	cin>>q;
	multiset<int> myset;
	while(q>0)
	{
		int num;
		cin>>num;
		
		if(num==1)
		{
			cin>>num;
			myset.insert(num);
		}
		else if(num==2)
		{
			cin>>num;
			if(myset.find(num)==myset.end())
			{
				cout<<"-1\n";
			}
			else
			{
			//	cout<<num<<endl;
				multiset<int>::iterator it=myset.find(num);
				myset.erase(it);
				
			}
			
		}
		else if(num==3)
		{
			if(myset.size()==0)
				cout<<"-1\n";
			else
			{
				multiset<int>::iterator it=myset.end();
				it--;
				cout<<*it<<endl;
			}
		}
		else
		{
			if(myset.size()==0)
				cout<<"-1\n";
			else
			{
				multiset<int>::iterator it=myset.begin();
				cout<<*it<<endl;
			}	
		}
		q--;
	}
}
