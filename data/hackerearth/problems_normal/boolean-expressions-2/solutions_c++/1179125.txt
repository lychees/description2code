
/*10101000101000100101010001001100010010100010010101010001010001001010100010011000100101000100101010100010100010010101000100110001001010001001010101000101000100101010001001100010010100010010
aaoxxooaoxoaaoxoaooxoaooxoaoaoxoaxaoaxooxoxoaoaaoxxooaoxoaaoxoaooxoaooxoaoaoxoaxaoaxooxoxoaoxaaoxxooaoxoaaoxoaooxoaooxoaoaoxoaxaoaxooxoxoaoaaoxxooaoxoaaoxoaooxoaooxoaoaoxoaxaoaxooxoxoaoxx
1
1 180 true*/
#include<bits/stdc++.h>


using namespace std;

#define rep(i,n) for(i=0;i<n;i++)
#define ll long long
#define elif else if
#define pii pair<int,int>
#define mp make_pair
#define pb push_back
#define m 1000000009
//ll int m=1000000009;
char sym[305],oper[305];
ll int F[305][305]={0},T[305][305]={0};
 int n;
void foo()
{
  int i=0,gap,g,j;
    for (i = 0; i < n; i++)
    {
        F[i][i] =(sym[i] == '0')? 1: 0;
        T[i][i] = (sym[i] == '1')? 1: 0;
    }
    for ( gap=1; gap<n; ++gap)
    {
        for ( i=0, j=gap; j<n; ++i, ++j)
        {
            T[i][j] = F[i][j] = 0;
            for ( g=0; g<gap; g++)
            {
              ll  int k = i + g;
                ll int tik = (T[i][k] + F[i][k])%m;
                ll int tkj = (T[k+1][j] + F[k+1][j])%m;
 
                if (oper[k] == 'a')
                {
                    T[i][j] += ((T[i][k]%m)*(T[k+1][j]%m))%m;
                    F[i][j] += (  (tik*tkj)%m - ((T[i][k])*(T[k+1][j]))%m +m)%m;
                }
                if (oper[k] == 'o')
                {
                    F[i][j] += ((F[i][k]%m)*(F[k+1][j]%m))%m;
                    T[i][j] += (  (tik*tkj)%m - ((F[i][k])*(F[k+1][j]))%m + m)%m;
                }
                if (oper[k] == 'x')
                {
                    T[i][j] +=  ((F[i][k])*(T[k+1][j]))%m + ((T[i][k])*(F[k+1][j]))%m;
                    F[i][j] += ((T[i][k])*(T[k+1][j]))%m + ((F[i][k])*(F[k+1][j]))%m;
                }
                T[i][j]= T[i][j]%m;
                F[i][j]= F[i][j]%m;
               }
        }
    }
}
ll int qu(int i,int j,string temp)
{
  if(temp=="true")
    return T[i][j];
  else
    return F[i][j];
}
int main()
{
  ios_base::sync_with_stdio(0);
  cin>>sym>>oper;
  //cout<<sym.length()<<" "<<oper.length();
   int q,l=strlen(sym),i,j;

  n=l;
  cin>>q;
  foo();
  for(i=0;i<q;i++)
  {
    int a,b;
    string temp;
    cin>>a>>b>>temp;
    cout<<qu(a-1,b-1,temp)%m<<"\n";
  }
  return 0;
}