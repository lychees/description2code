#include <iostream>
#include <vector>
#include <algorithm>
#include <cstdio>
using namespace std;
vector<vector<long long int> > v1;
long long int binary(long long int a,long long int b,long long int c,long long int d)
{
	if(a>b)
	return -1;
	long long int mid=(a+b)/2;
	if(v1[d][mid]==c)
	{
		if(mid==b)
			return mid;
		else if(c<v1[d][mid+1])
			return mid;
		else
			binary(mid+1,b,c,d);
	}
	else if(c>v1[d][mid])
	{
		if(mid==b)
			return mid;
		else if(mid<b&&c<v1[d][mid+1])
			return mid;
		else
			return binary(mid+1,b,c,d);
	}
	else
	{
		if(mid==0)
			return -1; 
		else if(mid>0&&c>=v1[d][mid-1])
			return mid-1;
		else
			return binary(a,mid-1,c,d);
	}
}
int main()
{
    long long int n,m,q,p1,p2,h,result=1e9;
    scanf("%lld %lld %lld",&n,&m,&q);
    v1.resize(n);
    for(p1=0;p1<n;p1++)
    	v1[p1].resize(m);
    for(p1=0;p1<n;p1++)
    {
    	for(p2=0;p2<m;p2++)
    	{
    		scanf("%lld ",&v1[p1][p2]);
    		
    	}
    }
  
  //  for(p1=0;p1<n;p1++)
    //	sort(v1[p1].begin(),v1[p1].end());
 //   cout<<v1[0][4000]<<"\n";
  //     for(p1=0;p1<n;p1++)
    //{
    //	for(p2=0;p2<m;p2++)
    //	{
    	//	scanf("%d ",&v1[p1][p2]);
    //		cout<<v1[p1][p2]<<"->";
    //	}
    //}
    while(q--)
    {
    	result=100000000000;
    	for(p1=0;p1<n;p1++)
    	{
    		
    		cin>>h;
    	//	cout<<binary(0,m-1,h,p1)<<"->"<<v1[p1][binary(0,m-1,h,p1)]<<"-->";
    		result=min(result,binary(0,m-1,h,p1)+1);
    	}
    	cout<<result<<"\n";
    }
  	
    return 0;
}
