#include<bits/stdc++.h>
#define ll long long
using namespace std;
const int N=200010;
int A[N];
int main()
{
    int t;
    scanf("%d", &t);
    while(t--){
        int n,m;
        ll k;
        scanf("%d %d %lld", &n, &m, &k);
        ll sum=0;

        for(int i=0; i<n; i++){
            scanf("%d", &A[i]);
        }
        for(int i=n-1, j=0; i>=0; i--, j++){
            if(j%2==0)
                sum+=A[i];
            else
                sum-=A[i];
            if(sum>=m)
                sum%=m;
            else if(sum<0)
                sum+=m;
        }
        A[n]=sum;
        //cout<<A[n]<<endl;
        for(int i=n+1, j=0; i<=2*n+1; i++,j++){
            if(n%2==0){
                sum+=A[j];
            }
            else{
                sum-=A[j];
            }
            sum=(sum+m)%m;
            //cout<<"s="<<sum<<endl;
            sum=A[i-1]-sum;
            sum=(sum+m)%m;
            A[i]=sum;
            //cout<<i<<" "<<A[i]<<endl;
        }
        ll p=k%(2*n+2);
        printf("%d\n", A[p]);
    }
    return 0;
}
