#include<bits/stdc++.h>
using namespace std;
int main()
{
    //cout << "Hello World!" << endl;
    long long int n,m,q;
    cin>>n>>m>>q;
    long long int arr[n];
    long long int i;
    long long int pro=1;
    for(i=0;i<n;++i)
    {
    	scanf("%lld",&arr[i]);
    	pro=(arr[i]*pro)%m;
    }
    long long int arrf[n], arrb[n];
    long long int tmp=1;
    for(i=0;i<n;++i)
    {
    	tmp=(tmp*arr[i])%m;
    	arrf[i]=tmp;
    }
    tmp=1;
    for(i=n-1;i>=0;--i)
    {
    	tmp=(tmp*arr[i])%m;
    	arrb[i]=tmp;
    }
    while(q--)
    {
    	int p;
    	cin>>p;
    	p--;
    	if(p==0) cout<<(arrb[p+1]+m)%m<<endl;
    	else if(p==n-1) cout<<(arrf[p-1]+m)%m<<endl;
    	else cout<<(arrf[p-1]*arrb[p+1]+m)%m<<endl;
    }
    
    return 0;
}
