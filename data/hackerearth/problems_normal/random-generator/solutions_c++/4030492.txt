#include <bits/stdc++.h>
#define mod 1000000007
#define open freopen("/home/kislaya/inp.txt","r",stdin);
#define close freopen("/home/kislaya/out.txt","w",stdout);
#define pb push_back 
#define ss second
#define ff first
#define powerLev9000 2000000000
#define optimize_shit cin.sync_with_stdio(0);cin.tie(0);
using namespace std;
typedef long long int ll;
typedef pair<int,int> ii;
int a[100005];
string str[]={"NO\n","YES\n"};
int main()
{
    optimize_shit
   // open close
    int t;
    cin>>t;
    while(t--)
    {
        int n,k,p;
        cin>>n>>k>>p;
        for(int i=1;i<=n;i++)
            cin>>a[i];
        sort(a+1,a+1+n);
        bool ans=true;
        for(int i=1;i<=n and ans;i++)
        {
            int x=a[i];
            int r=upper_bound(a+i,a+n+1,x+2*p)-a;
            
            ans&=(r-i)<k;
        }   
        cout<<str[ans];
    }
    return 0;
}