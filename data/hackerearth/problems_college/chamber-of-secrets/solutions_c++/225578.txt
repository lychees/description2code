#include<stdio.h>
#include<iostream>
#include<algorithm>
#define mod 1000000007
#define max 10000001
#define pb(i) push_back(i)
using namespace std;
int main()
{
    int t;
    cin>>t;
    while(t--)
    {    
    	long long int n,q,k,w,x,y,z;int i;
    	cin>>n>>q;
    long long a[n+1],b[n+1],c[n+1];
    for(i=1;i<=n;i++)
    {
    	cin>>a[i];
    	a[i]%=mod;
    }
    b[0]=0;c[0]=0;
    for(i=1;i<=n;i++)
    {
    	b[i]=(b[i-1]+a[i])%mod;
    	}
        for(i=1;i<=n;i++)
        {
        	c[i]=(c[i-1]+(i*a[i])%mod)%mod;
        }
	while(q--)
        {
            cin>>w>>x>>y>>z;
 			cout<<(((((c[x+z]-c[x+y-1]+mod)%mod-(x*(b[x+z]-b[x+y-1]+mod)%mod)%mod)+mod)%mod+(w*(b[x+z]-b[x+y-1]+mod)%mod)%mod)%mod)<<endl;
          
        }
        
    }
    return 0;
}