#include <iostream>
#include<vector>
using namespace std;

int main() {
	
long long int n=1000000000;
vector<long long int> v;
long long int i=2;

while(i*i<=n)
{
v.push_back(i*i);
i++;
}
int s=v.size();
int t;
cin>>t;
while(t--)
{
	long long int x,y;
	cin>>x>>y;
	if(x>y)
	{
		long long int temp=x;
		x=y;
		y=temp;
	}
	long long int arr[1000006]={0};
	for(long long int i=0;i<s && v[i]<y;i++)
	{	long long int a;
		if(x%v[i]!=0)
		a=x/v[i]+1;
		else
		a=x/v[i];
		
		for(long long int j=a;j*v[i]<=y;j++)
		arr[j*v[i]-x]=1;
	
		
	}
	
	long long int count=0;
	for(long long int i=0;i<=(y-x);i++)
	{
		if(arr[i]==0)
		count++;
		
		
		
	}
	cout<<count<<"\n";
}

	// your code goes here
	return 0;
}