#include <bits/stdc++.h>

using namespace std;

#define INF (1<<29)

int cnt[100001];
int length = 0;

int main() {
    int N;
    cin >> N;
    priority_queue<int> max;
    priority_queue<int> min;
    for (int i = 0; i < N; i++) {
    	int t;
    	cin >> t;
    	if (t == 1) {
    		int x;
    		cin >> x;
    		cnt[x]++;
    		max.push(x);
    		min.push(-x);
    	}
    	if (t == 2) {
    		int x;
    		cin >> x;
    		if (cnt[x] == 0)
    			cout << -1 << endl;
    		else
    			cnt[x]--;
    	}
    	if (t == 3) {
    		while (!max.empty() && cnt[max.top()] == 0) {
    			max.pop();
    		}
    		if (!max.empty())
    			cout << max.top() << endl;
    		else
    			cout << -1 << endl;
    	}
    	if (t == 4) {
	   		while (!min.empty() && cnt[-min.top()] == 0) {
	    		min.pop();
	    	}
	    	if (!min.empty())
	    		cout << -min.top() << endl;
	    	else
	    		cout << -1 << endl;
    	}
    }
    return 0;
}
