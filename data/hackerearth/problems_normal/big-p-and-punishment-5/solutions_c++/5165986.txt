#include <stdio.h>
#include <vector>
#include <string.h>
#define MAX 10009
using namespace std;
vector <vector <int > > graph(MAX);
int visit[MAX];
void dfs(int node)
{
	visit[node] = 1;
	//printf("node = %d\n", node);
	for(int i = 0; i < (int) graph[node].size(); i++)
	{
		int present = graph[node][i];
		if(visit[present] == 0)
			dfs(present);
	}
	return;
}
int main()
{
	int test, n, s, f, ans;
	scanf("%d", &test);
	while(test--)
	{
		scanf("%d%d%d", &n, &f, &s);
		int a, b;
		for(int i = 0; i < MAX; i++)
		{
			graph[i].clear();
			visit[i] = 0;
		}
		for(int i = 0; i < f; i++)
		{
			scanf("%d%d", &a, &b);
			graph[a].push_back(b);
		}
		while(s--)
		{
			scanf("%d", &a);
			//memset(visit, 0, sizeof(visit));
			dfs(a);
			
		}
		ans = 0;
		for(int i = 1; i <= n; i++)
			if(visit[i])
				ans++;
		printf("%d\n", ans);
	}
}