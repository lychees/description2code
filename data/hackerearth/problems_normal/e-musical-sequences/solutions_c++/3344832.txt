#include <bits/stdc++.h>
using namespace std;
#define lld long long int
lld giv[100005];
int main()
{
    int t;
    cin >>t;
    while (t--)
    {
        lld n,m,sum=0,result;
        lld z;
        cin>>n>>m>>z;
    	for (int i=1;i<=n;++i)
            cin>>giv[i-1];

    	for (int i=1;i<=n;++i)
    		sum=sum+pow(-1,i-1)*giv[n-i];

    	lld k,l;

    	sum=sum%m;
        k=z%(n+1);
    	if (n%2==0)
    	{

    		l=z/(n+1);
    		if (l%2==0 && k!=n)
                result=giv[k];
    		else if(l%2==0 && k==n)
                result=sum;
    		else if(l%2==1 && k!=n)
    		result=-giv[k];
    		else
    		result=-sum;
    	}
    	else if(n%2==1 && k==n)
            result=sum;
        else
            result=giv[k];

    	result=result%m;
    	if (result<0)
    		result+=m;
    		cout<<result<<endl;
    }
    return 0;
}
