#include <bits/stdc++.h>
#define MOD 1000000007
using namespace std;
int n, m, q;
bool visit[1001][1001], a[1001][1001];
long long f[1000001];
vector<pair<int, int > > v;
int inc[8][2]={{-2, -1}, {-2, 1}, {-1, 2}, {1, 2}, {2, 1}, {2, -1}, {1, -2}, {-1, -2}};
int func(int x, int y);
bool valid(int sx, int sy);

int main(){
f[0]=1;
for(int i=1; i<1000001; i++){
	f[i]=(f[i-1]*i)%MOD;
}
int test_case, x,y;
cin>>test_case;
while(test_case--){
	memset(a, false, sizeof(a));
	memset(visit, false, sizeof(visit));
	v.clear();
    cin>>n>>m>>q;
	for(int i=0; i<q; i++){
		cin>>x>>y;
		x--; y--;
		v.push_back(make_pair(x, y));
		a[x][y]=true;
	}
	long long t=0, total=1;
	for(int i=0; i<v.size(); i++){
		x=v[i].first; y=v[i].second;
		if(visit[x][y]==false){
			visit[x][y]=true;
			t = func(x, y);
			total = (total * f[t])%MOD;
		}
	}
	cout<<total<<endl;
}
}
int func(int x, int y){
int sx=0, sy=0;
int c=1;
	for(int i=0; i<8; i++){
		sx=x+inc[i][0]; sy=y+inc[i][1];
		if(valid(sx, sy) && visit[sx][sy]==false){
			visit[sx][sy]=true;
			c+=func(sx, sy);
		}
	}
	return c;
}

bool valid(int sx, int sy){
	if(sx<0 || sx >= n || sy<0 || sy>=m || a[sx][sy]==false){
		return false;
	}
    return true;
}
