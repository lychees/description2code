#include <iostream>
#include<vector>

using namespace std;

int count;
int visited[10004];
vector<int> frnd[10004];

void solution(int s)
{
	visited[s] = 1;
	count++;

	for(int i=0;i<frnd[s].size();i++)
   	{
   		if(!visited[frnd[s][i]])
   			solution(frnd[s][i]);
    }
}

int main()
{
    int t;

    cin>>t;

    while(t--)
    {
    	int n,f,s;
    	int i,j;

    	cin>>n>>f>>s;
		
    	for(i=0;i<10004;i++)
        {
            visited[i] = 0;
            frnd[i].clear();
        }

    	for(i=1;i<=f;i++)
    	{
    		int a,b;

    		cin>>a>>b;

    		frnd[a].push_back(b);
    	}
		
		count=0;
		
		while(s--)
		{
    		int slp;
    		cin>>slp;
    		
    		if(!visited[slp])
    		{
				visited[slp]=1;
    			count++;
    		
    			for(i=0;i<frnd[slp].size();i++)
    			{
    				if(!visited[frnd[slp][i]])
    					solution(frnd[slp][i]);
    			}
    		}
		}
    	
    	cout<<count<<endl;
    }
    return 0;
}

