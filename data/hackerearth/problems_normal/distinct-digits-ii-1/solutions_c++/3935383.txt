#include<bits/stdc++.h>
using namespace std;
#define ll long long int
#define mod 1000000007
ll a[200000+20],bt[200020][11],n,q,w,k,l,j,u,v;
void update(ll ind,ll val,ll pos)
{
        while(ind<=n)
        {
               (bt[ind][pos])=(bt[ind][pos]+val);
                ind+=(ind&(-ind));
        }
}
ll query1(ll ind,ll pos)
{
        ll sum=0;
        while(ind)
        {
                sum+=(bt[ind][pos]);
                ind-=(ind&(-ind));
        }
        return sum;
}
inline ll query(ll l,ll r,ll count){
 return query1(r,count)-query1(l-1,count);
}
ll disdigit(ll num)
{
	ll b[11],r,cnt=0;
	memset(b,0,sizeof(b));
	while(num)
	{
		r=(num%10);
		if(b[r]==0)
		{
			cnt++;
			b[r]=1;
		}
		num/=10;
	}
	return cnt;
}
int main()
{	ll nk,mk,r,i;
	string str;
	cin>>n;
	for(i=1;i<=n;i++)
	{
	cin>>a[i];
	int e=disdigit(a[i]);
	update(i,1,e);
	}
	cin>>q;
	while(q--)
	{
			cin>>str>>l>>r;
			if(str=="ADD")
			{	
				ll cc=disdigit(a[l]);
				update(l,-1,cc);
				ll qq=(a[l]+r)%mod;
				update(l,1,disdigit(qq));
				a[l]=((a[l]%mod)+(r%mod))%mod;
			}
			else if(str=="MUL")
			{
					ll cc=disdigit(a[l]);
				update(l,-1,cc);
				ll qq=(a[l]*r)%mod;
				update(l,1,disdigit(qq));
				a[l]=((a[l]%mod)*(r%mod))%mod;
			}
			else if(str=="REP")
			{
				update(l,-1,disdigit(a[l]));
				update(l,1,disdigit(r));
				a[l]=(r%mod);
			}
			else if(str=="MAX")
			{	
				for(i=10;i>=0;i--)
				{
					 nk=query(l,r,i);
					if(nk)
					break;
				}
				cout<<i<<" "<<nk<<endl;
				//cout<<query(r)-query(l-1)<<endl;	
			}
			else
			{
				for(i=1;i<=10;i++)
				{
					mk=query(l,r,i);
					if(mk)
					break;
				}
				cout<<i<<" "<<mk<<endl;		
			}
			
	}
	return 0;
}