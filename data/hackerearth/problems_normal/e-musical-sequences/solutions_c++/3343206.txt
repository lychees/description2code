/*                 Kehte hain ki ...... 
            Agar kisi cheez ko dil se chaaho to 
    puri kayanat usey tumse milane ki koshish mein lag jaati hai...    */

#include<bits/stdc++.h>
using namespace std;
#define ll long long 
#define MAX 200005
#define N 1000000007
#define pb push_back
#define MIN 5005
#define imax 2000000200
#define eps 1e-9

ll a[MAX];
int main()
{
    ios_base::sync_with_stdio(false);
    ll i,k,l,m,n,z,t;
    cin>>t;
    while(t--){
        cin>>n>>m>>z;
        for(i=0;i<n;i++){
            cin>>a[i];
        }
        a[n]=0;
        for(i=n-1;i>=0;i--){
            if((n-i)%2==1)
                a[n]=(a[n]+a[i]);
            else
                a[n]=(a[n]-a[i]);
        }
        a[n]=(a[n]+(n+1)*m)%m;
        ll msd;
        k=z%(n+1);
        l=z/(n+1);
        if(n%2==1){
        	msd=(a[k]+n*m+m)%m;
        }
        else if(l%2==0){
            msd=(a[k]+n*m+m)%m;
        }
        else{
            msd=(-a[k]+n*m+m)%m;
        }
        cout<<msd<<endl;
    }
    return 0;
}
