#include <iostream>
#include <fstream>
#include <sstream>
#include <cstdio>
#include <cmath>
#include <cstring>
#include <cctype>
#include <string>
#include <vector>
#include <list>
#include <set>
#include <map>
#include <queue>
#include <stack>
#include <algorithm>
#include <functional>
#include <iomanip>

#include <cstdio>
#include <cctype>
#include <cmath>
#include <ctime>
#include <cstring>

using namespace std;
#define MOD 1000000007
typedef long long LL;
typedef pair<int, int> ii;
int main(){
    ios_base::sync_with_stdio(false);
    int Q;
    cin >> Q;
    multiset <int> m;
    for (int i = 0; i < Q; i++) {
    	int ch;
    	cin >> ch;
    	switch(ch) {
    		case 1:
    			{
    				int X;
    				cin >> X;
    				m.insert(X);
    			}
    			break;
    		case 2:
    			{
    				int X;
    				cin >> X;
    				auto it = m.find(X);
    				if (it == m.end())
    					cout << "-1\n";
    				else
    					m.erase(it);
    			}
    			break;
    		case 3:
    			if (m.empty())
    				cout << "-1" << endl;
    			else
    				cout << *m.rbegin() << endl;
    			break;
    		case 4:
    			if (m.empty())
    				cout << "-1" << endl;
    			else
    				cout << *m.begin() << endl;
    			break;
    	}
    }
    return 0;
}