#include <bits/stdc++.h>
using namespace std;

int main()
{
  	int t,n,flag;
  	char a[1001][1001];
  	long long sum,csum;
  	cin>>t;
  	while(t--)
  	{
  		sum=0;
  		cin>>n;
  		for(int i=0;i<n;i++)
  		{
  			for(int j=0;j<n;j++)
  			{
  				cin>>a[i][j];
  				if(a[i][j]=='#')
  				sum++;
  				
  			}
  		}
  		if(sum%2==1)
  		cout<<"NO\n";
  		else
  		{
  			csum=0;flag=0;
  			for(int i=0;i<n-1;i++)
  			{
  				for(int j=0;j<n;j++)
  				{
  				if(a[i][j]=='#')
  					csum++;
  				}
  				if(csum==(sum/2))
  				{
  					flag=1;
  					break;
  				}
  			}
			if(flag)
  				cout<<"YES\n";
  			else
  			{
  				csum=0;
  				for(int i=0;i<n-1;i++)
  				{
  					for(int j=0;j<n;j++)
  					{
  						if(a[j][i]=='#')
  						csum++;
  					}
  				if(csum==(sum/2))
  				{
  					flag=1;
  					break;
  				}
  			}
  				if(flag)
  				cout<<"YES\n";
  				else
  				cout<<"NO\n";
  			}
  			
  		}
  	}
    return 0;
}
