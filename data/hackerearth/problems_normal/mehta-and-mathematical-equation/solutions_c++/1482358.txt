#include <bits/stdc++.h>
#include <iostream>
#include <algorithm>
#include <vector>
#include <set>
#include <string>
#include <map>
using namespace std;
#define LL long long
string s;
int len;
LL dp[66][66][2];
#define mod 1000000007
vector<int>Arr;
void convert(LL N)
{
	s.clear();
	s = "";
	while (N > 0) {
		s += (char)((N % 2) + 48);
		N = N / 2;
	}
	reverse(s.begin(), s.end());
	len = (int)s.size();
	return;
}
	
LL rec(int idx, int carry, bool flag)
{
	if (idx == -1) {
		if (!carry && flag) {
			return 1;
		}
		return 0;
	}
	if (dp[idx][carry][flag] != -1) {
		return dp[idx][carry][flag];
	}
	LL ans = 0;
	for (int i = 0; i <= 1; i++) {
		for (int j = 0; j <= 1; j++) {
			for (int k = 0; k <= 1; k++) {
				bool sum = ((i + j + k) == 3);
				if (((i + j + k + carry) % 2) == s[idx] - 48) {
					ans += rec(idx - 1, (i + j + k + carry) / 2, flag | sum);
					if (ans >= mod) {
						ans %= mod;
					}
				}
			}
		}
	}
	return dp[idx][carry][flag] = ans;
}

int main()
{
	int t;
	scanf("%d", &t);
	while (t--) {
		LL N;
		scanf("%lld", &N);
		memset(dp, -1, sizeof dp);
		convert(N);
		LL ans = rec(len - 1, 0, 0);
		printf("%lld\n", ans);
	}
	return 0;
}