#include<iostream>
#include<cstdio>
#include<string>
#include<cstring>
#include<vector>
#include<set>
#include<list>
#include<queue>
#include<cmath>
#include<functional>
#include<algorithm>
#define INF (1<<29)
#define rep(i,n) for(int i=0;i<(int)(n);i++)
using namespace std;


#define MOD 1000000009

long long dp[301][301][2];

int main(){
	ios::sync_with_stdio(0);
	cin.tie(0);
	string s,op;
	cin>>s>>op;

	rep(i,s.size())dp[i][i][s[i]=='1']=1;
	for(int len=2;len<=s.size();len++){
		for(int a=0;a+len<=s.size();a++){
			long long res0=0,res1=0;
			for(int b=a;b<a+len-1;b++){
				if(op[b]=='a'){
					res0+=dp[a][b][0]*dp[b+1][a+len-1][0];
					res0+=dp[a][b][1]*dp[b+1][a+len-1][0];
					res0+=dp[a][b][0]*dp[b+1][a+len-1][1];
					res0%=MOD;
					res1+=dp[a][b][1]*dp[b+1][a+len-1][1];
					res1%=MOD;
				}else if(op[b]=='o'){
					res0+=dp[a][b][0]*dp[b+1][a+len-1][0];
					res0%=MOD;
					res1+=dp[a][b][0]*dp[b+1][a+len-1][1];
					res1+=dp[a][b][1]*dp[b+1][a+len-1][0];
					res1+=dp[a][b][1]*dp[b+1][a+len-1][1];
					res1%=MOD;
				}else{
					res0+=dp[a][b][0]*dp[b+1][a+len-1][0];
					res0+=dp[a][b][1]*dp[b+1][a+len-1][1];
					res0%=MOD;
					res1+=dp[a][b][0]*dp[b+1][a+len-1][1];
					res1+=dp[a][b][1]*dp[b+1][a+len-1][0];
					res1%=MOD;
				}
			}
			dp[a][a+len-1][0]=res0;
			dp[a][a+len-1][1]=res1;
		}
	}

	int q;
	cin>>q;
	rep(i,q){
		int l,r,res;
		string t;
		cin>>l>>r>>t;
		res=t[0]=='t';
		cout<<dp[l-1][r-1][res]<<endl;
	}
	return 0;
}