#include <iostream>
#include<vector>
#include<utility>
#include<algorithm>
using namespace std;


int root(int arr[],int x)
{
	
	while(arr[x]!=x)
	{
		arr[x]=arr[arr[x]];
		x=arr[x];
	}
	return x;
}

int main()
{
   int t;
   cin>>t;
   while(t--)
   {
   	int n,m;
   	cin>>n>>m;
   	pair<int,int> p[m];
   	for(int i=0;i<m;i++)
   	{
   		int  x,y;
   		cin>>x>>y;
   		p[i]=make_pair(x,y);
   	}
   	int a[n-1];
   	
   	for(int j=0;j<n-1;j++)
   	cin>>a[j];
   	
   	int adj[n+1];
   	for(int i=0;i<=n;i++)
   	adj[i]=i;
   	
   	for(int i=0;i<n-1;i++)
   	{
   		int b,c;
   	b=p[a[i]-1].first;
   	c=p[a[i]-1].second;
   	if(c<b);
   	swap(c,b);
   	int root_b=root(adj,b);
  int  	root_c=root(adj,c);
   	adj[root_c]=adj[root_b];
   	}
   	int z=root(adj,1);
   	for(int q=1;q<=n;q++)
   	{
   		if(z!=root(adj,q))
   		{
   			z=0;break;
   		}
   	}
   	if(z==0)
   	cout<<"NO"<<endl;
   	else
   	cout<<"YES"<<endl;
   	
   }
    return 0;
}
