#include <bits/stdc++.h>
using namespace std;

int main()
{
    int i,j,k,n,m,t,amt;
    scanf("%d",&t);
    while(t--)
     {
     	map<string,int> mp;
     	string s;
     	scanf("%d %d",&n,&m);
     	string arr[n];
     	for(i=0;i<n;i++) {
     		cin >> s;
     		arr[i]=s;
     		mp[s]=0;
     	}
     	for(i=0;i<m;i++) {
     		cin >> s;
     		cin >> amt;
     		cin >> k;
     		mp[s]=mp[s]+amt/(k+1)+amt%(k+1)-amt;
     		for(j=0;j<k;j++) {
     			cin >> s;
     			mp[s]=mp[s]+amt/(k+1);
     		}
       	}
       	for(i=0;i<n;i++) {
       		if(mp[arr[i]]<0) {
       			cout << arr[i] << " is owed " << -mp[arr[i]] <<"\n";
       		} else if(mp[arr[i]]>0) {
       			cout << arr[i] << " owes " << mp[arr[i]] <<"\n";
       		} else {
       			cout << arr[i] << " neither owes nor is owed\n";
       		}
       	}
     }
    return 0;
}
