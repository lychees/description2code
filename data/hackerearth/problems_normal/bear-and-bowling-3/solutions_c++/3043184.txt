#include <bits/stdc++.h>

using namespace std;

using lint = long long;
const lint mod = 1e9 + 7;
int main()
{

    int n; cin >> n;
    vector<lint>vec(n, 0);
    for(int i = 0; i < n; ++i)
        cin >> vec[i];

    vector<lint>pr(n + 1);
    pr[0] = 1;

    for(int i=1;i<=n;++i)
        pr[i]=(pr[i-1]<<1)%mod;
    vector<lint>term(n);
    term[0] = 3;
    for(int i = 1; i < n; ++i) {
        lint a = (term[i - 1] * 2), b = pr[i];
        term[i] = (a + b) % mod;
    }

    lint su = vec[0] % mod;
    for(int i = 1; i < n; ++i)
        su = (su * 2 + term[i - 1] * vec[i]) % mod;
    cout << su;
    return 0;
}

