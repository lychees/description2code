//link :- https://www.hackerearth.com/code-monk-hashing/algorithm/monk-in-the-land-of-pokemons/

#include <bits/stdc++.h>
using namespace std;

int main() {
	int T;
	cin >> T;

	while(T--) {
		int N, food[1000005], ans=0, x, y;
		for(int i=0; i<1000005; i++) {
			food[i] = 0;
		}
		cin >> N;
		while(N--) {
			cin >> x >> y;
			if(x == y)
				continue;
			else
				if(food[y] == 0) {
					food[x] += 1;
					ans += 1;
				}
				else {
					food[y] -= 1;
					food[x] += 1;
				}
		}

		cout << ans << "\n";
	}
	return 0;
}