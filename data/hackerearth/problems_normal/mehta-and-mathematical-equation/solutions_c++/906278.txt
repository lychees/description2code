#include<cstdio>
#include<vector>
#include<iostream>
#define FOR(i,j,n) for(i=j;i<=n;i++)
#define CIN(n) scanf("%d",&n)
#define CINL(n) scanf("%lld",&n)
#define FORR(i,j,n) for(i=j;i>=n;i--)
#define MAX 1000000000LL
#define M 1000000007LL
typedef long long ll;
using namespace std;
int A[100];
ll dp[100];
int z[100];
ll pow3(ll n)
{
    if(n==1LL)
        return 3LL;
    if(n==0LL)
        return 1LL;
    ll a=(pow3(n/2))%M;
    if(n%2==0LL)
    {
        return((a*a)%M);
    }
    else
        return((a*a*3LL)%M);
}
int main()
{
    int t,i,d,y,k,temp,s,j,ind1;
    CIN(t);
    ll n,a,b,c,e;
    while(t--)
    {
        CINL(n);
        a=n;
        i=0;
        while(a>0LL)
        {
            A[++i]=a%2;
            a/=2;
        }
        d=i/2;
        FOR(j,1,d)
        {
            temp=A[j];
            A[j]=A[i+1-j];
            A[i+1-j]=temp;
        }
        dp[0]=1LL;
        y=0;
        FOR(j,1,i)
        {
            if(A[j]==1)
            {
                z[y++]=j;
            }
        }
        k=-1;
        FOR(j,1,i)
        {
            if(A[j]==1)
            {
                dp[j]=(dp[j-1]*3)%M;
                k++;
            }
            else
            {
                dp[j]=dp[j-1];
                FOR(s,0,k)
                {
                    ind1=z[s];
                    dp[j]=(dp[j]+(dp[ind1-1]*pow3(j-ind1))%M)%M;
                }
            }
        }
        b=n+1;
        c=n+2;
        if(b%2==0LL)
        {
            b/=2;
        }
        else
            c/=2;
        b=b%M;
        c=c%M;
        e=(b*c)%M;
        printf("%lld\n",(e-dp[i]+M)%M);
    }
    return 0;
}
