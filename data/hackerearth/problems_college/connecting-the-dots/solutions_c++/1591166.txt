#include <bits/stdc++.h>
#define _ ios_base::sync_with_stdio(false);cin.tie(0);
using namespace std;
#define pb push_back
#define pob pop_back
#define pf push_front
#define pof pop_front
#define mp make_pair
#define all(a) a.begin(),a.end()
#define bitcnt(x) __builtin_popcountll(x)
#define MOD 1000000007
#define MAXN 100005
typedef unsigned long long int uint64;
typedef long long int int64;

struct xx{
	int node,col,ans;
};
int vis[1001][4];
vector<pair<int,int> >v[1001];
int main(){
	int n,m,i,j,x,y,c;
	cin>>n>>m;
	for(i=0;i<m;i++){
		cin>>x>>y>>c;
		v[x].pb(mp(y,c));
	}
	xx tmp;
	memset(vis,-1,sizeof(vis));
	tmp.node=1;
	tmp.col=0;
	tmp.ans=0;
	queue<xx>q;
	q.push(tmp);
	int ans=1e9;
	while(!q.empty()){
		tmp=q.front();
		q.pop();
		vis[tmp.node][tmp.col]=tmp.ans;
		if(tmp.node==n){
			printf("%d\n",tmp.ans);
			return 0;
		}
		for(i=0;i<v[tmp.node].size();i++){
			x=v[tmp.node][i].first;
			c=v[tmp.node][i].second;
			if(c==tmp.col)
			continue;
			xx nx;
			if(vis[x][c]==-1){
				vis[x][c]=tmp.ans+1;
				nx.node=x;
				nx.col=c;
				nx.ans=tmp.ans+1;
				q.push(nx);
			}
		}
	}
	if(ans==1e9)
	printf("-1\n");
	else
	printf("%d\n",ans);
	return 0;
}
