//#define WYTE
#include<bits/stdc++.h>
#define MOD 1000000007
using namespace std;
typedef long long ll;
typedef vector<ll> vll;

int main()
{
    ios_base::sync_with_stdio(false);
    cin.tie(NULL);
    int t,a[10],i,j,k,x,y;
    ll n,sum;
    vll factor[41],res[2];
    res[0].resize(81);
    res[1].resize(81);
    for(i=0;i<3;i++)
    {
        for(j=0;j<3;j++)
        {
            for(x=0;x<3;x++)
            {
                for(y=0;y<3;y++)
                {
                    factor[0].emplace_back(abs(i-x)+abs(j-y)+abs(i+j-x-y));
                }
            }
        }
    }
    for(x=1;x<=40;x++)
    {
        for(i=0;i<9;i++)
        {
            for(j=0;j<9;j++)
            {
                sum=0;
                for(k=0;k<9;k++)
                {
                    sum+=factor[x-1][i*9+k]*factor[x-1][k*9+j];
                }
                if(sum>=MOD)
                {
                    sum%=MOD;
                }
                factor[x].emplace_back(sum);
            }
        }
    }
    cin>>t;
    while(t--)
    {
        cin>>n;
        for(i=0;i<9;i++)
        {
            cin>>a[i];
        }
        y=0;
        for(i=0;i<9;i++)
        {
            for(j=0;j<9;j++)
            {
                res[y][i*9+j]=(i==j);
            }
        }
        for(x=0;x<=40;x++)
        {
            if(n&(1ll<<x))
            {
                y^=1;
                for(i=0;i<9;i++)
                {
                    for(j=0;j<9;j++)
                    {
                        sum=0;
                        for(k=0;k<9;k++)
                        {
                            sum+=res[y^1][i*9+k]*factor[x][k*9+j];
                        }
                        if(sum>=MOD)
                        {
                            sum%=MOD;
                        }
                        res[y][i*9+j]=sum;
                    }
                }
            }
        }
        for(i=0;i<9;i++)
        {
            sum=0;
            for(j=0;j<9;j++)
            {
                sum+=res[y][i*9+j]*a[j];
            }
            if(sum>=MOD)
            {
                sum%=MOD;
            }
            cout<<sum<<(i%3==2?'\n':' ');
        }
    }
}
