#include <iostream>
#include <bits/stdc++.h>
using namespace std;
int a[1000005],seg[100005],pr[1000005];
void sieve()
{
	int i,j;
	a[1]=1;
	for(i=2;i<=1e6;i++)
	{
		if(!a[i])
		{
			for(j=i*2;j<=1e6;j+=i)
			{
				a[j]=1;
			}
		}
	}
}
void build(int l,int r,int ind)
{
	if(l==r)
	{
		seg[ind]=!a[pr[l]];
		return;
	}
	int m=(l+r)/2;
	build(l,m,2*ind);
	build(m+1,r,2*ind+1);
	seg[ind]=seg[2*ind]+seg[2*ind+1];
}
void update(int i,int x,int l,int r,int ind)
{
	if(l==r)
	{
		seg[ind]=!a[x];
		pr[i]=x;
		return;
	}
	int m=(l+r)/2;
	if(i<=m)
	{
		update(i,x,l,m,2*ind);
	}
	else
	{
		update(i,x,m+1,r,2*ind+1);
	}
	seg[ind]=seg[2*ind]+seg[2*ind+1];
}
int query(int ql,int qr,int l,int r,int ind)
{
	if(ql>r||qr<l)
	{
		return 0;
	}
	if(ql<=l&&r<=qr)
	{
		return seg[ind];
	}
	int m=(l+r)/2;
	return query(ql,qr,l,m,2*ind)+query(ql,qr,m+1,r,2*ind+1);
}
int main()
{
	sieve();
    int x,t,n,i,q,l,r,ind;
    char c;
    scanf("%d",&t);
    while(t--)
    {
    	scanf("%d",&n);
    	for(i=1;i<=n;i++)
    	{
    		scanf("%d",&pr[i]);
    	}
    	build(1,n,1);
    	cin>>q;
    	while(q--)
    	{
	 		cin>>c;
	 		if(c=='C')
	 		{
	 			scanf("%d%d",&ind,&x);
	 			update(ind,x,1,n,1);
	 		}
	 		else
	 		{
	 			scanf("%d%d",&l,&r);
	 			printf("%d\n",query(l,r,1,n,1));
	 		}
    	}
    }
    return 0;
}
