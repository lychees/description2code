#include <functional> 
#include <algorithm> 
#include <iostream> 
#include <fstream> 
#include <sstream> 
#include <iomanip> 
#include <numeric> 
#include <cstring> 
#include <climits> 
#include <cassert> 
#include <complex> 
#include <cstdio> 
#include <string> 
#include <vector> 
#include <bitset> 
#include <queue> 
#include <stack> 
#include <cmath> 
#include <ctime> 
#include <list> 
#include <set> 
#include <map> 

using namespace std; 

#define REP(i, n) for (int i=0;i<n;++i) 
#define FOR(i, a, b) for (int i=a;i<b;++i) 

string s; 

int u=0; 

int dfs(){ 
    if (s[u] == 'X'){ 
        ++u;return 1; 
    } 
    else if (s[u]=='A'){ 
        ++u;return dfs()+dfs(); 
    } 
    else{ 
        ++u;return max(dfs(),dfs()); 
    } 
} 

#define ALL(A) A.begin(), A.end() 
int maximizeResistance(string circuit, vector <int> conductors) { 
        sort(ALL(conductors), greater<int>()); 
        s = circuit; 
        u = 0; int n = dfs(); 
        int res = 0; REP(i, n) res += conductors[i]; 
    return res; 
}
int main()
{
	int t;
	cin >> t;
	while (t--) {
		string s;
		cin >> s;
		int c = 0;
		for (int i = 0; i < s.size(); i++) {
			if (s[i] == 'X') c++;
		}
		vector <int> v;
		for (int i = 0; i < c; i++) {
			int x;
			cin >> x;
			v.push_back(x);
		}
		cout << maximizeResistance(s, v) << endl;
	}
	return 0;
}