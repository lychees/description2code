#include <iostream>
using namespace std;
#define ll long long
ll doctorarray[1100]={0};
ll optimus[100000];
ll ps=0,n;
ll arr[100000];
ll peds[100000][168]={0};
ll le(ll x){ return x*2+1;}
ll re(ll x){ return x*2+2;}
ll whittttters[200];
ll pooopersss(ll a,ll b)
{
	ll uttarssss=1,temp=a;
	while(b>0)
	{
		if(b&1)
		uttarssss=(uttarssss*temp)%1000000007;
		b>>=1;
		temp=(temp*temp);
	}
	return uttarssss;
}
void build(ll l,ll r,ll pos)
{
	if(l>r) return ;
	else if(l==r)
	{
		ll i=0;
		while(arr[l]>1)
		{
			while(arr[l]%optimus[i]==0)
			{
			peds[pos][i]++,arr[l]/=optimus[i];
			}
			i++;
		}
	}
	else
	{
		ll left=le(pos),right=re(pos);
		build(l,(l+r)/2,left);build((l+r)/2+1,r,right);
		for(ll i=0;i<ps;i++)
		{
			ll mi=0;
			if(l<=(l+r)/2) mi=peds[left][i];
			if((l+r)/2+1<=r) mi=(mi>peds[right][i])?mi:peds[right][i];
			peds[pos][i]=mi;
		}
	}
}
void jodde(ll x,ll l,ll r,ll pos,ll val)
{
	if(l>r || x>r || x<l)
	return ;
	else if(l==r )
	{
		if(l!=x)
		return ;
		ll i=0;
		while(i<ps)
		{
			peds[pos][i]=0;
			i++;
		}
		i=0;
		while(val>1)
		{
			while(val%optimus[i]==0)
			peds[pos][i]++,val/=optimus[i];
			i++;
		}
	}
	else
	{
		ll left=le(pos),right=re(pos);
		jodde(x,l,(l+r)/2,left,val);jodde(x,(l+r)/2+1,r,right,val);
		for(ll i=0;i<ps;i++)
		{
			ll mi=0;
			if(l<=(l+r)/2) mi=peds[left][i];
			if((l+r)/2+1<=r) mi=(mi>peds[right][i])?mi:peds[right][i];
			peds[pos][i]=mi;
		}
	}
}
void calculators(ll x,ll y,ll l,ll r,ll pos)
{
	if(l>r || l>y || r<x)
	return ;
	else 
	{
		ll left=le(pos),right=re(pos);
		if(l>=x && y>=r )
		{			
			for(ll i=0;i<ps;i++)
			{
				if(whittttters[i]<peds[pos][i]) whittttters[i]=peds[pos][i];
			}
		}
		else
		{
			calculators(x,y,l,(l+r)/2,left);calculators(x,y,(l+r)/2+1,r,right);
		}
	}
}
int main()
{
	ps=0;
	for(ll i=2;i<=1000;i++)
	{
		if(!doctorarray[i])
		{
			optimus[ps]=i;
			ps++;
			for(ll j=i*2;j<=1000;j+=i)
			{
				doctorarray[j]=1;
			}
		}
	}
	cin>>n;
	for(ll i=0;i<n;i++)	cin>>arr[i];
	build(0,n-1,0);
	ll q;
	cin>>q;
	for(ll i=0;i<q;i++)
	{
		ll t,l,r;
		cin>>t>>l>>r;
		if(t==1)
		{
			l--;
			jodde(l,0,n-1,0,r);
		}
		else
		{
			l--;r--;
			for(int jj=0;jj<200;jj++)
			whittttters[jj]=0;
			calculators(l,r,0,n-1,0);
			ll uttarssss=1;
			for(int i=0;i<ps;i++)
			{
				uttarssss=(uttarssss*pooopersss(optimus[i],whittttters[i]))%1000000007;
			}
			cout<<uttarssss<<endl;
		}
	}
	return 0;
}
