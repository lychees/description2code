#include <iostream>
using namespace std;

int main()
{
     int N,M,Q;
    cin>>N;
    cin>>M;
    cin>>Q;
    int A[N],left[N],right[N];
    for(int i=0;i<N;i++)
    {
    	int x;
    	cin>>x;
    	A[i]=x;
    }
    int l(1),r(1);
    for(int i=0;i<N;i++)
    {
    	l=((l%M)*(A[i]%M))%M;
    	left[i]=l;
    	r=((r%M)*(A[N-1-i]%M))%M;
    	right[N-1-i]=r;
    }
    for(int i=0;i<Q;i++)
    {
    	int x;
    	cin>>x;
    	int y;
    	if(x==1)
    	y=right[1];
    	else if(x==N)
    	y=left[N-2];
    	else
    	y=((right[x]%M)*(left[x-2]%M))%M;
    	cout<<y<<endl;
    }
    
    return 0;
}
