#include<bits/stdc++.h>
using namespace std;
int ar[100][100],res[100][100],n;
void transpose()
{
	int tmp[n][n];
	for(int i=0;i<n;i++)
	for(int j=0;j<n;j++)
	tmp[i][j]=ar[j][i];
	for(int i=0;i<n;i++)
	for(int j=0;j<n;j++)
	ar[i][j]=tmp[i][j];
	return;
}

void rowRev()
{
	int tmp[n][n];
	for(int i=0;i<n;i++)
	{
		for(int j=0;j<n;j++)
		{
			tmp[i][j]=ar[i][n-j-1];
		}
	}
	for(int i=0;i<n;i++)
	for(int j=0;j<n;j++)
	ar[i][j]=tmp[i][j];
	return;
}

void print()
{
		for(int i=0;i<n;i++)
		{
			for(int j=0;j<n;j++)
			cout<<ar[i][j]<<" ";
			cout<<endl;
		}
}

void restore()
{
		for(int i=0;i<n;i++)
		{
			for(int j=0;j<n;j++)
			ar[i][j]=res[i][j];
		}	
}

int main()
{
//	freopen("C:\\users\\admin\\documents\\programs\\input.txt","r",stdin);
	int q;
	cin>>n>>q;
	for(int i=0;i<n;i++)
	for(int j=0;j<n;j++)
	{
		cin>>ar[i][j];
		res[i][j]=ar[i][j];
	}
	while(q--)
	{
		restore();
		int angle;
		cin>>angle;
		int flips = (angle/90)%4;
		while(flips--)
		{
			transpose();
			rowRev();
		}
		print();
		cout<<endl;
	}
	return 0;
}