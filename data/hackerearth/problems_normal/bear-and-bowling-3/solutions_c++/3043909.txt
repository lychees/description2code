#include <bits/stdc++.h>
using namespace std;
#define GOD 1000000007
#define ll long long 
int main()
{

  ll n, ans ,an1, a[200888];
  cin>>n;

  ll i;
  for(i=1;i<=n;i++)
  	cin>>a[i];
  	ans=0;
  if(n==1)
  {cout<<a[1];return 0;}
  for(i=1;i<=n;i++)
  {
  	ans=((ans%GOD)+(((i+1)%GOD)*(a[i]%GOD))%GOD)%GOD;
  	//cout<<ans<<" ";
  }
  an1=1;
 
for(i=1;i<=n-2;i++)
{
an1=((an1%GOD)*2)%GOD;
}

 ans= ((ans%GOD) *(an1%GOD))%GOD;
cout<<ans;

	return 0;
}