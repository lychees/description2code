#include<bits/stdc++.h>
#define ll long long
using namespace std;
//g++ -std=c++11 your_file.cpp

std::vector< pair<ll, ll> > g[5];
ll a[1003] ,b[1003];

ll cpa(ll n){
	return a[n] == n ? n : a[n] = cpa(a[n]);
}
ll cpb(ll n){
	return b[n] == n ? n : b[n] = cpb(b[n]);
}

int main()
{
	ios_base::sync_with_stdio(false);cin.tie(0);
 
	ll n,m,i,j;
	cin >> n >> m;
	ll x, y, z, e = 0;
	for(i=0;i<m;i++){
		cin >> x >> y >> z;
		g[z].push_back({x,y});
	}
	for(i=1;i<=n;i++) a[i] = i;
	for(i=0;i<g[3].size();i++){
		x = g[3][i].first;
		y = g[3][i].second;
		ll cx = cpa(x), cy = cpa(y);
		if(cx == cy) continue;
		e++;
		a[cx] = cy;
	}
	ll ea = 0, eb = 0;
	for(i=1;i<=n;i++) b[i] = a[i];
	for(i=0;i<g[1].size();i++){
		x = g[1][i].first;
		y = g[1][i].second;
		ll cx = cpa(x), cy = cpa(y);
		if(cx == cy) continue;
		ea++;
		a[cx] = cy;
	}
	for(i=0;i<g[2].size();i++){
		x = g[2][i].first;
		y = g[2][i].second;
		ll cx = cpb(x), cy = cpb(y);
		if(cx == cy) continue;
		eb++;
		b[cx] = cy;
	}
	if(ea + e != n-1 || eb + e != n-1) cout << -1 << endl;
	else cout << m - (e + ea + eb) << endl;
 
	return 0;
} 