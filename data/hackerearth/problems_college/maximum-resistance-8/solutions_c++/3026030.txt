#include<bits/stdc++.h>
using namespace std;

int main()
{
    int t;
    cin>>t;
    
    while(t--){
    	string s;
    	cin>>s;
    	
    	int n=s.size();
    	
    	stack <int> stk;
    	int c=0;
    	for(int i= n-1; i>=0; i--){
    		if(s[i]=='X'){
    			c++;
    			stk.push(1);
    		}
    		else{
    			int a = stk.top();
    			stk.pop();
    			int b = stk.top();
    			stk.pop();
    			
    			if(s[i]=='A') stk.push(a+b);
    			else stk.push(max(a,b));
    		}
    	}
    	
    	vector<int> d(n);
    	for(int i=0;i<c;i++){
    		cin>>d[i];
    	}
    	
    	sort(d.rbegin(),d.rend());
    	
    	cout<<accumulate(d.begin(), d.begin()+stk.top(),0)<<endl;
    }
    return 0;
}
