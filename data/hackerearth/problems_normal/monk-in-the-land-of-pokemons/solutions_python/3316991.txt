t = int(raw_input())
while t>0:
	n = int(raw_input())
	j=0
	p=[]
	for i in range(1000001):
		p.append(0)
	for i in range(n):
		l,k = map(int,raw_input().split())
		if l!=k and p[k]==0:
			j=j+1
			p[l]=p[l]+1
		if l!=k and p[k]!=0:
			p[l]=p[l]+1
			p[k]=p[k]-1
	print j
	t=t-1