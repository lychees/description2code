#include <bits/stdc++.h>
using namespace std;

typedef long long ll;

const int N=1000002;
const ll mod=1000000007;

	
#define sc(x) scanf("%d",&(x))
#define scl(x) scanf("%lld",&x)
#define pb push_back
#define mp make_pair
#define F first
#define S second

map<ll,ll> mym;

ll exp(ll a,ll b){
	ll ans=1;
	a=a%mod;
	while(b!=0){
		if(b%2==1)ans=(ans*a)%mod;
		a=(a*a)%mod;
		b/=2;
	}
	return ans;
}

ll solve(ll n){
	//cout<<"n "<<n<<endl;
	if(mym[n]){return mym[n];}
	else {
		ll temp=1;
		ll nn=n-1;
		ll t1=sqrt(nn);
		for(ll i=2;i<=t1;i++){
			if(nn%i==0){
				ll t2=nn/i;
				ll t3=solve(i);
				mym[i]=t3;
				ll t4=exp(t3,t2);
				temp=(temp+t4)%mod;
				if(i*i==nn)continue;
				ll t5=solve(t2);
				mym[t2]=t5;
				ll t6=exp(t5,i);
				temp=(temp+t6)%mod;
			}
		}
		return temp;
	}
}



////************
int main()
{
	//freopen("input.txt","r",stdin);
	mym[1]=1;mym[2]=1;mym[3]=1;mym[4]=1;mym[5]=2;
	ll n;
	scl(n);
	cout<<solve(n)<<endl;


	
	


}