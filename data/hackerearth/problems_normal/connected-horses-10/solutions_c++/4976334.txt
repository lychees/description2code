#include <iostream>
#include <vector>
#include <algorithm>
#include <cstdio>
#include <cstring>
using namespace std;
#define mx 100001
#define ll long long
#define pb push_back
#define e printf("\n");
#define rep(i,a,b) for(int (i)=(a);(i)<=(b);(i)++)
void solve();
ll fact[1000001];
const ll mod=1000000007;
ll ct;
int main()
{
  fact[0]=1;
  rep(i,1,1000000)
  {
    fact[i]=fact[i-1]*i;
    fact[i]%=mod;
  }
  int t;
  cin>>t;
  while(t--)
    solve();
  return 0;
}
int dx[8]={-1,-2,-2,-1,1,2,2,1};
int dy[8]={-2,-1,1,2,-2,-1,1,2};
bool vis[1001][1001];
int ar[1001][1001];
int m,n;
void dfs(int i,int j)
{
  if(i<1||i>n||j<1||j>m||vis[i][j]||!ar[i][j])
    return ;
  vis[i][j]=true;
  ct++;
  for(int k=0;k<8;k++)
  {
    dfs(i+dx[k],j+dy[k]);
  }  
}
void solve()
{
   int q,i,j;
   cin>>n>>m>>q;
    memset(ar,0,sizeof ar);
   while(q--)
   {
    cin>>i>>j;
    ar[i][j]=1;
   }
   ll ans=1;
   memset(vis,false,sizeof vis);  
   rep(i,1,n)
   {
     rep(j,1,m)
     {
       if(!vis[i][j] && ar[i][j])
       {
         ct=0;
         dfs(i,j);
        // cout<<ct<<" ";
         ans*=fact[ct];
         ans%=mod;
       }
     }
   }  
   cout<<ans;e
}