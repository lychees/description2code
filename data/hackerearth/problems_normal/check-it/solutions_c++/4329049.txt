#include <bits/stdc++.h>
using namespace std;
typedef vector< int > vi;
typedef vector< vi > vii;
vii adj(5001);
vector< pair<int,int> > ed;
int arr[5000];
vi visited;
void dfs(int s)
{
  visited[s] = 1;
  for (int i = 0; i < adj[s].size(); ++i)
  {
    if(!visited[adj[s][i]])
      dfs(adj[s][i]);
  }

}
int main()
{
  int t;
  cin>>t;
  while(t--)
  {
    int n,m;
    string str = "YES";
    cin>>n>>m;
    visited.clear();
    ed.clear();
    for (int i = 0; i <= n ; ++i)
    {
      visited.push_back(0);
      adj[i].clear();
    }
    for (int i = 0; i < m; ++i)
    {
      int p,q;
      cin>>p>>q;
      ed.push_back(make_pair(p,q));
    }
    int p;
    for (int i = 0; i < n-1; ++i)
    {
      cin>>arr[i];
      int x = ed[arr[i]-1].first;
      p = x;
      int y = ed[arr[i]-1].second;
      adj[x].push_back(y);
      adj[y].push_back(x);
    }
    dfs(p);
    for (int i = 1; i <= n; ++i)
    {
      if(!visited[i])
      {
        str = "NO";
        
      }
    }
    cout<<str<<endl;


  }

}