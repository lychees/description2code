#include<bits/stdc++.h>
using namespace std;
#define vi vector < int >
#define pii pair < int , int >
#define pb push_back
#define mp make_pair
#define ff first
#define ss second
#define foreach(it,v) for( __typeof((v).begin())it = (v).begin() ; it != (v).end() ; it++ )
#define ll long long
#define llu unsigned long long
#define MOD 1000000007
#define INF 0x3f3f3f3f
#define dbg(x) { cout<< #x << ": " << (x) << endl; }
#define dbg2(x,y) { cout<< #x << ": " << (x) << " , " << #y << ": " << (y) << endl; }
#define all(x) x.begin(),x.end()
#define mset(x,v) memset(x, v, sizeof(x))
#define sz(x) (int)x.size()
int tot[500005];
int gs[500005];
void prec()
{
    int i,j;
    for(i=1;i<=500000;i++)
    {
        tot[i] = i;
    }
    for(i=2;i<=500000;i++)
    {
        if(tot[i] == i)
        {
            for(j=i;j<=500000;j+=i)
            {
                tot[j] -= tot[j]/i;
            }
        }
    }
    for(i=1;i<=500000;i++)
    {
        for(j=i;j<=500000;j+=i)
        {
            gs[j] += i*tot[j/i];
        }
    }
}
ll a[1000006];
ll b[1000006];
void upd(int x,ll val)
{
    val %= MOD;
    if(val < 0)
        val += MOD;
    while(x <= 1000000)
    {
        b[x] += val;
        b[x] %= MOD;
        x += (x&-x);
    }
}
ll get(int x)
{
    ll sum = 0;
    while(x > 0)
    {
        sum += b[x];
        sum %= MOD;
        x -= (x&-x);
    }
    return sum;
}
int main()
{
    prec();
    int n,i;
    scanf("%d",&n);
    assert(1 <= n && n <= (int)1e6);
    for(i=1;i<=n;i++)
    {
        scanf("%lld",&a[i]);
        assert(1 <= a[i] && a[i] <= 500000);
        upd(i,gs[a[i]]);
    }
    int q;
    scanf("%d",&q);
    while(q--)
    {
        char op[3];
        int x,y;
        scanf("%s%d%d",op,&x,&y);
        if(op[0] == 'U')
        {
            assert(1 <= x && x <= n);
            assert(1 <= y && y <= 500000);
            upd(x,-gs[a[x]]);
            a[x] = y;
            upd(x,gs[y]);
        }
        else
        {
            assert(1 <= x && x <= n);
            assert(x <= y && y <= n);
            ll ans = (get(y) - get(x-1) + MOD)%MOD;
            printf("%lld\n",ans);
        }
    }
    return 0;
}