#include <bits/stdc++.h>
using namespace std;

typedef vector<vector<int> >  VVI;
#define SIZE 100000
#define pb push_back

void print_graph(VVI  &g, int n){

	for(int i=0;i<n;i++){
		cout<< i<< " : ";
		for(auto it = g[i].begin(); it != g[i].end(); it++ ){
			cout<< *it << " ";
		}
		cout<<endl;
	}
}


int main(){
	int t;
	cin>>t;
	while(t){
		
		int n,m;
		cin >> n>> m;
		
		//VVI g(n);
		int a[SIZE], b[SIZE];
		
		for(int i=0 ; i<m ; i++){
			
			cin>>a[i]>>b[i];
			a[i]-=1;b[i]-=1;
			//g[ a[i] ].push_back(b[i]);
			//g[ b[i] ].push_back(a[i]);
		}

		//print_graph(g,n);
		
		bool flag = false;
		int ed[SIZE],temp;
		//memset(ed,0,n*sizeof(int));
		for(int i=0;i<5001;i++) ed[i]=0;
		for(int i=0;i<n-1;i++){
			cin>> temp;
			temp-=1;
			/*if( ed[a[temp]] && ed[b[temp]] ) {
				flag = true;
				break;
			}*/
			ed[a[temp]] = 1;
			ed[b[temp]] = 1;
		}
		
		//for(int i=0;i<n-1;i++) cout<<ed[i]<<" "; cout<< endl;
		
		
		/*if(flag) cout<<"NO"<<endl;
		else cout<< "YES" << endl;*/
		
		int sum=0;
		for(int i=0;i<n;i++){
			sum+= ed[i];
		}
		if(sum == n) cout<<"YES"<<endl;
		else cout<<"NO"<<endl;

		t--;
	}
	

	return 0;
}