#include <bits/stdc++.h>
using namespace std;

int main()
{
	int t;
	cin>>t;
	while(t--) {
    int n,q,amount,p,i;
    cin>>n>>q;
    int given[n+1],taken[n+1];
    getchar();
    map<string,int> mp;
    map<int,string> mpu;
    char names[15];
    for(i=0;i<n;i++) {
    	cin>>names;
    	mp[names]=i;
    	mpu[i]=names;
    	//cout<<names;
    }
    memset(given,0,sizeof(given));
    memset(taken,0,sizeof(taken));
    while(q--) {
    	cin>>names;
    	cin>>amount;
    	cin>>p;
    	getchar();
    	int per;
    	//if(mp.find(names)!=mp.end()) {
    	per=mp[names];
    	//cout<<amount<<endl;
    	given[per]=given[per]+amount;
    	taken[per]=taken[per]+(amount/(p+1))+(amount%(p+1));
    	//cout<<given[per]<<" ** "<<taken[per]<<" "<<per<<endl;
    	for(i=0;i<p;i++) {
    		cin>>names;
    		per=mp[names];
    		taken[per]=taken[per]+(amount/(p+1));
    		//cout<<names<<" "<<taken[per]<<" "<<per;
    	}
    }
    
    for(i=0;i<n;i++) {
    	//names=mpu[i];
    	//cout<<given[i]-taken[i]<<" ";
    	if(given[i]-taken[i]>0) {
    		cout<<mpu[i]<<" is owed "<<(given[i]-taken[i]);
    	}
    	else if(given[i]-taken[i]==0) {
    		cout<<mpu[i]<<" neither owes nor is owed";
    	}
    	else{
    		cout<<mpu[i]<<" owes "<<taken[i]-given[i];
    	}
    	cout<<endl;
    }
	}
    return 0;
}
