#include<bits/stdc++.h>
using namespace std;

const int N=310;
const int md=1e9+9;
typedef long long ll;

string str1,str2;
ll dp[N][N][2];

int main() {
    cin>>str1>>str2;
    int len=str1.size();
    for(int i=0;i<len;i++) {
        dp[i][i][str1[i]-'0']=1;
    }
    for(int l=2;l<=len;l++) {
        for(int i=0;i<=len-l;i++) {
            int j=i+l-1;
            for(int k=i;k<j;k++) {
                if(str2[k]=='x') {
                    dp[i][j][1]+=dp[i][k][0]*dp[k+1][j][1]+dp[i][k][1]*dp[k+1][j][0];
                    dp[i][j][1]%=md;

                    dp[i][j][0]+=dp[i][k][0]*dp[k+1][j][0]+dp[i][k][1]*dp[k+1][j][1];
                    dp[i][j][0]%=md;
                } else if(str2[k]=='a') {
                    dp[i][j][1]+=dp[i][k][1]*dp[k+1][j][1];
                    dp[i][j][1]%=md;

                    dp[i][j][0]+=dp[i][k][1]*dp[k+1][j][0]+dp[i][k][0]*dp[k+1][j][0];
                    dp[i][j][0]%=md;
                    dp[i][j][0]+=dp[i][k][0]*dp[k+1][j][1];
                    dp[i][j][0]%=md;
                } else {
                    dp[i][j][0]+=dp[i][k][0]*dp[k+1][j][0];
                    dp[i][j][0]%=md;

                    dp[i][j][1]+=dp[i][k][1]*dp[k+1][j][1]+dp[i][k][1]*dp[k+1][j][0];
                    dp[i][j][1]%=md;
                    dp[i][j][1]+=dp[i][k][0]*dp[k+1][j][1];
                    dp[i][j][1]%=md;
                }
            }
        }
    }
    int q;
    cin>>q;
    while(q--) {
        int l,r;
        string res;
        cin>>l>>r>>res;
        l--;r--;
        if(res[0]=='t') {
            printf("%d\012",dp[l][r][1]);
        } else {
            printf("%d\012",dp[l][r][0]);
        }
    }
    return 0;
}
