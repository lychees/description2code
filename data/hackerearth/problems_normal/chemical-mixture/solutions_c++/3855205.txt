#define _CRT_SECURE_NO_WARNINGS
#include <iostream>
#include <ctime>
#include <cstdio>
#include <vector>
#include <algorithm>
#include <set>
#include <map>
#include <cstdlib>
#include <fstream>
#include <string>
#include <cmath>
#include <deque>
#include <queue>
#include <bitset>
#include <iomanip>
#include <climits>
#include <functional>

using namespace std;

#define sqr(x) ((x)*(x))
#define GetTime int(clock()*1000.0/CLOCKS_PER_SEC)

typedef unsigned long long ull;
typedef long long ll;
typedef long double ld;

int main(){
	//freopen("in.txt", "rt", stdin);
	//freopen("ou.txt", "wt", stdout);	
	int t;
	scanf("%d", &t);
	while (t--){
		ll m;
		scanf("%lld", &m);
		int n, n1;
		scanf("%d %d", &n, &n1);
		vector<ll> a(n), a1(n1), z(n1 + 1), ans;
		for (int i = 0; i < n; i++){
			scanf("%lld", &a[i]);
		}
		sort(a.rbegin(), a.rend());
		for (int i = 0; i < n1; i++){
			scanf("%lld", &a1[i]);
		}		
		ll ans_sm = (ll)(2e18);
		while (true){
			ll sm = 0;
			for (int i = 0; i < n1; i++){
				sm += a1[i] * z[i + 1];
			}
			ll mm = m - sm;						
			vector<ll> tmp;
			for (int i = 0; i < n; i++){
				if (mm >= a[i]){
					mm -= a[i];
					tmp.push_back(a[i]);
				}
			}
			if (mm == 0 && sm < ans_sm){
				ans = tmp;
				ans_sm = sm;
			}
			int pos = n1;
			while (true){
				if (!z[pos]){
					z[pos]++;
					break;
				}
				z[pos] = 0;
				pos--;
			}
			if (pos == 0) break;
		}
		if (ans.empty()){
			printf("NO\n");
			continue;
		}
		printf("YES\n");
		sort(ans.begin(), ans.end());
		for (int i = 0; i < ans.size(); i++){
			printf("%lld ", ans[i]);
		}
		putc('\n', stdout);
	}
}
