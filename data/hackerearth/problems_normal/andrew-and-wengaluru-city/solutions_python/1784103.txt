cases = int(raw_input())

def sumWater(lst, stop):
	currentLeft = 0
	currentMaxRight = 0
	currentAcc = []
	total = 0
	for x in lst:
		
		if x > currentLeft:
			if len(currentAcc) > 0:
				for r in currentAcc:
					total += (currentLeft-r)
				currentAcc = []
			currentLeft = x
		elif x < currentLeft:
			currentAcc.append(x)
		else:
			if len(currentAcc) > 0:
				for r in currentAcc:
					total += (currentLeft-r)
				currentAcc = []
		if x == stop:
			for r in currentAcc:
				total += (currentLeft-r)
			return total
	return total

for n in range(cases):
	num = int(raw_input())
	lst = map(int,raw_input().split())
	
	currentLeft = 0
	currentMaxRight = 0
	currentAcc = []
	total = 0
	for x in lst:
		if x > currentLeft:
			if len(currentAcc) > 0:
				for r in currentAcc:
					total += (currentLeft-r)
				currentAcc = []
			currentLeft = x
		elif x < currentLeft:
			currentAcc.append(x)
		else:
			if len(currentAcc) > 0:
				for r in currentAcc:
					total += (currentLeft-r)
				currentAcc = []
	
	if len(currentAcc) > 0:
		total += sumWater(lst[::-1],currentLeft)
	
	print total%1000000007
