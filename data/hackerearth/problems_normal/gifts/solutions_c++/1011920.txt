#pragma comment(linker, "/STACK:1024000000,1024000000")
#include<stdio.h>
#include<iostream>
#include<string.h>
#include<queue>
#include<algorithm>
#include<string>
#include<map>
#include<set>
#include<fstream>
#include<math.h>
#include<iomanip>
#include<time.h>
#include<assert.h>
using namespace std;
#define ll long long
#define ull unsigned long long
#define db double
#define inf 1000000007
#define mod 1000000007
#define pii pair<int,int>
#define vi vector<int>
#define VS vector<string>
#define all(x) x.begin(),x.end()
#define mp make_pair
#define pb push_back
#define x first
#define y second
#define N 100005
#define pi 3.14159265358979323846
#define DBG(vari) cerr<<#vari<<"="<<(vari)<<endl;
#define FOREACH(i,t) for(__typeof(t.begin()) i=t.begin();i!=t.end();i++)

char s[N];
int a[5][N],p[5],q[5];
struct node
{
    ll f[N];int n;
    void init(int n)
    {
        this->n=n;
        for(int i=0;i<=n;i++)f[i]=0;
    }
    void upd(int x,int v)
    {
        while(x<=n)f[x]+=v,x+=x&-x;
    }
    ll query(int x)
    {
        ll ans=0;
        while(x>0)ans+=f[x],x-=x&-x;
        return ans;
    }
    ll query(int x,int y)
    {
        return query(y)-query(x-1);
    }
}T[5][5];
int main()
{
    int i,j,ca=0,k,n,m;
    while(~scanf("%d",&n))
    {
        for(i=0;i<5;i++)
        for(j=0;j<n;j++)scanf("%d",&a[i][j]);
        scanf("%s",s);
        for(i=0;i<5;i++)
            for(j=0;j<5;j++)T[i][j].init(n);
        for(i=0;i<5;i++)
        {
            p[i]=i;q[i]=i;
            for(j=0;j<n;j++)
            {
                k=s[j]-'A';
                T[i][k].upd(j+1,a[i][j]);
            }    
        }
        scanf("%d",&m);
        while(m--)
        {
            char t[5];
            scanf("%s",t);getchar();
            if(t[1]=='s')
            {
                scanf("%d%d",&i,&j);
                ll ans=0;
                for(k=0;k<5;k++)ans+=T[k][p[k]].query(i,j);//cerr<<ans<<" ";
                printf("%lld\n",ans);
            }
            else if(t[1]=='c')
            {
                char c;
                scanf("%d %c",&i,&c);i--;
                if(s[i]==c)continue;
                for(k=0;k<5;k++)
                    T[k][s[i]-'A'].upd(i+1,-a[k][i]),T[k][c-'A'].upd(i+1,a[k][i]);
                s[i]=c;
            }
            else
            {
                char c,d;scanf("%c %c",&c,&d);
                i=c-'A',j=d-'A';
                int x=q[i],y=q[j];
                p[x]=j,q[j]=x;p[y]=i;q[i]=y;
            }
            //for(i=0;i<5;i++)printf("%d ",p[i]);
              //  puts("");
        }    
    }
    return 0;
}