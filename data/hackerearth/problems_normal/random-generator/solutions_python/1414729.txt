T = int(raw_input())

for t in range(T):
	(N, K, P) = map (int, str(raw_input()).split())
	nums = sorted (map (int, str(raw_input()).split()))
	for I in range(N-K+1):
		fail = False
		if nums[I+K-1] - nums[I] <= 2 * P:
			fail = True
			break
	if fail:
		print "NO"
	else:
		print "YES"