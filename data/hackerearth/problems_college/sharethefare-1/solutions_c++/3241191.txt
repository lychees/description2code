#include <bits/stdc++.h>
using namespace std;

struct cmp_str
{
   bool operator()(char const *a, char const *b)
   {
      return std::strcmp(a, b) < 0;
   }
};

int main()
{
	long long int T ,n ,q ,i ,amt ,val ,m ,pay ,j ,mval ,dif;
	char pname[51][12] ,name[12] ,mname[12]; 
	
    for(cin >> T; T; T--)
    {
    	cin >> n >> q;
    	map < char* ,long long int ,cmp_str> valmap;
    	for(i = 0; i < n; i++)
    	{
    		cin >> pname[i];
    		valmap[pname[i]] = 0;
    	}
    	for(i = 0; i < q; i++)
    	{
    		cin >> name;
    		cin >> amt;
    		val = valmap[name];
    		valmap[name] = val + amt;
    		cin >> m;
    		pay = amt / (m + 1);
    		for(j = 0; j < m; j++)
    		{
    			cin >> mname;
    			mval = valmap[mname];
    			valmap[mname] = mval - pay;
    		}
    		dif = amt - (pay * m);
    		mval = valmap[name];
    		valmap[name] = mval - dif;
    	}
    	for(i = 0; i < n; i++)
    	{
    		if(valmap[pname[i]] > 0)
    			cout << pname[i] << " is owed " << valmap[pname[i]] << "\n";
    		else if(valmap[pname[i]] < 0)
    			cout << pname[i] << " owes " << (-1 * valmap[pname[i]]) << "\n";
    		else
    			cout << pname[i] << " neither owes nor is owed\n";
    	}
    	valmap.clear();
    }
    return 0;
}
