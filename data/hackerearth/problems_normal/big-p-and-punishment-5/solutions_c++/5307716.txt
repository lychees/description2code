#include <bits/stdc++.h>
using namespace std;
#define s(x) scanf("%d",&x)
#define p(x) printf("%d",x)
#define MOD 1000000007
#define sl(x) scanf("%lld",&x)
#define pl(x) printf("%lld",x)


int main()
{
	int t;
	cin>>t;
	while(t--)
	{
		int n,p,s,x,y;
		map<int,vector<int>> m;
		cin>>n>>p>>s;
		while(p--)
		{
			cin>>x>>y;
			m[x].push_back(y);
		}
		bool vis[n+1];
		memset(vis,0,sizeof(vis));
		for(int i=0;i<s;i++)
		{
			cin>>x;
			if(!vis[x])
			{
				vis[x]=1;
				list<int> q;
				q.push_back(x);
				int g;
				vector<int>::iterator it;
				while(!q.empty())
				{
					g=q.front();
					q.pop_front();
					for(it=m[g].begin();it!=m[g].end();it++)
					{
						if(!vis[*it])
						{
							q.push_back(*it);
							vis[*it]=1;
						}
					}
				}
			}
		}
		int coun=0;
		for(int i=1;i<=n;i++) if(vis[i]==1) coun++;
		cout<<coun<<"\n";
	}
    return 0;
}
