#include <iostream>
#include <fstream>
using namespace std;

//ifstream f("wow.in");

#define ll long long
#define inf ((ll)1<<(ll)40)
#define LE 2066
#include <cstring>
#define f cin

string str,str2;
int pos[LE];
ll dp[LE][LE];

ll mdl(ll val)
{
   return (val<0?-val:val);
}

int main()
{
    int nrt;
    f>>nrt;

    for(; nrt; --nrt)
    {
        int N,C01,C10,CQ,CSW;
        int nr1=0,i,j;

        f>>N>>C01>>C10>>CQ>>CSW;
        f.get();
        f>>str;
        f>>str2;

        for(i=0; i<N; ++i)
            if (str2[i]=='1')
                pos[++nr1]=i+1;

        str=" "+str;

        for(i=0; i<=N; ++i)
            for(j=0; j<=N; ++j)
                dp[i][j]=inf;

        dp[0][0]=0;

        for(i=0; i<N; ++i)
            for(j=0; j<=i&&j<=nr1; ++j)
            {
                ll c1=0,c0=0;
                if (str[i+1]=='1') c1=0,c0=C10;
                if (str[i+1]=='0') c1=C01,c0=0;
                if (str[i+1]=='?') c1=c0=CQ;

                dp[i+1][j+1]=min(dp[i+1][j+1],dp[i][j]+c1+mdl(i+1-pos[j+1])*CSW);
                dp[i+1][j]=min(dp[i+1][j],dp[i][j]+c0);
            }


        cout<<dp[N][nr1]<<'\n';
    }

    return 0;
}
