#include <bits/stdc++.h>
#define MAXN 1696969
using namespace std;

struct node{
    int children[26];
    int c;
};

node trie[MAXN];
int trieNodes = 1;
int N , Q;

void add(char s[MAXN] , int cost){
    int curNode = 1;
    int len = strlen(s);

    for(int i=0; i<len; i++){
        int nextNode = trie[curNode].children[s[i]-'a'];
        if(nextNode == 0){
            trieNodes++;
            nextNode = trie[curNode].children[s[i]-'a'] = trieNodes;
            curNode = nextNode;
        }
        else    curNode = nextNode;

        trie[curNode].c = max(trie[curNode].c , cost);
    }
}

int query(char s[MAXN]){
    int curNode = 1;
    int len = strlen(s);

    for(int i=0; i<len; i++){
        int nextNode = trie[curNode].children[s[i]-'a'];
        if(nextNode == 0){
            return -1;
        }
        else    curNode = nextNode;
    }

    return trie[curNode].c;
}

int main(){
    scanf("%d %d" , &N , &Q);

    for(int i=0; i<N; i++){
        char s[MAXN];
        int cost;
        scanf(" %s" , s);
        scanf("%d" , &cost);
        add(s ,cost);
    }

    for(int i=0; i<Q; i++){
        char s[MAXN];
        scanf(" %s" , s);
        printf("%d\n" ,  query(s));
    }

    return 0;
}
