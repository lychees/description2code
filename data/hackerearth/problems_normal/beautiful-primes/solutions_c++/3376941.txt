#include<iostream>
#include<vector>
#include<stdio.h>
#include<math.h>
#include<algorithm>
#include<map>
#include<string>
#include <sstream>
using namespace std;
#define f(i,a,b) for(ll i=a;i<b;i++)
#define ff(i,a,b,c) for(int i=a;i<b;i+=c)
#define w(n) while(n>0)
#define vi vector<int>
#define vll vector<long long int>
typedef long long int ll;
typedef int I;
typedef string S;
ll mod_pow(ll a,ll n,ll b){ll res = 1;while(n){if(n&1) {res = (res*a)%b;}a = (a*a)%b;n >>= 1;}return res%b;}
ll mod_div(ll a,ll b,ll md){ll ans = (a*mod_pow(b,md-2,md))%md; return ans;}
ll mul(ll a,ll b,ll md){ return (ll)(a*b)%md;}
ll gcd(ll n,ll m){if(m<=n && n%m==0)return m;if(n<m)return gcd(m,n);else return gcd(m,n%m);}
ll add(ll a,ll b,ll md){a=((a%md)+(b%md))%md;return a;}
ll sub(ll a,ll b,ll md){return add(a,md-b,md);}
ll mod=1000000000+7;
I main()
{
    I t;
    cin>>t;
    ll prime[100005];
    ll power[100005];
    w(t)
    {
        t--;
        I x;
        ll ans=1;
        cin>>x;
        f(i,0,x)cin>>prime[i];
        f(i,0,x)cin>>power[i];
        f(i,0,x)
           ans=mul(prime[i],mul(ans,mod_div(sub(mod_pow(prime[i],power[i],mod),1,mod),prime[i]-1,mod),mod),mod);
        cout<<ans<<endl;
    }
}
