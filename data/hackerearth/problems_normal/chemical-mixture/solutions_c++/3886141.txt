#include <iostream>
#include <algorithm>
#include <vector>
using namespace std;

int main()
{
	int t,n1,n2,i,j;
	long long m,a[60],w[15],wsum,asum,rem,amx;
	vector <long long> a1;
	vector <long long> a1mx;
	cin>>t;
	while(t--){
		amx=0;
		cin>>m>>n1>>n2;
		for(i=0;i<n1;i++)
			cin>>a[i];
		sort(a,a+n1);
		for(i=0;i<n2;i++)
			cin>>w[i];
		for(i=0;i<(1<<n2);i++){
			wsum=0;
			a1.clear();
			for(j=0;j<n2;j++)
				if(i & (1<<j))
					wsum+=w[j];
			rem=asum=m-wsum;
			for(j=n1-1;j>=0;--j){
				if(a[j]<=rem){
					rem-=a[j];
					a1.push_back(a[j]);
				}
			}
			if(rem==0 && asum>amx){
				a1mx.clear();
				amx=asum;
				for(j=0;j<a1.size();++j)
					a1mx.push_back(a1[j]);
			}
		}
		if(amx){
			cout<<"YES"<<'\n';
			for(j=a1mx.size()-1;j>=0;--j)
				cout<<a1mx[j]<<" ";
			cout<<'\n';
		}
		else
			cout<<"NO"<<'\n';
	}
    return 0;
}
