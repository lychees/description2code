#include<bits/stdc++.h>
using namespace std;
#define mp make_pair
#define pb push_back
vector< pair<int,int> >mn;
vector< pair<int,int> >wmn;
vector< pair<int,int> >bth;
int men[1001];
int women[1001];

int root(int x,int *arr)
{
	while(arr[x]!=x)x=arr[arr[x]];
	return x;
}
void Union(int x,int y,int *arr)
{
	int rtx=root(x,arr);
	int rty=root(y,arr);
	arr[rty]=rtx;
}

int main()
{
	for(int i=0;i<1001;i++)
	{
		men[i]=i;
		women[i]=i;
	}
	int n,m,x,y,t;
	cin>>n>>m;
	for(int i=0;i<m;i++)
	{
		cin>>x>>y>>t;
		if(t==3)bth.pb(mp(x,y));
		else if(t==2)wmn.pb(mp(x,y));
		else mn.pb(mp(x,y));
	}
	int ans=0,mans=0,wans=0;
	for(int i=0;i<bth.size();i++)
	{
		x=bth[i].first;
		y=bth[i].second;
		if(root(x,men)!=root(y,men))
			{
				Union(x,y,men);
				Union(x,y,women);
				ans++;
			}
	}
	for(int i=0;i<mn.size();i++)
	{
		x=mn[i].first;
		y=mn[i].second;
		if(root(x,men)!=root(y,men))
			{
				Union(x,y,men);
				mans++;
			}
	}
	for(int i=0;i<wmn.size();i++)
	{
		x=wmn[i].first;
		y=wmn[i].second;
		if(root(x,women)!=root(y,women))
			{
				Union(x,y,women);
				wans++;
			}
	}
	if(mans+ans==n-1 and ans+wans==n-1)cout<<m-(ans+wans+mans);
	else cout<<"-1";
	return 0;

}