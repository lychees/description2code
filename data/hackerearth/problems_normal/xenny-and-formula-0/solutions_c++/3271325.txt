#include <bits/stdc++.h>
#define MOD 1000000007
using namespace std;
int t,n,s;
typedef long long ll;
ll sum,k,w,d,u,fw[100005];
void update(int p, ll v){
	for(;p<=n;p+=(p&(-p))) fw[p]=(fw[p]+v)%MOD;
}
ll query(int p){
	ll ans=0ll;
	for(;p;p-=(p&(-p))) ans=(ans+fw[p])%MOD;
	return ans;
}
int main(){
	scanf("%d %d",&t,&n);
	for(int x=1;x<=n;x++){
		scanf("%lld",&k);
		update(x,k);
		sum=(sum+k)%MOD;
	}
	while(t--){
		scanf("%d %lld %lld %lld",&s,&w,&d,&u);
		ll l=w/d,tot=(w*(l+1ll)-d*l*(l+1ll)/2ll)+1ll;
		ll ans=(tot/ll(n))%MOD*sum%MOD;
		tot%=ll(n);
		if(ll(n-s+1)>=tot){
			ans+=query(s+int(tot)-1)+MOD-query(s-1);
			ans%=MOD;
		}
		else{
			ans+=query(n)+MOD-query(s-1);
			ans+=query(tot-ll(n-s+1));
		}
		printf("%lld\n",ans%MOD);
		update(s,u);
		sum=(sum+u)%MOD;
	}
	return 0;
}
		

		