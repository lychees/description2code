// There is nothing in a caterpillar that tells you its going to be a butterfly --------------------- !
#include<bits/stdc++.h>
using namespace std;
#define rep(i,n) for(int i=0;i<n;i++)
#define ll  long long int
#define pi pair<int,int>
#define pii pair<ll,pi>
#define f first
#define mp make_pair
#define mod 1000000007
#define s second
#define pb push_back
bool func(pii a,pii b){
    if(a.f!=b.f) return a.f<b.f;
    if(min(a.s.f,a.s.s)!=min(b.s.f,b.s.s)) return min(a.s.f,a.s.s)>min(b.s.f,b.s.s);
    return max(a.s.f,a.s.s)>max(b.s.f,b.s.s);
}
int pa[100011];
int sz[100011];
int deg[100011];
int f(int x){
    if(x==pa[x]) return x;
    return pa[x]=f(pa[x]);
}

void join(int a,int b){
    if(sz[a]<sz[b]) swap(a,b);
    sz[a]+=sz[b];
    pa[b]=a;
}
int main(){
    int t;
    cin >> t;
    while(t--){
        int n,m;
        cin >> n >> m;
        int u,v,w;
        rep(i,n+1){
            sz[i]=1;
            pa[i]=i;
            deg[i]=0;
        }
        vector<pii>s;
        rep(i,m){
            cin >> u >> v >> w;
            s.pb({w , {u,v}  });
        }
        sort(s.begin(),s.end(),func);
        ll ans=0;
        for(auto x:s){
            w=x.f;
            u=x.s.f;
            v=x.s.s;
            if(f(u)!=f(v)){
                ans+=w;
                deg[u]++;
                deg[v]++;
                join(f(u),f(v));
            }
        }
        cout<<ans<<"\n";
        rep(i,n){
            cout<<deg[i+1]<<" ";
        }
        cout<<"\n";
    }
}
