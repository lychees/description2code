/* [themighty] Deathsurgeon (Rupesh Maity)
* 2nd year, B.Tech in IT
* IIIT - Allahabad
*/

#ifdef _MSC_VER
#define _CRT_SECURE_NO_WARNINGS
#endif

#include <iostream>
#include <cstdio>
#include <math.h>
#include <string>
#include <cstring>
#include <algorithm>
#include <cstdlib>
#include <stack>
#include <queue>
#include <vector>
#include <map>
#include <utility>
#include <climits>
#include <ctime>

#define LL long long
#define pii pair<int, int>

#define MOD 1000000007
#define MAX 100000

using namespace std;

double pro[1000][1000];
double win[1000][1000];
double lose[1000][1000];

int main()
{
#ifdef _MSC_VER
	freopen("input.txt", "r", stdin);
	//	freopen("output.txt", "w", stdout);
#endif

	int t;
	cin >> t;

	while (t--) {
		int n, m;
		cin >> n >> m;

		for (int i = 0; i < n; i++) {
			for (int j = 0; j < m; j++) {
				scanf("%lf", &pro[i][j]);
			}
		}

		win[0][0] = pro[0][0];
		lose[0][0] = 1 - pro[0][0];
		for (int i = 1; i < m; i++) {
			win[0][i] = win[0][i - 1] * pro[0][i];
			lose[0][i] = win[0][i - 1] * (1 - pro[0][i]);
		}

		for (int i = 1; i < n; i++) {
			win[i][0] = (lose[i - 1][0]) * pro[i][0];
			lose[i][0] = (lose[i - 1][0]) *(1 - pro[i][0]);
			for (int j = 1; j < m; j++) {
				win[i][j] = (win[i][j - 1] + lose[i - 1][j]) * pro[i][j];
				lose[i][j] = (win[i][j - 1] + lose[i - 1][j]) * (1 - pro[i][j]);
			}
		}

		double p = 0;
		for (int i = 0; i < n; i++) {
			p += win[i][m - 1] * (m + i);
		}

		for (int i = 0; i < m; i++) {
			p += lose[n - 1][i] * (n + i);
		}

		printf("%.6lf\n", p);
	}


	return 0;
}