#include <bits/stdc++.h>
using namespace std;

int row[1003], col[1003];
char S[1003][1003];

int main()
{
    int T;
    scanf("%d", &T);
    
    while(T--)
    {
    	int N;
    	scanf("%d", &N);
    	
    	for(int i=0; i<N; i++)
    		scanf(" %s", S[i]);
    	
    	int cherry = 0;
    	
    	for(int i=0; i<N; i++)
    	{
    		if(i==0)
	    		row[i] = 0;
    		else
				row[i] = row[i-1];
			
			for(int j=0; j<N; j++)
			{
				if(S[i][j]=='#')
				{
					row[i]++;
					cherry++;
				}
			}
    	}
    	
    	for(int i=0; i<N; i++)
    	{
    		if(i==0)
    			col[i] = 0;
    		else
    			col[i] = col[i-1];
    		
    		for(int j=0; j<N; j++)
    		{
    			if(S[j][i]=='#')
    				col[i]++;
    		}
    	}
    	
    	bool flag = 0;
    	
    	for(int i=0; i<N; i++)
    		if(row[i]==cherry/2 || col[i]==cherry/2)
    			flag = 1;
    	
    	if(cherry%2 || !flag)
    		printf("NO\n");
    	else
    		printf("YES\n");
    }
    
    return 0;
}
