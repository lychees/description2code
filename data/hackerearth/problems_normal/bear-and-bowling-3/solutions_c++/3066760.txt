#include<bits/stdc++.h>

using namespace std;

#define rep(i,b) for(i=0;i<b;i++)
#define REP(i,a,b) for(i=a;i<=b;i++)
#define REV(i,b,a) for(i=b;i>=a;i--)

#define plln(n) printf("%lld\n",n)

#define s3ll(n1,n2,n3) scanf("%lld%lld%lld",&n1,&n2,&n3)
#define s2ll(n1,n2) scanf("%lld%lld",&n1,&n2)
#define sll(n) scanf("%lld",&n)

#define countSetBits(n) __builtin_popcountll(n)
#define gcd(a,b) __gcd(a,b)

typedef long long LL;

#define mod 1000000007
#define mx 999999

long long power(LL a,LL b)
{
    long long x=1,y=a;
    while(b > 0)
    {
        if(b%2 == 1)
        {
            x=(x*y);
            if(x>mod) x%=mod;
        }
        y = (y*y);
        if(y>mod) y%=mod;
        b /= 2;
    }
    return x;
}

int main()
{
	LL n;
	sll(n);
	LL x,i,ans=0;
	LL mul=power(2,n-1);
	LL add=power(2,n-2);
	rep(i,n){
		sll(x);
		ans=(ans+((mul*x)%mod))%mod;
		mul=(mul+add)%mod;
	}
	plln((ans+mod)%mod);
	return 0;
}
