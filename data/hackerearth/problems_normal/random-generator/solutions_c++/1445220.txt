#include <iostream>
#include <algorithm>
using namespace std;
int n,k;
long long p;
long long a[100001];
int main()
{
    int t;
    scanf("%d",&t);
    while(t--){
    	scanf("%d%d%lld",&n,&k,&p);
    	for(int i=0;i<n;i++) scanf("%lld",&a[i]);
    	sort(a,a+n);
    	bool ok = true;
    	for(int i=0;i<n;i++){
    		long long L =a[i]-2*p;
    		//int iR = upper_bound(a,a+n,R)-a;
    		int iL = lower_bound(a,a+n,L)-a;
    		//cout <<x << " " <<  iL << " " << iR << endl;
    		if (i-iL+1>=k){
    			ok = false;
    			//cout << x << " " << iR-iL << endl;
    			break;
    		}
    	}
    	if (ok) cout << "YES\n";
    	else cout << "NO\n";
    }
    return 0;
}
