#include<cstdio>
#include<iostream>
#include<cmath>
#include<algorithm>
#include<vector>
#include<map>
#include<stack>
#include<string>
#include<cstring>
#include<queue>
#include<list>
#define ll long long
#define pr(n) printf("%d",n)
#define sc(n) scanf("%d",&n)
#define prl(n) printf("%lld",n)
#define scl(n) scanf("%lld",&n)
using namespace std;
/*
#define gc getchar_unlocked
int read_int() {
  char c = gc();
  while(c<'0' || c>'9') c = gc();
  int ret = 0;
  while(c>='0' && c<='9') {
    ret = 10 * ret + c - 48;
    c = gc();
  }
  return ret;
}
*/

char arr[1000][1000];
int row[1000],col[1000];
int main()
{
   //freopen("in.txt","r",stdin);
  int t;
  sc(t);
  while(t--)
  {
  	int n;bool f=0;
  	cin>>n;long long total=0;
  	for(int i=0;i<n;i++)
  	 for(int j=0;j<n;j++)
  	 {
  	  
  	             cin>>arr[i][j];
              		if(arr[i][j]=='#')
                       total++;
                   }
                   
                   
                   
                   if(!total)
                   {
                   	cout<<"YES\n";
                   	continue;
                   }
	 long long s=0;
        for(int i=0;i<n;i++)
        {
        	s=0;
        	for(int j=0;j<n;j++)
        	{
        		if(arr[i][j]=='#')
        		s+=1;
        		
        	}
        	row[i]=s;
        	
        }


 
        for(int i=0;i<n;i++)
        {
        	s=0;
        	for(int j=0;j<n;j++)
        	{
        		if(arr[j][i]=='#')
         		s+=1;
        		
        	}
        	col[i]=s;
         }
   	//for(int i=0;i<n;i++)
     // cout<<row[i]<<" ";

// cout<<"\n";   	for(int i=0;i<n;i++)
  //    cout<<col[i]<<" ";
      
        if(total&1)
         cout<<"NO\n";
         else
         {
         	long long s=0;
         	for(int i=0;i<n;i++)
         	{
         		if(s==(total/2))
         		{
         		 f=1;
         		   cout<<"YES\n";
         		 break;
         	}
         		s+=row[i];
         	}
         	if(!f)
         	{
    
            s=0;         	
         	for(int i=0;i<n;i++)
         	{
         		if(s==(total/2))
         		{
         		f=1;
              		cout<<"YES\n";
         		 break;
         	    }
				 s+=col[i];
     
	     	}
           }
	     	if(!f)
         	cout<<"NO\n";
         	
         }






   

  }    
   return 0;
}
