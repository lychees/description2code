#include<bits/stdc++.h>
#include<algorithm>
using namespace std;
#define fr(i,a,b) for(int i=a;i<b;i++)
#define frn(i,a,b) for(int i=a;i>b;i--)
#define si(x) scanf("%d",&x)
#define sll(x)  scanf("%lld",&x)
#define pln printf("\n")
#define pi(x) printf("%d",x)
#define pll(x) printf("%lld",x)
#define mp make_pair
#define pb push_back
#define x first
#define y second
typedef long long ll;
ll MOD=1000000009;
ll pw(ll a,ll b){
  ll r=1;
  while(b>0){
     if(b&1){
       r=(r*a)%MOD;
        }
     b=b>>1;
     a=(a*a)%MOD;
  }
return r;
}
int main(){
 char in[311],sign[311],res[10];
 scanf("%s %s",in,sign);
 int q,a,b,n=strlen(in);

 ll t[311][311]={{}},f[311][311]={{}};//stores true and false in segments
  fr(i,0,n){
      f[i][i]=(in[i]-'0')==0;
      t[i][i]=(in[i]-'0')==1;
  }



 fr(l,2,n+1){
    fr(i,0,n-l+1){
       int j=i+l-1;
       ll t1=0,f1=0;
       fr(k,i,j){
            ll left,right;//total
            left=(t[i][k]+f[i][k])%MOD;
            right=(t[k+1][j]+f[k+1][j])%MOD;
            char op=sign[k];
          /* if(op=='a'){
               t[i][j]=(t[i][j]%MOD+(t[i][k]*t[k+1][j])%MOD)%MOD;
               f[i][j]=(f[i][j]%MOD+((left*right)%MOD-(t[i][k]*t[k+1][j])%MOD)%MOD)%MOD;
           }
           if(op=='o'){
               f[i][j]=(f[i][j]%MOD+(f[i][k]*f[k+1][j])%MOD)%MOD;
               t[i][j]=(t[i][j]%MOD+((right*left)%MOD-(f[i][k]*f[k+1][j])%MOD)%MOD)%MOD;
           }
           if(op=='x'){
               t[i][j]=(t[i][j]%MOD+((f[i][k]*t[k+1][j])%MOD+(t[i][k]*f[k+1][j])%MOD)%MOD)%MOD;
               f[i][j]=(f[i][j]%MOD+((t[i][k]*t[k+1][j])%MOD+(f[i][k]*f[k+1][j])%MOD)%MOD)%MOD;
           }*/
           if(op=='a'){
					t1  = (t1 + (t[i][k] * t[k+1][j])%MOD)%MOD;
				}else if(op == 'o'){
					t1  = (t1 + (t[i][k] * t[k+1][j])%MOD+(f[i][k]*t[k+1][j])%MOD+(t[i][k]*f[k+1][j])%MOD)%MOD;
				}else if(op=='x'){
					t1  = (t1 + (t[i][k]*f[k+1][j])%MOD+(f[i][k]*t[k+1][j])%MOD)%MOD;
				}

				if(op=='a'){
					f1 = (f1 + (f[i][k]*t[k+1][j])%MOD+(t[i][k]*f[k+1][j])%MOD+(f[i][k]*f[k+1][j])%MOD)%MOD;
				}else if(op == 'o'){
					f1 = (f1 +  (f[i][k]*f[k+1][j])%MOD)%MOD;
				}else if(op=='x'){
					f1 = (f1 +(f[i][k]*f[k+1][j])%MOD+(t[i][k]*t[k+1][j])%MOD)%MOD;
				}
		 }
    		t[i][j]=t1;
				f[i][j]=f1;

    }
 }

   si(q);
   while(q--){
        si(a),si(b);
        scanf(" %s",res);
        if(res[0]=='t'){
            cout<<t[a-1][b-1]%MOD;pln;
        }
        else{
              cout<<f[a-1][b-1]%MOD;pln;
        }

   }



return 0;
}
