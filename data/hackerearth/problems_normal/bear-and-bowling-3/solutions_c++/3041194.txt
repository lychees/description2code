#include <iostream>
using namespace std;


#define ull unsigned long long
#define MODULO 1000000007

ull PowMod(ull n)
{
	if(n<0)
		return 0;
    ull ret = 1;
    ull a = 2;
    while (n > 0) {
        if (n & 1) ret = ret * a % MODULO;
        a = a * a % MODULO;
        n >>= 1;
    }
    return ret;
}

int main()
{
 int n;
 scanf("%d",&n);
 ull arr[500000];
 for(int i=0;i<n;i++){
 	scanf("%lld",&arr[i]);
 }
 ull result=0;
 ull temp;
 ull pow1=PowMod(n-1);
 ull pow2=PowMod(n-2);
 for(int i=0;i<n;i++){
 	temp=( ( ( pow1 % MODULO +( pow2 * (ull) i) % MODULO ) % MODULO) * arr[i]  ) % MODULO;
 	// cout<<temp<<endl;
 	result=(result+temp) % MODULO;
 	
 }
 printf("%lld",result);
    return 0;
}
