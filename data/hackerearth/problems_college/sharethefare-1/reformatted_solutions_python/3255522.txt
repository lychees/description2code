from collections import defaultdict
T = input()
for i in range(T):
    N, Q = map(int, raw_input().split())
    names = {}
    name_list = []
    for i in range(N):
        name = raw_input()
        name_list.append(name)
        names.setdefault(name, [])
    for i in range(Q):
        name_paid = raw_input()
        amt_paid = input()
        M = input()
        share_amt = amt_paid/(M+1)
        extra = amt_paid % (M+1)
        x = share_amt+extra
        names[name_paid].append(amt_paid)
        names[name_paid].append(-x)
        for i in range(M):
            person = raw_input()
            names[person].append(-share_amt)
    for name in name_list:
        total_share = 0
        expenses = names[name]
        total_share = sum(expenses)
        if total_share > 0:
            print '{0} is owed {1}'.format(name, total_share)
        elif total_share < 0:
            print '{0} owes {1}'.format(name, -total_share)
        else:
            print '{0} neither owes nor is owed'.format(name)
