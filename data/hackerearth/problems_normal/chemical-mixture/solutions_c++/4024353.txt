#include<iostream>
#include<algorithm>
#include<vector>
using namespace std;

vector< long long >v,amulus,water,ans,t1;

int main()
{
    int t;
    cin>>t;
    while(t--) 
    {
        v.clear(); amulus.clear(); water.clear(); ans.clear();
        long long i,j,n1,n2,m,temp,temp1=0,amt=0;
        cin>>m>>n1>>n2;
        for(i=0;i<n1;i++) cin>>temp,amulus.push_back(temp);
        for(i=0;i<n2;i++) cin>>temp,water.push_back(temp);
        sort(amulus.begin(),amulus.end(),greater<long long>());
        for(i=0;i<(1<<n2);i++) 
        {
            temp=0; temp1=0; t1.clear();
            for(j=0;j<n2;j++) 
            {
                if(i&(1<<j)) temp+=water[j];
            }
            for(j=0;j<n1;j++) 
            {
                if(temp+temp1+amulus[j]<=m) temp1+=amulus[j],t1.push_back(amulus[j]);
            }
            if(temp+temp1==m) 
            {
                if(temp1>amt) 
                {
                    ans.clear(); amt=temp1;
                    for(j=0;j<t1.size();j++) ans.push_back(t1[j]);
                }
            }
        }
        if(ans.empty()) 
        	cout<<"NO";
        else 
        { 
        	cout<<"YES\n"; for(i=ans.size()-1;i>=0;i--) cout<<ans[i]<<" "; 
        	
        }
        cout<<"\n";
    }
}
