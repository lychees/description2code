#include <iostream>
#include<bits/stdc++.h>
using namespace std;
#define mod 1000000007
/*void power ( long long a[][], int n ){
	long long c[5][5];
	while ( n ){
		if ( n&1)
	}
}*/
long long mul ( long long a[][5], long long b[][5]) {
	long long c[5][5];
	memset(c,0,sizeof c);
	for ( int i = 0; i < 5; i++ ){
		for ( int j = 0; j < 5; j++ ){
			for ( int k = 0; k < 5; k++ ){
				c[i][j]=(c[i][j]+a[i][k]*b[k][j])%mod;
			}
		}
	}
	for ( int i = 0; i < 5; i++ ){
		for ( int j = 0; j < 5; j++ )
		a[i][j] = c[i][j];
	}
}
void f ( long long a[], int n ){
	if ( n < 5 )
	{
		printf("%lld\n",a[n]);
		return;
	}
	long long b[5][5], i,c[5][5];
	memset(b,0,sizeof b);
	memset(c,0,sizeof c);
	for(i=0;i<5;i++)c[i][i]=1;
	b[4][0]=b[4][3]=b[4][2]=b[4][4]=1;
	b[4][1]=2;
	for ( i = 0; i < 4; i++ ){
		b[i][i+1]=1;
	}
	n-=4;
	while ( n ){
		if ( n & 1 ){
			mul(c,b);
		}
		mul(b,b);
		n>>=1;
	}
	long long ans = 0;
	for (int i = 0; i < 5; i++ )
	ans =( ans + c[4][i]*a[i])%mod;
	printf("%lld\n",ans%mod);
}
int main()
{
	int t, n;
	cin >> t;
	while ( t-- ){
		long long a[5];
		for (int i = 0; i < 5; i++ )
		scanf("%lld",&a[i]);
		scanf("%d", &n );
		f(a,n);
	}
    //cout << "Hello World!" << endl;
    return 0;
}
