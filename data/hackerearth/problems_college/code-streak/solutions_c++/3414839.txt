#include <bits/stdc++.h>
#define ll long long 
using namespace std;

int main()
{
    ll t,n,i,cnt,ans,a,b;
    set<ll> s,s2;
    cin>>t;
    while(t--)
    {
    	s.clear();
    	s2.clear();
    	cin>>n;
    	ans=0;
    	cnt=0;
    	for(i=0;i<n;i++)
    	{
    		cin>>a>>b;
    		if(b==0)
    		{
    			ans=max(ans,cnt);
    			cnt=0;
    			s.clear();
    		}
    		else
    		{
    			ll temp2=s2.size();
    			ll temp=s.size();
    			s2.insert(a);
    			s.insert(a);
    			if(temp!=s.size()&&temp2!=s2.size())
    			{
    				cnt++;
    			}
    		}
    		//cout<<cnt<<" ";
    	}
    	ans=max(ans,cnt);
    	cout<<ans<<endl;
    }
    return 0;
}
