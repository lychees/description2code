#include<bits/stdc++.h>
#define mod 1000000007
using namespace std;

long long  dx[8]={2,1,-2,1,-1,-2,2,-1};
long long  dy[8]={1,2,1,-2,-2,-1,-1,2};

long long  mat[1001][1001];
long long  visited[1001][1001];
long long  power[1000002];
long long  counti;

long long  n,m;
void dfs(long long  i,long long  j)
{
	if(i<1 || j<1 || i>n || j>m)
	return ;
	
	for(long long k=0;k<8;k++)
	{
		long long  temp1=i+dx[k];
		long long  temp2=j+dy[k];
		
		if(temp1>=1 && temp1<=n && temp2>=1 && temp2<=m && !visited[temp1][temp2] && mat[temp1][temp2])
		{
			counti++;
			visited[temp1][temp2]=1;
			dfs(temp1,temp2);
		}
	}
	return;
}


int  main()
{
	long long t,x,y,ans=1,q;
	long long  i,j;
	
	power[0]=1;
	power[1]=1;
	
	for(i=2;i<=1000000;i++)
	{
		power[i]=(i*power[i-1]);
		power[i]=power[i]%mod;
	}
	cin>>t;
	while(t--)
	{
		memset(visited,0,sizeof(visited));
		memset(mat,0,sizeof(mat));
		counti=0;
		ans=1;
		cin>>n>>m>>q;
		while(q--)
		{
			cin>>x>>y;
			mat[x][y]=1;
		}
		for(i=1;i<=n;i++)
		{
			for(j=1;j<=m;j++)
			{
				if(mat[i][j]==1 && !visited[i][j])
				{
					counti=1;
					visited[i][j]=1;
					dfs(i,j);
					ans*=(power[counti]);
					ans=ans%mod;
				}
			}
		}
		if(ans==0)
		cout<<"1\n";
		else
		cout<<ans<<"\n";
	}
	return 0;
}