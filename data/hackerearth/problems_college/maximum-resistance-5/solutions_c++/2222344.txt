#include <iostream>
#include <cstring>
#include <algorithm>
#include <stack>
using namespace std;

int main()
{
    int t;
    scanf("%d", &t);
    while(t--) {
    string st;
    stack<int> s1;
    cin >> st;
    int c = 0, sum = 0,i = 0;
    for(i = st.length()-1; i >= 0; i--) {
          if(st[i] == 'X') {
              s1.push(1);
              c++;
              }
         else{
     		if(st[i] == 'A') {
    			int a = s1.top();
    			 s1.pop();
    			int b = s1.top();
    			 s1.pop();
    			s1.push(a + b);
    			}
    		else {
    			int a = s1.top();	
    			 s1.pop();
    			int b = s1.top();	
    			  s1.pop();
    			s1.push(max(a, b));
    			}
    		}
    }
    vector<int> v(c);
    for(i = 0; i < c; i++){
    	scanf("%d", &v[i]);
    }	
    	
    sort(v.begin(), v.end(), greater<int>());
    i = s1.top();
    i -= 1;
    
    for(; i >= 0; i--)	
    		sum += v[i];
   	printf("%d\n", sum);
    }
    return 0;
}
