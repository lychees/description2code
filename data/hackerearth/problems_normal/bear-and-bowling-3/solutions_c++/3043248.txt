#include <iostream>
#define modval 1000000007
typedef long long ll;

using namespace std;

int main(){
	int n;
	cin >> n;
 
	ll a[n];
	int i;
	ll result=0;
	ll tpow=1;
	ll j;

	if((n == 1) || (n == 2)){
		tpow = 1;
	}
	else{
		for(j=0; j<n-2; j++){
			tpow = ((tpow % modval)*2) % modval;
		}
	}

	if(n > 1){
		for(i=2; i<n+2; i++){
			cin >> a[i-2];

			result = ((result % modval) + ((a[i-2] % modval)*((i*tpow) % modval) % modval)) % modval;
		}
	}
	else
		cin >> result;

	cout << result << endl;

	return 0;
}