#include<iostream>
#include<bits/stdc++.h>
using namespace std;
#define MOD 1000000007

#define VI vector<int>
#define PII pair<int,int>
#define pb push_back
// input and output
#define scan(x) scanf("%d",&x)
#define scanll(x) scanf("%lld",&x)
#define ll long long int
#define rep(i,x,y) for(i=x;i<y;i++)
#define print(x) printf("%d\n",x)
#define printll(x) printf("%lld\n",x)
#define MAX 1000001
ll A[MAX],S[MAX];
int main(){
 int t;
 scan(t);
 while(t--)
 {
 	int k,q;
 	scan(q);
 	scan(k);
 	
 	vector<long long int> C,ans;
 	
 	for(int i=0;i<k;i++)
 	{
 		long long int x;
 		scanll(x);
 		A[i+1]=x;
 		S[i+1]=x;
 	}
 	for(int i=0;i<k;i++)
 	{
 		long long int x;
 		scanll(x);
 		C.pb(x);
 	}
 	
 	for(int i=k+1;i<MAX;i++)
 	{
 		A[i]=0;
 		for(int j=0;j<k;j++)
 		{
 			A[i]=(A[i]+(A[i-j-1]*C[j])%MOD)%MOD;
 		}
 		S[i]=A[i];
 	}
 	
 	for(int i=1;(i+9999)<MAX;i+=10000)
 	{
 		sort(S+i,S+i+10000);
 	}
 	
 	for(int i=0;i<q;i++)
 	{
 		int l,r;
 		scan(l);
 		scan(r);
 		int j;
 		for(j=l;j<=(l+(10000-l%10000))&&j<=r;j++)
 		{
 			ans.pb(A[j]);
 		}
		for(;j+9999<=r;j+=10000)
		{
			
			for(int l=0;l<100;l++)
			{
				ans.pb(S[l+j]);
			}
		}
		for(;j<=r;j++)
		{
			ans.pb(A[j]);
		}
 	    sort(ans.begin(),ans.end());
	    if(ans.size()>100)
	    {
	    	for(int i=0;i<100;i++)
	    	cout<<ans[i]<<" ";
	    	
	    	cout<<endl;
	    }
	    else
	    {
	    	for(auto i:ans)
	    	{
	    		cout<<i<<" "; 
	    	}
	    	cout<<endl;
	    }
	    ans.clear();
	 }
 }
 return 0;
}
