// AUTHOR : SIKANDER MAHAN
// sikander_nsit
// PLAGIARISM IS BAD

#include <vector>
#include <list>
#include <map>
#include <set>
#include <queue>
#include <deque>
#include <stack>
#include <bitset>
#include <algorithm>
#include <functional>
#include <numeric>
#include <utility>
#include <sstream>
#include <iostream>
#include <iomanip>
#include <cstdio>
#include <cmath>
#include <cstdlib>
#include <ctime>
#include <limits>
#include <string.h>

#define tr(type,c,it) for(type::iterator it=c.begin();it!=c.end();++it)
#define all(c) c.begin(),c.end()
#define mod 1000000007
#define itor(c) c::iterator
#define ll long long
#define vi vector<int>
#define vs vector<string>
#define si set<int>
#define msi multiset<int>
#define ii pair<int,int>
#define sii set<ii>
#define vii vector<ii>
#define vvi vector<vi>
#define pb push_back
#define mp make_pair

using namespace std;

#define N 100

ll M[N][N]={{0}};
int sz;

void multiply(ll A[N][N],ll B[N][N])
{
    int i,j,k;
    ll C[N][N]={{0}};
    for(i=0;i<sz;++i)
    {
        for(j=0;j<sz;++j)
        {
            for(k=0;k<sz;++k)
            {
                C[i][j]=(C[i][j]+A[i][k]*B[k][j])%mod;
            }
        }
    }
    for(i=0;i<sz;++i)
    {
        for(j=0;j<sz;++j)
        {
            A[i][j]=C[i][j];
        }
    }
}

void power(ll F[N][N],int p)
{
    if(p==0 || p==1)
        return;
    power(F,p/2);
    multiply(F,F);
    if(p&1)
    {
        multiply(F,M);
    }
}

int calc(string str)
{
    int i,j,len=str.length(),k;
    set<string> s;
    for(i=0;i<len;++i)
    {
        for(j=i;j<len;++j)
        {
            for(k=i;k<=j;++k)
            {
                if(str[k]!=str[j+i-k])
                    break;
            }
            if(k>j)
            {
                s.insert(str.substr(i,j-i+1));
            }
        }
    }
    return (s.size());
}

int main()
{
    ios::sync_with_stdio(false);
    //freopen("input.txt","r",stdin);
    //freopen("out.txt","w",stdout);
    int t=0,i=0,j=0,n=0,m,k=0,num=0,temp=0,ind,c,d,nm;
    int a,b,x,y;
    cin>>n>>m;
    nm=n*m;
    sz=nm;
    string str;
    ll B[N][N],A[N][N];
    for(i=0;i<n;++i)
    {
        for(j=0;j<m;++j)
        {
            cin>>str;
            B[0][i*m+j]=calc(str);
        }
    }
    for(i=1;i<nm;++i)
    {
        for(j=0;j<nm;++j)
        {
            B[i][j]=B[0][j];
        }
    }
    cin>>c;
    for(i=0;i<c;++i)
    {
        cin>>a>>b>>x>>y;
        j=a*m+b;
        k=x*m+y;
        M[j][k]++;
        M[k][j]++;
    }
    for(i=0;i<nm;++i)
    {
        M[i][i]=1;
    }
    for(i=0;i<nm;++i)
    {
        for(j=0;j<nm;++j)
        {
            A[i][j]=M[i][j];
        }
    }
    cin>>d;
    power(A,d);
    /*
    for(i=0;i<nm;++i)
    {
        for(j=0;j<nm;++j)
        {
            cout<<A[i][j]<<" ";
        }
        cout<<endl;
    }
    */
    multiply(B,A);
    /*
    for(i=0;i<nm;++i)
    {
        for(j=0;j<nm;++j)
        {
            cout<<B[i][j]<<" ";
        }
        cout<<endl;
    }
    */
    for(i=0;i<nm;++i)
    {
        if(i>0 && i%m==0)
            cout<<"\n";
        cout<<B[0][i]<<" ";
    }
    return 0;
}
