#include <bits/stdc++.h>
using namespace std;
struct trie
{
	trie * a[26];
	int wt;
	trie()
	{
		for(int i=0;i<26;i++)
		a[i]=NULL;
		wt=0;
	}
};
trie* insert(string & str,int we,int is,trie *r)
{
	int curr=str[is]-'a';
	if(!r->a[curr])r->a[curr]=new trie();
	r->a[curr]->wt=max(r->a[curr]->wt,we);
	if(is+1!=str.size())
	r->a[curr]=insert(str,we,is+1,r->a[curr]);
	return r;
	
}
int bst(string &str,trie*r)
{  int y=0;int best=-1;
	while(y!=str.size())
	{if (!r->a[str[y]-'a']) return -1;
		best=r->a[str[y]-'a']->wt;
		r=r->a[str[y]-'a'];
		y++;
	}
	return best;
}
int main()
{
    int n,q;
    cin>>n>>q;
    string s;int l;
    trie *r=new trie();
    while(n--)
    {
    	cin>>s>>l;
    	r=insert(s,l,0,r);
    }
    while(q--)
    {
    cin>>s;
    cout<<bst(s,r)<<"\n";
    }
    return 0;
}
