#include<bits/stdc++.h>
using namespace std;
#define ll long long
int arr[10001];

int dfs(vector<int>fr[],int c,int count)
{
		vector <int>::iterator pos;
		for(pos=fr[c].begin();pos!=fr[c].end();++pos)
		if(arr[*pos]!=1)
		{
		count++;
		arr[*pos]=1;
		count=dfs(fr,*pos,count);	
		}
		
	return count;
	
}

int main()

{
	int t;
	cin>>t;
	while(t--)
	{
		
		int n,f,s;
		cin>>n>>f>>s;
		int a,b;
		vector<int> fr[10001];
		for (int i=0;i<f;i++)
		{
			
			cin>>a>>b;
			fr[a].push_back(b);
		}
		
		int count=0;
		int c;
		
		memset(arr,0,sizeof(arr));
		
		for(int i=0;i<s;i++)
		{cin>>c;
		
		if(arr[c]!=1)
		{
		arr[c]=1;
		count++;
		
		
		count=dfs(fr,c,count);
		}
		}
		cout<<count<<endl;
		
	}
}