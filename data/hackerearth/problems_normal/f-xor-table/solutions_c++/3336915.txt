#include <iostream>
using namespace std;

typedef long long ll;

const int N = (int)1e6 + 100;
int n, p;
int m, x;
char s[N];
int a[N];
int b[N];

void apply(int z)
{
	for (int i = 0; i < m; i++)
		b[i] = a[i] ^ a[(i + z) % m];
	for (int i = 0; i < m; i++)
		a[i] = b[i];
}

void solve()
{
	scanf("%d%d%d%d", &n, &m, &p, &x);
	scanf(" %s ", s);
	for (int i = 0; i < m; i++)
		a[i] = (int)(s[i] - '0');
	if (n == 1)
	{
		for (int i = 0; i < m; i++)
			printf("%d", a[i]);
		printf("\n");
		return;
	}
	p = (m - p) % m;
	n--;
	for (int k = 30; k >= 0; k--)
	{
		int z = p;
		ll len = 1;
		for (int i = 0; i < k; i++)
		{
			z = (z * 2) % m;
			len *= 2;
		}
		while(n >= len)
		{
			n -= len;
			apply(z);
		}
	}
	for (int i = 0; i < m; i++)
		printf("%d", a[i] ^ x);
	printf("\n");
	return;
}

int main()
{
	int t;
	scanf("%d", &t);
	while(t--)
		solve();
    return 0;
}
