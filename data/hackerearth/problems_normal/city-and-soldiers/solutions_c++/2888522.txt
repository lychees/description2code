#include <bits/stdc++.h>
using namespace std;
int a[100010];
void make_it_reps(int x);
void union_(int x,int y);
int root(int x);

int main(){
int n, q;
cin>>n>>q;
for(int i=1; i<=n; i++){
    a[i] = i;
}
int x, y;
for(int i=0; i<q; i++){
    cin>>x;
    switch(x){
        case 1:
            cin>>x>>y;
            union_(x, y);
            break;
        case 2:
            cin>>x;
            make_it_reps(x);
            break;
        case 3:
            cin>>x;
            cout<<root(x)<<endl;
            break;
    }
}
}

int root(int x){
    while(x != a[x]){
        a[x] = a[a[x]];
        x = a[x];
    }
    return x;
}

void union_(int x,int y){
int r1=root(x);
int r2=root(y);
a[r1] =r2;
}

void make_it_reps(int x){
    int t=x;
    x = root(x);
    a[x] = t;
    a[t]=t;
}
