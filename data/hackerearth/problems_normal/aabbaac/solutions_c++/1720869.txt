#include <stdio.h>
#include <string.h>

#define NMAX 55
#define LMAX 128

char S[NMAX][LMAX];
int Slen[NMAX];
long long Tlen[NMAX];

char GetChar(int i, long long x) {
	if (i == 0) return S[0][x];
	if (x >= 2 * Tlen[i - 1]) return S[i][x - 2 * Tlen[i - 1]];
	if (x < Tlen[i - 1]) return GetChar(i - 1, x);
	else return GetChar(i - 1, Tlen[i - 1] - 1 - (x - Tlen[i - 1]));
}

int main() {
	//freopen("y.txt", "r", stdin);
	int T, N, M, i;
	long long x;
	scanf("%d", &T);
	while (T--) {
		scanf("%d %d", &N, &M);
		for (i = 0; i < N; i++) {
			scanf("%s", &S[i][0]);
			Slen[i] = strlen(S[i]);
		}
		Tlen[0] = Slen[0];
		for (i = 1; i < N; i++)
			Tlen[i] = (Tlen[i - 1] << 1) + Slen[i];
		while (M--) {
			scanf("%lld", &x);
			printf("%c", GetChar(N - 1, x));
		}
		printf("\n");
	}
	return 0;
}
