#include <algorithm>
#include <cmath>
#include <cstdio>
#include <cstdlib>
#include <cstring>
#include <deque>
#include <iostream>
#include <map>
#include <queue>
#include <set>
#include <stack>
#include <string>
#include <vector>

#define pb push_back
#define mk make_pair
#define REP(i, n) for (int(i) = 0; (i) < (n); ++(i))
#define FOR(i, f, n) for (int(i) = (f); (i) < (n); ++(i))

using namespace std;

int main() {
  int n, M, T;
  cin >> n >> M >> T;
  vector<int> res(n, 0);
  int ind = 0;
  bool no = true;
  deque<int> q;
  REP(j, n) {
    int tc, hh, mm, ss;
    scanf("%d:%d:%d", &hh, &mm, &ss);
    tc = ss + mm * 60 + hh * 3600;
    while (!q.empty() && q.front() < tc)
      q.pop_front();
    if (q.size() >= M) {
      res[j] = ind;
      q.pop_back();
    } else {
      res[j] = ++ind;
    }
    q.push_back(tc + T - 1);
    if (q.size() == M)
      no = false;
  }
  if (no)
    cout << "No solution";
  else {
    cout << ind << endl;
    REP(j, n) cout << res[j] << endl;
  }
  return 0;
}
