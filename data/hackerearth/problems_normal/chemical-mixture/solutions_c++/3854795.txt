#include <iostream>
#include <vector>
#include <algorithm>
using namespace std;

int main()
{
    int T;
    scanf("%d", &T);
    for(int test=0; test<T; test++){
    	vector<int> ans;
    	long long max=-1;
    	long long a[100];
    	long long b[100];
    	int mark[100];
    	for(int i=0; i<100; i++) a[i] = 0, b[i] = 0, mark[i] = 0;
    	long long m;
    	int n1, n2;
    	scanf("%lld%d%d", &m, &n1, &n2);
    	for(int i=0; i<n1; i++) scanf("%lld", &a[i]);
    	for(int i=0; i<n2; i++) scanf("%lld", &b[i]);
    	sort(a, a+n1);
    	for(int mask=0; mask<(1<<n2); mask++){
    		vector<int> uselist;
    		int temp = mask;
    		long long sum=0;
    		int cur=0;
    		long long totaluse=0;
    		//printf("%d ", mask);
    		while(temp > 0){
    			if(temp%2) sum += b[cur];
    			cur++;
    			temp /= 2;
    		}
    		//printf("%lld))\n", sum);
    		sum = m - sum;
    		//printf("%lld\n", sum);
    		cur = n1-1;
    		int used = 0;
    		while(sum > 0 && cur >= 0){
    			if(sum >= a[cur]){ sum -= a[cur]; used++; uselist.push_back(cur); totaluse += a[cur];}
    			cur--;
    		}
    		if(sum == 0 && totaluse > max){
    			max = totaluse;
    			ans.clear();
    			//printf("%d!", mask);
    			for(int i=0; i<used; i++) ans.push_back(uselist[i]);
    		}
    	}
    	if(max >= 0){
    		printf("YES\n");
    		for(int i=ans.size()-1; i>=0; i--) printf("%lld ", a[ans[i]]);
    		printf("\n");
    	} else{
    		printf("NO\n");
    	}
    	
    }
    return 0;
}
