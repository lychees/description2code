#include<bits/stdc++.h>
#define LL long long int
#define M 1000000007
#define reset(a) memset(a,0,sizeof(a))
#define rep(i,j,k) for(i=j;i<=k;++i)
#define per(i,j,k) for(i=j;i>=k;--i)
#define print(a,start,end) for(i=start;i<=end;++i) cout<<a[i];
#define endl "\n"
using namespace std;
int row[10001];
int col[10001];
int a[1005][1005],b[1005][1005];
int main()
    {
    	int i,j,t,n,m,count;
        ios_base::sync_with_stdio(0);
        cin>>t;
        while(t--)
        	{
        		count = 0;
        		cin>>n>>m;
        		rep(i,1,n)
        			rep(j,1,m)
        				cin>>a[i][j];
        		rep(i,1,n)
        			rep(j,1,m)
        				cin>>b[i][j];
        		for(i=1;i<=n;++i)
        			row[i] = -1;
        		for(i=1;i<=m;++i)
        			col[i] = -1;
        		for(j=1;j<=m;++j)
        			{
        				for(i=1;i<=n;++i)
        					{
        						col[j] = max(col[j],a[i][j]);
        					}
        			}
        		for(i=1;i<=n;++i)
        			{
        				for(j=1;j<=m;++j)
        					{
        						row[i] = max(row[i],b[i][j]);
        					}
        			}
        		for(i=1;i<=n;++i)
        			{
        				for(j=1;j<=m;++j)
        					{
        						if(b[i][j]==row[i]&&a[i][j]==col[j])
        							++count;
        					}
        			}
        		cout<<count<<endl;
        	}
    }
