#include <iostream>

using namespace std;

long long int arr[26][26];
long long int min(long long int x, long long int y) {
  if (x < y)
    return x;
  return y;
}
string str1, str2;
int main() {
  long long int i, j, k, l, t, ans = 0, x;

  cin >> t;
  for (int i = 0; i < 26; ++i) {
    for (int j = 0; j < 26; ++j) {
      cin >> arr[i][j];
    }
  }

  for (k = 0; k < 26; ++k) {
    for (i = 0; i < 26; ++i) {
      for (j = 0; j < 26; ++j) {
        arr[i][j] = min(arr[i][j], arr[i][k] + arr[k][j]);
      }
    }
  }

  for (k = 0; k < t; ++k) {
    cin >> str1 >> str2;
    ans = 0;
    for (i = 0; i < str1.size(); ++i) {
      if (str1[i] != str2[i]) {
        ans += arr[str1[i] - 'a'][str2[i] - 'a'];
      }
    }

    cout << ans << endl;
  }

  return 0;
}
