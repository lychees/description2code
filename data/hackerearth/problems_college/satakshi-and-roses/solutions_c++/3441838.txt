#include <bits/stdc++.h>
using namespace std;
int search(int *arr,int start,int n,long long int val)
{
   int i;
   for(i=start;i<n;i++)
   {
       if(arr[i]>=val)
       return i;
   }
   return n;

}
int search1(int *arr,int start,int n,long long int val)
{
   int i;
   for(i=start;i<n;i++)
   {
       if(arr[i]>val)
       return i;
   }
   return n;

}
int count(int *sum,int n,int l,int r)
{
	   int currIndex = 0;
	   int answer=0;
	   int x=l;
	   int index= search(sum,currIndex,n,x);
	   answer+=(n-index);
	   currIndex = index;
	   for(int i=0;i<n;i++)
	   {
	       int ans = search(sum,currIndex,n,sum[i]+x);
	       currIndex = ans;
	       answer+=(n-ans);
	   }
	   return answer;

}
int count1(int *sum,int n,int l,int r)
{
	   int currIndex = 0;
	   int answer=0;
	   int x=r;
	   int index= search1(sum,currIndex,n,x);
	   answer+=(n-index);
	   currIndex = index;
	   for(int i=0;i<n;i++)
	   {
	       int ans = search1(sum,currIndex,n,sum[i]+x);
	       currIndex = ans;
	       answer+=(n-ans);
	   }
	   return answer;

}
int main()
{
    int t;
    scanf("%d",&t);
    while(t--)
    {
    	int n,m,l,r;
    	scanf("%d %d %d %d",&n,&m,&l,&r);
    	int arr[n][m];
    	for(int i=0;i<n;i++)
    	{
    		for(int j=0;j<m;j++)
    		{
    			scanf("%d",&arr[i][j]);
    		}
    	}

    	for(int i=1;i<n;i++)
    	{
    		for(int j=0;j<m;j++)
    		{
    			arr[i][j]+=arr[i-1][j];
    		}
    	}
    	for(int i=0;i<n;i++)
    	{
    		for(int j=1;j<m;j++)
    		{
    			arr[i][j]+=arr[i][j-1];
    		}
    	}
    	long long int countA=0;
    	for(int i=0;i<n;i++)
    	{
    		for(int j=i;j<n;j++)
    		{
    			int arr1[m];
    			for(int k1=0;k1<m;k1++)
    			{
    			  if(i!=0)
    			     arr1[k1]=arr[j][k1]-arr[i-1][k1];
    			  else
    				  arr1[k1]=arr[j][k1];
    			}
    			int tempQW=count(arr1,m,l,r)-count1(arr1,m,l,r);
                countA+=tempQW;
                //cout<<i<<" "<<j<<" "<<count(arr1,m,l,r)<<endl;
    		}
    	}
    	printf("%d\n",countA);
    }

    return 0;
}
