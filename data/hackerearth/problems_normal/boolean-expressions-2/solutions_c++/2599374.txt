#include<bits/stdc++.h>
using namespace std;
typedef long long int uli;
const int mx=310;
const uli mod=1000000009;
char s[mx],o[mx];
uli f[2][mx][mx];
int main(){
   scanf("%s %s",s,o);
   int n=strlen(s),q,l,r,x;
   for(int i=0;i<n;i++)f[s[i]-'0'][i][i]=1ll;
   for(int l=2;l<=n;l++){
      for(int i=0;i<=n-l;i++){
         int j=i+l-1;
         for(int k=i;k<j;k++){
            for(int b=0;b<2;b++)
            for(int c=0;c<2;c++)
            for(int d=0;d<2;d++){
               if(o[k]=='a')x=(c&d);
               else if(o[k]=='x') x=(c^d);
               else  x=(c|d);
               if(x==b){
                  uli inc=f[c][i][k]*f[d][k+1][j]%mod;
                  f[b][i][j]=(f[b][i][j]+inc)%mod;
               }
            }
         }
      }
   }
   scanf("%d",&q);
   char op[6];
   while(q--){
      scanf("%d %d %s",&l,&r,op);
      x=op[0]=='t'?1:0;
      printf("%lld\n",f[x][--l][--r]);
   }
   return 0;
}

