#include<bits/stdc++.h>
using namespace std;
vector<pair<int, int> > v[1005];
int dp[1005][4], n, m, f = 0;
int vis[1005] = {0};
int func(int in, int col)
{
	if(in == n) {
		f = 1;
		return 0;
	}
	if(col != -1 && dp[in][col] != -1)
		return dp[in][col];
	int i, j, k, l, tot = 99999999;
	l = v[in].size();
	for(i = 0; i < l; i++) {
		if(v[in][i].second != col && vis[v[in][i].first] == 0) {
			vis[v[in][i].first] = 1;
			tot = min(tot, 1+func(v[in][i].first, v[in][i].second));
			vis[v[in][i].first] = 0;
		}
	}
	if(col != -1) {
		dp[in][col] = tot;
		return dp[in][col];
	}else
		return tot;	
}

int main()
{
	int i, j, k ,l, x, y, c;
	scanf("%d%d", &n, &m);
	memset(dp, -1, sizeof(dp));
	for(i = 0; i < m; i++) {
		scanf("%d%d%d", &x, &y, &c);
		v[x].push_back(make_pair(y, c));
	}
	k = func(1, -1);
	if(f == 1) {
		printf("%d\n", func(1, -1));
	} else {
		printf("-1\n");
	}	
	return 0;
}