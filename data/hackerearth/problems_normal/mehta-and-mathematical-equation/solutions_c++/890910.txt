// iostream is too mainstream
#include <cstdio>
// bitch please
#include <iostream>
#include <vector>
#include <set>
#include <map>
#include <string>
#include <queue>
#include <stack>
#include <algorithm>
#include <iomanip>
#define dibs reserve
#define OVER9000 1234567890
#define patkan 9
#define tisic 47
#define soclose 10e-7
#define ALL_THE(CAKE,LIE) for(auto LIE =CAKE.begin(); LIE != CAKE.end(); LIE++)
#define chocolate win
#define ff first
#define ss second
#define abs(x) ((x < 0)?-(x):(x))
// mylittlepony
using namespace std;
	
int main() {
    cin.sync_with_stdio(0);
    int T;
    cin >> T;
    for(int t =0; t < T; t++) {
    	long long N, mod =1000000007;
    	cin >> N;
    	vector< vector<long long> > A(100,vector<long long>(4,0));
    	A[0][0] =1;
    	long long ans =0;
    	int C[4] ={1,3,3,1};
    	for(int i =0; i < 63; i++) {
    		int a =(N>>i)&1LL;
    		for(int j =0; j < 4; j++) for(int k =0; k < 4; k++) {
    			if(A[i][j] < 0) A[i][j] +=mod;
    			// k 1-tiek
    			if((a+(j%2)+k)%2 != 0) continue;
    			if(k == 3) {
    				// a+b+c+(j+k)/2=(N>>(i+1))
    				long long S =(N>>(i+1))-(j+k)/2;
    				if(S < 0) continue;
    				long long Q1 =(S%2 == 0)?(S/2+1)%mod:((S+2)%mod);
    				long long Q2 =(S%2 != 0)?((S+1)/2)%mod:((S+1)%mod);
    				Q1 =(Q1*Q2)%mod;
    				if(Q1 < 0) Q1 +=mod;
    				ans =(ans+A[i][j]*Q1)%mod;}
    			else A[i+1][(j+k)/2] =(A[i+1][(j+k)/2]+A[i][j]*C[k])%mod;}
    		}
    	cout << ans << "\n";}
    return 0;}
        
// look at my code
// my code is amazing