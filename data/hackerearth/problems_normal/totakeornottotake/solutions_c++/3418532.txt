#include<iostream>
using namespace std;

int main()
{
	int t;
	cin>>t;
	while(t--)
	{
		 long long int n,j=0,sum2=1,sum1=1,o,sum3=0;
		int arrr[55];
		char chr[55];
		cin>>n;
		o=n;
		while(n--)
		{
			cin>>chr[j];

			if(chr[j]=='N')
				{arrr[j]=0;

				}

			else
				cin>>arrr[j];
			j++;


		}
			j=0;
					
		while(o--)
		{//cout<<"lol";
			
			//getch();
			//cout<<"char[j]="<<chr[j]<<endl;
		

			if(chr[j]=='N'&&(sum1*(-1))>sum2)
			{	
				sum3+=sum1*(-1);
				sum1=0;
				sum2=0;

			}
			if(chr[j]=='N'&&(sum1*(-1))<=sum2)
			{	
				sum3+=sum2;
				sum2=0;
				sum1=0;

			}
			
			if(chr[j]=='-')
			{
			
				sum1=sum1-arrr[j];
			}

			if(chr[j]=='+')
			{
				sum2=sum2+arrr[j];
			}

			if(chr[j]=='*')
			{
				sum1=(sum1)*arrr[j];
				sum2=(sum2)*arrr[j];
				sum3=(sum3)*arrr[j];
			}
			if(chr[j]=='/'&&sum1>-1)
			{
				sum1=(sum1)/arrr[j];
			}
			

			//cout<<"sum1="<<sum1<<endl<<"sum2="<<sum2<<endl<<"sum3="<<sum3<<endl;
			//if(flag==1&&chr[j]=='N')
			//	{sum1=sum1-2; flag=-1;}
			j++;
		}
		cout<<sum3+sum2<<endl;
	}
	return 0;
}