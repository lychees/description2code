#include<cstdio>
#include<iostream>
#include<algorithm>
#include<string>
#include<cstring>
using namespace std;
string s;
int main()
{
int i,n,t,j,last_a,last_b,last_c,k;
unsigned long long int x;
scanf("%d\n",&t);
while(t--)
{
cin>>s;
x=s.size();
last_a=last_b=last_c=0;
bool vis[4];
memset(vis,0,3*sizeof(bool));
for(i=0;i<s.size();i++)
{
    if(s[i]=='a')
    {

        if((!vis[1])||(!vis[2]))
        {
            x+=i;
        }
        else
        {
            k=i-min(last_b,last_c)-1;
         x+=k;

        }
        last_a=i;
        vis[0]=1;
    }
    else if(s[i]=='b')
    {

         if((!vis[0])||(!vis[2]))
        {
            x+=i;
        }
        else
        {
        k=i-min(last_a,last_c)-1;
            x+=k;
        }
        last_b=i;
        vis[1]=1;
    }
    else{

         if((!vis[0])||(!vis[1]))
        {
            x+=i;
        }
        else
        {
            k=i-min(last_a,last_b)-1;
            x+=k;
        }
        last_c=i;
        vis[2]=1;
    }
}

printf("%llu\n",x);
}
return 0;
}
