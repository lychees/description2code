#include <iostream>
#include <cstdio>
#include <vector>
#include <algorithm>
#define MAXN 100005

using namespace std;

vector<int> roditelj(MAXN),dubina(MAXN),lider(MAXN);

void setuj()
{
    for(int i=0;i<MAXN;i++)
    {
        roditelj[i]=i;
        dubina[i]=0;
        lider[i]=i+1;
    }
}

int pronadi(int cvor)
{
    if(roditelj[cvor]==cvor)return cvor;
    else
    {
        int proba = pronadi(roditelj[cvor]);
        roditelj[cvor] = proba;
        return proba;
    }
}


void spoji(int a,int b)
{
    int roditelja = pronadi(a);
    int roditeljb = pronadi(b);
    if(roditelja==roditeljb)return;

    if(dubina[roditelja]>=dubina[roditeljb])
    {
        roditelj[roditeljb] = roditelj[a];
        if(dubina[roditelja]==dubina[roditeljb])
            dubina[roditelja]++;
        lider[roditelja] = lider[roditeljb];
    }
    else
        roditelj[roditelja]=roditeljb;
}

int main()
{
    setuj();
    int n,m; cin >> n >> m;
    for(int i=0;i<m;i++)
    {
        int u,a,b;
        scanf("%d",&u);
        if(u==1)
        {
            scanf("%d%d",&a,&b);
            a--;b--;
            spoji(a,b);
        }
        else if(u==2)
        {
            scanf("%d",&a); a--;
            lider[pronadi(a)] = a+1;
        }
        else if(u==3)
        {
            scanf("%d",&a); a--;
            printf("%d\n",lider[pronadi(a)]);
        }
    }

    return 0;
}
