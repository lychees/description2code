#include <bits/stdc++.h>
#define MOD 1000000009
using namespace std;
int main(){
string s, op;
cin>>s>>op;
long long t_count[s.size()+1][s.size()+1];
long long f_count[s.size()+1][s.size()+1];
for(int i=0; i<s.size(); i++){
    fill(t_count[i], t_count[i]+s.size()+1, 0);
	fill(f_count[i], f_count[i]+s.size()+1, 0);
    bool x= (s[i] == '1');
    if(x){
		t_count[i][i]++;
	}else{
		f_count[i][i]++;
	}
}

for(int l=2; l<=s.size(); l++){
	for(int i=0; i<=s.size()-l; i++){
		int j=i+l-1;
		unsigned long long  t=0, f=0;
		for(int k=i; k<j; k++){

			///calculate true
				if(op[k]=='a'){
					t  = (t + (t_count[i][k] * t_count[k+1][j])%MOD)%MOD;
				}else if(op[k] == 'o'){
					t  = (t + (t_count[i][k] * t_count[k+1][j])%MOD+(f_count[i][k]*t_count[k+1][j])%MOD+(t_count[i][k]*f_count[k+1][j])%MOD)%MOD;
				}else if(op[k]=='x'){
					t  = (t + (t_count[i][k]*f_count[k+1][j])%MOD+(f_count[i][k]*t_count[k+1][j])%MOD)%MOD;
				}

			///calculate false
				if(op[k]=='a'){
					f = (f + (f_count[i][k]*t_count[k+1][j])%MOD+(t_count[i][k]*f_count[k+1][j])%MOD+(f_count[i][k]*f_count[k+1][j])%MOD)%MOD;
				}else if(op[k] == 'o'){
					f = (f +  (f_count[i][k]*f_count[k+1][j])%MOD)%MOD;
				}else if(op[k]=='x'){
					f = (f +(f_count[i][k]*f_count[k+1][j])%MOD+(t_count[i][k]*t_count[k+1][j])%MOD)%MOD;
				}

		}
		t_count[i][j] = t;
		f_count[i][j]=f;
	}
}
int q, l, r;
string res;
cin>>q;
for(int i=0; i<q; i++){
	cin>>l>>r>>res;
	if(res=="true"){
        printf("%lld\n", t_count[l-1][r-1]);
	}else{
		printf("%lld\n", f_count[l-1][r-1]);
	}
}
}
