#include <iostream>
using namespace std;
typedef long long int lli;
int main()
{
	   lli n,m,q,i,j,a;
	   cin>>n>>m>>q;
	   lli arr[100005];
    	lli arrf[100005];
    	lli arrr[100005];
    	lli fsum=1,y;
    	for(i=0;i<n;i++)
    	{
    		cin>>arr[i];
       }
    	lli sum,z;
    	lli store[100005];
    	sum=1;
    	for(i=0;i<n;i++)
   		{
   			
   				z=arr[i]%m;
   		sum=(sum*z)%m;
   			arrf[i]=sum;
   			
   		}
    sum=1;
    for(i=n-1;i>=0;i--)
   		{
   			
   				z=arr[i]%m;
   		sum=(sum*z)%m;
   			arrr[i]=sum;
   			
   		}
    	lli fck;
    	while(q--)
    	{
    		cin>>a;
    		if(a==1)
    			cout<<arrr[1]<<endl;
    		else if(a==n)
    			cout<<arrf[n-2]<<endl;
    		else
    		{	fck=(arrr[a]*arrf[a-2])%m;
    		
    		cout<<fck<<endl;
    		}
    		
    	}
    return 0;
}
