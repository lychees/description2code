#define lli long long int
#define INF 1000000007
#include <iostream>
#include <bits/stdc++.h>
using namespace std;

long long int row[201];
long long int col[201];
lli rs[401],cs[401];

void adjust(long long int a[],int n){
	lli temp=a[0];
	//cout<<"\nvalue of temp was set to"<<temp<<"\n";
	int i=0;
	while(i+1<n&&temp>a[i+1]){
		a[i]=a[i+1];
		i++;
	}
	a[i]=temp;
}

int main()
{
	
ios_base::sync_with_stdio(0);cin.tie(0);
int t;
cin>>t;
while(t--){
	memset(row,0,sizeof(row));
	memset(col,0,sizeof(col));
	memset(rs,0,sizeof(rs));
	memset(cs,0,sizeof(cs));
	int n;int k;
	cin>>n>>k;
	for(int i=0;i<n;i++)
	for(int j=0;j<n;j++){
		int temp;
		cin>>temp;
		row[i]+=temp;
		col[j]+=temp;
	}
	sort(row,row+n);
	sort(col,col+n);
	int acol=0,arow=0;
	lli ans=INF;
	for(int i=1;i<=k;i++){
	cs[i]=cs[i-1]+col[0];
	col[0]+=n;
	adjust(col,n);
	rs[i]=rs[i-1]+row[0];
	row[0]+=n;
	adjust(row,n);
}
for(int i=0;i<=k;i++){
	ans=min(ans,rs[i]+cs[k-i]+i*(k-i));
}
cout<<ans<<"\n";
}
return 0;
}