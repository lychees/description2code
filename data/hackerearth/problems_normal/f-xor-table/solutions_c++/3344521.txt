#include <bits/stdc++.h>
using namespace std;

#define ll long long int
#define vi vector<ll>
#define vvi vector<vi>
#define pb push_back
#define forn(i,n) for( i = 0; i < n; i++ )
#define s(n) scanf("%lld",&n);
vi v;
ll i, j, t, n, m, p, x;

int main()
{
	s(t);
	while( t-- )
	{
		s(n);s(m);s(p);s(x);
		string str;
		cin >> str;
		
		if( n != 1 ){
        
			v.clear();
			ll log_2, val, base;
			base = n - 1;
			v.pb(base);
			if( base > 0 )
			{
				while( base > 0 )
				{
					log_2 = log2(base);
					val = pow( 2, log_2 );
					v.pb(base - val);
					base -= val;
				}
			}
			sort(v.begin(),v.end());
			ll idx;
			string ans;
			
			for( i = 0; i < v.size() - 1; i++ )
			{
				ans = str;
				for( j = 0; j < str.length(); j++ ){
					idx = ( j - ( (v[i+1]-v[i]) * p ) % m + m ) % m;

					ans[j] = ( ( str[j] - '0' ) ^ x  ^ ( str[idx] - '0' ) ) + '0';
				}
				str = ans;
			}
		}
		
		cout << str << endl;
	 }
    return 0;
}