#include <iostream>
#include <climits>
using namespace std;
long long int maxi;

long long int traverse(int a[],int i,int n)
{
	
	
if(i>n)
  return 0;
 long long int l= traverse(a,2*i,n);
  long long int r= traverse(a,2*i+1,n);
  maxi=max(maxi,a[i]+l+r);
return max(a[i]+l,a[i]+r)  ;
	
	
	
}


int main()
{
    
    
    int t;
    cin>>t;
    while(t--)
    {
    int n;cin>>n;
    int a[n+1];
    for(int i=1;i<=n;i++)
    cin>>a[i];
    maxi=INT_MIN;
    traverse(a,1,n);
    cout<<maxi<<endl;
    
    
    }
    
    
    
    
    
    
    
}
