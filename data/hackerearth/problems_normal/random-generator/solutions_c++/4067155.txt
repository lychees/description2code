#include <bits/stdc++.h>
#define ll long long
using namespace std;
ll search(ll a[],ll i,ll n,ll xx)
{	ll low,high,mid;
	if(xx>=a[n-1])	return n-1;
	low=i;
	high=n-1;
	mid=(high+low)/2;
	while(low!=high)
	{
		if(a[mid]<xx)
		{
			if(a[mid+1]>xx)	return mid;
			low=mid;
			mid=(high+low)/2;
		}
		else if(a[mid]>xx)
		{
			high=mid;
			mid=(high+low)/2;
		}
		else
		{
			if(a[mid]!=a[mid+1])
				return mid;
			mid++;
		}
	}
	return low;	
}
int main()
{
	int t;
	cin>>t;
	while(t--)
	{
		ll n,k,p,j,xx,temp;
		int flag=0;
		cin>>n>>k>>p;
		ll a[n];
		for(ll i=0;i<n;i++)
			cin>>a[i];
		sort(a,a+n);
		for(ll i=0;i<n-1;i++)
		{
			xx=a[i]+(2*p);
			temp=search(a,i,n,xx);
			if(temp-i+1>=k)
			{	flag=1;	break; }
		}
		if(flag==1)	cout<<"NO"<<endl;
		else	cout<<"YES"<<endl;
	}
}
