#include<iostream>
//#include<conio.h>
#include<cmath>
using namespace std;
 long long int maxx=-9999999,q=1,n;
long long int recurse(long long int a[],long long int pos)
  {  long long int xx,yy;
                if(pos>=q&&pos<=n)
                { if(a[pos]>maxx)
                    { maxx=a[pos];
                    }
                     return a[pos];
                }
                
              
           xx=a[pos]+recurse(a,pos*2);
           yy=a[pos]+recurse(a,(pos*2)+1);
         //  cout<<xx<<endl<<yy<<endl;
             if((xx+yy-a[pos])>maxx)
              { maxx=xx+yy-a[pos];
              }
              
              
           if(xx>=yy)
            {  return xx;
              }
          
           return yy;
           }
                     

int main()
{ long long int t,i,x,w,vaishu,a[4000];
    cin>>t;
    while(t--)
     { cin>>n;
      maxx=-9999999;
        for(i=1;i<=n;i++)
         { cin>>a[i];
         }
       x=n+1;
        w=0;
       while(x>2)
         { x=x/2;
           w++;
           }
         
       
       q=1;
       for(i=1;i<=w;i++)
         { q=q*2;
         }
        // cout<<q<<endl;
        vaishu=recurse(a,1);
        cout<<maxx<<endl;
        }
       // getch();
       return 0;
        }
           
        
