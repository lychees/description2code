#include <bits/stdc++.h>
#define PB push_back 
#define INF 1919
using namespace std;
long long int mat[200][200],n,m;
int main()
{
	int t;
	cin>>t;
	while(t--){
		cin>>n>>m;
		vector< long long int > save[200][200];
		for(int i=0;i<n;i++)
		for(int j=0;j<m;j++){
			char s[10];
			cin>>s;
			if(s[0]=='#')
			mat[i][j]=INF;
			else
			mat[i][j]=atoi(s);
		}
		if(mat[0][0]!=INF)save[0][0].PB(mat[0][0]);
		
		for(int i=1;i<n;i++)
		if(mat[i][0]!=INF  && save[i-1][0].size()>0)
		save[i][0].PB(save[i-1][0][0]+mat[i][0]);
		
		for(int i=1;i<m;i++)
		if(mat[0][i]!=INF && save[0][i-1].size()>0)
		save[0][i].PB(save[0][i-1][0]+mat[0][i]);
 
		for(int i=1;i<n;i++){
			for(int j=1;j<m;j++)
				if(mat[i][j]!=INF){
					int s1=save[i-1][j].size(),s2=save[i][j-1].size();
					int i1=0,i2=0,cnt=0;
					while(cnt!=101 && (i1<s1 ||i2<s2)){
						if(i1==s1)
							save[i][j].PB(mat[i][j]+save[i][j-1][i2++]);
						else if(i2==s2)
							save[i][j].PB(mat[i][j]+save[i-1][j][i1++]);
						else{
							if(save[i-1][j][i1]>save[i][j-1][i2])
							save[i][j].PB(mat[i][j]+save[i][j-1][i2++]);
							else
							save[i][j].PB(mat[i][j]+save[i-1][j][i1++]);
						}
						cnt++;
					}
 
				}
			}
		int q;
		cin>>q;
		while(q--){
			int x,y,k;
			cin>>x>>y>>k;
			if(mat[x][y]>=INF)
			cout<<"Obstacle\n";
			else if(k>save[x][y].size() || k>101)
			cout<<"Not so many paths\n";
			else
			cout<<save[x][y][k-1]<<endl;
		}
		
	}
	
    return 0;
}