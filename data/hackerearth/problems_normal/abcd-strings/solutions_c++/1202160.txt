#include <bits/stdc++.h>

#define REP(i, a) for (int i = 0; i < (int) (a); i ++)
#define REPP(i, a, b) for (int i = (int) (a); i <= (int) (b); i ++)
#define MST(a, b) memset(a, b, sizeof(a))

using namespace std;

const int C = 4;
const int N = 155;
const int MOD = 1e9 + 7;

void add(int &x, int y) {
	x += y;
	if (x >= MOD) x -= MOD;
}

struct Matrix{
	int v[N][N];

	Matrix() {MST(v, 0);}
	Matrix(bool ident) {
		MST(v, 0);
		if (ident) {
			REP(i, N) v[i][i] = 1;
		}
	}

	int * operator [] (int i) {
		return v[i];
	}

	const int * operator [] (int i) const {
		return v[i];
	}
};

Matrix mul(const Matrix &a, const Matrix &b, int n) {
	Matrix ans;
	REP(i, n) REP(j, n) REP(k, n) {
		add(ans[i][j], 1LL * a[i][k] * b[k][j] % MOD);
	}
	return ans;
}

Matrix pow_mod(Matrix a, long long b, int n) {
	Matrix ans(1);
	while (b) {
		if (b & 1) ans = mul(ans, a, n);
		b >>= 1;
		a = mul(a, a, n);
	}
	return ans;
}

struct AC_Automation{
	int tr[N][C], fail[N], val[N], node;

	int New_Node() {
		MST(tr[node], 0);
		fail[node] = val[node] = 0;
		return node++;
	}
	
	void init() {
		node = 0;
		New_Node();
	}

	void insert(char *s) {
		int pos = 0, now = 0;
		while (s[pos]) {
			int x = s[pos++] - 'a';
			if (!tr[now][x]) {
				tr[now][x] = New_Node();
				val[tr[now][x]] = val[now];
			}
			now = tr[now][x];
		}
		val[now] = 1;
	}

	void getfail() {
		queue<int> q;

		REP(i, C) {
			if (tr[0][i]) {
				fail[tr[0][i]] = 0;
				q.push(tr[0][i]);
			}
		}

		while (q.size()) {
			int x = q.front(); q.pop();
			REP(i, C) {
				int &y = tr[x][i];
				if (!y) {
					y = tr[fail[x]][i];
					continue;
				}
				q.push(y);
				fail[y] = tr[fail[x]][i];
				val[y] |= val[fail[y]];
			}
		}
	}

	void getMatrix(Matrix &fun) {
		REP(i, node) {
			if (!val[i]) {
				REP(j, C) {
					if (!val[tr[i][j]]) {
						fun[i][tr[i][j]]++;
					}
				}
			}
		}
	}
}AC;

char s[N];

int main() {
	int t, m;
	long long n;

	cin >> t;
	while (t--) {
		cin >> n >> m;
		AC.init();
		REP(i, m) {
			cin >> s;
			AC.insert(s);
		}
		int node = AC.node;
		Matrix func, ans;
		AC.getfail();
		AC.getMatrix(func);
		ans[0][0] = 1;
		ans = mul(ans, pow_mod(func, n, node), node);
		int answer = 0;
		REP(i, node) {
			add(answer, ans[0][i]);
		}
		cout << answer << endl;
	}
	return 0;
}
