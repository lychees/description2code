// adijimmy
#include <bits/stdc++.h>
using namespace std;

typedef long long int ll;
typedef pair<int,int> PII;
typedef vector<int> VI;
typedef vector<vector<int> > VVI;
const int mod = 1e9+9;
const int INF = 1e9+9;

#define pb push_back
#define mp make_pair
#define F first
#define S second

#define CLR(a,x) memset(a,x,sizeof (a));
#define rep(i,n) for(int i=0;i<n;i++)
#define repi(i,n) for(int i=n-1;i>=0;i--)
#define fr(i,a,b) for(int i=a;i<=b;i++)
#define bk(i,a,b) for(int i=b;i>=a;i--)

#define gi(n) scanf("%d",&n);
#define gl(n) scanf("%lld",&n);
#define ps printf(" ");
#define pn printf("\n");
#define pi(n) printf("%d",n);
#define pl(n) printf("%lld",n);

char s[405];
char op[405];
char res[15];
vector<ll> arr;
ll F[405][405], T[405][405],n;
void solve(){
    for(ll i = 0; i < n; i++){
        F[i][i] = (arr[i] == 0)? 1: 0;
        T[i][i] = (arr[i] == 1)? 1: 0;
    }
    for(ll gap=1; gap<n; ++gap){
        for(ll i=0, j=gap; j<n; ++i, ++j){
            T[i][j] = F[i][j] = 0;
            for(ll g=0; g<gap; g++){
                ll k = i + g;
                ll tik = (T[i][k]+F[i][k])%mod;
                ll tkj = (T[k+1][j]+F[k+1][j])%mod;
                if(op[k] == 'a'){
                    T[i][j] = (T[i][j]+(T[i][k]*T[k+1][j])%mod)%mod;
                    F[i][j] = (F[i][j]+((((tik*tkj)%mod)-((T[i][k]*T[k+1][j])%mod)+mod)%mod))%mod;
                }
                if(op[k] == 'o'){
                    F[i][j] = (F[i][j]+((F[i][k]*F[k+1][j])%mod))%mod;
                    T[i][j] = ( T[i][j]+ ( (((tik*tkj)%mod) - ((F[i][k]*F[k+1][j])%mod)+mod)%mod) )%mod;
                }
                if(op[k] == 'x'){
                    T[i][j] = (T[i][j]+(((F[i][k]*T[k+1][j])%mod) + ((T[i][k]*F[k+1][j])%mod))%mod)%mod;
                    F[i][j] = (F[i][j]+((((T[i][k]*T[k+1][j])%mod) + ((F[i][k]*F[k+1][j])%mod))%mod))%mod;
                }
            }
        }
    }
}
int main(){
ll q,l,r;
scanf("%s %s",s,op);
scanf("%lld",&q);
for(ll i=0;i<strlen(s);i++){
   ll a = s[i]-'0';
   arr.pb(a);
}
n = arr.size();
solve();
while(q--){
  scanf("%lld %lld %s",&l,&r,res);
  l--;r--;
  if(res[0] == 't'){
    printf("%lld\n",T[l][r]);
  }else{
    printf("%lld\n",F[l][r]);
  }
}
return 0;
}
