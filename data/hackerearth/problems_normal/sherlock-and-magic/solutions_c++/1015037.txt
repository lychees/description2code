#include<bits/stdc++.h>
using namespace std;
int main()
{
	int t;
	int x[55],y[55];
	cin>>t;
	while(t--)
	{
		int n,ans=0;
		cin>>n;		
		char str[55];
		bool vanished[55]={false};
		for(int i=0;i<n;i++)
		{
			scanf("%d %d",&x[i],&y[i]);
			cin>>str[i];
		}
		
		for(int k=0;k<2001;k++)
		{
			for(int i=0;i<n;i++)
			{
				if(vanished[i]==false)
				{
					if(str[i]=='E')
					{
						for(int j=0;j<n;j++)
						{
							if(i!=j && vanished[j]==false)
							{
								if(str[j]=='W' && x[i]+1==x[j] && y[j]==y[i])
								{
									vanished[i]=true;
									vanished[j]=true;
									//cout<<"vanished ones are="<<i<<" AND "<<j<<"AT TIME="<<k<<endl;
								}
							}						
						}
					}
					else if(str[i]=='W')
					{
						for(int j=0;j<n;j++)
						{
							if(i!=j && vanished[j]==false)
							{
								if(str[j]=='E' && x[i]==x[j]+1 && y[j]==y[i])
								{
									vanished[i]=true;
									vanished[j]=true;
									//cout<<"vanished ones are="<<i<<" AND "<<j<<"AT TIME="<<k<<endl;
								}
							}						
						}
					}
					else if(str[i]=='N')
					{
						for(int j=0;j<n;j++)
						{
							if(i!=j && vanished[j]==false)
							{
								if(str[j]=='S' && x[i]==x[j] && y[i]+1==y[j])
								{
									vanished[i]=true;vanished[j]=true;
									//cout<<"vanished ones are="<<i<<" AND "<<j<<"AT TIME="<<k<<endl;
								}
							}
						}
					}
					else
					{
						for(int j=0;j<n;j++)
						{
							if(i!=j && vanished[j]==false)
							{
								if(str[j]=='N' && x[i]==x[j] && y[j]+1==y[i])
								{
									vanished[i]=true;vanished[j]=true;
									//cout<<"vanished ones are="<<i<<" AND "<<j<<"AT TIME="<<k<<endl;
								}
							}
						}
					}
				}
			}
			for(int i=0;i<n;i++)
			{
				if(str[i]=='N')y[i]++;
				else if(str[i]=='S')y[i]--;
				else if(str[i]=='W')x[i]--;
				else if(str[i]=='E')x[i]++;				
			}
			for(int i=0;i<n;i++)
			{
				if(vanished[i]==false)
				{
					for(int j=0;j<n;j+=1)
					{
						if(i!=j)
						{
							if(vanished[j]==false && x[i]==x[j] && y[i]==y[j])
							{
								vanished[i]=true; vanished[j]=true;
							//cout<<"vanished ones are="<<i<<" AND "<<j<<"AT TIME="<<k<<endl;
							}
						}
					}
				}
			}
		}
		for(int i=0;i<n;i++)
		{
			if(vanished[i]==false)ans+=1;
		}
		printf("%d\n",ans);
	}
}