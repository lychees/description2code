#include<bits/stdc++.h>
using namespace std;
bool isprime[5000005];
int main(){
        int t;
        int i,j;
        isprime[1] = 1;
        for(i=2;i<3000;i++){
                if(!isprime[i])
                for(j=i*i;j<5000000;j+=i){
                        isprime[j] = 1;
                }
        }
        scanf("%d",&t);
        while(t--){
                long long a,b,ans = 0;
                scanf("%lld%lld",&a,&b);
                while(1){
                        if(a==b){
                                if(isprime[a]==1){
                                        ans +=a;
                                }else{
                                        ans -=a;
                                }
                                break;
                        }
                        if(b>a){
                                if(isprime[b]==1){
                                        ans += b;
                                }else{
                                        ans -=b;
                                }
                                b = b/2;
                        }else if(a>b){
                                if(isprime[a]==1){
                                        ans +=a;
                                }else{
                                        ans-=a;
                                }
                                a = a/2;
                        }
                        //printf("a=%lld b=%lld ans=%lld\n",a,b,ans);
                }
                printf("%lld\n",ans);
        }
        return 0;
}
