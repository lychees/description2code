#include<cstdio>
#include<iostream>
#include<algorithm>
#include<cstring>
#include<cmath>
#include<cstdlib>
#include<map>
#include<ctime>
using namespace std;
const long long modul=1000000007;
long long n,sol,q,t,f,k,dist,br,pr,w,pok,p,pomoc,y,koren;
__int128 niz[100];
__int128 step (__int128 e, __int128 x,__int128 modul)
{
    __int128 s;
    if (x==0)return 1;
    else
    {
        s=step(e,x/2,modul);
        s=s*s;
        s%=modul;
        if (x%2==1){s*=e;s%=modul;}
        return s;
    }
}
bool check(__int128 x)
{

    for (int i=1;i<=15;i++)
    {
        __int128 br=niz[i];
        if (br>=x)continue;
        __int128 res=step(br,x-1,x);
        if (res!=1)return 0;
    }
    return 1;
}
int main()
{
    ios_base::sync_with_stdio(false);
	cin.tie(NULL);
	srand (time(NULL));
	niz[1]=2;niz[3]=31;niz[5]=5;niz[7]=61;niz[9]=23;niz[11]=11;niz[13]=37;niz[14]=19;
    niz[2]=3;niz[4]=73;niz[6]=7;niz[8]=13;niz[10]=1662803;niz[12]=17;niz[15]=29;


    scanf("%lld %lld",&n,&q);

    pok=1;
    while(q--)
    {
        scanf("%lld %lld %lld",&t,&f,&k);
        if  (t==1)
        {
                bool h=check(f+k);
                if (h==true)
                {
                    sol+=k;
                    dist+=abs(pok-f);
                    dist%=modul;
                    pok=f;
                }
        }
        if (t==2)
        {
            br=f+k;
            koren=sqrt(br);
            if (koren*koren==br)
            {
                sol-=k;
                dist+=abs(pok-f);
                dist%=modul;
                pok=f;
            }
        }

    }
    printf("%lld %lld\n",dist,sol);
    return 0;
}