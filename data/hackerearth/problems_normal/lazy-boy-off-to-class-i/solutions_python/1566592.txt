t=input()
while t:
	t-=1
	an=[]
	for x in range(7):
		s=map(int,raw_input().split())
		y=1
		while y<len(s):
			an.append(s[y+1]-s[y])
			y+=2
	an=sorted(an)
	x=0
	ans=0
	while x<3.0*len(an)/4:
		ans+=an[x]
		x+=1
	print 604800-ans