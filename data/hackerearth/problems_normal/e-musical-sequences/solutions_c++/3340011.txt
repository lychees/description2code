/*    SHUBHAM SINHA    */



#include <cstdio>
#include <iostream>
#include <algorithm>
#include <string.h>
#include <vector>
#include <set>
#include <map>
#include <queue>
#include <list>
#include <math.h>

#define ll long long int
#define maxN 100000
#define maxVal 1e8
#define minVal -1e8
#define mod 1e9+7

#define gcd(a,b) __gcd(a,b)

using namespace std;

ll a[10*maxN+5];
ll b[10*maxN+5];

int main()
{
    ios_base::sync_with_stdio(false);
    cin.tie(NULL);
    #ifndef ONLINE_JUDGE
    	freopen("in.txt","r",stdin);
    #endif
	ll t,n,m,z,i,j,k,c,flag,sum;
	scanf("%lld",&t);
	while(t--)
	{
		scanf("%lld%lld%lld",&n,&m,&z);
		for(i=0;i<n;i++)
		{
			scanf("%lld",&a[i]);
			b[i]=a[i];
		}
		sum=0;
		c=1;
		for(i=n-1;i>=0;i--)
		{
			sum=sum+c*a[i];
			c=c*(-1);
		}
		sum=sum%m;
		if(sum<0)
			sum=sum+m;
		a[n]=sum;
		sum=((ll)pow(-1,n+1)*a[0])%m;
		if(sum<0)
			sum=sum+m;
		i=n;
		k=0;
		while(true)
		{
			if(a[i]==b[k])
			{
				flag=1;
				while(k<n)
				{
					i++;
					k++;
					if(k==n)
						break;
					a[i]=sum;
					sum=((ll)pow(-1,n+1)*a[i-n])%m;
					if(sum<0)
						sum=sum+m;
					if(a[i]!=b[k])
					{
						flag=0;
						break;
					}
				}
				if(flag==1)
				{
					n=i-n;
					break;
				}
			}
			i++;
			a[i]=sum;
			sum=((ll)pow(-1,n+1)*a[i-n])%m;
			if(sum<0)
				sum=sum+m;
		}
		z=z%n;
		printf("%lld\n",a[z]);
	}
    return 0;
}