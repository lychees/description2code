#include<bits/stdc++.h>
using namespace std;
#define MD 1000000007

#define ll long long

ll mul ( ll p[][5], ll q[][5]) {
	ll r[5][5];
	for (int i = 0; i < 5; i++) {
		for (int j = 0; j < 5; j++) {
			r[i][j] = 0;
		}
	}
	for ( int i = 0; i < 5; i++ ){
		for ( int j = 0; j < 5; j++ ){
			for ( int k = 0; k < 5; k++ ){
				r[i][j]=(r[i][j]+p[i][k]*q[k][j])%MD;
			}
		}	
	}
	for ( int i = 0; i < 5; i++ ){
		for ( int j = 0; j < 5; j++ )
		p[i][j] = r[i][j];
	}
}
void power ( int n, ll x[][5], ll y[][5]){
	while ( n ){
		if ( n%2 )
		{
			mul(y,x);
		}
		mul(x,x);
		n/=2;
	}
}
void f ( ll p[], int n ){
	if ( n < 5 ) {
		cout << p[n] << endl;
		return;
	}
	ll q[5][5], i,r[5][5];
	for (int i = 0; i < 5; i++) {
		for (int j = 0; j < 5; j++) {
			r[i][j] = 0;
		}
	}
	for (int i = 0; i < 5; i++) {
		for (int j = 0; j < 5; j++) {
			q[i][j] = 0;
		}
	}
	q[4][4] = 1;
	q[4][1]=2;
	q[4][0]= 1;
	q[4][3]= 1;
	q[4][2]= 1;
	
	for(i=0;i<5;i++) {
		r[i][i]=1;
	}
	for ( i = 0; i < 4; i++ ){
		q[i][i+1]=1;
	}
	n-=4;
	power(n,q,r);
	ll answer = 0;
	for (int i = 0; i < 5; i++ )
	{
		answer  = (answer + r[4][i]*p[i])%MD;
	}
	cout << answer <<endl;
}
int main()
{
	int t, n;
	cin >> t;
	while ( t-- ){
		ll p[5];
			for (int i = 0; i < 5; i++ ) {
		  scanf("%lld",&p[i]);
		}
		cin >> n;
		f(p,n);
	}
    //cout << "Hello World!" << endl;
    return 0;
}