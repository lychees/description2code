#pragma comment(linker, "/STACK:1024000000,1024000000") 
#include <iostream>
#include <stdio.h>
#include <algorithm>
#include <string.h>
#include <vector>
#include <map>
#include <queue>
#include <set>
#include <assert.h>
#include <cmath>
#define x first 
#define y second 
#define pb push_back 
#define mp make_pair 
#define vi vector<int> 
#define pii pair<int,int> 
#define ll long long 
#define ull unsigned long long 
#define inf 1000000007 
#define mod 1000000007 
#define all(x) x.begin(),x.end() 
#define N 100010
#define pi acos(-1.)
#define DBG(x) cerr<<#x<<"="<<x<<"\n"; 
#define FOREACH(it,x) for(__typeof(x.begin()) it=x.begin();it!=x.end();it++) 
using namespace std;

int f[N],h[N],v[N],p[N];
void upd(int x,int v,int f[]){
    while(x>0)f[x]+=v,x-=x&-x;
}
int query(int x,int f[]){
    int ans=0;
    while(x<N)ans+=f[x],x+=x&-x;
    return ans;
}
int main()
{
    //clock_t start=clock();
    int T,i,j,k,ca=0,n,m;
    p[0]=1;
    for(i=1;i<N;i++)p[i]=p[i-1]*2LL%mod;
    scanf("%d",&n);
    ll ans=0;ll one=0,two=0;
    for(i=0;i<n*2;i++){
        scanf("%d",&j);
        ll a=query(j+1,f);
        ans+=2*a*p[n-2]%mod;
        if(v[j])ans+=(one-1)*p[n-2]%mod+p[n-1];
        else ans+=one*p[n-2]%mod;
        a=query(j+1,h);
        //DBG(two)
        ans+=4LL*a*p[n-2]%mod;
        ans+=2*two*p[n-2]%mod;
        if(v[j])upd(j,-1,f),v[j]=0,upd(j,1,h),one--,two++;
        else v[j]=1,upd(j,1,f),one++;
    }
    printf("%d\n",(int)(ans%mod));
    return 0;
}