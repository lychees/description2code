#include <iostream>
#include <algorithm>
using namespace std;

int main()
{
	int t;
	cin>>t;
	while(t--) {
		int n, k, i;
		long long p;
		int array[100001];
		cin>>n>>k>>p;
		for(i = 0; i < n; i++)
			cin>>array[i];
		sort(array, array + n);
		p = 2 * p;
		int count = 1, index = 0;
		bool value = true;
		for(i = 1; i < n; i++) {
			count++;
			if(array[i] - array[index] <= p) {
				if(count >= k) {
					cout<<"NO"<<endl;
					value = false;
					break;
				}
			} else {
				while(array[i] - array[index] > p)
				{
					count--;
					index++;
				}
			}
		}
		if(value)
			cout<<"YES"<<endl;
	}
    return 0;
}
