P=10**9+7
N = int(raw_input())
A = map(int, raw_input().split())
E = (N-1)%(P-1) -1
if E<0: E += P-1
Z = pow(2,E,P)
Y =sum( i*( (ix+2) ) for ix,i in enumerate(A) )

print Y*Z %P