for t in xrange(int(raw_input())):
	n=int(raw_input())
	c=[0]
	l=[]
	for x in xrange(n):
		temp=raw_input()
		l.append(temp)
		c.append(c[-1]+temp.count('#'))
	d=[0]
	for x in xrange(n):
		temp=0
		for y in xrange(n):
			if (l[y][x]=='#'):
				temp+=1
		d.append(d[-1]+temp)
	total=c[-1]
	if (total%2==1):
		print "NO"
	else:
		half=total/2
		if (half in c or half in d):
			print "YES"
		else:
			print "NO"
		
	