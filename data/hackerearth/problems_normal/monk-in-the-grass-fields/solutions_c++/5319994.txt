#include<bits/stdc++.h>
using namespace std;

int main()
{
	ios_base::sync_with_stdio(false);
	int t;
	cin >> t;
	while(t--)
	{
		int n,k;
		cin >> n >> k;
		
		int mat[n][n];
		for(int i=0;i<n;i++)
			for(int j=0;j<n;j++)
				cin >> mat[i][j];
		
		int sumr[n],sumc[n];
		memset(sumr,0,sizeof(sumr));
		memset(sumc,0,sizeof(sumc));
		
		for(int i=0;i<n;i++)
		{
			for(int j=0;j<n;j++)
			{
				sumr[i]+=mat[i][j];
				sumc[j]+=mat[i][j];
			}
		}
		
		priority_queue<int,vector<int>,greater<int> > rows,cols;
		for(int i=0;i<n;i++)
		{
			rows.push(sumr[i]);
			cols.push(sumc[i]);
		}
		
		int solr[k+1],solc[k+1];
		solr[0]=0;
		solc[0]=0;
		for(int i=1;i<=k;i++)
		{
			int val1=rows.top();
			rows.pop();
			int val2=cols.top();
			cols.pop();
			solr[i]=solr[i-1]+val1;
			solc[i]=solc[i-1]+val2;
			rows.push(val1+n);
			cols.push(val2+n);
		}
		int ans=INT_MAX;
		for(int i=0;i<=k;i++)
		{
			ans=min(ans,solr[i]+solc[k-i]+i*(k-i));
		}
		cout << ans << "\n";
	}
	return 0;
}