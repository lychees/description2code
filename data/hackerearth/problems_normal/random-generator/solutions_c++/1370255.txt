#include<bits/stdc++.h>
using namespace std;
inline int scan(){
    int x;
    scanf("%d",&x);
    return x;
}
int main(){
    int t=scan();
    while(t--){
        int n=scan(),k=scan(),p=scan();
        int a[100001];
        for(int i=0;i<n;i++){
            a[i]=scan();
        }
        if(p==0){
        //    printf("NO\n");
        //    continue;
        }
        if(k==1){
        //	printf("NO\n");
         //   continue;
        }
        sort(a,a+n);
        bool x=0;
        for(int i=0;i+k-1<n;i++){
            int end = i+k-1;
            if(a[end]-a[i]<=2*p){
            	x=1;
                printf("NO\n");
                break;
            }
        }
        if(!x)printf("YES\n");
    }
} 