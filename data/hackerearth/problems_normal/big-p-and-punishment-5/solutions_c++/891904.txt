#include <iostream>
#include <queue>
#include <map>

using namespace std;

int main()
{
    
    int a,b,i,t,x,n,f,s,o,num;
    cin>>t;
    while(t--){
    	o=0;
    	cin>>n;
    	cin>>f;
    	cin>>s;
    	map <int,int> tr;
    map <int,queue <int>> storage;	
    for(i=1;i<=f;i++){
    	cin>>a;
    	cin>>b;
    	storage[a].push(b);
    }
    queue <int>q;
    
    for(i=1;i<=s;i++){
    	cin>>x;
   		q.push(x);
   		while(!q.empty()){
   			num = q.front();
   			q.pop();
    		if(tr[num]==0){
    			o++;
    			tr[num]=1;
    			while(!storage[num].empty()){
    				q.push(storage[num].front());
    				storage[num].pop();
    			}
    		}
    	}
    }
   
    cout<<o<<"\n";
    }
    return 0;
}
