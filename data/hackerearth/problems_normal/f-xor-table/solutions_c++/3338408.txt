#include <bits/stdc++.h>
using namespace std;
typedef long long ll;
int t,b;
ll n,m,p;
char str[1000005],str2[1000005];
int main(){
	scanf("%d\n",&t);
	while(t--){
		scanf("%lld %lld %lld %d\n",&n,&m,&p,&b);
		scanf("%s\n",str);
		if(n==1ll){
			printf("%s\n",str);
			continue;
		}
		--n;
		while(n){
			int lsb=(n&(-n));
			for(int x=0;x<m;x++){
				str2[(ll(x)+lsb*p)%m]=str[x];
			}
			for(int x=0;x<m;x++){
				if(b) str[x]=((str[x]==str2[x])?'1':'0');
				else str[x]=((str[x]!=str2[x])?'1':'0');
			}
			n^=lsb;
		}
		printf("%s\n",str);
	}
	return 0;
}