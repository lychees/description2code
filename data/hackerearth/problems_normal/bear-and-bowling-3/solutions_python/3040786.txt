N=input()
s=raw_input()
s=s.split(" ")
sum=0
for i in range(1,N+1):
	sum+=int(s[i-1])*(i+1)
sum=int((2**(N-2))*sum)
sum=sum%((10**9)+7)
print sum
