#include <bits/stdc++.h>
using namespace std;

vector<pair<int, int> > v[4];
int n,m,a,b,c;
int root[1005];
int cou;

int find_root(int id){
	if(id == root[id]) return id;
	root[id] = find_root(root[id]);
	return root[id];
}

void create_link(int id){
	int x, y;
	for(unsigned int i=0; i<v[id].size(); i++){
		x = find_root(v[id][i].first);
		y = find_root(v[id][i].second);
		if(x!=y) {cou++; root[x] = y;}
	}
}

bool div_check(int id){
	for(int i=1; i<=n; i++) root[i] = i;
	cou = 0;
	create_link(id);
	create_link(3);
	return (cou==n-1);
}

bool pre_check(){
	return div_check(1) && div_check(2);
}

int main()
{
	//freopen("src/in.txt", "r", stdin);
    scanf("%d %d", &n, &m);
    for(int i=0; i<m; i++){
    	scanf("%d %d %d", &a, &b, &c);
    	v[c].push_back(make_pair(a,b));
    }
    if(!pre_check()) {puts("-1"); return 0;}
    div_check(3);
    printf("%d\n", m-(2*n-2-cou));
    return 0;
}
