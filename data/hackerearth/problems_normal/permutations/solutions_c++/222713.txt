#include <iostream>
using namespace std;

bool Swap[101][101]={false};

void FWSwap(int n)
{
	//Flloyd-Warshall
	for(int k=0; k<n; k++)
		for(int j=0; j<n; j++)
			for(int i=0; i<n; i++)
			{
				if(!Swap[i][j] && (Swap[i][k] && Swap[k][j]))
					Swap[i][j] = true;
			}
			
}

void Sort(int a[], int n)
{
	//Selection Sort
	for(int i=0; i<n; i++)
		for(int j=0; j<n; j++)
		{
			if(a[i] < a[j] and Swap[i][j])
			{
				int temp = a[i];
				a[i] = a[j];
				a[j] = temp;
			}
		}
	
}

int main()
{
    int n;
    cin >> n;
    int *a = new int [n];
    for(int i=0; i<n; i++)	cin >> a[i];
    
    for(int i=0; i<n; i++)
    	for(int j=0; j<n; j++)
    	{
    		char ch;
    		cin >> ch;
    		if(ch == 'Y')	
    			Swap[i][j] = true;
    	}
    
    FWSwap(n);
    Sort(a, n);
    for(int i=0; i<n; i++) cout << a[i] << " ";
    return 0;
}
