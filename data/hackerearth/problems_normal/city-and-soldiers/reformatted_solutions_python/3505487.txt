#!/usr/bin/env python
# encoding: utf-8

fa, leader = [], []


def findfa(x):
    if x == fa[x]:
        return x
    else:
        fa[x] = findfa(fa[x])
        return fa[x]


if __name__ == '__main__':
    N, Q = map(int, raw_input().split())
    fa = [i for i in xrange(N + 1)]
    leader = [i for i in xrange(N + 1)]
    for _ in xrange(Q):
        op = raw_input().split()
        if op[0] == '1':
            a, b = int(op[1]), int(op[2])
            x, y = findfa(a), findfa(b)
            if x != y:
                fa[x] = y
        else:
            a = int(op[1])
            if op[0] == '2':
                leader[findfa(a)] = a
            else:
                print leader[findfa(a)]
