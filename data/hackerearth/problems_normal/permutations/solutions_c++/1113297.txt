#include <bits/stdc++.h>
using namespace std;
vector<int> v;
int matrix[101][101];
void dfs(int i,bool visited[],int n)
{
	if(!visited[i])
	{
		visited[i]=true;
		v.push_back(i);
		for(int j=0;j<n;j++)
		{
			if(matrix[i][j]==1)
			dfs(j,visited,n);
		}
	}
}

int main()
{
    int n;
    cin>>n;
   
    int arr[n],ans[n];
    //int matrix[n][n];
    bool visited[101]={false};
    for(int i=0;i<n;i++)
    {
    	cin>>arr[i];
    	ans[i]=arr[i];
    }
    for(int i=0;i<n;i++)
    {
    	string str;
    	cin>>str;
    	for(int j=0;j<n;j++)
    	{
    		matrix[i][j]=((str[j]=='N')?0:1);
    	}
    }
    
    for(int i=0;i<n;i++)
    {
    	if(!visited[i])
    	{
    	dfs(i,visited,n);
    	vector<int> v1;
    	sort(v.begin(),v.end());
    	for(int j=0;j<v.size();j++)
    	{
    		v1.push_back(arr[v[j]]);
    	}
    	sort(v1.begin(),v1.end());
    	for(int j=0;j<v.size();j++)
    	{
    		ans[v[j]]=v1[j];
    	}
    	v.clear();
    	v1.clear();
    	}
    	
    }
    for(int i=0;i<n;i++)
    cout<<ans[i]<<" ";
    
    return 0;
}
