#include <bits/stdc++.h>

using namespace std;

#define MOD 		1000000007
#define MAX 	    100000
#define ff 			first
#define ss 			second
#define clr 		clear()
#define square(x) ((x)*(x))
#define pb 			push_back
#define mp 			make_pair
#define gcd(a,b)  	__gcd(a,b)
#define sz(a) 		((int)(a.size()))
#define len(a) 		((int)a.length())
#define mem(i,n) 	memset(i,n,sizeof(i))
#define IOS 		ios_base::sync_with_stdio(false); cin.tie(NULL)

int main()
{
	IOS;
    int t; cin >> t; 
    while(t--)
    {
    	int n,m,P,Q,s,pos;
    	long long int val = 0,ans = 0;
    	cin >> n >> m;
    	vector <int> L(m);
    	vector <int> R(m);
    	vector <int> C(m);
    	vector <long long int> S(n+1);
    	vector <long long int> E(n+1);
    	cin >> L[0] >> R[0] >> C[0] >> P >> Q >> s;
    	
    	for(int i=1;i<m;++i)
    	{
    		L[i] = ((1LL * L[i-1] * P) + R[i-1]) % n + 1;
    		R[i] = ((1LL * R[i-1] * Q) + L[i-1]) % n + 1;
    		if(L[i] > R[i]) swap(L[i] , R[i]);
    		C[i] = (1LL * C[i-1] * s) % 1000000 + 1;
    	}
    	
    	for(int i=0;i<m;++i)
    	{
    		S[L[i]] += C[i];
    		E[R[i]] += C[i];
    	}
    	
    	for(int i=1; i<n+1;++i)
    	{
    		val += S[i];
    		if(val > ans)
    		{
    			ans = val;
    			pos = i;
    		}
    		val -= E[i];
    	}
    	cout << pos << " " << ans << '\n';
    }
    
    
    return 0;    
}
