#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
ll prefix[10055];
ll bs1(ll strt,ll end,ll val){
	ll ans=-1;
	while(end>=strt){
		ll mid=(strt+end)/2;
		if(prefix[mid]>=val){
			ans=mid;
			end=mid-1;
		}else{
			strt=mid+1;
		}
	}
	return ans;
}
ll bs2(ll strt,ll end,ll val){
	ll ans=-1;
	while(end>=strt){
		ll mid=(strt+end)/2;
		if(prefix[mid]<=val){
			ans=mid;
			strt=mid+1;
		}else{
			end=mid-1;
		}
	}
	return ans;
}
int main(){
	int t;
	cin>>t;
	while(t--){
		ll n,k,l,r;
		cin>>n>>k>>l>>r;
		string dress,spcl;
		cin>>dress>>spcl;
		memset(prefix,0,sizeof(prefix));
		ll mark[256];
		memset(mark,0,sizeof(mark));
		for(int i=0;i<k;i++){
			mark[spcl[i]]=1;
		}
		for(int i=0;i<n;i++){
			if(mark[dress[i]]){
				prefix[i]=1;
			}else{
				prefix[i]=0;
			}
		}
		for(int i=1;i<n;i++){
			prefix[i]+=prefix[i-1];
		}
		ll ans=0;
		ll val=0;
		ll low;
		ll high;
		for(int i=0;i<n;i++){
			if(i==0){
				val=0;
			}else{
				val=prefix[i-1];
			}	
			low=-1;
			low=bs1(i,n-1,val+l);
			if(low==-1)continue;
			high=-1;
			high=bs2(i,n-1,val+r);
			if(high==-1)continue;
			ans+=(high-low+1);
		}
		cout<<ans<<endl;
	}
	return 0;
}