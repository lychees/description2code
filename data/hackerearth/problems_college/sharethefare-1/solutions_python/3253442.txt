tc=int(raw_input())
while tc:
    tc=tc-1
    N,Q=map(int,raw_input().split())
    persons=[]
    for i in xrange(N):
        persons.append(raw_input())
    #print 'N,Q,persons:',N,Q,persons
    Expenses={}
    Paid={}
    for I in persons:
        Expenses[I]=0
        Paid[I]=0
    #print 'Expenses,Paid:',Expenses,Paid
    for i in xrange(Q):
        person_paid=raw_input()
        amount=input()
        no_of_person=input()
        q_persons=[person_paid]
        for j in xrange(no_of_person):
            q_persons.append(raw_input())
        #print 'person_paid,amount,no_of_person,q_persons:',person_paid,amount,no_of_person,q_persons

        no_of_person+=1
        Paid[person_paid]+=amount
        
        for ab in q_persons:
            Expenses[ab]+=amount/no_of_person            
        
        Expenses[q_persons[0]]+=amount%no_of_person

        #print 'Expenses,Paid:',Expenses,Paid


    for A in persons:
        if Expenses[A]>Paid[A]:
            #print A,' has to pay ',Expenses[A]-Paid[A]
            print A,'owes',Expenses[A]-Paid[A]
        elif Expenses[A]<Paid[A]:
            #print A,' will get back ',Paid[A]-Expenses[A]
            print A,'is owed',Paid[A]-Expenses[A]
        else:
            #print A,' has no dues'
            print A,'neither owes nor is owed'
            


        
