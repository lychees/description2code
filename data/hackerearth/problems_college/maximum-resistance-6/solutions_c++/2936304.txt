#include<bits/stdc++.h>
using namespace std;
int main()
{
    int t;
    cin>>t;
    while(t--)
    {
    	string s;
    	stack<int> stack;
    	int count=0, i, e1, e2, sum=0;
    	cin>>s;
    	for(i=s.length()-1;i>=0;i--)
    	{
    		if(s[i]=='X')
    		{
    			stack.push(1);
    			count++;
    		}
    		else
    		{
    			if(s[i]=='A')
    		{
    			e1=stack.top();
    			stack.pop();
    			e2=stack.top();
    			stack.pop();
    			stack.push(e1+e2);
    		}
    		else
    		{
    			e1=stack.top();
    			stack.pop();
    			e2=stack.top();
    			stack.pop();
    			stack.push(max(e1,e2));
    		}
    	}
    }
    vector<int> v(count);
    	for(i=0;i<(count);i++)
    	cin>>v[i];
    	sort(v.begin(),v.end(),greater<int>());
    	i=stack.top();
    	i-=1;
    	//cout << i;
    	for(;i>=0;--i)
    	sum+=v[i];
    	cout<<sum<<endl;
    }
return 0;
}
