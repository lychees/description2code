#include<bits/stdc++.h>
#define N 22
#define M 110
using namespace std;
int a[N];
int wt[M];
int arr[M];
int n,m,k;
int lol=0;
vector<int> v[N];
void rec(int pos, int used, int ans, int x[]){
	int y[M];
	for(int i=1; i<=m; i++) y[i]=x[i];
	if(pos>n || used==k){
		lol=max(lol,ans); 
		return;	
	} 
	rec(pos+1,used,ans,x);
	for(int i=0; i<v[pos].size(); i++){
		int cur=v[pos][i];
		if(!y[cur]){
			ans+=wt[cur];
			y[cur]=1;	
		}
	}
	rec(pos+1,used+1,ans,y);
}
int main(){
	int t;
	cin>>t;
	while(t--){
		lol=0;
		cin>>n>>m>>k;
		for(int i=1; i<=n; i++){
			cin>>a[i];
			v[i].clear();
		} 
		for(int i=1; i<=m; i++) cin>>arr[i];
		for(int i=1; i<=m; i++) cin>>wt[i];
		for(int i=1; i<=n; i++){
			for(int j=1; j<=m; j++){
				int val=__gcd(a[i],arr[j]);
//				cout<<a[i]<<" "<<arr[j]<<" "<<val<<endl;
				if(val!=1){
				//	cout<<a[i]<<" "<<arr[j]<<endl;
					v[i].push_back(j);
				//	cout<<i<<" "<<j<<endl;
				}
			}
		}
		int x[M]; memset(x,0,sizeof x);
		rec(1,0,0,x);
		cout<<lol<<endl;
	}
}