#include <bits/stdc++.h>

using namespace std;

const int MOD=1000000009;
int Q;
int dp[301][301][2];
char S[302];
char T[302];

int solve(int l, int r, int v)
{
    int& ret=dp[l][r][v];
    if(ret!=-1)
        return ret;
    if(l==r)
        return ret=(S[l]-'0')==v;
    ret=0;
    for(int i=l+1; i<=r; i++)
    {
        int l0=solve(l, i-1, 0);
        int l1=solve(l, i-1, 1);
        int r0=solve(i, r, 0);
        int r1=solve(i, r, 1);
        if(T[i]=='a')
        {
            if(v==0)
                ret=(ret+1LL*l0*r0%MOD+1LL*l0*r1%MOD+1LL*l1*r0%MOD)%MOD;
            else
                ret=(ret+1LL*l1*r1%MOD)%MOD;
        }
        else if(T[i]=='o')
        {
            if(v==0)
                ret=(ret+1LL*l0*r0%MOD)%MOD;
            else
                ret=(ret+1LL*l0*r1%MOD+1LL*l1*r0%MOD+1LL*l1*r1%MOD)%MOD;
        }
        else
        {
            if(v==0)
                ret=(ret+1LL*l0*r0%MOD+1LL*l1*r1%MOD)%MOD;
            else
                ret=(ret+1LL*l0*r1%MOD+1LL*l1*r0%MOD)%MOD;
        }
    }
    return ret;
}

int main()
{
    memset(dp, -1, sizeof dp);
    scanf("%s", S+1);
    scanf("%s", T+2);
    scanf("%d", &Q);
    int a, b;
    char buf[6];
    for(int i=0; i<Q; i++)
    {
        scanf("%d%d%s", &a, &b, buf);
        if(buf[0]=='t')
            printf("%d\n", solve(a, b, 1));
        else
            printf("%d\n", solve(a, b, 0));
    }
    return 0;
}
