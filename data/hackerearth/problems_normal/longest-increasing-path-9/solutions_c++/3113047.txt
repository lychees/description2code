#include<bits/stdc++.h>
#define ll long long
#define fo(i,a,b) for(i=a;i<b;i++)        
using namespace std;
int main()
{
    ll i,j,st,t,n,ans,sum,l,s,m;//string s;
cin>>t;
    while(t--)
    {
        
        cin>>n>>m;
        ll a[n][m],dp[n][m],maxim=1;
        fo(i,0,n)
            fo(j,0,m)
            cin>>a[i][j];
        dp[0][0]=1;
        fo(i,1,n)
        {dp[i][0]=a[i][0]<=a[i-1][0]||dp[i-1][0]==-1?-1:(dp[i-1][0]+1);maxim=max(maxim,dp[i][0]);}
        
        fo(i,1,m)
        {dp[0][i]=a[0][i]<=a[0][i-1]||dp[0][i-1]==-1?-1:(dp[0][i-1]+1);maxim=max(maxim,dp[0][i]);}
        /*fo(i,0,m)
                cout<<dp[0][i]<<" ";*/
        
       /* 
       fo(i,0,n)
        {fo(j,0,m)
                cout<<a[i][j]<<" ";
        cout<<endl;}
        */
        fo(i,1,n)
            fo(j,1,m)
         dp[i][j]=max(a[i][j]<=a[i-1][j]||dp[i-1][j]==-1?-1:(dp[i-1][j]+1),a[i][j]<=a[i][j-1]||dp[i][j-1]==-1?-1:(dp[i][j-1]+1)),
        maxim=max(maxim,dp[i][j]);
        
    cout<<maxim<<endl;
    }
    return 0;
}