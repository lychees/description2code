#include <stdio.h>

int main(){
    
    long long int t,n,k;
    scanf("%lld",&t);
    for(int i=0;i<t;i++){
        scanf("%lld %lld",&n,&k);
        long long int arr[n];
        for(int j=0;j<n;j++)
            scanf("%lld",arr+j);
        long long int counter=0,prev=2;
        for(int j=0;j<n;j++){
            int l = prev;
            while( l<n &&(arr[l]-arr[j]<=k)) l++;
            long long int temp = l-j-1;
            prev=l;
            if (temp>0){
                counter+=((temp)*(temp-1))/2;
            }
        }
        printf("%lld\n",counter);
    }
    return 0;
}
