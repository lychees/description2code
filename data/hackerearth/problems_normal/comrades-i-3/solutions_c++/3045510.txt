#include <bits/stdc++.h>
using namespace std;
int din[100001];
int dout[100001];
int level[100001];
vector <int> v[100001];
int num=0;
void dfs(int k,int l)
{
  din[k]=num;
  level[k]=l;
  num++;
   for(int i=0;i<v[k].size();i++)
    dfs(v[k][i],l+1);
   dout[k]=num;
   num++;
}
int main()
{
	int t,n,x,q,a,b;
	
	
	scanf("%u",&t);
	while(t--)
	{
		
		num=0;
		scanf("%u",&n);
		
		for(int i=1;i<=n;i++)
		{
			scanf("%u",&x);
			v[x].push_back(i);
		}
		dfs(0,0);
		scanf("%u",&q);
		
		for(int i=0;i<q;i++)
		{
		   scanf("%u %u",&a,&b);
		   if(din[a]>din[b] && dout[a]<dout[b])
		   printf("%i\n",level[a]-level[b]-1);
		   
		  else
		   printf("%i\n",-1);
		}
	   num=0;
	  for(int i=0;i<100001;i++)
	  v[i].clear();
	}
	

   return 0;
}