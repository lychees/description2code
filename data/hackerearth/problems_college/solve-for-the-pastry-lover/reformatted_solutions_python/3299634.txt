noOfTestCases = int(raw_input())


def minDistance(n):
    structureCount = {}
    curIndex = 0
    for digit in n:
        if (structureCount.has_key(digit) == False):
            structureCount[digit] = [curIndex, -1]
        else:
            newDistance = curIndex - structureCount[digit][0]
            if (structureCount[digit][1] == -
                    1 or newDistance < structureCount[digit][1]):
                structureCount[digit] = [curIndex, newDistance]
            else:
                structureCount[digit][0] = curIndex
        curIndex += 1

    distances = []
    for key, value in structureCount.items():
        if (value[1] != -1):
            distances.append(value[1])

    if (len(distances) == 0):
        return -1
    else:
        return min(distances)


for caseNo in range(1, noOfTestCases + 1):
    count = int(raw_input())
    print minDistance(raw_input())
