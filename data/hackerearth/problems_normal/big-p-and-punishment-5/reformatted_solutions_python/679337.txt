def color_it(friendship_map, student_list, i, visitlist):
    if len(friendship_map[i]) > 0:
        for j in friendship_map[i]:
            if not visitlist[j]:
                student_list[j-1] = True
                visitlist[j] = True
                color_it(friendship_map, student_list, j, visitlist)


def solve(friendship_map, slappedlist, student_list, visitlist):
    for i in slappedlist:
        student_list[i-1] = True
        color_it(friendship_map, student_list, i, visitlist)


if __name__ == "__main__":
    T = int(raw_input())

    for i in range(T):
        val = raw_input().split()
        N = int(val[0])
        F = int(val[1])
        S = int(val[2])
        friendship_map = {}
        student_list = []
        visitlist = {}
        for i in range(N):
            student_list.append(False)
            friendship_map[i+1] = []
            visitlist[i+1] = False

        for i in range(F):
            f = raw_input().split()
            friendship_map[int(f[0])].append(int(f[1]))

        slappedlist = []
        for i in range(S):
            x = int(raw_input())
            slappedlist.append(x)
            visitlist[x] = True

        solve(friendship_map, slappedlist, student_list, visitlist)
        count = 0
        for k in student_list:
            if k:
                count += 1
        print count
