#include<cstdio>
#include<iostream>
#include<algorithm>
#include<cmath>
#include<cstring>
using namespace std;
int cs, n, m, i, j;
char A[201][201],str[1000];
int M[201][201];
int solve(int i, int j)
{
  int &res = M[i][j], x;
  if (res == -2)
  {
    if (!i && !j)
      if (A[i][j] == 'T')
        res = 150;
      else if (A[i][j] == 'D')
        res = -1;
      else
        res = 0;
    else
    {
      if (A[i][j] == 'T')
        x = 150;
      else if (A[i][j] == 'D')
        x = -100;
      else
        x = 0;
      res = -1;
      if (j && solve(i, j - 1) >= 0)
        res = max(res, solve(i, j - 1) + x);
      if (i && solve(i - 1, j) >= 0)
        res = max(res, solve(i - 1, j) + x);
    }
  }
  return res;
}
int main()
{
  scanf("%d", &cs);
  while(cs--)
  {
    scanf("%d%d", &n, &m);
    gets(str);
    for (i = 0; i < n; i++)
    {
      gets(str);
      for (j = 0; j < m; j++)
      {
        A[i][j] = str[2 * j];
        M[i][j] = -2;
      }
    }
    printf("%d\n", max(-1, solve(n - 1, m - 1)));
  }
  return 0;
}
