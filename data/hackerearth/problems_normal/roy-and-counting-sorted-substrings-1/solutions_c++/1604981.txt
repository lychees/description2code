#include <iostream>

using namespace std;

long long int sum(long long int x)
{
    if(x%2 == 0)
    {
        return ( (x/2)*(x+1) );
    }
    else
        return ( ( (x+1)/2 ) * x );
}
int main()
{
    int t;
    long long int count,n;
    cin>>t;
    for(int i=0; i<t; i++)
    {
        cin>>n;


        char* arr= new char[n+1];
        long long int j,x=0,prev=0;

        for(j=0; j<n; j++)
        {
            cin>>arr[j];
        }

        if(n == 1)
        {
            cout<<"1"<<endl;
            continue;
        }


        count = 0;
        j=1;

        while( j < n)
        {
            while( j<n && arr[x] <= arr[j])
            {
                x++;
                j++;
            }

            x++;
            j++;

            //cout<<"x="<<x<<endl;
            //cout<<"j="<<j<<endl;

            count += sum(x-prev);

            if( j >= n && x < n )
                count += sum(j-x);
            prev=x;
        }
        cout<<count<<endl;

    }
    return 0;
}
