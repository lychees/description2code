#include <cstdio>
#define MOD 1000000007
using namespace std;

typedef long long ll;

ll power(ll b, ll e)
{
	ll c=1;
	while(e)
	{
		if(e&1)
			c=(c*b)%MOD;
		e/=2;
		b=(b*b)%MOD;
	}
	return c;
}

ll A[200010];
ll ans[200010];

int main()
{
    //cout << "Hello World!" << endl;
    ll N, i, j;
    scanf("%lld", &N);
    for(i=1; i<=N; ++i)
    	scanf("%lld", &A[i]);
    ans[1]=A[1];
    ll p2=1;
    for(i=2; i<=N; ++i)
    {
    	ans[i]=((2LL*ans[i-1LL])%MOD+(((p2*(i+1LL))%MOD)*A[i])%MOD)%MOD;
    	p2=(p2*2LL)%MOD;
    }
    printf("%lld", ans[N]);
    return 0;
}
