#include<iostream>
#include<algorithm>
using namespace std;
#define lli long long int
#define md 1000000007
#define pii pair<lli,int>
pii A[1000005];
inline void fi(lli *a)
{
       int tmp=0;
 register char c=0;
 while (c<33) c=getchar_unlocked();
 *a=0;
 while (c>33)
 {
       if(c==42)
       {
                tmp=1;
                continue;
       }
     *a=*a*10+c-'0';
     c=getchar_unlocked();
 }
 if(tmp==1)
 *a=0-*a;
}
int main()
{
    lli t;
    fi(&t);
    while(t--)
    {
              lli q,k;
              fi(&q);fi(&k);
              lli B[k],C[k];
              for(int i=0;i<k;i++)
              {
                      fi(&B[i]);
                      A[i].first=B[i];
                      A[i].second=i;
              }
              for(int i=0;i<k;i++) fi(&C[i]);
              for(int i=k;i<=1000000;i++)
              {
                      A[i].first=0;
                      A[i].second=i;
                      for(int j=0;j<k;j++)
                      {
                              (A[i].first)+=(C[j]*(A[i-j-1].first))%md;
                              (A[i].first)%=md;
                      }
              }
              sort(A,A+1000001);
              while(q--)
              {
                        lli l,r;
                        fi(&l);fi(&r);
                        l--;r--;
                        int ct=0;
                        for(int i=0;i<=1000000;i++)
                        {
                                if((A[i].second)>=l && (A[i].second)<=r)
                                {
                                                    ct++;
                                                    printf("%lld ",A[i].first);
                                }
                                //ct++;
                                if(ct==100) break;
                        }
                        printf("\n");
              }
    }
    return 0;
}
                        
