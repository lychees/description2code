#include <iostream>
#include <cstdio>
#include <climits>
#include <algorithm>
#include <queue>
#include <cstring>
#include <cmath>
#include <vector>
#include <stack>
#include <set>
#include <map>
#include <deque>
#define SET(p) memset(p,-1,sizeof(p))
#define CLR(p) memset(p,0,sizeof(p))
#define LL long long int
#define ULL unsigned long long int
#define S(n)				scanf("%d",&n)
#define Sl(n)				scanf("%lld",&n)
#define Sf(n) 				scanf("%lf",&n)
#define Ss(n) 				scanf("%s",n)
using namespace std;
int main()
{
	int t,i,j,k,n,m;
	S(t);
	while(t--)
	{
		string stg;
		int CAA=0,CBB=0,CCC=0,l,r;
		cin>>stg;
		
		l=0,r=1;
		if(stg[0]=='a')
			CAA++;
		else if(stg[0]=='b')
			CBB++;
		else if(stg[0]=='c')
			CCC++;
		
		long long int answer=1;
		for(;r<stg.size();r++)
		{
				if(stg[r]=='a')
					CAA++;
				else if(stg[r]=='b')
					CBB++;
				else if(stg[r]=='c')
					CCC++;
				if(CAA==0||CBB==0||CCC==0)
					answer+=r-l+1;
				else
				{
						while(1)
						{
								if(stg[l]=='a')
									CAA--;
								else if(stg[l]=='b')
									CBB--;
								else if(stg[l]=='c')
									CCC--;
								l++;
								if(CAA==0||CBB==0||CCC==0)
								{
									answer+=r-l+1;
									break;
								}	
						}		
				}
		}
		printf("%lld\n",answer);
	}
	return 0;
}