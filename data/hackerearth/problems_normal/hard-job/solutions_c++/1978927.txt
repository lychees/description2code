//ITNOG
#include<bits/stdc++.h>
 
using namespace std;
 
 
//#define int long long
#define rep(i, s, e) for(int i = s; i < e; i ++)
typedef double ld;
 
const int maxN = 500*1000 + 5;
const int mod = 1000*1000*1000+7;
//const int delta = 12899;
const int maxL = 17;
typedef long long ll;

#define x first
#define y second


int fen[3 * maxN];
int p[maxN], ps[maxN];

void add(int n, int k)
{
    for(; n < 3 * maxN; n += n & (-n)) 
	  fen[n] += k;
}

int get(int n)
{
    int res = 0;
    for(; n > 0; n -= n & (-n)) res += fen[n];
    return res;
}

main()
{
    ios::sync_with_stdio(0); cin.tie();
    int n,m; cin >> n >> m;
    rep(i,0,n) cin >> p[i], p[i]--, ps[p[i]] = i + maxN;

    int st = maxN - 1, en = maxN + n;

    rep(i,0,n) add(ps[i], 1);
    
    ll ans = 0;

    rep(i,0,m)
    {
	  int x; char c; cin >> x >> c; x --;
	  int cnt = get(ps[x]); cnt --;
	  ans += min(cnt, n-1-cnt);
	  
	  add(ps[x], -1); 
	  if(c == 'l')
		ps[x] = st --;
	  else
		ps[x] = en ++;

	  add(ps[x], 1);
    }
    
    cout << ans << endl;

    return 0;
}
