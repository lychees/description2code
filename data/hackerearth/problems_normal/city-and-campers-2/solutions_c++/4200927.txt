#include <iostream>
using namespace std;
int arr[100005],size[100005],count[100005],m,n,x,y,m1,m2,maxi,mini;
int root(int i)
{
	while(arr[i]!=i)
	{
		arr[i]=arr[arr[i]];
		i=arr[i];
	}
	return i;
	
}
void unioni(int i,int j)
{
	int ra=root(i);
	int rb=root(j);
	if(ra!=rb)
	{if(size[ra]>size[rb])
	{
		arr[rb]=arr[ra];
		count[size[ra]]--;
		count[size[rb]]--;
		count[size[ra]+size[rb]]++;
		size[ra]+=size[rb];
		if(size[ra]>maxi)
		maxi=size[ra];
	}
	else 
	{
		arr[ra]=arr[rb];
		count[size[rb]]--;
		count[size[ra]]--;
		count[size[ra]+size[rb]]++;
		size[rb]+=size[ra];
		if(size[rb]>maxi)
		maxi=size[rb];
	}
	}
}
int main()
{
	int a,b;
	//m2=1;
	maxi=1;
	cin>>m>>n;
	for(int i=1;i<=m;i++)
	{
		arr[i]=i;
		size[i]=1;
		if(i==1)
		count[1]=m;
		else
		count[i]=0;
	}
	
	while(n--)
	{
		m1=0;
		cin>>x>>y;
		unioni(x,y);
		mini=m+1;
		int i=1,j,k=0;
		while(count[i]==0)
		i++;
		if(i==maxi)
		{
			cout<<"0\n";
			continue;
		}
		while(i<=(maxi-1))
		{
			j=i+1;
			if(count[i]>1)
			{
				cout<<"0\n";m1=1;
				break;
				
			}
			while(count[j]==0)
			j++;
			if((j-i)<mini)
			mini=j-i;
			i=j;
		}
		if(!m1)
		cout<<mini<<endl;
	}
    return 0;
}
