#include <iostream>
#include <map>
#include <cstdio>
#include <vector>
#include <algorithm>
using namespace std;
map<long long int,long long int> mp1,mp2;
map<long long int,long long int>::iterator it;
vector<long long int> v1,v2;
int main()
{
    long long int t,b,p1,p2;
    long long int x;
    char ch;
    cin>>t;
    while(t--)
    {
    	v1.clear();
    	v2.clear();
    	scanf("%lld",&b);
    	v1.resize(b+1);
    	v2.resize(b+1);
    	v1[0]=1;
    	v2[0]=1;
    	for(p1=1;p1<=b;p1++)
    	{
    	//	scanf("%c ",&ch);
    		cin>>ch;	
    		
    		if(ch!='N')
    		{
    			scanf("%lld",&x);
    		
    				if(ch=='+')
    				{
    					v1[p1]=min(v1[p1-1],v1[p1-1]+x);
    					v1[p1]=min(v1[p1],v2[p1-1]+x);
    					v2[p1]=max(v2[p1-1],v1[p1-1]+x);
    					v2[p1]=max(v2[p1],v2[p1-1]+x);
    				}
    				else if(ch=='-')
    				{
    					v1[p1]=min(v1[p1-1],v1[p1-1]-x);
    					v1[p1]=min(v1[p1],v2[p1-1]-x);
    					v2[p1]=max(v2[p1-1],v1[p1-1]-x);
    					v2[p1]=max(v2[p1],v2[p1-1]-x);
    				}
    				else if(ch=='*')
    				{
    					v1[p1]=min(v1[p1-1],v1[p1-1]*x);
    					v1[p1]=min(v1[p1],v2[p1-1]*x);
    					v2[p1]=max(v2[p1-1],v1[p1-1]*x);
    					v2[p1]=max(v2[p1],v2[p1-1]*x);
    				}
    				else
    				{
    					v1[p1]=min(v1[p1-1],v1[p1-1]/x);
    					v1[p1]=min(v1[p1],v2[p1-1]/x);
    					v2[p1]=max(v2[p1-1],v1[p1-1]/x);
    					v2[p1]=max(v2[p1],v2[p1-1]/x);
    				}
    		
    			
    		}
    		else
    		{
    			v1[p1]=min(v1[p1-1],v1[p1-1]*-1);
    			v1[p1]=min(v1[p1],v2[p1-1]*-1);
    			v2[p1]=max(v2[p1-1],v1[p1-1]*-1);
   				v2[p1]=max(v2[p1],v2[p1-1]*-1);
    		}
    //	cout<<v1[p1]<<"--"<<v2[p1]<<"\n";
    	}
    
    	printf("%lld\n",v2[b]); 
    	
    }
    return 0;
}
