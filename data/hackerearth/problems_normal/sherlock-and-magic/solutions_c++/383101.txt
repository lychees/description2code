#include<stdio.h>
#include<iostream>
#include<string>
using namespace std;
int main()
{
    int t,n;
    cin>>t;
    while(t--)
    {
       int x[51],y[51],dx[51],dy[51];
       bool isalive[51];
       fill_n(dx,51,0); 
       fill_n(dy,51,0); 
       fill_n(isalive, 101, false); 
       //cout<<isalive[i]<<":"<<x[i]<<":"<<y[i]<<":"<<dx[i]<<":"<<dy[i]<<endl;
       cin>>n;
       int n1=n,i=1;;          
       while(n1--)
        {
            cin>>x[i]>>y[i];           
            char c;
            cin>>c; 
            x[i]*=2;
            y[i]*=2;
            isalive[i]=true;
            if(c=='N') 
              dy[i]=1;
            else if(c=='S')  
              dy[i]=-1;  
            else if(c=='W')
              dx[i]=-1;
            else 
              dx[i]=1;   
           
//           cout<<isalive[i]<<":"<<x[i]<<":"<<y[i]<<":"<<dx[i]<<":"<<dy[i]<<endl;
            i++;
        
        }
        
       for(int ti=0;ti<4001;ti++)
       {
               int n1=n,i=1;          
               while(n1--)
                {
                          
                  if(isalive[i])
                  {        
                  
                    int flag=0;
                    int j;
                    for(j=i+1;j<n+1;j++)
                      {
                        if(!isalive[j])
                          {//cout<<j<<"Not"<<endl;
                          continue;}                
                                        
                          if(x[i]+dx[i]==x[j]+dx[j]&&y[i]+dy[i]==y[j]+dy[j]&&isalive[i]&&isalive[j])
                                {isalive[j]=false;flag=1;}
                                 //  cout<<ti<<":"<<x[i]<<":"<<y[i]<<":"<<i<<":"<<dy[i]<<endl;}
                         // {  cout<<ti<<":"<<x[i]<<":"<<y[i]<<":"<<x[j]<<":"<<y[j]<<":"<<i<<":"<<j<<endl;}
                                   
                      } 
                    if(flag==1)
                      isalive[i]=false; 
                  }  
                   
                 i++;
                }
                
               n1=n,i=1;          
               while(n1--)
                {                       
                    x[i]+=dx[i];
                    y[i]+=dy[i];
                   i++;
                }
                      
       }
        
      int cnt=0; 
      for(i=1;i<n+1;i++)  
        {
             if(isalive[i])
                 cnt++;
        }         
       cout<<cnt<<endl; 
    }
    return 0;
}
