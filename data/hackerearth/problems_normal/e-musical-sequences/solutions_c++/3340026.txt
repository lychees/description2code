#include <iostream>
#include <cmath>
#include <vector>

using namespace std;

int main(){
	int t; cin>>t;
	for(int it=1;it<=t;it++){
		long long n,m,z;
		cin>>n>>m>>z;
		vector<long long> arr(n+1);
		for(int i=0;i<n;i++)
			cin>>arr[i];
		long long sum=0;
		long long mult=1;
		for(int i=n-1;i>=0;i--){
			sum+=mult*arr[i];
			if(mult==1)
				mult=-1;
			else
				mult=1;
		}
		if(sum>=0)
			arr[n]=sum%m;
		else{
			sum*=-1;
			if(sum<=m)
				arr[n]=m-sum;
			else
				arr[n]=m-(sum%m);
		}
		long long d=z%(2*(n+1));
		if(d>=0 && d<=n)
			cout<<arr[d]<<endl;
		else{
			if(n%2==0)
				cout<<m-arr[d-n-1]<<endl;
			else
				cout<<arr[d-n-1]<<endl;
		}
	}
	return 0;
}