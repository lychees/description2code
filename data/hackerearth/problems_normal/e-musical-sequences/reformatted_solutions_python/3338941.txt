for _ in range(int(raw_input())):
    n, m, z = map(int, raw_input().split())
    a = map(int, raw_input().split())
    t = z % (n+1)
    if t == n:
        ans = 0
        for i in range(n):
            ans += (1-2*(i & 1))*a[n-i-1]
    else:
        ans = a[t]
    if n & 1:
        print(ans+m) % m
    else:
        print((1-2*((z/(n+1)) & 1))*ans+m) % m
