#include<bits/stdc++.h>
using namespace std;

const int N = 5000009;
vector<int> pr;
int lp[N+1];
int ar[N+1]={0};

int main () {

	for (int i=2; i<=N; ++i) {
		if (lp[i] == 0) {
			lp[i] = i;
			pr.push_back (i);
		}
		for (int j=0; j<(int)pr.size() && pr[j]<=lp[i] && i*pr[j]<=N; ++j)
			lp[i * pr[j]] = pr[j];
	}
	int le=pr.size();
	for(int i=0;i<le;i++)
		ar[pr[i]]=1;

	int n;
	cin>>n;
	while(n--)
	{
		int x,y;
		cin>>x>>y;
		long long int p,q;
		p=x;
		q=y;
		map < int , int > tmp;
		tmp[1]=1;
		while(p!=1)
		{
			tmp[p]=1;
			if(p%2==0)
				p/=2;
			else
				p=(p-1)/2;
		}
		int ma=0;
		while(tmp.find(q)==tmp.end())
		{
			if(q%2==0)
				q/=2;
			else
				q=(q-1)/2;
		}
		int g=q;
		p=x;
		q=y;
		long long int ans=0;
		while(p!=g)
		{
			if(ar[p]==1)
				ans-=p;
			else
				ans+=p;
			if(p%2==0)
				p/=2;
			else
				p=(p-1)/2;
		}
		while(q!=g)
		{
			if(ar[q]==1)
				ans-=q;
			else
				ans+=q;
			if(q%2==0)
				q/=2;
			else
				q=(q-1)/2;
		}
		if(ar[g]==1)
			ans-=g;
		else
			ans+=g;

		cout<<ans<<endl;	
	}
	return 0;
}
