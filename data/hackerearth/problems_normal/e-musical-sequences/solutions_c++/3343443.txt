#include <iostream>
#include <algorithm>
#include <cstdio>
#include <vector>
#include <cmath>
using namespace std;
#define rep(i, a, b) for(int i = (a); i < (b); i++)
#define repd(i, a, b) for(int i = (a); i > (b); i--)
#define forIt(it, a) for(__typeof((a).begin()) it = (a).begin(); it != (a).end(); it++)
#define ll long long
#define fi first
#define se second
#define mk make_pair
#define pb push_back
#define sz(a) (a).size()
#define all(a) (a).begin(), (a).end()
typedef vector<int> vi;
typedef pair<int, int> ii;
typedef pair<ii, int> iii;
typedef vector<ii> vii;
const int N = 100000 + 7;
const int M = 1001;
const int inf = 1e9 + 7;
const int oth = 853454;
const double pi = acos(-1);

int n, m;
ll z;
int a[N];

void solve() {
	cin >> n >> m >> z;

	rep(i, 0, n) scanf("%d", a + i);

	a[n] = 0;
	rep(i, 1, n + 1) {
		if (i % 2 == 1) a[n] = (a[n] + 0ll + a[n - i]) % m;
		else a[n] = (a[n] + 0ll - a[n - i] + m) % m;
	}
	if (n % 2 == 1)
	cout << a[z % (n + 1)] << "\n";
	else {
		int t = z % (2 * n + 2);
		if (t <= n) cout << a[t] << "\n";
		else cout << (0ll - a[t - n - 1] + m) % m << "\n";
	}
}

int main() {
#ifndef ONLINE_JUDGE
    freopen("in.txt", "r", stdin); //freopen("out.txt", "w", stdout);
#endif
    int T = 1;
    cin >> T;
    for(int i = 1; i <= T; i++){
        solve();
    }
}

