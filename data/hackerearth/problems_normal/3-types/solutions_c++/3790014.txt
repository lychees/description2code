#include<iostream>
#include<cstdio>
#include<cmath>
#include<stack>
#include<queue>
#include<cstring>
#include<set>
#include<vector>
#include<map>
#include<algorithm>
#include<utility>
#include<ctime>

#define MX 100000
#define pb push_back
#define mp make_pair
#define fs first
#define sec second
#define sc scanf
#define pr printf
#define TC int T;cin>>T;for(int t=1;t<=T;t++)
using namespace std;
struct q{
	int x;
	int y;
	int z;
};
int root(int a[],int x)
{
	while(a[x]!=x)
	x=a[x];
	return x;
}
bool find(int a[], int x,int y)
{
	if(root(a,x)==root(a,y))
	return true;
	else
	return false;
}
void union_set(int a[],int x,int y,int s[])
{
	x=root(a,x);
	y=root(a,y);
	if(s[x]<s[y])
	{
		a[x]=a[y];
		s[y]+=s[x];
	}
	else
	{
		a[y]=a[x];
		s[x]+=s[y];
	}
}
int main()
{
	int n,m,i,j,k;
	cin>>n>>m;
	bool vis[m+1];
	memset(vis,false,sizeof(vis));
	vector<struct q> men;
	vector<struct q> women;
	vector<struct q> both;
	int a[n+1];
	int s[n+1];
	for(i=0;i<=n;++i)
	{
		a[i]=i;
		s[i]=1;
	}
	struct q r;
	for(i=0;i<m;++i)
	{
		cin>>r.x>>r.y>>k;
		r.z=i;
		if(k==3)
		{
			both.pb(r);
		}
		else if(k==2)
		women.pb(r);
		else
		men.pb(r);
	}
	i=0;
	while(i<both.size())
	{
		if(!find(a,both[i].x,both[i].y)){
			vis[both[i].z]=true;
			union_set(a,both[i].x,both[i].y,s);
		}
		++i;
	}
	i=0;
	while(i<men.size())
	{
		if(!find(a,men[i].x,men[i].y)){
			vis[men[i].z]=true;
			union_set(a,men[i].x,men[i].y,s);
		}
		++i;
	}
	int c1=0;
	for(i=1;i<=n;++i)
	{
		if(a[i]==i)
		++c1;
	}
	if(c1>1)
	cout<<"-1";
	else{
	for(i=0;i<=n;++i)
	{
		a[i]=i;
		s[i]=1;
	}
	i=0;
	while(i<both.size())
	{
		if(!find(a,both[i].x,both[i].y)){
			vis[both[i].z]=true;
			union_set(a,both[i].x,both[i].y,s);
		}
		++i;
	}
	i=0;
	while(i<women.size())
	{
		if(!find(a,women[i].x,women[i].y)){
			vis[women[i].z]=true;
			union_set(a,women[i].x,women[i].y,s);
		}
		++i;
	}
	int c1=0;
	for(i=1;i<=n;++i)
	{
		if(a[i]==i)
		++c1;
	}
	if(c1>1)
	cout<<"-1";
	else{
	int c=0;
	for(i=0;i<m;++i)
	{
		if(vis[i]==false)
		++c;
	}
	cout<<c;
	}
	}
return 0;
}

