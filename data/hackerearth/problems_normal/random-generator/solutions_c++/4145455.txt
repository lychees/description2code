#include<bits/stdc++.h>
#define ll long long int
using namespace std;
int main()
{
	vector<ll> v;
	ll t,n,k,p,i,j,ele;
	for(cin>>t;t;t--)
	{
		cin>>n>>k>>p;
		v.clear();
		for(i=0;i<n;i++)
		{
			cin>>ele;
			v.push_back(ele);
		}
		sort(v.begin(),v.end());
		ll dif_in_range=(2*p);	//always;
		ll flag=0;
		vector<ll>::iterator temp;
		for(i=0;i<n;i++)
		{
			ll val=v[i]+dif_in_range;
			temp=upper_bound(v.begin(),v.end(),val);
			ll idx=(temp-v.begin());
			if(idx-i>=k)
			{
				flag=1;
				break;
			}
		}
		if(flag==1)
		{
			cout<<"NO"<<endl;
		}
		else
		{
			cout<<"YES"<<endl;
		}
	}
	return 0;
}