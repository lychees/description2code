MOD_OUTPUT_BY = 1000000007
T = int(raw_input())


def calculate_water(starting_index, ending_index):
    global building_heights
    height_of_smallest_enclosing_building = building_heights[starting_index] if building_heights[
        starting_index] < building_heights[ending_index] else building_heights[ending_index]

    total = 0
    for index in range(starting_index + 1, ending_index):
        total += height_of_smallest_enclosing_building - \
            building_heights[index]
    return total


def process_input():
    global total_water_stored, building_heights

    total_water_stored = 0
    starting_index = 0
    largest_ending_index = -1
    i = 1
    while i < N:
        calculated = False
        if building_heights[i] < building_heights[starting_index]:
            if building_heights[i] > building_heights[largest_ending_index] or largest_ending_index == -1:
                largest_ending_index = i
        elif building_heights[i] >= building_heights[starting_index]:
            largest_ending_index = i
            total_water_stored += calculate_water(
                starting_index, largest_ending_index)
            starting_index = largest_ending_index
            largest_ending_index = -1
            calculated = True
        i += 1
        if i == N and not calculated:
            total_water_stored += calculate_water(
                starting_index, largest_ending_index)
            starting_index = largest_ending_index
            i = largest_ending_index + 1
            largest_ending_index = -1


while T > 0:
    T -= 1
    N = int(raw_input())
    building_heights = [int(x) for x in raw_input().split()]
    process_input()
    print total_water_stored % MOD_OUTPUT_BY
