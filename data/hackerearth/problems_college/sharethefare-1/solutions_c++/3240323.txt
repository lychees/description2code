#include <bits/stdc++.h>
using namespace std;

typedef long long ll;
typedef pair<int,int> ii;
typedef vector<int> vi;
typedef vector<ii> vii;

const int  MOD=1000000007;
const int  INF= int(1e9);




int main()
{
    int testCases;
    cin>>testCases;
    while(testCases--) {
        int n,q;
        cin>>n>>q;
        map<string,ii> record;
        vector<string> names(n);
        for(int i=0;i<n;i++) {
            string x;
            cin>>x;
            names[i]=x;
            record[x]=ii(0,0);
        }
        
        while(q--) {
            string paidBy;
            cin>>paidBy;
            int amountPaid;
            cin>>amountPaid;
            int m;
            cin>>m;
            int rem= amountPaid%(m+1);
            int distribute= amountPaid/(m+1);
            record[paidBy].first+=rem+distribute;
            record[paidBy].second+=amountPaid;
            for(int i=0;i<m;i++) {
                string x ;
                cin>>x;
                record[x].first+=distribute;
            }
        }
        for(int i=0;i<n;i++) {
            string x =names[i];
            if(record[x].second == record[x].first) {
                cout<<x<<" "<<"neither owes nor is owed\n";
            } else if( record[x].second > record[x].first) {
                cout<<x<<" "<<"is owed "<<record[x].second-record[x].first<<"\n";
            } else {
                cout<<x<<" "<<"owes "<<record[x].first-record[x].second<<"\n";
            }
        }

    }



	return 0;

}
