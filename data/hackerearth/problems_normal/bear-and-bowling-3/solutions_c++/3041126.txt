#include<bits/stdc++.h>

#define gc getchar
#define ii(x) scanf(" %d", &x)
#define ill(x) scanf(" %lld", &x)
#define ll long long
#define pb push_back
#define mp make_pair
#define F first
#define S second
#define mod 1000000007

using namespace std;

void in(int &x)
{
    register int c=gc();
    x=0;
    for(;(c<48||c>57);c=gc());
    for(;c>47&&c<58;c=gc()){x=(x<<1)+(x<<3)+c-48;}
}

int main()
{
    ll n,i,j,p=1,q=1,sum=0;ill(n);
    ll *a=new ll[n+2];
    for(i=0;i<n;i++){ ill(a[i]); }
    for(i=0;i<n-1;i++){ p=(p<<1)%mod;if(i){ q=(q<<1)%mod; } }
    for(i=0;i<n;i++){
        j=(p+(i*q))%mod;
        sum=(sum+(a[i]*j))%mod;
    }cout << sum;

    return 0;
}
