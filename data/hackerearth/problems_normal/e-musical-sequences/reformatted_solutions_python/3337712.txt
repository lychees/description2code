for x in range(input()):
    line = raw_input().split()
    n, m, z = map(int, line)
    l = raw_input().split()
    arr = map(int, l)
    ans = 0
    tp = -1
    for i in range(n-1, -1, -1):
        tp *= -1
        ans += (tp)*arr[i]

    arr.append(ans)

    if n % 2 == 1:
        arr += arr
    else:
        arr += [-p for p in arr]

    print arr[z % (2*(n+1))] % m
