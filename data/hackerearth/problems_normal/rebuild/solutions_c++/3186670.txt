#include<bits/stdc++.h>
#define ll long long
#define sl(x) scanf("%lld",&x);
#define fs first
#define se second
#define mp make_pair
#define pb push_back
#define mod 1000000007
using namespace std;
struct node
{
	ll a,b,c;
};
bool comp(struct node p,struct node q)
{
	if(p.c==q.c)
	{
		if(p.a==q.a)
			return (p.b>q.b);
		else
			return (p.a>q.a);	
	}
	else
		return (p.c<q.c);
}
int main()
{
	ll t;
	cin>>t;
	while(t--)
	{
		ll n,m,i,j,k,ctr=0;
		sl(n);sl(m);
		struct node v[m+1];
		for(i=0;i<m;i++)
		{
			ll aa,bb,cc;
			sl(aa);sl(bb);sl(cc);
			if(aa>bb)
				swap(aa,bb);
			v[i].a= aa;
			v[i].b= bb;
			v[i].c= cc;
		}
		sort(v ,v+m,comp);
		ll arr[n+1], res=0;
		
		for(i=0;i<=n+1;i++)
				arr[i]=i;
		//cout<<"\n";
		//for(i=0;i<v.size();i++)
		//	cout<<v[i].fs<<" "<<v[i].se.fs<<" "<<v[i].se.se<<"\n";	
		ll hsh[n+1], tp,wp;
		memset(hsh,0,sizeof(hsh));
		for(i=0; i<m;i++)
		{
			tp= v[i].a ;
			wp= v[i].b ;
			//cout<<tp<<" "<<wp<<endl;
			while(1)
			{
				arr[tp]= arr[arr[tp]];
				if(arr[tp]==tp)
					break;
				tp= arr[tp];
			}
			while(1)
			{
				arr[wp]= arr[arr[wp]];
				if(arr[wp]==wp)
					break;
				wp=arr[wp];
			}
				
			if(tp!=wp)
			{
				res+= v[i].c ;
				arr[tp]= wp;
				hsh[v[i].b]++;
				hsh[v[i].a]++;
			}
		}
		printf("%lld\n",res);
		for(i=1;i<=n;i++)
			cout<<hsh[i]<<" ";
		cout<<"\n";
	}
	return 0;
}