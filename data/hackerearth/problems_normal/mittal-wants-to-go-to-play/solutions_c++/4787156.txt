#include<bits/stdc++.h>
using namespace std;
# define ll long long
# define mod 1000000007
vector<pair<ll,ll> >v[10003];

ll dis[10003];

ll dij(ll src,ll dest)
{
        ll i,k,j,wn,u,we,v1,size1;
        dis[src]=0;
        priority_queue<pair<ll,ll> ,vector<pair<ll,ll> >,greater<pair<ll,ll> > >q;
        q.push(make_pair(0,src));
        while(!q.empty())
        {
            wn=q.top().first;
            u=q.top().second;
            q.pop();
            //if(f[u]) continue;
            size1=v[u].size();
            for(i=0;i<size1;i++)
            {
                  we=v[u][i].first;
                  v1=v[u][i].second;
                  if( dis[we]>dis[u]+v1)
                   {
                    dis[we]=dis[u]+v1;
                    q.push(make_pair(dis[we],we));
                   }
            }
            //f[u]=1;
        }

        return dis[dest];
}

int main()
{
    int t;
    cin>>t;
    while(t--)
    {
        ll n,m,i,j,k,l,c=0,x,y,z,q;
        cin>>n>>m;
        for(i=0;i<=n;i++)
        {
            v[i].clear();
            dis[i]=mod;
        }
        for(i=1;i<=m;i++)
        {
            cin>>x>>y>>z;
            v[x].push_back(make_pair(y,z));
            v[y].push_back(make_pair(x,z));
        }
        cin>>q;
        while(q--)
        {
            cin>>k>>l;
            c=dij(1,k);
            c=l-(2*c);
            if(c<=0)
                c=0;
            cout<<c<<"\n";
        }
    }

}
