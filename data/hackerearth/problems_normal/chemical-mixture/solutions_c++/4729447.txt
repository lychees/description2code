//Abhishek Bansal
//May'15 Easy - Chemical mixture
#include<bits/stdc++.h>
#define PB push_back
#define MP make_pair
#define F first
#define S second
#define SZ(a) (int)(a.size())
#define SET(a,b) memset(a,b,sizeof(a))
#define LET(x,a) __typeof(a) x(a)
#define TR(v,it) for( LET(it,v.begin()) ; it != v.end() ; it++)
#define loop(i,a,b) for(int i=a;i<b;i++)
#define si(n) scanf("%d",&n)
#define sll(n) scanf("%lld",&n)
#define all(a) a.begin(),a.end()
#define bitcount(n) __builtin_popcount(n)
#define fast_io ios_base::sync_with_stdio(false);cin.tie(NULL)

//#define TRACE

using namespace std;
#ifdef TRACE
#define trace(...) __f(#__VA_ARGS__, __VA_ARGS__)
template <typename Arg1>
void __f(const char* name, Arg1&& arg1){
	cerr << name << " : " << arg1 << std::endl;
}
template <typename Arg1, typename... Args>
void __f(const char* names, Arg1&& arg1, Args&&... args){
	const char* comma = strchr(names + 1, ',');cerr.write(names, comma - names) << " : " << arg1<<" | ";__f(comma+1, args...);
}
#else
#define trace(...)
#endif
typedef long long int lli;
typedef pair<int,int> ii;
typedef vector<int> vi;
typedef vector< vi > vvi;
typedef vector< ii > vii;
lli modpow(lli a,lli n,lli temp){lli res=1,y=a;while(n>0){if(n&1)res=(res*y)%temp;y=(y*y)%temp;n/=2;}return res%temp;}
//***********************************END OF TEMPLATE*********************************************************************
lli A[100],B[100];
vector<lli> water;
bool check(lli amt,int n){
	lli val = amt;
	bool flag = 0;
	for(int i = n-1;i>=0;--i){
		if(val==0){
			flag=1;
			break;
		}
		else if(A[i]>val) continue;
		else val-=A[i];
	}
	if(val==0) flag=1;
	return flag;
}
void PrintSol(lli amt,int n){
	vector<lli> ans;
	for(int i=n-1;i>=0&&amt;--i){
		if(A[i]>amt) continue;
		else{
			amt-=A[i];
			ans.PB(A[i]);
		}
	}
	if(SZ(ans)){
		reverse(all(ans));
		TR(ans,it) printf("%lld ",*it);
		printf("\n");
	}
}
void gen(int n){
	water.clear();
	int ma = (1<<n);
	for(int i=0;i<ma;++i){
		lli val = 0;
		int tm = i,p=n-1;
		while(tm){
			if(tm&1) val+=B[p];
			tm>>=1;p--;
		}
		water.PB(val);
	}
	sort(all(water));
}
int main(){
	int n,m,t;
	lli amt;
	si(t);
	while(t--){
		sll(amt);si(n);si(m);
		for(int i=0;i<n;++i) sll(A[i]);
		for(int i=0;i<m;++i) sll(B[i]);
		sort(A,A+n);
		gen(m);
		int flag = 0;
		for(int i=0;i<SZ(water);++i){
			lli val = amt-water[i];
			if(val<0) break;
			if(check(val,n)){
				amt-=water[i];
				flag=1;break;
			}
		}
		if(!flag) printf("NO\n");
		else{
			printf("YES\n");
			PrintSol(amt,n);
		}
	}
	return 0;
}
