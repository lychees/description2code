#include<bits/stdc++.h>
#define M 1000000007
using namespace std;
long long t,cnt,n,a,b,c,arr[100];
long long dp[100][10];
long long f(long long i,long long l,long long c)
{
	
	if(i==l)
	{
		if(c==0)return 1;else return 0;
	}
	long long temp=0;
	if(dp[i][c]!=-1)return dp[i][c];
	if(c==0)
	{
		
		if(arr[i]==0)
		{
			temp+=f(i+1,l,0)+3*f(i+1,l,1)%M;
		}
		else
		{
			temp+=3*f(i+1,l,0)%M;
		}
		
	}
	else
	{
		if(arr[i]==0)
		{
			temp+=3*f(i+1,l,1)%M;
		}
		else
		{
			temp+=f(i+1,l,0)+3*f(i+1,l,1)%M;
		}
	}
	return dp[i][c]=temp%M;
	
}
int main()
{
	
	
	
	
	scanf("%lld",&t);
	while(t--)
	{
		memset(dp,-1,sizeof(dp));
		scanf("%lld",&n);
		long long ans=1;
		
		cnt=((n%M+1)*(n%M+2)%M)*(500000004)%M;
		
		long long l=0;
		
		while(n)
		{
			if(n%2==0)
			{
				arr[l++]=0;
			}
			else
			{
				arr[l++]=1;
			}
			n/=2;
		}
		

		cnt-=f(0,l,0);if(cnt<0)cnt+=M;cnt%=M;
		
		printf("%lld\n",cnt);
		
	}
	
	
	
	
	
}