#include <iostream>
#include<stdio.h>
using namespace std;
int max(int a,int b)
{
	if(a>b)
		return a;
	return b;
}
int main()
{
	int t,n,i,j,m,a[300][300],ans;
	char c[300][300],x;
	//freopen("inpmat.txt","r",stdin);
	//freopen("outmat.txt","w",stdout);
	cin>>t;
	while(t--)
	{
		ans=0;
		cin>>n>>m;

		for(i=1;i<=n;i++)
		{
			for(j=1;j<=m;j++)
			{
				scanf("%c",&c[i][j]);
				scanf("%c",&c[i][j]);
			}
			//scanf("%c",&x);
		}
		/*for(i=1;i<=n;i++)
		{
			for(j=1;j<=m;j++)
				cout<<c[i][j]<<" ";
			cout<<endl;
		}*/
		if(c[1][1]=='T')
			a[1][1]=150;
		else if(c[1][1]=='D')
        {
            ans=-1;
            goto label;
        }
        else
        {
            ans=0;
            goto label;
        }
		for(i=2;i<=n;i++)
		{
		    if(a[i-1][1]<0)
                a[i][1]=-1;
            else
            {
                if(c[i][1]=='T')
                    a[i][1]=a[i-1][1]+150;
                else if(c[i][1]=='D')
                {
                    a[i][1]=a[i-1][1]-100;
                    if(a[i][1]<0)
                        a[i][1]=-1;
                }
                else
                {
                    a[i][1]=a[i-1][1];
                }
            }
		}
		for(j=2;j<=m;j++)
		{
		    if(a[1][j-1]<0)
                a[1][j]=-1;
            else
            {
                if(c[1][j]=='T')
                    a[1][j]=a[1][j-1]+150;
                else if(c[1][j]=='D')
                {
                    a[1][j]=a[1][j-1]-100;
                    if(a[1][j]<0)
                        a[1][j]=-1;
                }
                else
                {
                    a[1][j]=a[1][j-1];
                }
            }
		}
		for(i=2;i<=n;i++)
		{
			for(j=2;j<=m;j++)
			{
				if(a[i-1][j]<0&&a[i][j-1]<0)
					a[i][j]=-1;
				else
				{
                    if(c[i][j]=='T')
                    {
                        a[i][j]=max(a[i-1][j],a[i][j-1])+150;
                    }
                    else if(c[i][j]=='D')
                    {
                        a[i][j]=max(a[i-1][j],a[i][j-1])-100;
                        if(a[i][j]<0)
                            a[i][j]=-1;
                    }
                    else if(c[i][j]=='L')
                    {
                        a[i][j]=max(a[i-1][j],a[i][j-1]);
                        if(a[i][j]<0)
                            a[i][j]=-1;
                    }
				}
			}
		}
		ans=a[n][m];
		/*for(i=n-10;i<=n;i++)
		{
			for(j=m-10;j<=m;j++)
				cout<<a[i][j]<<" ";
			cout<<endl;
		}*/
		label:
        printf("%d\n",ans);
	}
    return 0;
}

