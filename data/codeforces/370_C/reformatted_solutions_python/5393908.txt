def In():
    return map(int, raw_input().split())


n, m = In()
a = sorted(In())
b = a[n/2:]+a[:n/2]
ans = sum([1 if p != q else 0 for (p, q) in zip(a, b)])
print ans
for (x, y) in zip(a, b):
    print str(x)+' '+str(y)
