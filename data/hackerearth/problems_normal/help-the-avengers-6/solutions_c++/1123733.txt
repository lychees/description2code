#include <iostream>
using namespace std;

int *a;
int *b;

int isprime(int a)
{
	int i;
	if(a==1) return -1;
    for (i=2; i*i<=a; i++) {
        if (a % i == 0) return -1;
    }
    return 1;
}

int main()
{
    int t;
    cin>>t;
    while(t--)
    {   
    	int n;
    	cin>>n;
    	
        a=new int[n];
        b=new int[n]; 
        //read a
        for(int i=0;i<n;i++)
    	{cin>>a[i];
    	 b[i]=isprime(a[i]);//store with each if it is prime (1), not prime(-1), not known(0)
    	}
    	
    	
    	int loop;
    	cin>>loop;
    	
    	while(loop--)
    	{
    		char w;
    		int idx;
    		int num;
    		cin>>w>>idx>>num;
    	//	cout<<w<<" "<<idx<<" "<<num<<endl;
    	if(w=='A')
    	{
    	int count=0;
    	for(int i=idx-1;i<num;i++)
    	    {if(b[i]==1)count++;}
    	    cout<<count<<endl;
    	}
    	
    	if(w=='C')
    	{
    		a[idx-1]=num;
    		b[idx-1]=isprime(num);
    	}
    	
    	}
    	
    }
    return 0;
}
