#include <iostream>
using namespace std;

int mapping(int c)
{
	if (c == 'a')
	{
		return 0;
	}else if (c == 'b')
	{
		return 1;
	}else if (c == 'c')
	{
		return 2;
	}else
	{
		return -1;
	}
};
int main()
{
	int T;
	cin >> T;
	for(int i = 0; i < T; ++i)
	{
		string str;
		cin >> str;
		int N = str.size();
		int count[3] = {0,0,0};
		long num = 0;
		int start = 0;
		for(int j = 0; j < N; ++j)
		{
			++count[mapping(str[j])];
			while (count[0] > 0 && count[1] > 0 && count[2] > 0)
			{
				num += (j-start);
				--count[mapping(str[start])];
				++start;
			}
		}
		num += (N-start)*(N-start+1)/2;
		cout << num << endl;
	}
    //cout << "Hello World!" << endl;
    return 0;
}
