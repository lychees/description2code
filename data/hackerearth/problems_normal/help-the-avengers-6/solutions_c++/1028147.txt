#include <iostream>
#include <bits/stdc++.h>
#define MAXN 1000000
using namespace std;

bool pr[MAXN+1];
void sieve()
{
	pr[1]=1;
	for(int i=2;i<=1000;++i)
	{
		if(pr[i]==0)
		{
			for(int j=i*i;j<=MAXN;j+=i)
				pr[j]=1;
		}
	}
}
int n;
int bit[33000];
void update(int i,int val)
{
	while(i<=n)
	{
		bit[i]+=val;
		i+=(i&-i);
	}
}
int query(int i)
{
	int sum=0;
	while(i>0)
	{
		sum+=bit[i];
		i-=(i&-i);
	}
	return sum;
}
int range(int x,int y)
{
	return query(y)-query(x-1);
}
int arr[33000];
int main()
{
    sieve();
    int t,x,y,q;
    scanf("%d",&t);
    char qr[5];
    while(t--)
    {
    	scanf("%d",&n);
    	for(int i=0;i<n;++i)
    	{
    		scanf("%d",&arr[i]);
    		if(pr[arr[i]]==0) { update(i+1,1); }
    	}
    	scanf("%d",&q);
    	while(q--)
    	{
    		scanf("%s %d %d",qr,&x,&y);
    		if(qr[0]=='C')
    		{
    			if(pr[arr[x-1]]==0 && pr[y]==1)
    			{
    				update(x,-1);
    			}
    			else if(pr[arr[x-1]]==1 && pr[y]==0)
    			{
    				update(x,1);
    			}
    			arr[x-1]=y;
    		}
    		else
    		{
    			printf("%d\n",range(x,y));
    		}
    	}
    	memset(bit,0,sizeof(bit));
    }
    return 0;
}
