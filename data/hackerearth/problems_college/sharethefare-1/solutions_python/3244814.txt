from collections import defaultdict


t=input()
for i in xrange(t):
	expense = {}
	paid={}
	naam=[]
	n,q=map(int,raw_input().split(' '))
	for j in xrange(n):
		name=raw_input()
		naam.append(name)
		expense[name]=0
		paid[name]=0
	for k in xrange(q):
		who=raw_input()
		amnt=input()
		numb=input()
		naming=[]
		for l in xrange(numb):
			naming.append(raw_input())
		dist=(amnt)/((numb)+1)
		extra=amnt-dist*((numb)+1)
		paid[who]=paid[who]+amnt
		expense[who]=expense[who]+dist+extra
		for name in naming:
			expense[name]=expense[name]+dist
	for xyz in naam:
		if expense[xyz]>paid[xyz]:
			xx=expense[xyz]-paid[xyz]
			print xyz + " owes " +str(xx)
		elif paid[xyz]>expense[xyz]:
			xx=paid[xyz]-expense[xyz]
			print xyz + " is owed " +str(xx)
		else:
			print xyz+" neither owes nor is owed"