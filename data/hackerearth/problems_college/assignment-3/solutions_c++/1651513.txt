#include <iostream>
#include <vector>
#include <algorithm>
#include <cstring>
using namespace std;
typedef long long ll;

vector<int> gnot[20],g[20];
bool vis[20];
int n,k;
int c = 0;
int color[20];
/*int ff(int x){
    return x==g[x]?x:g[x]=ff(g[x]);
}*/
void solve(int x){
	if (x==n+1){
		c++;
		return;
	}
	for(int i=1;i<=3;i++){
		bool ok = true;
		for(int u:gnot[x]){
			if (color[u]==i){
				ok = false;
				break;
			}
		}
		for(int u:g[x]){
			if (color[u]!=i){
				//cout << u << ", " << i << endl;
				ok = false;
				break;
			}
		}
		//if (!ok) continue;
		
		if (ok) {
			//cout << x << ", ";
			color[x] = i;
			solve(x+1);
		}
	}
}
int main()
{
    scanf("%d%d",&n,&k);
    int op,x,y;
    
    for(int i=0;i<k;i++){
    	scanf("%d%d%d",&op,&x,&y);
    	if (op==1){
    		if (x>y) g[x].push_back(y);    	
    		else g[y].push_back(x);
    	}
    	else{
    		if (x>y) gnot[x].push_back(y);
    		else gnot[y].push_back(x);
    	} 
    	
    }
    memset(color,0,sizeof(color));
    solve(1);
    printf("%d",c);
    
    return 0;
}
