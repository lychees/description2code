#include<bits/stdc++.h>
#define si(n) scanf("%d",&n)
#define sll(n) scanf("%lld",&n)
#define mod 1000000007 // 10**9 + 7
#define INF 1e9
#define FOR(i,a,b) for(int (i) = (a); (i) < (b); ++(i))
#define RFOR(i,a,b) for(int (i) = (a)-1; (i) >= (b); --(i))
#define CLEAR(a) memset((a),0,sizeof(a))
#define mp(a, b) make_pair(a, b)
#define pb(a) push_back(a)
#define rep(i, a, b) for (int i = a; i < b; i++)
#define rrep(i, b, a) for (int i = b; i > a; i--)
#define all(v) v.begin(), v.end()
#define GETCHAR getchar_unlocked
#define pi(n) printf("%d\n",n)
#define pll(n) printf("%lld\n",n)
#define rk() int t; scanf("%d",&t); while(t--)
using namespace std;
const double pi = acos(-1.0);
//freopen("in","r",stdin);
//freopen("out","w",stdout);
const int er[8] = {-1,-1,0,1,1,1,0,-1};
const int ec[8] = {0,1,1,1,0,-1,-1,-1};
const int fr[4] = {-1,1,0,0};
const int fc[4] = {0,0,1,-1};
typedef unsigned long long ull;
typedef long long ll;
typedef long l;
typedef pair<int,int> pii;
typedef vector<int> vec;
typedef vector<pii> vpii;
ll po(ll a,ll p)
{ll ret = 1;while(p){if(p&1)ret = (ret*a)%mod;a=(a*a)%mod;p=p>>1;}return ret%mod;}
int bs(int pp[],int a, int b,int c ,int d)
{
		int mid=0,vv=0;
		if(c!=0) vv=pp[c-1];
		while(a<=b)
		{
			mid=(a+b)>>1;
			
			if(pp[mid]-vv>d)
				b=mid-1;
			else if(pp[mid]-vv<d)
				a=mid+1;
			else 
				return mid;
		}
		return mid;
}
int main()
{
    ll t;
    cin>>t;
    while(t--)
    {
    	int n,m,l,r,a[255][255],sum[255][255],ans=0;
    	scanf("%d %d",&n,&m);
    	scanf("%d %d",&l,&r);
    	//cout<<"hhe";
    	for(int i=0;i<n;i++)
    		{
    			for(int j=0;j<m;j++)
    			{
    				scanf("%d",&a[i][j]);
    			}
    		}
    	//		cout<<"--";
    	for(int i=0;i<n;i++)
    		sum[i][0]=a[i][0];
    
    	for(int i=0;i<n;i++)
    		for(int j=0;j<m;j++)
    		{
    			if(j==0)continue;
    			sum[i][j]=sum[i][j-1]+a[i][j];
    		}
    		
    	/*for(int i=0;i<n;i++)
    	{
    		for(int j=0;j<m;j++)
    		{
    			cout<<sum[i][j]<<" ";
    		}
    		cout<<endl;
    	}
    	*/
        for(int i=0;i<m;i++)
       		{
       			for(int j=i;j<m;j++)
       			{
       				int v[100005],pp[100005];
       				
       				for(int k=0;k<n;k++)
       				{
       					//cout<<"=n"<< n;
       					if(i==0)
       						v[k]=(sum[k][j]);
       					else
       						v[k]=(sum[k][j]-sum[k][i-1]);
       					//cout<<sum[k][j]-sum[k][i-1]<<" ";
       					if(k==0)
       						pp[k]=(v[0]);
       					else
       					    pp[k]=(v[k]+pp[k-1]);
       		
       				}
       			//	cout<<endl;
       	/* vector<int> pp;
       //	if(v[0]>r)continue;
       	 pp.push_back(v[0]);
       	 	for(int j=1;j<n;j++)
       	 	{
       	 
       	 	//	cout<<pp[j]<<" ";
       	 	}
       	 	*/
       	 	int rb=0,lb=0;
       	 	
       	 	for(int kk=0;kk<n;kk++)
    		{
    			
    			int ff=0;	
				if(kk!=0)
					ff=pp[kk-1];
				
			    rb=bs(pp,kk,n-1,kk,r);
    			if((pp[rb]-ff)>r) 
    				--rb;
    			
    	    	lb=bs(pp,kk,n-1,kk,l);
    			if((pp[lb]-ff)>=l)
    				--lb;
    			 
    			if(lb-rb==0)
    			{
    				int asdf=max(0,lb);
    				if((pp[asdf]-ff)>=l && (pp[asdf]-ff)<=r)
    					ans++;
    			}
   				ans+=rb-lb;
    		}
    	}
     }
    	printf("%lld\n",ans);
    }/*	
       	 for(int i=0;i<n;i++)
       	 {
       	 	
       	    std::vector<int>::iterator low,high;
            low=std::lower_bound (pp.begin(), pp.end(), l);
       	 	bs(v,0,n-1,l,)
       	 	cout<<"&& "<<*low<<" "<<*high<<endl;
       	 }
       	 */
    return 0;
}
