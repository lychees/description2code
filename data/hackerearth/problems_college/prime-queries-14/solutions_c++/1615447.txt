#include <iostream>
#include <cstdio>
using namespace std;

int prime[2000000] ;

int t[500000] ;
void upd( int v, int l, int r, int ind, int val ) {
    if( l == r ) {
        t[v] = val ;
        return ;
    }
    int m = (l+r)/2 ;
    if( ind <= m )
        upd( v*2, l, m, ind, val ) ;
    else
        upd( v*2+1, m+1, r, ind, val ) ;
    t[v] = max( t[v*2], t[v*2+1] ) ;
}
int get( int v, int l, int r, int L, int R ) {
    if( L > R )
        return 0 ;
    if( l == L && r == R )
        return t[v] ;
    int m = (l+r)/2 ;
    return max( get(v*2,l,m,L,min(m,R)),
        get(v*2+1,m+1,r,max(L,m+1),R) ) ;
}

int n, m, q, a, b, r, i, j, ans ;

int main()
{
    for(i = 0 ; i <= 1000000 ; ++i )
        prime[i] = 1 ;
    prime[0] = prime[1] = 0 ;
    for(i = 0 ; i <= 1000000 ; ++i )
        if( prime[i] )
            for( j = 2*i ; j <= 1000000 ; j += i )
                prime[j] = 0 ;

    scanf("%d %d", &n, &m) ;
    for( i = 1 ; i <= n ; ++i ) {
        scanf( "%d", &r );
        if( prime[r] )
            upd( 1, 1, n, i, r ) ;
    }
    while( m-- ) {
        scanf( "%d %d %d", &q, &a, &b ) ;
        if( !q ) {
            if( prime[b] )
                upd( 1, 1, n, a, b ) ;
            else
                upd( 1, 1, n, a, 0 ) ;
        }
        else {
            ans = get(1,1,n,a,b) ;
            if( !ans )
                ans = -1 ;
            printf( "%d\n", ans ) ;
        }
    }
}
