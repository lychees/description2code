#include <bits/stdc++.h>
using namespace std;
int a[100005],b[100005],x[100005],y[100005];
set< pair<int,int> > s,ss;
int main()
{
   // cout << "Hello World!" << endl;
   int t;
   scanf("%d",&t);
   while(t--)
   {
   	int n;
   	scanf("%d",&n);
   	int i,u,v;
   	for(i=1;i<=n;i++)a[i] = b[i] = x[i] = y[i] = 0;
   	s.clear();
   	ss.clear();
   	for(i=1;i<=n;i++)scanf("%d",&a[i]);
   	for(i=1;i<=n;i++)scanf("%d",&b[i]);
   	for(i=1;i<=n;i++)
   	{
   		u = a[i];
   		v = b[u];
   		if(v!=i)x[v]++,s.insert(make_pair(i,v));
   	}
   		for(i=1;i<=n;i++)
   	{
   		u = b[i];
   		v = a[u];
   		if(v!=i)y[v]++,ss.insert(make_pair(i,v));
   	}
   	int ma = 0;
   	for(i=1;i<=n;i++)ma = max(ma,x[i]),ma = max(ma,y[i]);
   	int oth = 0;
   	set< pair<int,int> >::iterator I;
   	for(I=s.begin();I!=s.end();I++)
   	{
   		u = I->first;
   		v = I->second;
   		if(s.find(make_pair(v,u))!=s.end())oth++;
   	}
   		for(I=ss.begin();I!=ss.end();I++)
   	{
   		u = I->first;
   		v = I->second;
   		if(ss.find(make_pair(v,u))!=ss.end())oth++;
   	}
   	printf("%d %d\n",ma,oth/2);
   }
    return 0;
}
