///IN THE NAME OF MY CREATOR.....................................................
#include<bits/stdc++.h>
#define LL long long
#define mod  1000000007
using namespace std;
LL a[100001];
LL b[100001];

LL bmod(LL a,LL b)
{
      if(b==0)
        {
             return 1;
        }
        else if(b%2==0)
        {
              LL k=bmod(a,b/2)%mod;
              return(k*k)%mod;
        }
        else if(b%2!=0)
        {
             LL k=a%mod;
             LL kk=bmod(a,b-1)%mod;
             return(k*kk)%mod;
        }
}
int main()
{
      int t;
      cin>>t;
      while(t--)
      {
            LL n;
            cin>>n;

            for(int i=0;i<n;i++)
            {
                 cin>>a[i];
            }
            for(int i=0;i<n;i++)
            {
                  cin>>b[i];
            }

            LL temp1=1;
            LL temp2=1;
            LL temp3=1;

            for(int i=0;i<n;i++)
            {
                  temp1=(temp1*a[i])%mod;
                  temp2=(temp2*(bmod(a[i],b[i])-1))%mod;
                  temp3=(temp3*(bmod(a[i]-1,mod-2)%mod))%mod;

              //    cout<<temp1<<" "<<temp2<<" "<<temp3<<endl;
            }

            LL sum=((temp1*temp2)%mod*temp3)%mod;
            cout<<sum<<endl;
      }
      return  0;

}
