#include <bits/stdc++.h>
using namespace std;
int n;
long long int mx;
void func(int A[],int in,int B[],int M[])
{
	if(2*in>n)
	{
		B[in]=A[in];M[in]=A[in];
		if(B[in]>mx) mx=B[in];
	}
	else
	{
		func(A,2*in,B,M);
		func(A,2*in+1,B,M);
		B[in]=M[2*in]+M[2*in+1]+A[in];
		M[in]=max(M[2*in],M[2*in+1])+A[in];
		if(B[in]>mx) mx=B[in];
	}
}
int main()
{
	int t;
	cin>>t;
	while(t--)
	{
		mx=-1000000000000000000LL;
		cin>>n;
		int A[n+1],B[n+1],M[n+1];
		for(int i=1;i<=n;i++) cin>>A[i];
		func(A,1,B,M);
		/*for(int i=1;i<=n;i++)
		{
			cout<<i<<" "<<A[i]<<" "<<M[i]<<"\n";
		}*/
		cout<<mx<<"\n";
	}
	return 0;
}