#include <iostream>
using namespace std;
void count_R(char str[1000][1000],int arr[],int size)
{
	for(int i=0;i<size;i++)
	{
		for(int j=0;j<size;j++)
		{
			if(str[i][j]=='#')
				arr[i]++;
		}
	}
}
int part(int arr[],int size)
{
	int part=1,i,j,upper,lower;
	while(part<=size-1)
	{
		upper=lower=0;
		for(i=0;i<part;i++)
		{
			upper+=arr[i];
		}
		
		for(i=part;i<size;i++)
		{
			lower+=arr[i];
		}
		
		if(upper==lower)
			return 1;
		part++;
	}
	return 0;
}
void swap(char str[1000][1000],int size)
{
	char str1[1000][1000];
	for(int i=0;i<size;i++)
	{
		for(int j=0;j<size;j++)
		{
			str1[j][i]=str[i][j];
		}
	}
	for(int i=0;i<size;i++)
	{
		for(int j=0;j<size;j++)
			str[i][j]=str1[i][j];
	}
}
int main()
{
    int tc,size,i,j;
    char str[1000][1000];
    cin>>tc;
    while(tc--)
    {
    	cin>>size;
    	int tmp_sum=0;
    	for(i=0;i<size;i++)
    	{
    		for(j=0;j<size;j++)
    		{
    			cin>>str[i][j];
    			if(str[i][j]=='#')
    				tmp_sum++;
    		}
    	}
    	if(tmp_sum%2!=0)
    	{
    		cout<<"NO\n";
    		continue;
    	}
    	int *arr=new int[size]();
    	count_R(str,arr,size);
    
    	int ans1=part(arr,size);
    	
    	
    	swap(str,size);
    
    	for(i=0;i<size;i++)
    		arr[i]=0;
    	count_R(str,arr,size);
    	int ans2=part(arr,size);
    	if(ans1==1||ans2==1)
    		cout<<"YES\n";
    	else
    		cout<<"NO\n";
    	delete []arr;
    	
    }
    return 0;
}
