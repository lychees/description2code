#include<bits/stdc++.h>
using namespace std;
void eval()
{
	int n,q;	
	cin>>n>>q;
	vector<string> name(n);
	map<string, int> mp;
	int id=0;
	for(int i=0;i<n;i++)
		{
			cin>>name[i];
			assert(mp.find(name[i])==mp.end());
			mp[name[i]]=id++;
		}
	vector<int> paid(n);
	int m,amt;
	string person, otherPersons;
	while(q--)
	 {
	 	cin>>person;
	 	cin>>amt>>m;
	 	int currId=0;
	 	int avg = amt/(m+1);
	 	paid[mp[person]]+=avg*m;
	 	for(int i=0;i<m;i++)
	 		{
	 			cin>>otherPersons;
	 			paid[mp[otherPersons]]-=avg;
			 }
	 }
	 for(int i=0;i<n;i++)
	  {
	  	int x=paid[i];
	  	cout<<name[i];
	  	if(x==0)
	  		cout<<" neither owes nor is owed\n";
	  	else if(x<0)
	  		cout<<" owes "<<-x<<endl;
	  	else
	  		cout<<" is owed "<<x<<endl;
	  }
}
int main()
{
//	freopen("sampleIn.txt","r",stdin);
	int t;
	cin>>t;
	while(t--)
	 {
		 eval();
	 }
}