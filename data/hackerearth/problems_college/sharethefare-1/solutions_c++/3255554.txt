#include <bits/stdc++.h>
using namespace std;

#define sc(x) scanf("%d",&(x))

int main()
{
    int t;
    sc(t);
    while(t--){
    	map<string,int> mymap;
    	int n,q;
    	sc(n);sc(q);
    	string s[n];
    	int a[n];
    	
    	for(int i=0;i<n;i++){
    		cin>>s[i];
    		mymap[s[i]]=i;
    		a[i]=0;
    	}
    	for(int i=0;i<q;i++){
    		
    		string str;
    		cin>>str;
    		int amount_spent;
    		sc(amount_spent);
    		int nn;
    		sc(nn);
    		nn++;
    		
    		int others_amount=amount_spent/nn;
    		int self_amount=others_amount+(amount_spent%nn);
    		a[mymap[str]]+=(amount_spent-self_amount);
    		for(int j=0;j<nn-1;j++){
    			cin>>str;
    			a[mymap[str]]-=others_amount;
    		}
    	}
    	
    	for(int i=0;i<n;i++){
    		if(a[i]>0){
    			cout<<s[i]<<" is owed "<<a[i]<<endl;	
    		}
    		else if(a[i]<0){
    			cout<<s[i]<<" owes "<<abs(a[i])<<endl;
    		}
    		else{
    			cout<<s[i]<<" neither owes nor is owed"<<endl;
    		}
    	}
    }
}
