#include <iostream>
#include <queue>
#include <algorithm>
#include <climits>
#include <cstdio>
#include <cstdlib>
#include <cmath>
#include <fstream>
#include <string.h>
#include <vector>
#include <set>
#include <stdlib.h>
#include <set>
#include <map>
#include <stack>
#define ll long long int
#define IN_M 1061109567
#define get getchar
 
using namespace std;
 
int arr[1000005];
 
int main ()
{
	ll t;
	cin >> t;
	
	for (ll i = 0; i < 10000005; i++) {
		
	}
    
    while (t--) {
    	string str;
    	
    	cin >> str;
    	
    	stack <ll> s;
    	
    	ll count = 0;
		ll sum = 0;
		
    	for (ll i = str.length() - 1; i >= 0; i--) {
    		
			if(str[i] == 'X') {
    			s.push(1);
    			count++;
    		}
    		
    		else {
    			if (str[i] == 'A') { 
    				ll a = s.top();	
					s.pop();
    				
					ll b = s.top();
					s.pop();
    				s.push(a + b);
    			}
    			
    			else { 
    				ll a = s.top();
					s.pop();
    				ll b = s.top();
					s.pop();
    				s.push(max(a, b));
    			}
    		}
    	}
    	
    	vector <int> v(count);
    	
    	for (ll i = 0; i < count; i++) {
    		cin >> v[i];
    	}
    	
    	sort(v.begin(), v.end(), greater <int> ());
    	
    	ll i = s.top();
    	i -= 1;
    	
    	for (; i >= 0; i--)	{
    		sum += v[i];
    	}
    	
    	cout << sum << endl;
    }
    
    return 0;
}