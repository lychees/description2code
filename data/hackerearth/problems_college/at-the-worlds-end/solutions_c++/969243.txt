#include<stdio.h>
#include<stdlib.h>
#include<math.h>
#include<iostream>
using namespace std;
int main()
{
	int n,m,ntc,arr[509][509],dp[509][509],i,j;
	scanf("%d",&ntc);
	while(ntc--)
	{

	scanf("%d%d",&n,&m);
	for(i=1;i<=n;i++)
		for(j=1;j<=m;j++)
			scanf("%d",&arr[i][j]);
	dp[n][m]=1;
	for(i=n-1;i>0;i--)
	{
		dp[i][m]=max(-arr[i][m]+1,dp[i+1][m]-arr[i][m]);
		if(dp[i][m]<0)
			dp[i][m]=0;
	}
	for(i=m-1;i>0;i--)
	{
		dp[n][i]=max(-arr[n][i]+1,dp[n][i+1]-arr[n][i]);
		if(dp[n][i]<0)
		dp[n][i]=0;
	}


	for(i=n-1;i>0;i--)
	{	
		for(j=m-1;j>0;j--)
		{
		dp[i][j]=max(min(dp[i][j+1],dp[i+1][j])-arr[i][j],-arr[i][j]+1);
		if(dp[i][j]<0)
			dp[i][j]=0;
		}
	}
	printf("%d\n",dp[1][1]);

}

}

