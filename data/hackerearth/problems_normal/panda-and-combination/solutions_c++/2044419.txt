# include<bits/stdc++.h>
using namespace std;

long long p[1006];

int power(long long n,long long k)
{
	p[0]=1;
	long long i=1,total=1;
	while(total<=n)
	{
		total=total*k;
	//	cout<<"was here"<<"\n";
		if(total>1e9 && k>=1e9)
		{		p[i]=total;
				return i;
		}
		
		if(total==p[i-1] || total>n)
			return i-1;
		p[i++]=total;
	}
	return 0;
}

int main()
{
	long long t,n,m,mp,ans;
	scanf("%lld",&t);
	while(t--)
	{	ans=0;
		memset(p,0,sizeof(p));
		scanf("%lld %lld",&n,&m);
		mp=power(n,m);
		for(int i=mp;i>=0;i--)
		{
			if(n/p[i])
			{	//cout<<"got screwed"<<"\n";
				ans+=n/p[i];
				n-=((n/p[i]))*p[i];
			}
			if(n==0)
			break;
		}
		printf("%lld\n",ans);
		
	}
	
}