#include<cstdio>
#include<iostream>
#include<algorithm>
#include<cmath>
#include<cstring>
using namespace std;
#define lim 200001
#define mod 1000000007
#define ll long long
ll n,i,x,y,s;
ll A[lim], tree[lim],B[lim];
ll read(ll idx){
  ll sum = 0;
  while (idx > 0){
    sum += tree[idx];
    idx -= (idx & -idx);
  }
  return sum;
}
void update(ll idx, ll val){
  while (idx <= n){
    tree[idx] += val;
    idx += (idx & -idx);
  }
} 
ll be(ll e)
{
  ll x;
  if(!e)
    return 1;
  x=be(e/2);
  x=x*x%mod;
  if(e&1)
    x=x*2%mod;
  return x;
}
int main()
{
  cin>>n;
  for(i=0;i<2*n;i++)
    cin>>A[i];
  if(n==1)
  {
    printf("1\n");
    return 0;
  }
  for(i=0;i<2*n;i++)
  {
    x=read(A[i]-1);
    y=i-x-B[A[i]];
    s=(s+3*y+x+2*B[A[i]])%mod;
    update(A[i],1);
    B[A[i]]=1;
  }
  cout<<s*be(n-2)%mod<<"\n";
	return 0;
}
