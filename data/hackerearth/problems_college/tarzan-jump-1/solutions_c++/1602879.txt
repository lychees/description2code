#include <bits/stdc++.h>
 #define FOR(i, a, b) for(int i=a; i<=b; ++i)
 using namespace std;
 int main()
 {
   //freopen("input8.txt", "r", stdin);
   //freopen("output8.txt", "w", stdout);
     // freopen("/home/spharish/input.txt", "r", stdin);

   int n,m,b,e,j,i;
   cin>>n>>m;
   assert(n >= 1 and n <= 1000);
   assert(m >= 0 and n <= 1000000);

   vector< vector<int> > a;
   vector<int> x1,x2,d,q;
   a.resize(n+1);
   x1.push_back(0);x2.push_back(0);
         for(i=0;i<=n;i++)
         { a[i].resize(n+1); d.push_back(-1); } 
         x1.resize(m+1);x2.resize(m+1);d.resize(n+1);q.resize(n+1);
         for(i=1;i<=n;i++){for(j=1;j<=n;j++){a[i][j]=1;}}

         for(i=1;i<=m;i++)
         {
             cin>>x1[i]>>x2[i];
             assert(x1[i] >= 1 and x1[i] <= n);
             assert(x2[i] >= 1 and x2[i] <= n);
             a[x1[i]][x2[i]]=0;
             a[x2[i]][x1[i]]=0;
         }
             int h=1,t=1;
             //cin>>b>>e;
             b = 1;
             e = n;
             d[b]=0;
             q[t]=b;
             while(t>=h) {
                 j=q[h];
             FOR(k,1,n) {
                   if((a[j][k]==1)&&(d[k]==-1)) {
                     t++;
                    q[t]=k;
                    d[k]=d[j]+1;
                   }
             }
                    h++;
         }
                   if (d.at(e) == -1)
                     cout << "HOHA HOHA"<< endl;
                   else
                     cout<<d.at(e);

         


         return 0;
 }
