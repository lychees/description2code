import sys
test = int(raw_input())
for x in xrange(test):
	Number,query=map(int,sys.stdin.readline().split())
	key=[]; vlaue = []
	for i in xrange(Number):
		string=raw_input()
		key.append(string)
		vlaue.append(0)
	owes = dict(zip(key,vlaue))
	owed = owes.copy()
	for i in xrange(query):
		strinput=str(raw_input())
		fare = int(raw_input())
		present = owed[strinput]
		owed[strinput] = fare+present
		number = int(raw_input())
		share = fare/(number+1)
		fare = fare -share*number
		rem = owes[strinput]
		owes[strinput]  = rem+fare
		for j in xrange(number):
			strr=str(raw_input())
			past = owes[strr]
			owes[strr]  = share+past	
	for keys in key:
		amount = owed[keys]-owes[keys]
		if(amount>0):
			print keys,"is owed",amount
		if(amount == 0):
			print keys,"neither owes nor is owed"
		if(amount<0):
			print keys,"owes",abs(amount)
