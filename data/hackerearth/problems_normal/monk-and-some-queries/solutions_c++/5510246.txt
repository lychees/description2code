#include <iostream>
#include<set>
#include<algorithm>
using namespace std;

int main()
{
	/*int t;
	cin>>t;
	while(t--)
	{*/
     long int n,val,i,cnt;
     cin>>n;
     multiset<long int> m;
     multiset<long int> ::iterator itr;
     for(i=0;i<n;i++)
     {
         int q;
         cin>>q;
         switch(q)
         {
         case 1:
            cin>>val;m.insert(val);
            break;
         case 2:
            cin>>val;

            itr = m.find(val);
            if(itr != m.end())
                m.erase(itr);
            else
                cout<<"-1"<<endl;
            break;
         case 3:
                if(m.size() != 0)
                    cout<<*m.rbegin()<<endl;
                else
                cout<<"-1"<<endl;

                break;
         case 4:
                if(m.size() != 0)
                    cout<<*m.begin()<<endl;
                else
                cout<<"-1"<<endl;

         }
     }


	//}

    return 0;
}