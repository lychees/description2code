//In the name of God
#include <bits/stdc++.h>
using namespace std;
typedef long long ll;
ll ans;
const int Maxn = 1e5 + 9;
const ll Mod = 1e9 + 7;
int fen[Maxn];
ll pw[Maxn];
void update(int v){
//	v++;
	for(v;v < Maxn;v += v & -v)
		fen[v]++;
	return;
}
int qry(int v){
	int res = 0;
//	v++;
	for(v;v;v -= v & -v)
		res += fen[v];
	return res;
}
int query(int l,int r){
	if(r < l) return 0;
	return qry(r) - qry(l-1);
}
int main(){
	int n;
	cin >> n;
	pw[0] = 1;
	for(int i = 1; i < Maxn;i++) pw[i] = (pw[i-1] << 1) % Mod;
	for(int i = 0; i < 2 * n;i++){
		int p;
		cin >> p;
		int self = query(p,p);
		ans += self * pw[n-1];
		ans %= Mod;
		ll up = query(p + 1,n);
		ll down = query(1,p - 1);
		ans += up * pw[n-1];
		ans %= Mod;
		ans += up * pw[n-2];
		ans %= Mod;
		ans += down * pw[n-2];
		ans %= Mod;
		update(p);
	}
	cout << ans << endl;
	return 0;
}