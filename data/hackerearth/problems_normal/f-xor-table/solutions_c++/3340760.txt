#include <bits/stdc++.h>
using namespace std;
#define ll long long
#define mod 1000000007

ll pw2[100];
string XOR(string st1, string st2)
{
	string fin;
	int l = st1.length();
	for(int i=0;i<l;i++)
	{
		if(st1[i]==st2[i]) fin.push_back('0');
		else fin.push_back('1');
	}
	return fin;
}

string rot(string st, ll k)
{
	string t;
	ll l = st.length();
	k %= l;
	for(int i=0;i<l;i++){
		t.push_back(st[(2*l-k+i)%l]);
	}
	return t;
}


string compute(ll n, ll p, string s)
{
	if( n == 0 )
		return s;
	int z=0;
	while(pw2[z]<=n){
		z++;
	}
	ll rot1 = pw2[z-1];
	s = XOR(s,rot(s,p*rot1));
	return compute(n-rot1,p,s);
}
int main()
{
	pw2[0]=1;
	for(int i=1;i<64;i++){
		pw2[i]=pw2[i-1]*2;
	}
	int t;
	scanf("%d",&t);
	while(t--)
	{
		string s;
		ll n,m,p,x;
		scanf("%lld %lld %lld %lld",&n,&m,&p,&x);
		cin>>s;
		n--;
		string fin = compute(n,p,s);
		if(x==1)
		{
			for(int i=0;i<m;i++){
				if(fin[i]=='0') fin[i]='1';
				else fin[i]='0';
			}
			cout<<fin<<endl;
		}
		else cout<<fin<<endl;
	}
}