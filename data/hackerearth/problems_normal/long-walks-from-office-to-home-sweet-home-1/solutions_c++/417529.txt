#include<stdio.h>
#define MOD 1000000007
int A[50][50];
void expo(long long t,int n)
{
	if(t==1)
	return;

	int B[n][n];

	if(t&1)
	{
		for(int i=0;i<n;i++)
		{
			for(int j=0;j<n;j++)
			{
				B[i][j]=A[i][j];
			}
		}
	}
	
	int C[n][n];

	for(int x=0;x<n;x++)
	{
		for(int y=0;y<n;y++)
		{
			C[x][y]=0;
			for(int z=0;z<n;z++)
			{
				C[x][y]=(C[x][y]+(long long )A[x][z]*A[z][y])%MOD;
			}
		}
	}
	for(int i=0;i<n;i++)
	{
		for(int j=0;j<n;j++)
		{
			A[i][j]=C[i][j];
		}
	}
	expo(t>>1,n);

	if(t&1)
	{
		for(int x=0;x<n;x++)
		{
			for(int y=0;y<n;y++)
			{
				C[x][y]=0;
				for(int z=0;z<n;z++)
				{
					C[x][y]=(C[x][y]+(long long)A[x][z]*B[z][y])%MOD;
				}
			}
		}
		for(int x=0;x<n;x++)
		{
			for(int y=0;y<n;y++)
			{
				A[x][y]=C[x][y];
			}
		}
	}
}
int main()
{
	int tc=0;
	scanf("%d",&tc);
	while(tc-->0)
	{
		int n,u,v;
		long long k;
		scanf("%d %lld %d %d",&n,&k,&u,&v);
		for(int i=0;i<n;i++)
		{
			for(int j=0;j<n;j++)
			scanf("%d",&A[i][j]);
		}
		expo(k,n);
		printf("%d\n",A[u][v]);
	}
	return 0;
}
