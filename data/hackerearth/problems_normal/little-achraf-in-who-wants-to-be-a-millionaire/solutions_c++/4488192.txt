#include <bits/stdc++.h>

using namespace std;

#define pb push_back
#define mp make_pair
#define REP(i, n) for (int i = 0; i < (int)(n); ++i)
typedef long long LL;
typedef pair<int, int> PII;

int ord, q, cnt;
char a[100];
LL len[500];
const LL INF = 1e18;
const int MOD = 1e9 + 7;

int solve(int pos, LL ind) {
    if (pos < ord) return pos;
    REP(i, ord) {
        if (ind < len[pos - ord + i]) {
            return solve(pos - ord + i, ind);
        }
        ind -= len[pos - ord + i];
    }
    assert(false);
    return 0;
}

int main() {
    scanf("%d%d", &ord, &q);
    REP(i, ord) {
        len[i] = 1;
        a[i] = '-';
    }
    len[ord] = ord;
    cnt = ord + 1;
    while (cnt < 300) {
        len[cnt] = 2 * len[cnt - 1] - len[cnt - ord - 1];
        len[cnt] = min(len[cnt], INF);
        ++cnt;
    }
    REP(i, q) {
        LL n, x;
        char c;
        scanf("%lld%lld %c", &n, &x, &c), --n, --x;
        if (x >= cnt) {
            x -= (x - cnt) / ord * ord;
            while (x >= cnt) x -= ord;
        }
        if (len[x] < n) {
            cout << 0 << endl;
            return 0;
        }
        int pos = solve(x, n);
        if (a[pos] != '-' && a[pos] != c) {
            cout << 0 << endl;
            return 0;
        }
        a[pos] = c;
    }
    int ans = 1;
    REP(i, ord) if (a[i] == '-') {
        ans = 62ll * ans % MOD;
    }
    cout << ans << endl;
    return 0;
}

