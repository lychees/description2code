#include<bits/stdc++.h>
using namespace std;
int a[6001];
static int n;
static int dp[5001][5001];
void solve(){
	for(int i=0;i<=5000;i++)
	  for(int j=0;j<=5000;j++)
	   dp[i][j]=0;
	for(int length=1;length<=n;length++){
		for(int start=0,end=length-1;end<n;start++,end++){
			if(start==end){
				dp[start][end]=1;
			} else {
				dp[start][end]=min(1+dp[start+1][end],1+dp[start][end-1]);
				for(int i=start+1;i<=end;i++){
				   if(a[start]==a[i]){
				   	dp[start][end]=min(dp[start][end],1+dp[start+1][i-1]+dp[i+1][end]);
				   }	
				}
				for(int i=start+2;i<end;i++){
					if(a[start]==a[i]&&a[i]==a[end]){
						dp[start][end]=min(dp[start][end],dp[start][i]+dp[i][end]-1);
					}
				}
			}
		   //printf("start=%d end=%d dp=%d\n",start,end,dp[start][end]);
		}
	}
	printf("%lld\n",dp[0][n-1]);
}
int main(){
	int t;
	scanf("%d",&t);
	while(t--){
		int c=0;
	scanf("%d",&n);
	for(int i=0;i<n;i++){
		int x;
	    scanf("%d",&x);
	    if(c==0||x!=a[c-1])
	       a[c++]=x;
	}
	n=c;
	if(n==1){
		printf("1\n");
		continue;
	}
	  solve();
	}
	return 0;
}