def tlnr(i):
	global lis
	if 2*i+1 > len(lis)-1: return lis[i],lis[i]
	ldia=tlnr(2*i+1)
	rdia=tlnr(2*i+2)
	return max(ldia[0],rdia[0],ldia[1]+rdia[1]+lis[i]),max(ldia[1],rdia[1])+lis[i]

T = int(raw_input())
for _ in xrange(T):
	N = int(raw_input())
	lis = [int(e) for e in raw_input().split()]
	print tlnr(0)[0]
