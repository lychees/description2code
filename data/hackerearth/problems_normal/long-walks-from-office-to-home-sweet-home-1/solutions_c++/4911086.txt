#include <stdio.h>
int A[50][50];
void expo(long long t,int n){
	if(t==1)
		return;
	int B[n][n];
	if(t&1){
		for(int x=0;x<n;x++)
			for(int y=0;y<n;y++)
				B[x][y]=A[x][y];
	}
	int C[n][n];
	for(int x=0;x<n;x++)
		for(int y=0;y<n;y++){
			C[x][y]=0;
			for(int z=0;z<n;z++){
				C[x][y]=(C[x][y]+(long long)A[x][z]*A[z][y])%1000000007;
			}
		}
	for(int x=0;x<n;x++)
		for(int y=0;y<n;y++)
			A[x][y]=C[x][y];
	expo(t>>1,n);
	if(t&1){
		for(int x=0;x<n;x++)
			for(int y=0;y<n;y++){
				C[x][y]=0;
				for(int z=0;z<n;z++){
					C[x][y]=(C[x][y]+(long long)A[x][z]*B[z][y])%1000000007;
				}
			}
		for(int x=0;x<n;x++)
			for(int y=0;y<n;y++)
				A[x][y]=C[x][y];
	}
}
int main(){
	int T;
	scanf("%d",&T);
	while(T--){
		int N,u,v;
		long long k;
		scanf("%d %lld %d %d",&N,&k,&u,&v);
		int ix,iy;
		for(ix=0;ix<N;ix++)
			for(iy=0;iy<N;iy++)
				scanf("%d",&A[ix][iy]);
		expo(k,N);
		printf("%d\n",A[u][v]);
	}
	return 0;
}