#include<iostream>
using namespace std;
long int M=1000000007;
int main()
{
    int days;
    cin>>days;
    while(days--)
    {
        int N,K;
        cin>>N>>K;
        long long int arr[N+1][N+1];
        for(int i=1;i<=N;i++){
            for(int j=1;j<=N;j++){
                arr[i][j]=K;
            }
        }
        int A;
        cin>>A;
        while(A--){
            char act;
            cin>>act;
            long long int ans=0;
            if(act=='s'){
                int first,second,third;
                cin>>first>>second>>third;
                arr[first][second]*=third;
                arr[first][second]=arr[first][second]%M;
            }
            else
            {
                int a,b,c,d;
                cin>>a>>b>>c>>d;
                //int ans=0;
                for(int i=a;i<=c;i++){
                    for(int j=b;j<=d;j++){
                        ans+=arr[i][j];
                        ans=ans;
                    }
                }
                cout<<ans%M<<endl;
            }
        }
    }
    return 0;
}
