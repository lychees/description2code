#include <bits/stdc++.h>
using namespace std;
#define MOD 1000000007
#define rank ran
#define endl '\n'
#define merge merreikfihikd
long long int dp[15][55][2];
int main(){
    int t;
    cin >> t;
    while(t--){
        int b;
        cin >> b;
        pair<string,long long int> B[b+1];
        for(int i=1;i<=b;++i){string a;
           cin >> a;
           if(a[0]!='N'){
                int c;
                cin >> c;
                B[i].first=a;
                B[i].second=c;
           }
           else{
            B[i].first=a;
            B[i].second=-1;
           }

        }
        dp[t][0][0]=1;
        dp[t][0][1]=1;
        for(int i=1;i<=b;++i){dp[t][i][0]=dp[t][i-1][0];
        dp[t][i][1]=dp[t][i-1][1];
            if(B[i].first=="+"){
                dp[t][i][0]=max(dp[t][i][0],dp[t][i-1][0]+B[i].second);

            }
            else if(B[i].first=="-"){
                dp[t][i][1]=min(dp[t][i][1],dp[t][i-1][1]-B[i].second);
            }
            else if (B[i].first=="*"){
                dp[t][i][1]=min(dp[t][i][1],dp[t][i-1][1]*B[i].second);
                dp[t][i][0]=max(dp[t][i][0],dp[t][i-1][0]*B[i].second);
            }
            else if(B[i].first=="/"){
                dp[t][i][0]=max(dp[t][i][0],dp[t][i-1][0]/B[i].second);
                dp[t][i][1]=min(dp[t][i][1],dp[t][i-1][1]/B[i].second);
            }
            else if(B[i].first=="N"){
                dp[t][i][0]=max(dp[t][i][0],-1*dp[t][i-1][1]);
                dp[t][i][1]=min(dp[t][i][1],dp[t][i-1][0]*-1);
            }
        }
        cout << dp[t][b][0] << endl;

    }
    return 0;
}
