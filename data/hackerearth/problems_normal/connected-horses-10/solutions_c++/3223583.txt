#include<bits/stdc++.h>
using namespace std;
#define maxn 1001
#define MOD 1000000007

typedef long long ll;
int n,m,q;
int mat[maxn][maxn];
vector<ll> fact(1000001);
int xdir[]={1,2,-1,-2,1,2,-1,-2};
int ydir[]={2,1,2,1,-2,-1,-2,-1};

ll bfs(int x,int y){
	queue<pair<int,int> > q;
	q.push(make_pair(x,y));
	mat[x][y]=2;	
	int c=0;
	while(!q.empty()){
		c++;
		pair<int,int> p=q.front();
		q.pop();
		int x1=p.first;
		int y1=p.second;
		for(int i=0;i<8;i++){
			if(x1+xdir[i]>=0 && x1+xdir[i]<n && y1+ydir[i]>=0 && y1+ydir[i]<m && mat[x1+xdir[i]][y1+ydir[i]]==1){
				mat[x1+xdir[i]][y1+ydir[i]]=2;
				q.push(make_pair(x1+xdir[i],y1+ydir[i]));	
			}
		}
	}
	return c;
}
void init(){
//	memset(fact,0,sizeof(fact));
	fact[0]=1;
	for(ll i=1;i<=1000000;i++){
		fact[i]=(i*fact[i-1])%MOD;
	}
}
int main(){
//	cout<<"j";
	int test;
	scanf("%d",&test);
	
	init();
//	cout<<"here";
	while(test--){
		scanf("%d%d%d",&n,&m,&q);
		memset(mat,0,sizeof(maxn));
		int x,y;
		for(int i=0;i<q;i++){
			scanf("%d%d",&x,&y);
			x--;
			y--;
			mat[x][y]=1;
		}
		ll ans=1;
		for(int i=0;i<n;i++){
			for(int j=0;j<m;j++){
				if(mat[i][j]==1){
					ans=(ans*fact[bfs(i,j)])%MOD;	
				}
			}
		}
		cout<<ans<<endl;
	}
	return 0;
}