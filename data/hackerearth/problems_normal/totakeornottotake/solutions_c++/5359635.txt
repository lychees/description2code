#include <bits/stdc++.h>
#define max(a, b) (a>=b?a:b)
#define min(a, b) (a<=b?a:b)
using namespace std;

int main()
{
    int t;
    cin>>t;
    while (t--){
    	int n;
    	cin>>n;
    	vector<long long> mx, mn;
		for (int i=0; i<=n+1; i++){ mx.push_back(1), mn.push_back(1); }
    	for (int i=1; i<=n; i++){
    		mx[i] = max(mx[i], mx[i-1]);
    		mn[i] = min(mn[i], mn[i-1]);
    		int no;
    		char x;
    		cin>>x;
    		if (x != 'N') cin>>no;
    		
    		if (x == '+'){
    			for (int j=0; j<i; j++){
    				mx[i] = (max(mx[j], (max(mx[j]+no, mn[j]+no))));
    				mn[i] = (min(mn[j], (min(mx[j]+no, mn[j]+no))));
    			}
    		}
    		
    		if (x == '-'){
    			for (int j=0; j<i; j++){
    				mx[i] = (max(mx[j], (max(mx[j]-no, mn[j]-no))));
    				mn[i] = (min(mn[j], (min(mx[j]-no, mn[j]-no))));
    			}
    		}
    		
    		if(x == '*'){
    			for (int j=0; j<i; j++){
    				mx[i] = (max(mx[j], (max(mx[j]*no, mn[j]*no))));
    				mn[i] = (min(mn[j], (min(mx[j]*no, mn[j]*no))));
    			}
    		}
    		
    		if (x == '/'){
    			for (int j=0; j<i; j++){
    				mx[i] = (max(mx[j], (max(mx[j]/no, mn[j]/no))));
    				mn[i] = (min(mn[j], (min(mx[j]/no, mn[j]/no))));
    			}
    		}
    		
    		if (x == 'N'){
    			for (int j=0; j<i; j++){
    				mx[i] = (max(mx[j], (max(-1*mx[j], -1*mn[j]))));
    				mn[i] = (min(mn[j], (min(-1*mx[j], -1*mn[j]))));
    			}
    		}
    	}
    	cout<<mx[n]<<endl;
    }
    return 0;
}
