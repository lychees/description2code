#include<iostream>
#include<stdio.h>
#include<string.h>
#include<cstring>
#include<map>
#include<vector>
#define LL long long
#define pb push_back
#define MAX 100010
#define MOD 1000000007
using namespace std;
LL num[MAX];
LL pow[MAX];
LL power(LL a, LL b)
{
          LL res = 1;
          LL mul = a;
          while(b > 0){
                  if(b&1){
                        res = res*mul;
                        if(res >= MOD)
                              res = res%MOD;            
                  }  
                  mul = mul*mul;
                  if(mul >= MOD)
                              mul = mul%MOD;
                  b = b>>1;      
          }
          return res;
}
LL GPSum(LL a, LL r , LL n){

          
          LL res = a;
          LL temp = power(r,n);
          temp = temp - 1LL;
          
          if(temp < 0)
                    temp = temp + MOD;
          res = res*temp;
     
          if(res >= MOD)
                    res = res%MOD;
          if(r > 1)
                    res = res*power(r-1LL, MOD-2LL);
   
          if(res >= MOD)
                    res = res%MOD;
          return res;
                    
}
int main()
{
           
          
           
          int t;
          cin>>t;
          while(t--)
          {
                    int n;
                    cin>>n;
                    for(int i=0 ; i<n ; i++)
                              cin>>num[i];
                    for(int i=0 ; i<n ; i++)
                              cin>>pow[i];
                    LL res = 1;
                    for(int i=0 ; i<n ; i++){
                              res = res*GPSum(num[i], num[i], pow[i]);
                              if(res >= MOD)
                                        res = res%MOD;
                    }
                    cout<<res<<endl;
                    
          }         
          
                    
}
