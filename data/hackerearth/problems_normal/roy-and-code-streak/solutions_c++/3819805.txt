#include <iostream>
#include <stdio.h>
#include <unordered_set>
using namespace std;

int main()
{
	int t,n,i,ans,a,b;
	unordered_set<int> s;
	scanf("%d",&t);
	while(t--){
		ans=0;
		int s1[1000001]={0};
		scanf("%d",&n);
		for(i=0;i<n;i++){
			scanf("%d %d",&a,&b);
			if(b==0){
				if(ans<s.size()) ans = s.size();
				s.clear();
			}
			else{
				if(s1[a]==0){ 
					s.insert(a);
					s1[a]=1;
				}
			}
		}
		if(s.size()>ans) ans = s.size();
		s.clear();
		printf("%d\n",ans);
	}
    return 0;
}
