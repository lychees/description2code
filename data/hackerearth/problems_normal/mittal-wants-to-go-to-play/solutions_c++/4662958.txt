#include<bits/stdc++.h>
using namespace std;
#define LL long long
#define S 1000005
#define W while
#define M 1000000007
#define str string
#define pi 3.14159265
LL mini=INT_MAX;
LL maxi=INT_MIN;
vector<pair<int,int > > v[10100];
int dist[10001];
int ver;
void digisktra(int i)
{
	for(int i=0;i<ver+1;i++)
	dist[i]=INT_MAX;
	priority_queue<pair<int,int> > pq;
	pq.push(make_pair(0,1));
	dist[1]=0;
	W(!pq.empty())
	{
		pair<int,int> p=pq.top();
		pq.pop();
		int i=p.second;
		if(dist[i]==INT_MAX)
				continue;
		for(int j=0;j<v[i].size();j++)
		{
			int x=v[i][j].first;
			int wt=v[i][j].second;
			
			if(dist[x]>dist[i]+wt)
			{
				dist[x]=dist[i]+wt;
				pq.push(make_pair(-dist[x],x));
			}
		}
	}
	for(int i=0;i<=ver;i++)
	v[i].clear();
}
int main()
{
	int t;
	cin>>t;
	W(t--)
	{
	int n,m;
	cin>>n>>m;
	ver =n;
	for(int i=0;i<m;i++)
	{
		int a,b,c;
		cin>>a>>b>>c;
		v[a].push_back(make_pair(b,c));
		v[b].push_back(make_pair(a,c));
	}
	digisktra(1);
//	for(int i=1;i<=n;i++)
	//	cout<<dist[i]<<endl;
	int q;
	cin>>q;
	while(q--)
	{
		int j,k;
		cin>>j>>k;
		if(2*dist[j]>k)
			cout<<0<<endl;
		else
			cout<<(k-2*dist[j])<<endl;
	}
	}
	return 0;
}