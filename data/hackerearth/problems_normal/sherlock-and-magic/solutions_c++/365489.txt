#include<cstdio>
#include<iostream>
using namespace std;
struct pos{
    int x;int y;char z;
    int status;
}a[55];
int main(){
    int t;scanf("%d",&t);
    while(t--){
        int n;scanf("%d",&n);
        for(int i=0;i<n;i++){
            cin>>a[i].x>>a[i].y>>a[i].z;
            a[i].x*=2;
            a[i].y*=2;
        }    
        int ans=n;
        int cant=5000;
        int check=4002;
        while(check--){
            for(int i=0;i<n;i++){
                if(a[i].z=='N'){a[i].y++;}
                else if(a[i].z=='E'){a[i].x++;}
                else if(a[i].z=='W'){a[i].x--;}
                else{a[i].y--;}
            }    
            for(int i=0;i<n;i++){
                int flag=0;
                for(int j=i+1;j<n;j++){
                    if(a[i].x==a[j].x&&a[i].y==a[j].y){
                        flag=1;
                        a[j].z='N';
                        a[j].x=a[j].y=cant++;
                        ans--;
                    }    
                }    
                if(flag){
                    ans--;
                    a[i].x=a[i].y=cant++;
                    a[i].z='N';
                }    
            }    
        }    
        printf("%d\n",ans);
    }
    //system("pause");    
    return 0;
}    