#include <bits/stdc++.h>

using namespace std;

const int N = int(1e4)+1;
const int M = int (1e5)+1;
vector<int> adjList[N];
int dist[N];
bool visited[N];

int main() {
	int T; 
	cin >> T;
	for (int t = 0; t < T; t++) {
		int N, M;
		cin >> N >> M;
		for (int i = 0; i < M; i++) {
			int x, y;
			cin >> x >> y;
			adjList[x].push_back(y);
			adjList[y].push_back(x);
		}
		
		queue<int> Q;
		Q.push(1);
		visited[1] = true;
		dist[1] = 0;
		while (!Q.empty()) {
			int u = Q.front();
			Q.pop();
			for (int i = 0; i < adjList[u].size(); i++) {
				if (!visited[adjList[u][i]]) {
					dist[adjList[u][i]] = dist[u]+1;
					Q.push(adjList[u][i]);
					visited[adjList[u][i]] = true;
				}
			}
		}
		cout << dist[N] << endl;
		for(int i=1;i<=N;i++)
		{
			adjList[i].clear();
			visited[i]=0;
		}
	}
	return 0;
}