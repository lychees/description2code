#include<bits/stdc++.h>			

#define pb push_back
#define pp pop_back
#define sz(a) (int)(a.size())
#define F first
#define S second
#define mp make_pair
#define ll long long
#define ull unsigned long long

using namespace std;

const int N = (int)1e6 + 123;
const ll INF = (ll)1e18 + 123;
const int inf = (int)1e9 + 123;
const double eps = 1e-6;

inline void boost()
{
	ios_base::sync_with_stdio(0);
	cin.tie(NULL);	
}

//  (?� ?? ?�)

int t, n;
int s[N];
bool r[N], u[N];
int ans, res;

int main() {
	scanf("%d", &t);
	while(t --){
		memset(u,0,sizeof u);
		ans = res = 0;
		scanf("%d", &n);
		for(int i = 1; i <= n; i ++){
			scanf("%d%d", &s[i], &r[i]);
		}
		for(int i = 1; i <= n; i ++){
			if(!r[i]){	
				res = max(res, ans);
				ans = 0;
			}
			if(u[s[i]])
				continue;
			if(r[i] == 1){
				ans ++;
				u[s[i]] = 1;
			}
		}
		res = max(res, ans);
		printf("%d\n", res);

	}  	
	return 0;
}
