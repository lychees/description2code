#include <bits/stdc++.h>
#define ll long long int
using namespace std;

ll in(){

	ll cc = getc(stdin);
	for (;cc < '0' || cc > '9';)  cc = getc(stdin);
	int ret = 0;
	for (;cc >= '0' && cc <= '9';)
	{
	  ret = ret * 10 + cc - '0';
	  cc = getc(stdin);
	}
	return ret;
}


int main()
{
    ll t,n,i,z,m,ans,sign,sum,p,q;
    t=in();
    while(t--){
    	ll a[100005];
    	n=in();
    	cin>>m;
    	cin>>z;
    	sum=0;
    	
    	for(i=0;i<n;i++)
    		a[i]=in();
    	if(n==1){
    		cout<<a[0]<<endl;
    	}
    	else{
    		p=1;
	    	for(i=n-1;i>=0;i--){
	    		sign=pow(-1,p+1);
	    		sum=(sum+(a[i]*sign))%m;
	    		p++;
	    	}
	    	a[n]=sum;
	    	if(z==n){
	    		cout<<a[z]<<endl;
	    	}
	    	else{
		    	p=z%(n+1);
		    	q=z/(n+1);
		    	ans=a[p];
		    	if(q%2!=0 && (n+1)%2!=0){
		    		ans=ans*-1;
		    	}
		    	if(ans<0)
		    		ans+=m;
		    	else
		    		ans%=m;
		    	cout<<ans<<endl;
	    	}
    	}
    }
    return 0;
}
