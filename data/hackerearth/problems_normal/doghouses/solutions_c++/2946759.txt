#include <bits/stdc++.h>

#define FO(i,a,b) for (int i = (a); i < (b); i++)
#define sz(v) int(v.size())

using namespace std;

#define W 1005

int y[1005];
vector<int> x[1005];
int c[1005][1005];
int n;

void fx(vector<int> &xs) {
    sort(xs.begin(),xs.end());
    if (sz(xs) < 6) return;
    xs.erase(xs.begin()+3, xs.end()-3);
}

int main() {
    scanf("%d", &n);
    FO(i,1,n+1) {
        scanf("%d", &y[i]);
        x[y[i]].push_back(i);
        c[y[i]][i]++;
    }
    FO(yy,0,W) FO(xx,1,W) c[yy][xx] += c[yy][xx-1];
    int res = 1;
    FO(y0,0,W) {
        vector<int> xs = x[y0];
        FO(y1,y0+1,W) {
            for (int v : x[y1]) xs.push_back(v);
            fx(xs);
            for (int x0 : xs) for (int x1 : xs) if (x0 < x1) {
                int ans = 0;
                ans += c[y1][x1] - c[y1][x0-1];
                ans += c[y0][x1] - c[y0][x0-1];
                ans += y0 < y[x0] && y[x0] < y1;
                ans += y0 < y[x1] && y[x1] < y1;
                res = max(res, ans);
            }
        }
    }
    printf("%d\n", res);
    return 0;
}

