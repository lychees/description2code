    //#include <bits/stdc++.h>
    #include <iostream>
    #include <vector>
    #include <iterator>
    #include <algorithm>
    #include <string>
    #include <cmath>
    #include <map>
    #include <set>
    #include <queue>
    #include <stack>
    #include <fstream>

    #define gc getchar_unlocked

    using namespace std;

    typedef long long        ll;
    typedef pair<int, int>   pii;
    typedef pair<int, pii>   piii;
    typedef vector<int>      vi;
    typedef set<int>         si;
    typedef vector<pii>      vii;
    typedef vector<piii>     viii;

    #define forup(a,b,c) for (int (a)=(b); (a)<(c); (a)++)
    #define forn(a,b,c)  for (int (a)=(b); (a)<=(c); (a)++)
    #define ford(a,b,c)  for (int (a)=(b); (a)>=(c); (a)--)
    #define rep(i,n)     forup(i,0,n)
    #define repn(i,n)    forn(i,1,n)
    #define repd(i,n)    ford(i,n,1)
    #define foreach(i,X) for(__typeof((X).begin()) i = (X).begin(); i != (X).end(); i++)
    #define all(a)       a.begin(),a.end()

    const int inf = numeric_limits<int>::max();
    const ll linf = numeric_limits<ll>::max();

    #define fi           first
    #define se           second
    #define pb           push_back
    #define mp           make_pair

    void fs(int &x)
    {
        register int c = gc();
        x = 0;
        int neg = 0;
        for(;((c<48 || c>57) && c != '-');c = gc());
        if(c=='-') {neg=1;c=gc();}
        for(;c>47 && c<58;c = gc()) {x = (x<<1) + (x<<3) + c - 48;}
        if(neg) x=-x;
    }



    int main()
    {
        int t; cin>>t;
        while(t--)
        {
            int n,m; cin>>n>>m;
            viii e;
            rep(i,m)
            {
                int a,b,w;
                cin>>a>>b>>w;
                e.pb(mp(-w, mp(a,b)));
            }
            int dis[n+1];
            repn(i,n) dis[i]=inf;
            dis[1]=0;
            int yes=0;
            repn(k,n+1)
            {
                foreach(it,e)
                {
                    piii p=*it;
                    if(dis[p.se.fi]==inf) continue;
                    if(dis[p.se.fi]+p.fi < dis[p.se.se])
                    {
                        dis[p.se.se]=dis[p.se.fi]+p.fi;
                        if(k==n+1) yes=1;
                    }
                }
            }
            if(yes) cout<<"Yes"<<endl;
            else cout<<"No"<<endl;
        }
        return 0;
    }