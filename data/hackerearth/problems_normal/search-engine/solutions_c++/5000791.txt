#include <iostream>
#include<string>
#include<string.h>
#include<algorithm>
#include<stdio.h>
using namespace std;

struct tr
{
	int a[26];
	int maxwt;
	int maxch;
}st[1000005];

int id=1;

void init_node(int cur)
{
	int i;
	for(i=0;i<26;i++)
		st[cur].a[i]=-1;
	st[cur].maxwt=-1;
	st[cur].maxch=-1;
}

void ins(string s,int wt)
{
	int i,j,cur=0;
	for(i=0;s[i]!='\0';i++)
	{
		if(st[cur].a[s[i]-'a']!=-1)
		{
			if(wt>st[cur].maxwt)
			{
				st[cur].maxwt=wt;
				st[cur].maxch=s[i]-'a';
			}
			cur=st[cur].a[s[i]-'a'];
		}
		else
		{
			init_node(id);
			st[cur].a[s[i]-'a']=id;
			if(wt>st[cur].maxwt)
			{
				st[cur].maxwt=wt;
				st[cur].maxch=s[i]-'a';
			}
			cur=id;
			id++;
		}
	}
}

int cal(string s)
{
	int i,j,cur=0;
	for(i=0;s[i]!='\0';i++)
	{
		if(st[cur].a[s[i]-'a']==-1)
			return -1;
		else
			cur=st[cur].a[s[i]-'a'];
	}
	return st[cur].maxwt;
}

int main()
{
    int n,q,wt,i,j;
    string s;
    cin>>n>>q;
    init_node(0);
    for(i=0;i<n;i++)
    {
    	cin>>s>>wt;
    	ins(s,wt);
    }
    
    //~ for(i=0;i<id;i++)
    //~ {
    	//~ for(j=0;j<26;j++)
    		//~ printf("%d ",st[i].a[j]);
    	//~ printf("\n");
    	//~ printf("%d %d\n\n",st[i].maxwt,st[i].maxch);
    //~ }
    
    while(q--)
    {
    	cin>>s;
    	cout<<cal(s)<<endl;
    }
    return 0;
}
