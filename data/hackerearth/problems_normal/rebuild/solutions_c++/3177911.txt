#include <bits/stdc++.h>
using namespace std;

int t;

int n, m;

int p1, p2;
pair < long long , pair <int,int> > tab[1000007];

int ile[1000007];
int oj[1000007];

long long sum;

int fin(int v)
{
    if (v!=oj[v])
    oj[v]=fin(oj[v]);
    return oj[v];
}

int uni(int v, int u)
{
    ile[v]++;
    ile[u]++;
    v=fin(v);
    u=fin(u);
    oj[v]=u;
}

int main()
{
    scanf("%d", &t);
    while(t--)
    {
        scanf("%d%d", &n, &m);
        for (int i=1; i<=n; i++)
        {
            ile[i]=0;
            oj[i]=i;
        }
        sum=0;
        for (int i=1; i<=m; i++)
        {
            scanf("%d%d%lld", &tab[i].second.first, &tab[i].second.second, &tab[i].first);
            tab[i].first*=-1;
            if (tab[i].second.first>tab[i].second.second)
            swap(tab[i].second.first, tab[i].second.second);
        }
        sort(tab+1, tab+1+m);
        for (int i=m; i; i--)
        {
            if (fin(tab[i].second.first)!=fin(tab[i].second.second))
            {
                sum-=tab[i].first;
                uni(tab[i].second.first, tab[i].second.second);
            }
        }
        printf("%lld\n", sum);
        for (int i=1; i<=n; i++)
        {
            printf("%d ", ile[i]);
        }
        printf("\n");
    }
    return 0;
}
