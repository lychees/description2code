#include <stdio.h>

#define NMAX 1111111

int N, M, P, X, p, c;
char A[2][NMAX];

void ReadInput() {
	scanf("%d %d %d %d %s", &N, &M, &P, &X, A[0]);
	for (int i = 0; i < M; i++) A[0][i] -= '0';
}

void Solve() {
	c = 0;
	for (int b = 30; b >= 0; b--) {
		if (((N - 1) & (1 << b)) == 0) continue;
		p = c; c ^= 1;
		int len = ((long long) (1 << b) * (long long) P) % M;
		for (int j = 0; j < M; j++) {
			A[c][j] = A[p][(j - len + M) % M] ^ A[p][j] ^ X;
		}
	}
}

void WriteOutput() {
	for (int i = 0; i < M; i++) A[c][i] += '0';
	printf("%s\n", A[c]);
}

int main() {
//	freopen("x.txt", "r", stdin);
	int T;
	scanf("%d", &T);
	while (T--) {
		ReadInput();
		Solve();
		WriteOutput();
	}
	return 0;
}