#include <iostream>
#include <utility>
#include <map>
#include <string>
#include <cstring>
using namespace std;

int find(string *s,string st,int n){
	for(int i=0;i<n;i++)
		if(st.compare(s[i]) == 0)
			return i;
}

int main()
{
    int test,n,q,ex,p,diff,mat[50][2],j;
    string str,s[50];
    cin>>test;
    while(test--){
    	cin>>n>>q;
    	for(int i=0;i<n;i++){
    		cin>>s[i];
			mat[i][0] = mat[i][1] = 0;
    	}
    	while(q--){
    		cin>>str;
  			cin>>ex>>p;
  			int i = find(s,str,n);
  			mat[i][0] += ex;
  			mat[i][1] += (ex%(p+1)?(ex/(p+1))+(ex%(p+1)) : (ex/(p+1)));
  			for(int i=0;i<p;i++){
  				cin>>str;
  				j = find(s,str,n);
  				mat[j][1] +=(ex/(p+1));
  			}
    	}
    	for(int i=0;i<n;i++){
    		diff = mat[i][0] - mat[i][1];
    		//cout<<mat[i][0]<<" "<<mat[i][1]<<endl;
    		if(diff > 0)
    			cout<<s[i]<<" is owed "<<diff<<endl;
    		else if(diff < 0)
    				cout<<s[i]<<" owes "<<(-1)*diff<<endl;
    			else
    				cout<<s[i]<<" neither owes nor is owed"<<endl;
    	}
    }
    return 0;
}
