#include <bits/stdc++.h>
#define ll long long
using namespace std;
int main()
{
	//ios_base::sync_with_stdio(false);
	cin.tie(NULL);
	ll int tt,test;
	cin>>test;
	for(tt=1;tt<=test;tt++)
	{
		ll int n;
		cin>>n;
		ll int i;
		ll int inh,inm,in;
		scanf("%lld:%lld",&inh,&inm);
		in=inh*3600+inm*60;//In-time in seconds
		ll int wh,wm,w;
		scanf("%lld:%lld",&wh,&wm);
		w=wh*3600+wm*60;//Wake-up time in seconds
		ll int fh,fm,f;
		scanf("%lld:%lld",&fh,&fm);
		f=fh*3600+fm*60;//Foot-ware store openining time in seconds
		ll int t;
		scanf("%lld",&t);
		t*=60;//travelling time
		ll int s;
		scanf("%lld",&s);
		s*=60;//Selection of sandal-time
		ll int ans=-1,back=INT_MAX;
		for(i=0;i<n;i++)
		{
			ll int x,ssh,ssm,eeh,eem,sh,sm,start,eh,em,end;
			scanf("%lld:%lld",&sh,&sm);
			ssh=0;ssm=0;
			start=ssh*3600+ssm*60;
			end=sh*3600+sm*60 -1;
			start=max(start,w);
			x=start+t;
			x=max(x,f);
			x+=t+s;
			if(x<in && x<=end)
			{
				if(x<back)
				{
					ans=i+1;
					back=x;
				}
			}
			scanf("%lld:%lld",&eh,&em);
			start=eh*3600+em*60+1;
			end=24*3600;
			start=max(start,w);
			x=start+t;
			x=max(x,f);
			x+=t+s;
			if(x<in && x<=end)
			{
				if(x<back)
				{
					ans=i+1;
					back=x;
				}
			}
		}
		printf("Case %lld: %lld\n",tt,ans);
	}
	return 0;
}
