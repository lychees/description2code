M = 10**9+7
for i in range(input()):
    a = input()
    l = [int(x) for x in raw_input().split()]
    l1 = [int(y) for y in raw_input().split()]
    n = 1
    for j in range(0, len(l1)):
        n *= ((pow(l[j], l1[j]+1, M)-l[j]+M) % M)*(pow(l[j]-1, M-2, M))
        n %= M
    print n
