#include <bits/stdc++.h>
#define MOD 1000000007LL

using namespace std;

typedef long long int64;
typedef unsigned long long uint64;

int pai[1000000], rk[1000000], qCount[1000000];

void init(int n){
    for( int i = 1; i <= n; i++ ){
        pai[i] = i;
        rk[i] = 0;
    }
}

int find(int u){
    int a = u;
    while( pai[a] != a ) a = pai[a];
    int b = u;
    while( pai[b] != a ){
        int c = pai[b];
        pai[b] = a;
        b = a;
    }
    return a;
}

void merge(int u, int v){
    int a = find(u);
    int b = find(v);
    if( a == b ) return ;
    if( rk[b] > rk[a] ) swap(a,b);
    if( rk[a] == rk[b] ) rk[a]++;
    pai[b] = a;
}


int main(){
    ios::sync_with_stdio(false);
    int n, k, de, para, op, pa, pb, lb, p;
    cin >> n >> k;
    init(n);
    map < int, int > lider;
    for( int i = 1; i <= n; i++ ) lider[i] = i;

    for( int i = 0; i < k; i++ ){
        cin >> op;
        switch(op){
            case 1:
                cin >> de >> para;
                pa = find(de);
                pb = find(para);
                lb = lider[pb];
                merge(de, para);
                p = find(de);
                lider[p] = lb;
                break;
            case 2: 
                cin >> de;
                p = find(de);
                lider[p] = de;
                break;
            case 3: 
                cin >> de;
                p = find(de);
                cout << lider[p] << '\n';
                break;
        }
    }
    return 0;
}