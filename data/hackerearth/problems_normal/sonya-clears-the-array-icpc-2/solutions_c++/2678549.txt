#include<bits/stdc++.h>
#define pb push_back
#define pii pair <int, int>
#define MOD 1000000007
#define mp make_pair
#define F first
#define S second
#define ll long long
#define maxs 100005
#define iosbase ios_base::sync_with_stdio(false)
#define sc scanf
#define pr printf
#define null NULL
#define getcx getchar_unlocked
using namespace std;
int p[1001005];
int a[1001005], next1[1001005], pre[1001005];
//map < vector <int>, int > M;
int dp[505][505];
vector <int> v;
int rec(int l, int r){
//	cout<<l<<" "<<r<<endl;
	if(r<l)return 0;
	if(l==r)return 100000000;
	if(dp[l][r]!=-1)return dp[l][r];
	int final=1000000000;
	for(int i=l; i<=l; i++){
		for(int j=i+1; j<=r; j+=2){
			int ans=0;
			if(v[i]>pre[a[v[j]]]){
				int tmp=a[v[i]];
				int nx=next1[tmp];
				ans+=(tmp-v[i]);
				ans+=(nx-v[j]);
			}
			else{
				int tmp=pre[a[v[j]]];
				int nxt=a[v[j]];
				ans+=(tmp-v[i])+(nxt-v[j]);
			}
			int t1=rec(l, i-1);
			int t2=rec(j+1, r);
			int t3=rec(i+1, j-1);
	//		cout<<i<<" "<<j<<" "<<l<<" "<<r<<" ";
	//		cout<<t1<<" "<<t2<<" "<<t3<<" "<<ans<<" "<<t1+t2+t3+ans+1<<endl;
			final=min(final, ans+t1+t2+t3+1);
		}
	}
	dp[l][r]=final;
	return final;
}
int main(){
	iosbase;
	for(int i=1; i<=1001000; i++)p[i]=1;
	p[0]=p[1]=0;
	for(int i=2; i<=1001000; i++){
		if(!p[i])continue;
		for(int j=2*i; j<=1001000; j+=i)p[j]=0;
	}
	vector <int> pr;
	for(int i=2; i<=1001000; i++)if(p[i])pr.pb(i);
	for(int i=0; i<pr.size()-1; i++)next1[pr[i]]=pr[i+1];
	for(int i=1; i<pr.size(); i++)pre[pr[i]]=pr[i-1];
	int p1=0;
	for(int i=1; i<=1000800; i++){
		if(pr[p1]>=i){
			a[i]=pr[p1];
		}
		else{
			p1++;
			i--;
		}
	}
	int n,x;
	cin>>n;
	for(int i=0; i<n; i++){
		cin>>x;
		v.pb(x);
	}
	for(int i=0; i<=500; i++)for(int j=0; j<=500; j++)dp[i][j]=-1;
	int ans=rec(0, n-1);
	cout<<ans<<endl;
}