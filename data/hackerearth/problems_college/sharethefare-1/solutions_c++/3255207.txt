#include <iostream>
#include <vector>
#include <string>
#include <map>
using namespace std;

int main()
{
	int t;
	scanf("%d",&t);
	while(t--){
		int n,q;
		scanf("%d%d",&n,&q);
		vector<string>names(n);
		
		map<string,int>paid;
		map<string,int>expenses;
		
		for(int i=0;i<n;++i){
			cin>>names[i];
			paid[names[i]]=0;
			expenses[names[i]]=0;
		}
		while(q--){
			string name;
			cin>>name;
			int amount;
			cin>>amount;
			int split;
			cin>>split;
			
			int each_amount=amount/(split+1);
			paid[name] += amount;
			expenses[name] += each_amount + (amount-(each_amount*(split+1)));
			
			while(split--){
				string each_name;
				cin>>each_name;
				expenses[each_name]+=each_amount;
			}
		}
		
		for(int i=0;i<n;++i){
			string str;
			/*cout<<"name:"<<names[i]<<endl;
			cout<<"paid: "<<paid[names[i]]<<endl;
			cout<<"expe: "<<expenses[names[i]]<<endl;
			cout<<"-----"<<endl;
			*/
			
			int amt=paid[names[i]]-expenses[names[i]];
			if(amt==0){
				str=names[i] + " neither owes nor is owed";
			}else if(amt<0){
				str=names[i] + " owes " + to_string(-1*amt);
				
			}else{
				str=names[i] + " is owed " + to_string(amt);
				
			}
			cout<<str<<endl;
		}
		
	}
    //cout << "Hello World!" << endl;
    return 0;
}
