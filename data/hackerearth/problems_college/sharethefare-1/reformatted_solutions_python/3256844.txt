t = input()
while t > 0:
    t -= 1
    n, q = map(int, raw_input().split())
    d = {}
    group = []
    for i in xrange(n):
        person = raw_input()
        group.append(person)
        d[person] = 0
    for i in range(q):
        payee = raw_input()
        amount = input()
        freeloaders_count = input()
        freeloaders = []
        for i in range(freeloaders_count):
            freeloaders.append(raw_input())
        d[payee] += amount - (amount/(freeloaders_count+1) +
                              amount % (freeloaders_count + 1))
        for freeloader in freeloaders:
            d[freeloader] -= amount/(freeloaders_count + 1)
    for person in group:
        if d[person] == 0:
            print "%s neither owes nor is owed" % (person)
        if d[person] < 0:
            print "%s owes %d" % (person, d[person]*-1)
        if d[person] > 0:
            print "%s is owed %d" % (person, d[person])
