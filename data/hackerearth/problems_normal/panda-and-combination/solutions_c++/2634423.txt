#include <iostream>
#include <algorithm>
#include <set>
using namespace std;

typedef long long ll;

ll t, n, m;
set<ll> store;

int main()
{
    cin >> t;
    
    while( t-- ) {
    	cin >> n >> m;
    	
    	if( m == 1 )
    		cout << n << endl;
    	else if( n < m )
    		cout << n << endl;
		else if( n == m )
			cout << "1\n";
		else {
			store.clear();
			store.insert( 1 );
			ll x = m;
			ll ox = m;
			while( x <= n ) {
				if( ox > x )
					break;
				store.insert( x );
				ox = x;
				x *= m;
			}
			
			ll c = 0;
			while( n > 0 ) {
				if( n < m ) {
					c += n;
					n -= n;
				}
				else if( n == m ) {
					c++;
					n -= n;
				}
				else {
					c++;
					n -= *--store.upper_bound(n);
				}
			}
			cout << c << endl;
		}
    }
    
    return 0;
}
