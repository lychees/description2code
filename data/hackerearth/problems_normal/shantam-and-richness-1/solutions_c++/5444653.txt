#include <iostream>
using namespace std;
int main()
{
    int N;
    cin >> N;
    long temp;
   	long max;
    int index;
    long n,m,l,r,c,p,q,s;
    for(int j=0;j<N;j++){
    	long cost[10000000]={0};
    	index=1;
    	max=0;
		cin >> n >> m;
		cin >> l >> r >> c >> p >> q >> s;
		for(int i=0;i<m;i++){
			cost[l]=cost[l]+c;
			cost[r+1]=cost[r+1]-c;
			temp = (l * p + r) % n + 1;
			r = (r * q + l) % n+ 1;
			if(temp>r){
				l=r;
				r=temp;
			}
			else{l=temp;}
			c = (c * s) % 1000000 + 1;
		}
		long sum=0;
		for(int i=1;i<=n;i++){
			sum=sum+cost[i];
		//	cout << cost[i] << endl;
			if(sum>max){
			//	cout << "inside" << endl;
				max=sum;
				index=i;
			}	
		}
	cout << index << " " << max << endl;
    }
    return 0;
}
