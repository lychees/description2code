#include <bits/stdc++.h>
using namespace std;

int main()
{
	map<int,int> m;
	m.clear();
	int q; cin>>q;
	int o,tmp;
	while(q--){
		cin>>o; 
		if(o==1){
			cin>>tmp;
			m[tmp]++;
		}
		else if(o==2){
			cin>>tmp;
			if(m.count(tmp)==0)
				cout<<-1<<endl;
			else if(m[tmp]==1){
				auto it = m.find(tmp);
				m.erase(it);
			}
			else
				m[tmp]--;
		}
		else if(o==3){
			if(m.size()==0)
			cout<<-1<<endl;
			else{
			auto it = m.rbegin();
			cout<<it->first<<endl;
			}
		}
		else if(o==4){
			if(m.size()==0)
			cout<<-1<<endl;
			else{
			auto it = m.begin();
			cout<<it->first<<endl;
			}
		}
	}
    return 0;
}
