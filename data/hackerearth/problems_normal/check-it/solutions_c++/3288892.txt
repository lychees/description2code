#include<iostream>
#include<utility>
#include<vector>
using namespace std;
int arr[40000];
int root(int a)
{
	while(arr[a]!=a)
	a=arr[a];
	return a;
}
void initialize(int arr[])
{
	for(int i=1;i<=40000;i++)
	arr[i]=i;
}
int main()
{
	int t,a,b,m,n,c;
	cin>>t;
	vector<pair<int,int> >p;
	while(t>0)
	{
		cin>>n>>m;
		initialize(arr);
		for(int i=1;i<=m;i++)
		{
			cin>>a>>b;
			p.push_back(make_pair(a,b));
		}
		int j=1;bool flag=true;
		while(j<n)
		{
			cin>>c;
			int A=p[c-1].first;
			int B=p[c-1].second;
			if(root(A)==root(B))
			{
				flag=false;
			}
			else
			{
				arr[root(A)]=root(B);
			}
			j++;
		}
		if(flag==true)
		cout<<"YES\n";
		else
		cout<<"NO\n";
		p.clear();
		t--;
	}
}
