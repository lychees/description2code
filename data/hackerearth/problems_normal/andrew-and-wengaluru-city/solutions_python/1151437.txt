import sys
def trap(A):
    if not A: 
        return 0
    res=0
    l=[A[0]] * len(A)
    r=[A[len(A) - 1]] * len(A)
    
    for i in range(1, len(A)): 
        l[i]= max(A[i], l[i - 1])
        r[-i - 1] = max(A[-i - 1], r[-i])

    for i in range(1, len(A) - 1):
        res += max(0, (min(l[i - 1], r[i + 1]) - A[i]))
    
    return res%1000000007

test=input()
for t in range(0,test):
	n=input()
	s=map(int,sys.stdin.readline().split())
	print trap(s)
