#include<iostream>
#include<set>
using namespace std;
multiset<long long> s;
long long q,a,b;
int main()
{	cin>>q;
multiset<long long>::iterator it,ij;
 	while(q--)
 	{cin>>a;
 	  if(a==1)
 	   {cin>>b;
 	     s.insert(b);
 	   }
 	   else if(a==2)
 	   {cin>>b;
 	     it=s.find(b);
 	     if(it!=s.end())
 	     s.erase(it);
 	     else
 	     cout<<-1<<endl;
 	   }
 	   else if(a==3)
 	   {if(s.empty())
 	     cout<<-1<<endl;
 	     else
 	     {it=s.end();
 	       it--;
 	       cout<<*it<<endl;
 	     }
 	   }
 	   else
 	   {if(s.empty())
 	     cout<<-1<<endl;
 	     else
 	     {it=s.begin();
 	       
 	       cout<<*it<<endl;
 	     }
 	   }
 	}
 	return 0;
}
 	     