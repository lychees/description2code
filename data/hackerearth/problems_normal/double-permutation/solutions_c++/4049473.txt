#include <iostream>
#include <cstdio>
using namespace std;
#define MOD 1000000007
long long pw2(long long n)
{
	if(n==0) return 1;
	if(n%2==0)
	{
		long long res = pw2(n/2);
		return res*res%MOD;
	}
	return 2*pw2(n-1)%MOD;
}
int data[100001];
char occ[100001];
int query(int idx)
{
	int res=0;
	if(idx<0) return 0;
	while(idx)
	{
		res+=data[idx];
		idx&=idx-1;
	}
	return res;
}
void update(int idx,int delta)
{
	while(idx<100001)
	{
		data[idx]+=delta;
		idx+=idx&-idx;
	}
}
int arr[200010];
int main()
{
    long long res=0;
    int n;
    scanf("%d",&n);
    for(int i=1;i<=2*n;++i) scanf("%d",&arr[i]);
    for(int i=n*2;i>0;--i)
    {
    	long long k = query(arr[i]-1);
    	if(n>1)
    	res = (res+k*pw2(n-2)*3%MOD)%MOD;
    	if(occ[arr[i]])
    	{
    		res = (res+pw2(n-1))%MOD;
    		++k;
    	}
    	if(n>1)
    	res = (res+(n*2-i-k)*pw2(n-2)%MOD)%MOD;
    	update(arr[i],1);
    	occ[arr[i]]=1;
    }
    printf("%lld\n",res);
    return 0;
}
