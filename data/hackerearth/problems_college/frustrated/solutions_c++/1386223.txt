#include <iostream>
#include <string>
using namespace std;
#define MAXNUM 1000003
#define MAXP 78500
int primes[MAXP];
bool arr[MAXNUM]={false};
void markMultiples(int a){
    int i=2,num;
    while((num=i*a)<=MAXNUM){
        arr[num-1]=true;
        ++i;
    }
}
void sievePrimes(){
	int i,k=0;
    for (i=1;i<MAXNUM;++i){
        if (!arr[i]){
        	primes[k++]=i+1;
            markMultiples(i+1);
        }
    }
}
int main(){
	cout.sync_with_stdio(0);
	cin.tie(0);
	sievePrimes();
	int t,k,i,j,pi,pj,n,tmp;
	bool flag;
	string x,y;
	cin>>t;
	while(t--){
		flag=false;
		cin>>k>>x>>y;
		pi=0;
		while(primes[pi]<=k)
			++pi;
		--pi;
		for(i=pi;i>=0;--i){
			n=primes[i];
			flag=true;
			pi=x.length()-1;
			pj=y.length()-1;
			while(n>0 && flag){
				tmp=n%10;
				flag=false;
				for(j=pi;j>=0;--j){
					if(tmp==(int)(x[j]-'0')){
						pi=j-1;
						flag=true;
						break;
					}	
				}
				if(!flag)
					break;
				flag=false;
				for(j=pj;j>=0;--j){
					if(tmp==(int)(y[j]-'0')){
						pj=j-1;
						flag=true;
						break;
					}	
				}
				n/=10;
			}
			if(flag)
				break;
		}
		if(flag)
			cout<<primes[i]<<"\n";
		else
			cout<<"-1\n";
	}
	return 0;
}