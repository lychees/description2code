    #include <bits/stdc++.h>
    using namespace std;
    #define ll long long
    #define mag 100000 //10^8
    #define inf 1e18
    #define MOD 1000000007
    #define rep(i,n) for(i=0;i<n;i++)
    #define mset(x,v) memset(x, v, sizeof(x))
    #define print_array(a,n) for(i=0;i<n;i++) cout<<a[i]<<" ";
    #define var_val(x) cout<<#x<<" "<<x<<endl;
    #define pb push_back
    #define fi first
    #define se second
     
    int main(){
    ll t;cin>>t;
    while(t--){
        ll n,k,i,j;cin>>n>>k;
        ll arr[n][n];
        ll r[n],c[n];mset(r,0);mset(c,0);
        ll r_max[k],c_max[k];
        rep(i,n)
        rep(j,n){
        cin>>arr[i][j];
        r[i]+=arr[i][j];c[j]+=arr[i][j];
        }
        rep(i,k){
        sort(r,r+n);
        r_max[i]=r[0];
        r[0]+=n;
        }
        rep(i,k){
        sort(c,c+n);
        c_max[i]=c[0];
        c[0]+=n;
        }
        rep(i,k){
        if(i==0)
        continue;
        r_max[i]+=r_max[i-1];
        }
        rep(i,k){
        if(i==0)
        continue;
        c_max[i]+=c_max[i-1];
        }
    //    sort(c,c+n,greater<ll>());
        ll ans=inf;
        rep(i,k-1){
    //    cout<<r_max[i]<<c_max[i]<<endl;
        ans=min(ans,c_max[i]+r_max[k-2-i]+(i+1)*(k-1-i));
        }
        ans=min(ans,c_max[k-1]);
        ans=min(ans,r_max[k-1]);
    cout<<ans<<endl;
    }
    }