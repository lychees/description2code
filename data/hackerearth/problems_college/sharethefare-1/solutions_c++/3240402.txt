#include <bits/stdc++.h>
#define ll long long
using namespace std;
string s[60];
int main()
{
	ios_base::sync_with_stdio(false);
	cin.tie(NULL);
	ll int test;
	cin>>test;
	while(test--)
	{
		ll int n,q;
		cin>>n>>q;//n people & q transaction
		unordered_map<string,ll int> mp,paid;
		ll int i,j,amt,m;
		string t,x;
		for(i=0;i<n;i++)
		{
			cin>>s[i];
			mp[s[i]]=0;
			paid[s[i]]=0;
		}
		for(i=0;i<q;i++)
		{
			cin>>t>>amt;
			paid[t]+=amt;
			cin>>m;
			for(j=0;j<m;j++)
			{
				cin>>x;
				mp[x]+=amt/(m+1);
			}
			mp[t]+=amt-((amt/(m+1))*m);
		}
		for(i=0;i<n;i++)
		{
			amt=paid[s[i]]-mp[s[i]];
			if(amt==0)
			cout<<s[i]<<" neither owes nor is owed"<<endl;
			else if(amt>0)
			cout<<s[i]<<" is owed "<<abs(amt)<<endl;
			else
			cout<<s[i]<<" owes "<<abs(amt)<<endl;
		}
	}
	return 0;
}
