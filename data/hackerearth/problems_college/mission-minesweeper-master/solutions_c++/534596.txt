#include<iostream>
#include<cstdio>
#include<queue>
using namespace std;

queue<int> qi,qj;

char a[1001][1001],b[1001][1001];
int c[1001][1001];
int t,x,y,i,j,ci,cj;
	
int calc(int i,int j)
{
	int a=0;
	if(j-1>=0)
		a+=b[i][j-1];
	
	if(i-1 >=0 && j-1>=0)
		a+=b[i-1][j-1];
	
	if(i-1>=0)
		a+=b[i-1][j];
	
	if(i-1>=0 && j+1<y)
		a+=b[i-1][j+1];
	
	if(j+1<y)
		a+=b[i][j+1];
	
	if(i+1<x && j+1<y)
		a+=b[i+1][j+1];
	
	if(i+1<x)
		a+=b[i+1][j];
	
	if(i+1<x && j-1>=0)
		a+=b[i+1][j-1];
	
	
	if(a==0)
	{
		if(j-1>=0)
		{
			qi.push(i);
			qj.push(j-1);
		}
		
		if(i-1 >=0 && j-1>=0)
		{
			qi.push(i-1);
			qj.push(j-1);
		}		
		if(i-1>=0)
		{
			qi.push(i-1);
			qj.push(j);
		}
		
		if(i-1>=0 && j+1<y)
		{
			qi.push(i-1);
			qj.push(j+1);
		}
		
		if(j+1<y)
		{
			qi.push(i);
			qj.push(j+1);
		}
		
		if(i+1<x && j+1<y)
		{
			qi.push(i+1);
			qj.push(j+1);
		}
		
		if(i+1<x)
		{
			qi.push(i+1);
			qj.push(j);
		}
		
		if(i+1<x && j-1>=0)
		{
			qi.push(i+1);
			qj.push(j-1);
		}	
	}
	return a;
}

int main()
{
	cin>>t;
	while(t--)
	{
		cin>>x>>y;
		for(i=0;i<x;i++)
			cin>>a[i];
		
		for(i=0;i<x;i++)
		{
			for(j=0;j<y;j++)
			{
				if(a[i][j]=='*')
					b[i][j]=1;
				else
					b[i][j]=0;
				if(a[i][j]=='c')
				{
					qi.push(i);
					qj.push(j);
				}
				c[i][j]=0;
			}
		}
		
		while(qj.size()!=0)
		{
			ci=qi.front();
			qi.pop();
			
			cj=qj.front();
			qj.pop();
			
			if(c[ci][cj]==1)
				continue;
			
			c[ci][cj]=1;
			
			a[ci][cj]=calc(ci,cj);
			a[ci][cj]+='0';
		}
		
		for(i=0;i<x;i++)
			printf("%s\n",a[i]);
	}
	return 0;
}
