#include <bits/stdc++.h>
#define mod 1000000009
using namespace std;
typedef long long int ll;
ll t[500][500]={0},f[500][500]={0};

void fill_table(char s[],char str[])
{
	ll i,j,k,l=strlen(s),v;
	for(i=0;i<l;i++)
	{
		if(s[i]=='1')
		{
			t[i][i]=1;
			f[i][i]=0;
		}
		else
		{
			f[i][i]=1;
			t[i][i]=0;
		}
	}

	ll tot_lef,tot_rig;
	for(i=1;i<l;i++)
	{
		j=0;
		k=i;
		for(k=i;k<l;k++,j++)
		{
		//	cout<<j<<"  "<<k<<"  ----->             ";	
			for(v=j;v<k;v++)
			{
		//		cout<<j<<"  "<<v<<"  ";	

				tot_lef=t[j][v]+f[j][v];
				tot_rig=t[v+1][k]+f[v+1][k];
				if(str[v]=='a')
				{
					t[j][k]+=(t[j][v]*t[v+1][k]);
					f[j][k]+=(tot_lef*tot_rig-(t[j][v]*t[v+1][k]));
				}
				else if(str[v]=='o')
				{
					t[j][k]+=(tot_lef*tot_rig-(f[j][v]*f[v+1][k]));
					f[j][k]+=(f[j][v]*f[v+1][k]);
				}
				else
				{
					t[j][k]+=(t[j][v]*f[v+1][k]+f[j][v]*t[v+1][k]);
					f[j][k]+=(t[j][v]*t[v+1][k]+f[j][v]*f[v+1][k]);	
				}
				if(t[j][k]>=mod)
					t[j][k]%=mod;
				if(f[j][k]>=mod)
					f[j][k]%=mod;	
			}
		//	cout<<endl;
		}
	}
}

int main()
{
	char s[500],str[500],boo[40];
	ll q,i,j,k,start,end,len;
	cin>>s>>str;
	len=strlen(s);
	fill_table(s,str);
	cin>>q;
	while(q--)
	{
		cin>>start>>end>>boo;
		if(!strcmp(boo,"true"))
		{
		//	cout<<"true case"<<endl;
			cout<<t[start-1][end-1]<<endl;
		}
		else
		{
	//		cout<<"false case"<<endl;
			cout<<f[start-1][end-1]<<endl;
		}
	}
	return 0;
}
