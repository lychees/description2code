#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
const int nmax=5*1e6+6;
bool isPrime[nmax];
int main() {
    for(int i=2;i<nmax;i++) {
        if(isPrime[i]==false) {
            for(int j=2*i;j<nmax;j+=i) isPrime[j]=true;
        }
    }
    isPrime[1]=true;
    int queries;
    scanf("%d",&queries);
    for(int i=0;i<queries;i++) {
        int a,b;
        scanf("%d%d",&a,&b);
        ll ans=0;
        while(b!=a) {
            if(b>a) {
                if(isPrime[b]==false) ans-=b;
                else ans+=b;
                b/=2;
            }
            else if(b<a) {
                if(isPrime[a]==false) ans-=a;
                else ans+=a;
                a/=2;
            }
        }
        if(isPrime[b]) ans+=b;
        else ans-=b;
        printf("%lld\012",ans);
    }
    return 0;
}
