#include <iostream>
#include<vector>
#include<stdio.h>
using namespace std;
int c;

void dfs(int a,vector<int> V[],int M[])
{
	//printf("1\t");
	c+=a;
	M[a]=1;
	for(int i=0;i<V[a].size();i++)
		if(M[V[a][i]]==0)
			dfs(V[a][i],V,M);
}


int main()
{
    int t,n,m,a,b,e;
    
    scanf("%d",&t);
    while(t--)
    {
    	scanf("%d %d",&n,&m);
    	vector< pair<int,int> > A;
    	for(int i=0;i<m;i++)
    		{
    			scanf("%d %d",&a,&b);
    			A.push_back( make_pair(a,b) );
    		}
    	vector<int> V[n+1];
    	for(int i=0;i<n-1;i++)
    		{
    			scanf("%d",&e);
    			a=A[e-1].first;
    			b=A[e-1].second;
    			V[a].push_back(b);
    			V[b].push_back(a);
    		}
    	c=0;
    	int M[5001]={0};
    	dfs(1,V,M);
    	if(c<( ((n)*(n+1)) /2 ) )
    		printf("NO\n");
    	else
    		printf("YES\n");
    }
    return 0;
}
