#include<iostream>
#include<cstring>
using namespace std;
int main(){
              int t,i,j;
              cin>>t;
              while(t>0){
                   int n,q;
                   cin>>n>>q;
                   char names[n][20];
                   int money[n];
                   for(i=0;i<n;i++){
                                        cin>>names[i];
                                        money[i]=0;
                   }
                   
                   while(q>0){
                   	        
                             char a[20];
                             int paid,h,m,r=0;
                             double p;
                             cin>>a;
                             cin>>paid;
                             
                             cin>>m;
                             p=(double)paid/(m+1);
                              h=p;
                            char split[m][100];
                            for(i=0;i<m;i++){
                                      cin>>split[i];
                                      for( j=0;j<n;j++){
                                                if(strcmp(split[i],names[j])==0){
                                                             money[j]=money[j]-h;
                                                 }
                                                if(strcmp(a,names[j])==0){
                                                              r=j;
                                                }
                                       }
                                }
                           
                               money[r]=money[r]+(m*h);      
                   q--;
                   
                  }
                 for(i=0;i<n;i++){
                      if(money[i]>0){
                       
					   cout<<names[i]<<" is owed "<<money[i]<<endl;
				}
                     else if(money[i]<0){
					 
                      
					  cout<<names[i]<<" owes "<<-1*money[i]<<endl;
				}
                    else{
					
                      
					  cout<<names[i]<<" neither owes nor is owed"<<endl;
				
                  }
              }

                t--;   
              }

return 0;
}