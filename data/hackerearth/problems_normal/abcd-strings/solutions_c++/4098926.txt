#include<bits/stdc++.h>
using namespace std;
#define ll long long  int
#define mod 1000000007
#define INF 1000000000
#define pi pair<ll,double>
#define pb push_back
#define mp make_pair
#define s second
#define f first
#define yup ios_base::sync_with_stdio(0)
#define yo cout<<"yo\n"
ll d3[4][4][4],d2[4][4],d1[4];
void mul(ll a[16][16],ll b[16][16]){
    ll c[16][16];
    for(int i=0;i<16;i++){
        for(int j=0;j<16;j++){
            c[i][j]=0;
            for(int k=0;k<16;k++){
                 c[i][j]+=a[i][k]*b[k][j] ;
                 c[i][j]%=mod;
            }
        }
    }
    for(int i=0;i<16;i++){
        for(int j=0;j<16;j++){
            a[i][j]=c[i][j];
        }
    }
}
ll id[16][16];
void bpow(ll a[16][16],ll p){
    for(int i=0;i<16;i++){
        for(int j=0;j<16;j++){
            id[i][j]=0;
        }
    }
    for(int i=0;i<16;i++) id[i][i]=1;
    while(p>0){
        if(p&1) mul(id,a);
        mul(a,a);
        p/=2;
    }
}
int main(){
    ll t,n,k;
    cin>>t;
    for(int i=0;i<16;i++) id[i][i]=1;
    while(t--){
        cin>>n>>k;
        string temp;
        ll h;
        for(int i=0;i<4;i++){
            d1[i]=1;
            for(int j=0;j<4;j++){
                d2[i][j]=1;
                for(int l=0;l<4;l++){
                    d3[i][j][l]=1;
                }
            }
        }
 
        for(int i=0;i<k;i++){
            cin>>temp;
            if(temp.size()==1)
                d1[temp[0]-'a']=0;
            else if(temp.size()==2)
                d2[temp[1]-'a'][temp[0]-'a']=0;
            else d3[temp[2]-'a'][temp[1]-'a'][temp[0]-'a']=0;
        }
        if(n==1){
            ll ans=0;
            for(int i=0;i<4;i++) if(d1[i]) ans++;
            cout<<ans<<"\n";
            continue;
        }
        else if(n==2){
            ll ans=0;
            for(int i=0;i<4;i++){
                for(int j=0;j<4;j++){
                    if(d2[i][j]) ans++;
                }
            }
            cout<<ans<<"\n";
            continue;
        }
        ll a[16][16];
        ll x,y,z;
        for(int i=0;i<16;i++){
            for(int j=0;j<16;j++){
                a[i][j]=0;
            }
        }
 
 
        for(int i=0;i<4;i++){
            if(!d1[i]) continue;
            for(int j=0;j<4;j++){
                if(!d1[j]) continue;
                if(!d2[i][j]) continue;
                for(int k=0;k<4;k++){
                    if(!d2[j][k]) continue;
                    if(!d1[k]) continue;
                     if(d3[i][j][k]){
                        a[4*i+j][4*j+k]++;
                    }
                }
            }
        }
        bpow(a,n-2);
        ll ans=0;
        for(int i=0;i<16;i++){
            for(int j=0;j<16;j++){
 
                ans+=id[i][j];
                ans%=mod;
            }
        }
        cout<<ans<<"\n";
 
 
    }
 
 
 
 
}
