#include <bits/stdc++.h>
using namespace std;
typedef long long ll;

map<string,ll> mp;
map<string,ll> ind;
vector<pair<ll,pair<string,ll> > > vec;

int main(){
	int t;
	scanf("%d",&t);
	while(t--){
		int in = 0;
		mp.clear();
		vec.clear();
		ind.clear();
		int n;int q;
		scanf("%d",&n);
		scanf("%d",&q);
		for(int i=0;i<n;i++){
			string temp;
			cin>>temp;
			mp[temp] = 0;
			ind[temp] = in++;
		}

		for(int i=0;i<q;i++){
			string s;
			cin>>s;
			int amt;
			scanf("%d",&amt);
			int m;
			scanf("%d",&m);

			int x = amt/(m+1);
			mp[s] += m*(x);
			for(int i=0;i<m;i++){
				string ss;
				cin>>ss;
				mp[ss] -= x;
			}
		}
		for(map<string,ll>::iterator it = mp.begin();it!=mp.end();it++){
			string s = it->first;
			ll x = it->second;
			vec.push_back(make_pair(ind[s],make_pair(s,x)));
		}

		sort(vec.begin(),vec.end());

		for(int i=0;i<(int)vec.size();i++){
			string s = vec[i].second.first;
			ll x = vec[i].second.second;
			cout<<s<<" ";
			if(x>0){
				printf("is owed %lld\n",abs(x));}
			else if(x<0){printf("owes %lld\n",abs(x));}
			else{printf("neither owes nor is owed\n");}
		}


	}
}
