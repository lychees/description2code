//-------------------------------
#include<bits/stdc++.h>
using namespace std ;
//-------------------------------
typedef long long ll ;
typedef vector<int> vi ;
typedef pair<int,int> ii ;
//-------------------------------
 
#define pb(a) push_back(a)
#define mp(a,b) make_pair(a,b)
#define rep(i,a,b) for(int i=(a) ; i<(b) ; ++i)
#define inf 2000000000
#define endl "\n"
#define max(a,b) ( (a>b) ? (a) : (b)  )
#define min(a,b) ( (a<b) ? (a) : (b)  )
//------------------------------
int ri()
{
	char c = getchar() ;
	while(c<'0' || c>'9') c = getchar() ;
	int ret = 0 ;
	while(c>='0' && c<='9')
	{
		ret = 10*ret+c-48;
		c = getchar();
	}
	return ret;
}

void de(int x) { cout<<x; }
const int maxn=5e5+10;
char fo[maxn][25];
int val[maxn];
int bit[maxn];

int query(int x)
{
	int su=0;
	while(x) { su+=bit[x]; x-=(x&(-x)); } return su; 
}
void update(int x,int pos)
{	
	while(pos<maxn) { bit[pos]+=x; pos+=(pos&(-pos)); } 
}
int sear(int x)
{
	int lo=0,hi=maxn,an=0;
	while(lo<=hi)
	{
		int mid= lo + ((hi-lo)>>1) ;
		int qr=query(mid);
		if(qr>=x) { an=mid; hi=mid-1; }
		else if(qr<x) lo=mid+1;
	}
	return an;
}

int main()
{
//	freopen("input.txt","r",stdin);
	int T=ri();
	while(T--)
	{
		int n=ri();
		memset(bit,0,sizeof bit);
		rep(i,1,n+1) scanf("%s",fo[i]);
		rep(i,1,n+1) { val[i]=ri(); update(1,i); }
		int C=0;

		rep(i,0,n-1)
		{
			int q=ri();
			int pos=sear(q);  C=max(C,val[pos]);
			//cout<<fo[pos]<<" "<<C<<endl; 
			printf("%s %d\n",fo[pos],C); update(-1,pos);
		}
		//de(1);
		int pos=sear(1); C=max(C,val[pos]);
		printf("%s %d\n",fo[pos],C);
	}
}
