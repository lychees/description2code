T = int(raw_input())
for t in range(T):
    N = int(raw_input())
    h = [-1]+[int(x) for x in raw_input().split()]
    left_max = [0]*(N+1)
    right_max = [0]*(N+1)
    left_max[1], right_max[-1] = h[1], h[-1]

    for i in range(2, N+1):
        left_max[i] = max(left_max[i-1], h[i])
        right_max[N-i+1] = max(right_max[N-i+2], h[N-i+1])
    ans = 0

    for i in range(1, N+1):
        ans += (min(left_max[i], right_max[i])-h[i])

    print(ans) % 1000000007
