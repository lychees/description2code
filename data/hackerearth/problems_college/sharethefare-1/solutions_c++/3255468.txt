/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * **
 Author : Prasad Ghangal					
 Title :  				
 Category : 						
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */

#include <bits/stdc++.h>
using namespace std;
#define gc getchar_unlocked

map<string,int> hsh;


int fin()
{
	int res=0;
	register char c=gc();
	while(c<'0' || c>'9')
		c=gc();
	while(c>='0' && c<='9')
	{
		res=res*10+(c-48);
		c=gc();
	}
	return res;
}

int main()
{
	int t,n,q,m,amnt;
	vector<string> names;
	char name[11];
	t=fin();
	while(t--)
	{
		hsh.clear();
		names.clear();
		n=fin();
		q=fin();
		for(int i=0;i<n;++i)
		{
			scanf("%s",name);
			hsh[name]=0;
			names.push_back(name);
		}
		while(q--)
		{
			scanf("%s%d%d",name,&amnt,&m);
			amnt=amnt/(m+1);
			hsh[name]+=(amnt*m);
			for(int i=0;i<m;++i)
			{
				scanf("%s",name);
				hsh[name]-=amnt;
			}
		}
		for(int i=0;i<n;++i)
		{
			//cout<<it->first<<" "<<it->second<<endl;
			if(hsh[names[i]] < 0)
				cout<<names[i]<<" owes "<<hsh[names[i]]*-1<<endl;
			else if(hsh[names[i]] > 0)
				cout<<names[i]<<" is owed "<<hsh[names[i]]<<endl;
			else
				cout<<names[i]<<" neither owes nor is owed\n";
		}
	}

	return 0;
}
