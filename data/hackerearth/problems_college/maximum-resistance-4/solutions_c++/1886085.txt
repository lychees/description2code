#include<bits/stdc++.h>
using namespace std;
#define N 1000000
long long c[N];
string  circuit;
int lefti[N];
int righti[N];
int stck[N];
int waste[N];
int noofxes[N];
int main()
{
	int t;
	scanf("%d",&t);
	while(t--)
	{
		circuit="";
		cin>>circuit;
		int len=circuit.size();
		int xes=0;
		for(int i=0;i<len;++i)
			if(circuit[i]=='X')
				++xes;

		for(int i=0;i<xes;++i)
		{
			c[i]=0;
			scanf("%lld",&c[i]);
		}

		int top=0;
		for(int i=len-1;i>=0;--i)
		{
			if(circuit[i]!='X')
			{
				lefti[i]=stck[top-1];
				--top;
				righti[i]=stck[top-1];
				--top;
			}
			stck[top]=i;
			++top;
		}

		for(int i=len-1;i>=0;--i)
		{
			if(circuit[i]=='A')
			{
				waste[i]=waste[lefti[i]]+waste[righti[i]];
				noofxes[i]=noofxes[lefti[i]]+noofxes[righti[i]];
			}
			else if(circuit[i]=='B')
			{
				waste[i]=min(noofxes[lefti[i]]+waste[righti[i]],noofxes[righti[i]]+waste[lefti[i]]);
				noofxes[i]=noofxes[lefti[i]]+noofxes[righti[i]];	
			}
			else
			{
				waste[i]=0;
				noofxes[i]=1;
			}
		}

		long long ans=0;
		sort(c,c+xes);
		for(int i=waste[0];i<xes;++i)
			ans+=c[i];
		printf("%lld",ans );
		if(t)
			printf("\n");
	}
	return 0;
}