#include<iostream>
#include<algorithm>
#include<vector>
#include<stdio.h>
#include<set>
using namespace std;
int a[131075];

int query(int idx) 
{
  int sum=0;
  for(;idx>0;idx-=idx&-idx)
    sum+=a[idx];
  return sum;
}
void add(int pos,int x) 
{
  for(;pos<=131072;pos+=pos&-pos) a[pos]+=x;
}

int  inline scan()
{
    register int N = 0, C;
    while ((C = getchar_unlocked()) < '0');
    do
    {
        N = (N<<3) + (N<<1) + C - '0';
    }while ((C = getchar_unlocked()) >= '0');
 
    return N;
}

int main()
{
  set< int >mySet;
int toAdd[100005];
set< int >::iterator it;
  int n,i,j,q,temp,x,y,z,t,t1,t2;
  n=scan();
  for(i=1;i<=131072;i++) a[i]=0;
  for(i=1;i<=100000;i++) toAdd[i]=0;
  for(i=1;i<=n;i++) {
    temp=scan();
    toAdd[temp]++;
  }
  for(i=1;i<=100000;i++) add(i,toAdd[i]),toAdd[i]=0;
  q=scan();
  while(q--) {
    t=scan();
    if(t==0) {
      x=scan(); y=scan();
      for(it=mySet.begin();it!=mySet.end();it++) {
        temp=*it;
        add(temp,toAdd[temp]);
        toAdd[temp]=0;
      }
      mySet.clear();
      t2=query(y); t1=query(x-1);
      cout<<t2-t1<<"\n";
    }
    else if(t==1) {
      x=scan();
      mySet.insert(x);
      toAdd[x]-=1;
    }
    else if(t==2) {
      x=scan();
      mySet.insert(x);
      toAdd[x]+=1;
    }
  }
//  system("pause");
  return 0;
}
