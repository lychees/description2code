#include<bits/stdc++.h>
#define X first
#define Y second
#define mpp make_pair
#define ll long long
#define nl printf("\n")
#define SZ(x) (int)(x.size())
#define pb(x) push_back(x)
#define pii pair<int,int>
#define pll pair<ll,ll>
#define S(a) scanf("%d",&a)
#define P(a) printf("%d",a)
#define PL(a) printf("%lld",a)
#define SL(a) scanf("%lld",&a)
#define S2(a,b) scanf("%d%d",&a,&b)
#define SL2(a,b) scanf("%lld%lld",&a,&b)
#define SL4(a,b,c,d) scanf("%lld%lld%lld%lld",&a,&b,&c,&d)
#define all(v) v.begin(),v.end()
#define CLR(a) memset(a,0,sizeof(a))
#define SET(a) memset(a,-1,sizeof(a))
#define fr(i,a,n) for(ll i=a;i<=n;i++)
ll arr[100005];ll seg[300000];	
ll mod=1000000007;
void init(ll nd,ll l,ll r)
{
	if(l==r)
	{
		seg[nd]=arr[l];
		seg[nd]%=mod;
		return;
	}
	ll mid=(l+r)/2;
	init(nd*2,l,mid);
	init(nd*2+1,mid+1,r);
	seg[nd]=seg[nd*2]+seg[nd*2+1];
	seg[nd]%=mod;	
}
ll quer(ll nd,ll l,ll r,ll a,ll b)
{
	if(b==-1)
	return 0;
	if((r<a)||(l>b))
	return 0;
	if((l>=a)&&(r<=b))
	return seg[nd];
	ll mid=(l+r)/2;
	return ((quer(nd*2,l,mid,a,b)+quer(nd*2+1,mid+1,r,a,b))%mod);
}
void update(ll nd,ll l,ll r,ll a,ll b)
{
	seg[nd]+=b;
	seg[nd]%=mod;
	if(l==r)
	return;
	ll mid=(l+r)/2;
	if(a<=mid)
	update(nd*2,l,mid,a,b);
	else
	update(nd*2+1,mid+1,r,a,b);
	
}


using namespace std;

int main()
{
	ll r,n,x,w,d,y,ans,val;
	SL(r);
	SL(n);
	fr(i,0,n-1)
	SL(arr[i]);
	init(1,0,n-1);
	fr(i,0,r-1)
	{
		ans=0;
		SL4(x,w,d,y);
		val=((1+(w/d))*(2*w-((w/d)*d)))/2;
		if((val+x)<=n)
		{
			ans+=quer(1,0,n-1,x-1,x+val-1);
			ans%=mod;
			cout<<ans<<endl;
		}
		else
		{
			val-=(n-x);
			ans+=quer(1,0,n-1,x-1,n-1);
			ans%=mod;
			ans+=(((val/n)%mod)*quer(1,0,n-1,0,n-1));
			ans%=mod;
			ans+=quer(1,0,n-1,0,((val%n)-1));
			ans%=mod;
			cout<<ans<<endl;
		}
		update(1,0,n-1,x-1,y);
	}
}
	