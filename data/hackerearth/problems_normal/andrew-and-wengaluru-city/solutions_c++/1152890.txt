#include <stdio.h>
#include <iostream>  

using namespace std;

long min(long a ,long b)
{
	if(a < b)
		return a;
	return b;
}
long max(long a ,long b)
{
	if(a > b)
		return a;
	return b;
}
int main(int argc, char** argv)
{
    int T;
    cin >> T;
    int i;
    for(i = 0; i < T; i++) {
		long N;
		cin >> N;
		int j;
		long *arr = new long[N];
		for(j = 0; j < N; j++) {
			cin >> arr[j];
		}

		// process
		long *left = new long[N];
		long *right = new long[N];

		for(int i = 0; i < N; i++) 
		{
			left[i] = max(arr[i], (i != 0) ? left[i - 1] : 0);
		}
		for (int i = N-1; i >= 0; i--) 
		{
			right[i] = max(arr[i],i<(N-1) ? right[i+1]:0);
		}
		int ans = 0;
		for (int i = 0; i < N; i++){
			ans += min(left[i], right[i]) - arr[i];
			if(ans >= 1000000007)
				ans = ans % 1000000007;
		}
		cout << ans << endl;
	}
    return 0;
}
