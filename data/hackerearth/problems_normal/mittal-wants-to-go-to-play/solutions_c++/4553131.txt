#include <bits/stdc++.h>
using namespace std;

#define MAX 99999999


typedef pair<int, int> P;
int main()
{
    int t;
    cin>>t;
    while(t--)
    {
        int n,m;
        cin>>n;
        cin>>m;
        vector<vector<pair<int,int> > > graph(n+1);
        int dist[n+1];
        for(int i=1;i<=n;i++)
        {
            dist[i]=MAX;
        }

        dist[1]=0;
        for(int i=1;i<=m;i++)
        {
            int x,y,c;
            cin>>x>>y>>c;
            graph[x].push_back(make_pair(c,y));
            graph[y].push_back(make_pair(c,x));
        }

        priority_queue< P, vector<P> , greater<P> > Q;
        Q.push(make_pair(0,1));

        while(!Q.empty()){
                P tt=Q.top();
                Q.pop();
                int i=tt.second;
                for(vector<pair<int,int> >::iterator it=graph[i].begin();it!=graph[i].end();it++)
                {
                    int point=(*it).second;
                    int weight=(*it).first;
                    if(dist[point]>(dist[i]+weight)){
                        dist[point]=dist[i]+weight;
                        Q.push(make_pair(dist[point],point));
                    }
                }
            }

        int q;
        cin>>q;
        for(int i=1;i<=q;i++)
        {
            int f,tt;
            cin>>f>>tt;
            int ti=dist[f];
            printf("%d\n",max(tt-2*ti,0));
        }
    }
    return 0;
}
