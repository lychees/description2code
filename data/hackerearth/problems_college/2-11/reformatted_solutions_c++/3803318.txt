#include <bits/stdc++.h>
using namespace std;
string str1, str2;
int main() {
  int n;
  cin >> n;
  int i, j;
  int cost[26][26];
  for (i = 0; i < 26; ++i) {
    for (j = 0; j < 26; ++j)
      scanf("%d", &cost[i][j]);
  }
  int dis[26][26];
  int k;
  for (i = 0; i < 26; ++i) {
    for (j = 0; j < 26; ++j) {

      dis[i][j] = cost[i][j];
    }
  }
  for (k = 0; k < 26; ++k) {
    for (i = 0; i < 26; ++i) {
      for (j = 0; j < 26; ++j) {
        dis[i][j] = min(dis[i][j], dis[i][k] + dis[k][j]);
      }
    }
  }
  for (i = 0; i < n; ++i) {
    cin >> str1 >> str2;
    long long int ans = 0;
    for (j = 0; j < str1.size(); ++j) {
      if (str1[j] != str2[j]) {
        ans += dis[str1[j] - 'a'][str2[j] - 'a'];
      }
    }
    cout << ans << endl;
  }
}
