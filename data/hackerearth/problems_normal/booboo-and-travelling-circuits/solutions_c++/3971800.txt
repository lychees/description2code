#include <bits/stdc++.h>
using namespace std;
#define ll long long int
#define MOD 1000000003
#define MIN(a,b) (a)<(b)?(a):(b)
int isprime[10005];
int lowest[10005];
ll A[10005],B[10005];
ll places[10005],prevv[10005];
ll mins[10005],mins2[10005];
vector<int> v[10005];
void func(ll m)
{
	for(int i=2;i<=m;i++)
	{
		isprime[i]=1;
	}
	for(int i=2;i<=m;i++)
	{
		if(isprime[i])
		{
			lowest[i]=i;
			v[i].push_back(i);
			for(int j=2*i;j<=m;j=j+i)
			{
				if(lowest[j]==0)
				{
					lowest[j]=i;
					v[i].push_back(j);
				}
				isprime[j]=0;
			}
		}
	}
}
int main()
{
	ll n,m;
	scanf("%lld %lld",&n,&m);
	func(m);
	ll s,p,q,r;
	scanf("%lld %lld %lld %lld",&s,&p,&q,&r);
	ll w,x,y,z;
	scanf("%lld %lld %lld %lld",&w,&x,&y,&z);
	ll mi1,mi2;
	int pos;
	for(int i=1;i<=n;i++)
	{
		mi1=1e15;
		for(int j=1;j<=m;j++)
		{
			long long s1=(p*s)%MOD;
			s1=(s1*s)%MOD;
			long long s2=(q*s)%MOD;
			s2=(s2+r)%MOD;
			s=(s1+s2)%MOD;
			A[j]=s;
			s1=(x*w)%MOD;
			s1=(s1*w)%MOD;
			s2=(y*w)%MOD;
			s2=(s2+z)%MOD;
			w=(s1+s2)%MOD;
			B[j]=w;
			mins[j]=1e15;
			mins2[j]=-1;
			if(places[j]<mi1)
				mi1=places[j];
		}
		for(int j=1;j<=m;j++)
		{
			prevv[j]=places[j];
			places[j]=prevv[j]+A[j];
		}
		for(int j=2;j<=m;j++)
		{
			places[1]=MIN(places[1],prevv[j]+B[j]);
		}
//		for(int j=1;j<=m;j++)cout<<places[j]<<" ";cout<<endl;

		for(int j=2;j<=m;j++)
		{
			if(v[j].size()>1)
			{
				ll x1,x2;
				x1=x2=1e15;
				int pos=-1;
				for(int pk=0;pk<v[j].size();pk++)
				{
					if(prevv[v[j][pk]]+B[v[j][pk]]<x1)
					{
						x1=prevv[v[j][pk]]+B[v[j][pk]];pos=pk;
					}
				}
				for(int pk=0;pk<v[j].size();pk++)
				{
					if(pk!=pos)
						places[v[j][pk]]=MIN(places[v[j][pk]],x1);
				}
				for(int pk=0;pk<v[j].size();pk++)
				{
					if(pk!=pos&&prevv[v[j][pk]]+B[v[j][pk]]<x2)
					{
						x2=prevv[v[j][pk]]+B[v[j][pk]];
					}
				}
				places[v[j][pos]]=MIN(places[v[j][pos]],x2);
			}
		}
//		for(int j=1;j<=m;j++)cout<<places[j]<<" ";cout<<endl;cout<<endl;
	}
	printf("%lld\n",mi1);
    return 0;
}
