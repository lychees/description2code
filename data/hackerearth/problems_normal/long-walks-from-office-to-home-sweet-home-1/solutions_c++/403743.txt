#include <iostream>
#define mod 1000000007
using namespace std;
struct mat {
	long long matrix[55][55];
};
mat walks;
mat multiply(mat a, mat b, int n) {
	mat c;
	for(int i = 0; i < n; i++)
		for(int j = 0; j < n; j++) {
			c.matrix[i][j] = 0;
			for(int k = 0; k < n; k++)
				c.matrix[i][j] = (c.matrix[i][j] + (a.matrix[i][k]*b.matrix[k][j])%mod)%mod;
		}
	return c;
}
int computeWalks(int u, int v, long long k, int n) {
	mat c;
	for(int i = 0; i < n; i++) {
    	for(int j = 0; j < n; j++) c.matrix[i][j] = 0;
		c.matrix[i][i] = 1;
	}
	while(k) {
		if(k&1) {
			c = multiply(c, walks, n);
		} 
		k >>= 1;
		walks = multiply(walks, walks, n);
	}
		//for(int i = 0; i < n; i++, cout<<'\n')
		//for(int j = 0; j < n; j++) cout<<c.matrix[i][j];
	return c.matrix[u][v];
}	
int main()
{
    int T;
    cin>>T;
    while(T--) {
    	long long n, k, u, v;
    	cin>>n>>k>>u>>v;
    	for(int i = 0; i < n; i++)
    		for(int j = 0; j < n; j++) cin>>walks.matrix[i][j];
    	cout<<computeWalks(u, v, k, n)<<"\n";
    }
}
