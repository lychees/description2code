#include<iostream>
#include<vector>
#include<set>
#include<map>
#include <unordered_map>
#include<algorithm>
#include<stdlib.h>
#include<utility>
#include<string>
using namespace std;
int main()
{
	int t;
	scanf("%d",&t);
	while(t--)
	{
		int n,q;
		scanf("%d %d",&n,&q);
		map<string,int> trip;
		string temp,temp1,names[n];
		for(int i=0;i<n;i++)
		{
			cin>>temp;
			trip[temp]=0;
			names[i]=temp;
		}
		int amount,noOfPeople,x,y,z;
		for(int i=0;i<q;i++)
		{
			cin>>temp;
			scanf("%d",&amount);
			scanf("%d",&noOfPeople);
			trip[temp]+=amount;
			x=amount/(noOfPeople+1);
			trip[temp]-=(amount-(noOfPeople*x));
			for(int j=0;j<noOfPeople;j++)
			{
				cin>>temp1;
				trip[temp1]-=x;
			}		
				
		}
		map<string,int>::iterator it=trip.begin();
		for(int i=0;it!=trip.end();it++,i++)
		{
			/*cout<<(*it).first;
			if((*it).second<0)
			{
				printf(" owes %d\n",-1*((*it).second));
			}
			else if((*it).second==0)
			{
				printf(" neither owes nor is owed\n");
			}
			else{
				printf(" is owed %d\n",(*it).second);
			}*/
			cout<<names[i];
			if(trip[names[i]]<0)
			{
				printf(" owes %d\n",-1*trip[names[i]]);
			}
			else if(trip[names[i]]==0)
			{
				printf(" neither owes nor is owed\n");
			}
			else{
				printf(" is owed %d\n",trip[names[i]]);
			}
			
		}
	}
}