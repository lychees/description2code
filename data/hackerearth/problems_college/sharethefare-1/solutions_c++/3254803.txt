#include<iostream>
#include<cstdlib>
#include<cstdio>
#include<map>
#include<cstring>

using namespace std;
int main() {
    int t;
    cin>>t;
    while(t--) {
        int n,q;
        cin>>n>>q;
        map<string,int> personid;
        string personnames[n];

        for(int i=0;i<n;i++)
        {
            cin>>personnames[i];
        }
        for(int i=0;i<n;i++)
        {
            personid[personnames[i]] = i;
       		}
        
        long long int personsum[51][2] = {0};
        for(int i=0;i<q;i++) {
            string names;
            cin>>names;
            long long int paidAmount;
            cin>>paidAmount;
            personsum[personid[names]][0] += paidAmount;

            int m;
            cin>>m;
            int avgShare = paidAmount/(m+1);
            personsum[personid[names]][1] += avgShare + (paidAmount%(m+1));
            for(int j=0;j<m;j++) {
                string taken;
                cin>>taken;
                personsum[personid[taken]][1] += avgShare;
            }
        }
        for(int i=0;i<n;i++) {
            if(personsum[personid[personnames[i]]][0] == personsum[personid[personnames[i]]][1]) {
                cout<<personnames[i]<<" neither owes nor is owed"<<endl;
            } else if(personsum[personid[personnames[i]]][0] > personsum[personid[personnames[i]]][1]) {
                cout<<personnames[i]<<" is owed "<< personsum[personid[personnames[i]]][0] - personsum[personid[personnames[i]]][1]<<endl;
            } else {
                cout<<personnames[i]<<" owes "<< personsum[personid[personnames[i]]][1] - personsum[personid[personnames[i]]][0]<<endl;
            }
        }

    }
    return 0;
}