#include<bits/stdc++.h>
#define ll long long
using namespace std;
//g++ -std=c++11 your_file.cpp

std::vector< pair<ll, ll> > v;
ll a[5003];
bool vis[5003];

ll capt(ll n){
	return a[n] == n ? n : a[n] = capt(a[n]);
}

int main()
{
	ios_base::sync_with_stdio(false);cin.tie(0);
 
	ll t,n,m,i,j;
	cin >> t;
	while(t--){
		cin >> n >> m;
		ll x, y;
		v.clear();
		for(i=1;i<=n;i++){
			a[i] = i;
			vis[i] = false;
		}
		for(i=0;i<m;i++){
			cin >> x >> y;
			v.push_back({x,y});
		}
		bool flag = true;
		for(i=1;i<n;i++){
			cin >> j;
			x = v[j-1].first; y = v[j-1].second;
			ll cx = capt(x), cy = capt(y);
			if(cx == cy) flag = false;
			a[cx] = cy;
			vis[x] = vis[y] = true;
		}
		for(i=1;i<=n;i++) flag = flag && vis[i];
		if(flag) cout << "YES" << endl;
		else cout << "NO" << endl;
	}
 
	return 0;
} 