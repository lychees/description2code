#include<bits/stdc++.h>
using namespace std;
typedef long long int uli;
int main(){
// freopen("data.in","r",stdin);
   int t;
   int n;
   uli m,z;
   scanf("%d",&t);
   while(t--){
      scanf("%d %lld %lld",&n,&m,&z);
      vector<uli> d;
      uli s=0;
      for(int i=0;i<n;i++){
         uli v;
         scanf("%lld",&v);
         d.push_back(v);
         if(i&1)s-=v;
         else s+=v;
      }
      if(n%2==0)s=-s;
      s%=m;
      s=(s+m)%m;
      d.push_back(s);
      uli idx=z%uli(n+1);
      uli ans=d[idx];
      if(n%2==0){
         if(z%uli((n+1)<<1)>=n+1)ans=(m-ans)%m;
      }
      printf("%lld\n",ans);
   }
   return 0;
}

