#include <cstdio>
#include <cstring>
#include <algorithm>

using namespace std;

#define MAX 100010

int a[MAX];
int t, n, k, p, res;

int main()
{
    scanf("%d", &t);
    while (t--){
        scanf("%d%d%d", &n, &k, &p);
        for (int i = 0; i < n; i++)
            scanf("%d", &a[i]);
        sort(a, a + n);
        res = 1;
        for (int i = 0; i < n - k + 1; i++){
            if (a[i + k - 1] - a[i] <= 2*p){
                res = 0;
                break;
            }
        }
        printf("%s\n", res ? "YES" : "NO");
    }
    return 0;
}
