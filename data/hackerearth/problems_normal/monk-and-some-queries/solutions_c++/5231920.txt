#include <cstdio>
#include <queue>
#include <map>
#include <vector>

using namespace std;

int main() {
    int Q, com, x, n;

    scanf("%d", &Q);

    n = 0;
    priority_queue<int, vector<int>> max_pq;
    priority_queue<int, vector<int>, greater<int>> min_pq;
    map<int, int> counter;

    while (Q--) {
        scanf("%d", &com);

        if (com == 1) {
            scanf("%d", &x);
            max_pq.push(x);
            min_pq.push(x);
            counter[x]++;
        } else if (com == 2) {
            scanf("%d", &x);
            if (counter[x] > 0)
                counter[x]--;
            else
                printf("-1\n");
        } else if (com == 3) {
            while (!max_pq.empty() && counter[max_pq.top()] < 1)
                max_pq.pop();
            if (!max_pq.empty())
                printf("%d\n", max_pq.top());
            else
                printf("-1\n");
        } else {
            while (!min_pq.empty() && counter[min_pq.top()] < 1)
                min_pq.pop();
            if (!min_pq.empty())
                printf("%d\n", min_pq.top());
            else
                printf("-1\n");
        }
    }
    return 0;
}