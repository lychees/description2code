#include<bits/stdc++.h>

using namespace std;

typedef long long ll;
typedef long double ld;

#define pb push_back
#define f(i,t) for(int i=0;i<t;i++)
#define fab(i,a,b) for(int i=a;i<=b;i++)

const int mod = 1e9 + 7;
const ld PI = 3.14159265358979323846;

int m,n,k,ans=0;
int ar[101][101];

int main(){
ll t;
bool dp[101][101][505];
int temp;
cin >> t;
f(s,t){
cin >>n>>m>>k;
ans=0;
f(j,n){
	f(l,m){
		cin >> ar[j][l];
	}
}

f(i,n){
f(j,m){
    for(int kk=0;kk<=k;kk++){
    dp[i][j][kk]=0;
    }
for(int kk=ar[i][j];kk<=k;kk++){
   if(i==0 && j==0 ){
    if(ar[i][j]==kk){
        dp[i][j][kk]=1;
    }
   }
   else if(i==0){
    dp[i][j][kk]=dp[i][j-1][kk-ar[i][j]];
   }
   else if(j==0){
    dp[i][j][kk]=dp[i-1][j][kk-ar[i][j]];
   }
   else{
    dp[i][j][kk]=(dp[i][j][kk] | dp[i-1][j][kk-ar[i][j]]);
    dp[i][j][kk]=(dp[i][j][kk] | dp[i][j-1][kk-ar[i][j]]);
    dp[i][j][kk]=(dp[i][j][kk] | dp[i-1][j-1][kk-ar[i][j]]);
   }
}

}
}
int j;
for(j=k;j>0;j--){
    if(dp[n-1][m-1][j]==1){
        cout << j << endl;
        break;
    }
}
if(j==0)
    cout << "-1" << endl;

}
return 0;
}
