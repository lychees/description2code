#include <bits/stdc++.h>
using namespace std;
typedef long long ll;
#define pii pair<int,int>
#define pll pair<ll,ll>
#define pdd pair<double,double>
#define X first
#define Y second
#define REP(i,a) for(int i=0;i<a;++i)
#define REPP(i,a,b) for(int i=a;i<b;++i)
#define FILL(a,x) memset(a,x,sizeof(a))
#define	foreach( gg,itit )	for( typeof(gg.begin()) itit=gg.begin();itit!=gg.end();itit++ )
#define	mp make_pair
#define	pb push_back

inline int max(int a,int b){return a<b?b:a;}
inline int min(int a,int b){return a>b?b:a;}
inline ll max(ll a,ll b){return a<b?b:a;}
inline ll min(ll a,ll b){return a>b?b:a;}
const int mod = 1e9+7;
const int N = 1e6+10;
const ll INF = 1e18;

//#define DEBUG

#ifdef DEBUG
#define dprintf(fmt,...) fprintf(stderr,fmt,__VA_ARGS__)
#else
#define dprintf(fmt,...)
#endif
ll power(ll x,int p){
  ll t=1;
  x%=mod;
  while(p>0){
    if(p%2) t=t*x%mod,p-=1;
    else p/=2,x=x*x%mod;
  }
  return t;
}
vector<int> a;
void factor(int x){
  a.clear();
  REPP(i,2,x){
    if(i*i>x) break;
    int y=1;
    while(x%i==0) y*=i,x/=i;
    if(y!=1) a.pb(y);
  }
  if(x>1) a.pb(x);
}
ll calc(int x,int y){
  int a=x+y-1,b=y; ll t=1;
  while(b>0) {t=(t*a%mod)*power(b,mod-2)%mod;b--,a--;}
  return t;
}
int dp[1<<10],s[1<<10];
int main(){
  int n,t;
//   printf("%lld\n",calc(2,3));
  scanf("%d",&t);
  while(t--){
    int x,l,r;
    scanf("%d%d%d%d",&n,&l,&r,&x);
    factor(x);
      int m=a.size();
    ll ans=calc(r-l+1,n);//printf("%lld %d\n",ans,(int)a.size());
    REPP(i,1,1<<(a.size())){
      int x=1,y=0; REP(j,a.size()) if((i>>j)&1) x*=a[j],y++;
      y=y%2;
      if(y==1) y=1; else y=-1;
      s[i]=y;
      int z=0;
      dp[i]=(r/x-(l-1)/x);
      REPP(j,1,1+i) if((j|i)==i)z+=s[j]*dp[j];
      ans=(ans-y*calc(r-l+1-z,n)+mod)%mod;
    //  printf("%d %d %d %lld\n",x,r-l+1-z,z,calc(r-l+1-z,n));
    }


    printf("%lld\n",(ans+mod)%mod);
  }
  return 0;
}
