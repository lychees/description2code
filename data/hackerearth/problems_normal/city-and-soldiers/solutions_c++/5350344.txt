#include<bits/stdc++.h>
#define pb push_back
#define F first
#define S second
#define mp make_pair
#define lli long long int
#define INF 1000000000000
#define MOD 1000000007
#define FOR(name,initial,final) for(lli name=initial;name<final;name++)
#define rz resize
#define all(x) (x).begin(),(x).end()
using namespace std;
typedef vector<lli> vli;
int root(vector<int> &arr,int i)
{
	while(arr[i]!=i)
	{
		arr[i]=arr[arr[i]];
		i=arr[i];
	}
	return i;
}

void initialise(vector<int> &v,int n)
{
	FOR(i,0,n)
	{
		v[i]=i;
		//sum[i]=1;
	}
}

void unions(vector<int> &arr,int a,int b)
{
	int root_A = root(arr,a);
	int root_B = root(arr,b);
	if(root_A==root_B)
		return;
	arr[root_A]=root_B;
}
int main()
{
	int n,q,ch,a,b;
	cin>>n>>q;
	vector<int> arr(n);
	//vector<lli> sum(n);
	initialise(arr,n);
	while(q--)
	{
		cin>>ch;
		if(ch==1)
		{
			cin>>a>>b;
			unions(arr,a-1,b-1);
		}
		else if(ch==2)
		{
			cin>>a;
			int root_A = root(arr,a-1);
			arr[root_A]=a-1;
			arr[a-1]=a-1;
		}
		else
		{
			cin>>a;
			cout<<root(arr,a-1)+1<<endl;
		}
	}

}