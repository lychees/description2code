#include<bits/stdc++.h>
using namespace std;
#define rep(i,n) for(i=0;i<n;i++)
#define ll long long
#define elif else if
#define pii pair<int,int>
#define mp make_pair
#define pb push_back
#define gc getchar_unlocked
int gcd(int u, int v) {
return (v != 0)?gcd(v, u%v):u;
}
int main()
{
    //freopen("in","r",stdin);
    //freopen("out","w",stdout);
    int tt;
    cin>>tt;
    assert(1<=tt && tt<=10);
    while(tt--)
    {
    	int i,j,n,m,k;
    	cin>>n>>m>>k;
    	assert(k<=n && n<=20);
        assert(1<=k && k<=10);
        assert(1<=m && m<=100);
    	vector< vector<int> >adj(n);
    	vector<int>kx(n);
    	vector<int>cc(m);
    	vector<int>vals(m);
        rep(i,n)
        {
        	cin>>kx[i];
        	assert(1<=kx[i] && kx[i]<=100);
        }
        rep(i,m)
        {
        	cin>>cc[i];
        	assert(1<=cc[i] && cc[i]<=100);
        }
        rep(i,m)
        {
        	cin>>vals[i];
        	assert(0<=vals[i] && vals[i]<=1000);
        }
        for(i=0;i<n;i++)
        {
        	//cout<<"\n";
        	for(j=0;j<m;j++)
        	{
                int gc=gcd(kx[i],cc[j]);
                if(gc>1)
                {
                	adj[i].pb(j);
              //  	cout<<j<<" ";
                }
        	}
        }
    int t=k,ans=0,tmp=0,cnt=0;
    int tk[11],done[100];
	for(i = (1<<k)-1; i < (1 << n); i++) 
	{
		cnt=0;
	for(j=0; j < t; j++) 
	   {
			if(  (i & (1 << j))) 
			{
				tk[cnt] = j;
				cnt++;
			}
			if(cnt > k) break;
		}
		if(i== (1<<t)-1)
			t++;
		if(cnt != k) continue;
		memset(done, 0, sizeof(done));
        tmp=0;
        //cout<<"\n"<<i<<"  --";
		for(j = 0; j < cnt; j++) 
		{
			int key=tk[j];
			//cout<<key<<" ";
			for(  int p=0;p< adj[key].size();p++) 
			{
				int val=adj[key][p];
				if(done[val]==0) 
				{
					done[val]=1;
					tmp+=  vals[val];
				}
			}
		}
		ans=max(tmp,ans);
	}
	cout<<ans<<"\n";
    }
    return 0;
}