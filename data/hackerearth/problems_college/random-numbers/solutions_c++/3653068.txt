#include<bits/stdc++.h>
#define mod 1000000007
using namespace std;
long long po(long long a,int b){
	long long x=1,y=a;
	while(b>0){
		if(b%2){
		   x=x*y;
		   x%=mod;
		}
		y=y*y;
		y%=mod;
		b/=2;
	}
	return x;
}
int main(){
	int n;
	long long x;
	scanf("%d",&n);
	long long int e=1,o=1;
	for(int i=0;i<n;i++){
	   scanf("%lld",&x);
	   e*=x%(mod-1);
	   e%=(mod-1);
	}
	for(int i=0;i<n;i++){
	   scanf("%lld",&x);
	   o*=x%(mod-1);
	   o%=(mod-1);
	}
    long long ans=po(2,(e+o-1)%(mod-1));
	ans=((po(2,e)-1)*po(ans,mod-2))%mod;
	printf("%lld\n",ans);
	return 0;
}