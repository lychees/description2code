#include<bits/stdc++.h>
using namespace std;

int w[50005],a[50005],b[50005];

int root(int x)
{
	if(w[x]==x)
	return x;
	
	return w[x]=root(w[x]);
}

void merge(int a,int b)
{
	w[a]=b;
}
int main()
{
	int t;
	cin>>t;
	while(t--)
	{
		int n,m;
		cin>>n>>m;
		for(int i=1;i<=m;i++)
		{
			cin>>a[i]>>b[i];
		}
		for(int i=1;i<=n;i++)
		{
			w[i]=i;
		}
		for(int i=1;i<n;i++)
		{
			int k;
			cin>>k;
			int q,w;
			q=a[k];
			w=b[k];
			q=root(q);
			w=root(w);
			merge(q,w);
		} 
		int c=0;
		for(int i=1;i<=n;i++)
		{
			if(w[i]==i)
			c++;
		} 
		 if(c==1)
		 cout<<"YES"<<endl;
		 else
		 cout<<"NO"<<endl;   
	}
	return 0;
}