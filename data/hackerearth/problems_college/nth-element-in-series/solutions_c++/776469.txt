#include <bits/stdc++.h>
using namespace std;
#define LL long long

LL x[5];
LL arr[6][6];
LL ans[6][6], D[6][6];
#define MOD 1000000007
LL mul(){
    LL i, j, k;
    for(i = 1; i <= 5; i++){
        for(j = 1; j <= 5; j++){
            D[i][j] = 0;
        }
    }
    for(i = 1; i <= 5; i++){
        for(j = 1; j <= 5; j++){
            for(k = 1; k <= 5; k++){
                D[i][j] += ans[i][k] * ans[k][j];
                if(D[i][j] >= MOD) D[i][j] %= MOD;
            }
        }
    }
    for(i = 1; i <= 5; i++){
        for(j = 1; j <= 5; j++){
            ans[i][j] = D[i][j];
        }
    }
}
LL mult(){
    LL i, j, k;
    for(i = 1; i <= 5; i++){
        for(j = 1; j <= 5; j++){
            D[i][j] = 0;
        }
    }
    for(i = 1; i <= 5; i++){
        for(j = 1; j <= 5; j++){
            for(k = 1; k <= 5; k++){
                D[i][j] += ans[i][k] * arr[k][j];
                if(D[i][j] >= MOD) D[i][j] %= MOD;
            }
        }
    }
    for(i = 1; i <= 5; i++){
        for(j = 1; j <= 5; j++){
            ans[i][j] = D[i][j];
        }
    }
}



LL pow(LL x){
    if(x == 0) return 0;
    pow(x / 2);
    mul();
    if(x & 1) mult();
    return 0;
}

int main(){
    LL t, n, i, j;
    cin>>t;
    while(t--){
        cin>>x[0]>>x[1]>>x[2]>>x[3]>>x[4];
        cin>>n;
        if(n < 5){
            cout<<x[n]<<endl;
        }
        else{
            for(i = 1; i <= 5; i++){
                for(j = 1; j <= 5; j++) ans[i][j] = 0;
                ans[i][i] = 1;
            }
            arr[1][1] = 1;
            arr[1][2] = 1;
            arr[1][3] = 1;
            arr[1][4] = 2;
            arr[1][5] = 1;

            for(i = 2; i <= 5; i++){
                for(j = 1; j <= 5; j++){
                    arr[i][j] = 0;
                }
                arr[i][i-1] = 1;
            }
            pow(n - 4);
            LL an = 0;
            an += ans[1][1] * x[4];
                if(an >= MOD) an %= MOD;
            an += ans[1][2] * x[3];
                if(an >= MOD) an %= MOD;
            an += ans[1][3] * x[2];
                if(an >= MOD) an %= MOD;
            an += ans[1][4] * x[1];
                if(an >= MOD) an %= MOD;
            an += ans[1][5] * x[0];
                if(an >= MOD) an %= MOD;
            cout<<an<<endl;
        }
    }

}
