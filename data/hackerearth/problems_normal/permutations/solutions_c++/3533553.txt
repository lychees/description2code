#include<bits/stdc++.h>
#define pb push_back
using namespace std;
typedef long long LL;

const int NMAX = 130;

int used[NMAX];

int g[NMAX][NMAX];

vector<pair<int,int> > r;

int cnt = 2;
vector<int>vec;

void dfs(int v){

    used[v] = cnt;
    r.pb({ vec[v] ,v });
    for(int i=0;i<103;i++){
        if(g[v][i]!=0 && !used[i])
        {
            dfs(i);
        }

    }
}

int main()
{
    int n;cin>>n;
    for(int i=0;i<n;i++)
    {
        int x;cin>>x;
        vec.pb(x);
    }
    getchar();

    for(int i=0;i<n;i++)
    {
        for(int j = 0;j<n;j++){
            char c = getchar();
            if(c=='N')
                g[i][j] = 0;
            else
                g[i][j] = 1;
        }
        getchar();
    }

    for(int i=0;i<n;i++)
    {
        cnt++;
        r.clear();
        if(!used[i])
        {
            dfs(i);
            sort(r.begin(),r.end());
            int pos  = 0;
            for(int j = 0;j<n;j++){
                if(used[j]==cnt){
                    vec[j] = r[pos].first;
                    pos++;
                }
            }
        }

    }

    for(int i=0;i<n;i++)
        cout<<vec[i]<<" ";
    cout<<endl;
    return 0;
}




