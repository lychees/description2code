#include <bits/stdc++.h>
#define ll long long
using namespace std;
ll int a[1010];
int main()
{
	ios_base::sync_with_stdio(false);
	cin.tie(NULL);
	ll int test;
	cin>>test;
	while(test--)
	{
		string s1;
		cin>>s1;
		stack<ll int> s;
		ll int t1,t2,i,n=0,j,l=s1.length(),ans=0;
		for(i=0;i<l;i++)
		{
			if(s1.at(i)=='X')
			n++;
		}
		for(i=0;i<n;i++)
		{
			cin>>a[i];
		}
		//~ cout<<"you enetered "<<s1<<endl;
		for(i=(l-1);i>=0;i--)
		{
			if(s1.at(i)=='A')
			{
				t1=s.top();
				s.pop();
				t2=s.top();
				s.pop();
				t1+=t2;
				s.push(t1);
			}
			else if(s1.at(i)=='B')
			{
				t1=s.top();
				s.pop();
				t2=s.top();
				s.pop();
				t1=max(t1,t2);
				s.push(t1);
			}
			else
			{
				s.push(1);
			}
		}
		sort(a,a+n,greater<ll int>());
		for(i=0;i<s.top();i++)
		ans+=a[i];
		cout<<ans<<endl;
	}
	return 0;
}
