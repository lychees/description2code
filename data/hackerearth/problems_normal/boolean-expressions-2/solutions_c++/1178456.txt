#include <cstdio>
#include <vector>
#include <cmath>
#include <set>
#include <map>
#include <algorithm>
#include <cstring>
#include <string>
#include <iostream>
#include <cassert>
#include <memory.h>
using namespace std;

#define forn(i, n) for (int i = 0; i < (int)(n); i++)
#define foreach(it, a) for (__typeof((a).begin()) it = (a).begin(); it != (a).end(); it++)
#define pb push_back
typedef long long ll;
typedef pair<int, int> pii;
typedef long double ld;

const int md = 1000000009;

char s[310], op[310];
int f[310][310][2];

int res_op(int a, int b, char c) {
	if (c == 'a') return a & b;
	if (c == 'o') return a | b;
	return a ^ b;
}

int get(int l, int r, int v) {
	int& res = f[l][r][v];
	if (res != -1) return res;
	res = 0;

	if (l == r) {
		return res = (s[l] - '0') == v;
	}

	for (int q = l; q < r; q++)
		forn(lv, 2)
			forn(rv, 2)
				if (res_op(lv, rv, op[q]) == v) {
					res = (res + ll(get(l, q, lv)) * ll(get(q + 1, r, rv)) % md) % md;
				}

	return res;
}

int main() {
	memset(f, 0xff, sizeof(f));
	scanf("%s %s", s, op);
	int n, l, r;
	char buf[15];
	scanf("%d", &n);
	forn(i, n) {
		scanf("%d %d %s", &l, &r, buf);
		printf("%d\n", get(l - 1, r - 1, buf[0] == 't'));
	}
	return 0;
}
