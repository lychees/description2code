// altizon_1.cpp : Defines the entry point for the console application.
//


#include"iostream"
#include"vector"
#include"string"
#include"map"
#include"math.h"
using namespace std;

int main()
{
	long int T, N, Q,i=0,j,amount,no_of_people,k;
	string name,temp;
	vector<string> stud_names;

	map<string, int> owes, owed;


//	cout << "Enter cases:\n";
	cin >> T;


	while (i < T)
	{
		stud_names.clear();
		owes.clear();
		owed.clear();
		//cout << "Enter number of people:\n";
		cin >> N;
		//cout << "Enter number of transactions:\n";
		cin >> Q;
		//cout << "Enter stud names:\n";

		for (j = 0; j < N; j++)
		{
			cin >> name;
			stud_names.push_back(name);
		}

		for (j = 0; j < Q; j++)
		{
			cin >> name;
			cin >> amount;
			cin >> no_of_people;
			amount = amount / (no_of_people+1);
			for (k = 0; k < no_of_people; k++)
			{
				cin >> temp;
				owes[temp] += amount;
				//cout << temp << " owes " << owes[temp] << endl;
				owed[name] += amount;
				//cout << name << " owed " << owed[temp] << endl;
			}




		}

		for (j = 0; j < N; j++)
		{
			if ((owes[stud_names[j]] == 0 && owed[stud_names[j]] == 0) || (owed[stud_names[j]] == owes[stud_names[j]]))
			{
				cout << stud_names[j] << " neither owes nor is owed\n";
			}

			else if (owes[stud_names[j]]>owed[stud_names[j]])
			{
				cout << stud_names[j] << " owes " << (owes[stud_names[j]] - owed[stud_names[j]]) << endl;
			}
			else
			{
				cout << stud_names[j] << " is owed " << (owed[stud_names[j]] - owes[stud_names[j]]) << endl;
			}

		}


		i++;
	}





	return 0;
}

