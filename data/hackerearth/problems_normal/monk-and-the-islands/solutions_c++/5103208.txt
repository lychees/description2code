#include<bits/stdc++.h>
#include <algorithm>
#include<vector>
#include<list>
#include<utility>
#include<map>
#include<set>
#include<stack>
#include<queue>
#define ll long long int
#define fill(a,v) memset(a,v,sizeof a)
#define FORN(i, n) for(i = 0; i < n; i++)
#define mp make_pair
#define pb push_back
#define s(a) sort(a.begin(),a.end())
#define sa(a,n) sort(a,a+(n))
#define ff first
#define ss second
#define elif else if
using namespace std;
ll i,j,n;
int main()
{
ll t;
cin>>t;
while(t--)
{
     ll m,x,y;
	 cin>>n>>m;
	 vector<ll>v[n+1];
     ll vis[100005];
     ll dis[100005];
	 fill(vis,0); 
     fill(dis,0);	
	for(i=0;i<m;i++)
	{
		cin>>x>>y;
		v[x].pb(y);	
	   	v[y].pb(x);
	}
	
	queue<ll>q;
	q.push(1);
	vis[1]=1;
	
	while(!q.empty())
	{
		ll p=q.front();
	//	cout<<p<<"<--ele visited now"<<endl;
		vis[p]=1;		
		q.pop();
	if(p==n)
	break;
	
		for(i=0;i<v[p].size();i++)
		{
		//	cout<<v[p][i]<<"<--ele considered now"<<endl;
			if(vis[v[p][i]]==0)
			{
				dis[v[p][i]]=dis[p]+1;
				q.push(v[p][i]);	
				vis[v[p][i]]=1;
			}
			
		}		
			
	}
	cout<<dis[n]<<endl;
	
    }
  return 0;
  }
