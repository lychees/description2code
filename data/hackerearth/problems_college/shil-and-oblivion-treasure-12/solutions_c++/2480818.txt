#include<iostream>
using namespace std;
#define mod 1000000007
#define ll long long
ll dp[1100]={0},q,pri[100000],ps=0,n,arr[100000],st[100000][168]={0},fou[200];
ll lef(long long x){ return x*2+1;}
ll ref(long long x){ return x*2+2;}
ll power(ll a,ll b)
{
	ll ans=1,temp=a;
	while(b>0)
	{
		if(b&1)
		ans=(ans*temp)%1000000007;
		b>>=1;
		temp=(temp*temp);
	}
	return ans;
}
void build(ll l,ll r,ll pos)
{
	if(l>r) return ;
	else if(l==r)
	{
		ll i=0;
		while(arr[l]>1)
		{
			while(arr[l]%pri[i]==0)
			st[pos][i]++,arr[l]/=pri[i];
			i++;
		}
	}
	else
	{
		ll left=lef(pos),right=ref(pos);
		build(l,(l+r)/2,left);
		build((l+r)/2+1,r,right);
		for(ll i=0;i<ps;i++)
		{
			ll mi=0;
			if(l<=(l+r)/2) mi=st[left][i];
			if((l+r)/2+1<=r) mi=(mi>st[right][i])?mi:st[right][i];
			st[pos][i]=mi;
		}
	}
}
void chang(ll x,ll l,ll r,ll pos,ll val)
{
	if(l>r || x>r || x<l)
	return ;
	else if(l==r )
	{
		if(l!=x)
		return ;
		ll i=0;
		while(i<ps)
		{
			st[pos][i]=0;
			i++;
		}
		i=0;
		while(val>1)
		{
			while(val%pri[i]==0)
			st[pos][i]++,val/=pri[i];
			i++;
		}
	}
	else
	{
		ll left=lef(pos),right=ref(pos);
		chang(x,l,(l+r)/2,left,val);
		chang(x,(l+r)/2+1,r,right,val);
		for(ll i=0;i<ps;i++)
		{
			ll mi=0;
			if(l<=(l+r)/2)
			 mi=st[left][i];
			if((l+r)/2+1<=r)
			 mi=(mi>st[right][i])?mi:st[right][i];
			st[pos][i]=mi;
		}
	}
}
void fin(ll x,ll y,ll l,ll r,ll pos)
{
	if(l>r || l>y || r<x)
	return ;
	else 
	{
		ll left=lef(pos),right=ref(pos);
		if(l>=x && y>=r )
		{			
			for(ll i=0;i<ps;i++)
				if(fou[i]<st[pos][i]) fou[i]=st[pos][i];
		}
		else
			fin(x,y,l,(l+r)/2,left);fin(x,y,(l+r)/2+1,r,right);
	}
}
int main()
{
	ps=0;
	for(ll i=2;i<=1000;i++)
	{
		if(!dp[i])
		{
			pri[ps]=i;
			ps++;
			for(ll j=i*2;j<=1000;j+=i)
				dp[j]=1;
		}
	}
	cin>>n;
	for(ll i=0;i<n;i++)	cin>>arr[i];
	build(0,n-1,0);
	cin>>q;
	while(q--)
	{
		ll t,l,r;
		cin>>t>>l>>r;
		if(t==1)
		{
			l--;
			chang(l,0,n-1,0,r);
		}
		else
		{
			l--;r--;
			for(int jj=0;jj<200;jj++)
			fou[jj]=0;
			fin(l,r,0,n-1,0);
			ll ans=1;
			for(int i=0;i<ps;i++)
			{
				ans=(ans*power(pri[i],fou[i]))%mod;
			}
			cout<<ans<<endl;
		}
	}
	return 0;
}