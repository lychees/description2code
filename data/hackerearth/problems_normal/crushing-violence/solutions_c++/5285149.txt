#include<bits/stdc++.h>
using namespace std;
int main()
{
    int t,n,b[100000][2],g[100000][2],maxi,ctr;
    cin>>t;
    while(t--)
    {
        maxi=ctr=0;
        cin>>n;
        for(int i=1;i<=n;i++)
            b[i][1]=g[i][1]=0;
        for(int i=1;i<=n;i++)
            cin>>b[i][0];
        for(int i=1;i<=n;i++)
            cin>>g[i][0];
        for(int i=1;i<=n;i++)
        {
            /*cout<<"boy"<<i<<endl;
            cout<<"boy's crush=girl"<<b[i][0]<<endl;
            cout<<"(boy's crush)crush=boy"<<g[b[i][0]][0]<<endl;
            cout<<"((boy's crush)crush)crush=girl"<<b[g[b[i][0]][0]][0]<<endl;
            cout<<"(((boy's crush)crush)crush)crush=boy"<<g[b[g[b[i][0]][0]][0]][0]<<endl;*/
            if(g[b[i][0]][0]!=i)
            {
                b[g[b[i][0]][0]][1]++;
                if(b[g[b[i][0]][0]][1]>maxi)
                    maxi=b[g[b[i][0]][0]][1];
            }
            if(b[g[i][0]][0]!=i)
            {
                g[b[g[i][0]][0]][1]++;
                if(g[b[g[i][0]][0]][1]>maxi)
                    maxi=g[b[g[i][0]][0]][1];
            }
            /*if((g[b[i][0]][0]!=i&&g[b[g[b[i][0]][0]][0]][0]==i)||(b[g[i][0]][0]!=i&&b[g[b[g[i][0]][0]][0]][0]==i))
                {
                    cout<<"boys crush"<<a[i]<<"girl's crush"<<g[b[i][0]][0]<<"boys crush"<<
                    ctr++;
                }*/
            /*if(g[b[i][0]][0]!=i&&g[b[g[b[i][0]][0]][0]][0]==i)
            {
                cout<<"yo";
                ctr++;
            }*/
            if(g[b[i][0]][0]!=i&&g[b[g[b[i][0]][0]][0]][0]==i)
                {
                    ctr++;
                    //cout<<"b";
                }
            if(b[g[i][0]][0]!=i&&b[g[b[g[i][0]][0]][0]][0]==i)
            {
                //cout<<"g";
                ctr++;
            }
        }
        cout<<maxi<<" "<<ctr/2<<endl;
    }
}

