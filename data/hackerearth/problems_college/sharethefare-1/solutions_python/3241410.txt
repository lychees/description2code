t = int(raw_input())

for _ in xrange(t):
    string = raw_input()
    n, q = string.split(" ")
    n = int(n)
    q = int(q)
    
    nameList = []
    details = {}
    for _ in xrange(n):
        name = raw_input()
        details[name] = 0
        nameList.append(name)
    
    for _ in xrange(q):
        name = raw_input()
        amount = int(raw_input())
        numberOfPeople = int(raw_input())
        
        temp = amount % (numberOfPeople+1)
        amountNew = amount - temp
        individualAmount = amountNew/(numberOfPeople+1)
        
        details[name] = details[name] + (numberOfPeople*individualAmount)
        
        for _ in xrange(numberOfPeople):
            nameTemp = raw_input()
            details[nameTemp] = details[nameTemp] - individualAmount
            
    for name in nameList:
        value = details[name]
        if value < 0:
            print name + " owes " + str(abs(value))
        elif value > 0:
            print name + " is owed " + str(value)
        else:
            print name + " neither owes nor is owed"