import math


def steps(n, k):
    if k == 1:
        return n
    p = int(math.floor(math.log(n, k)))
    ans = 0
    while True:
        n -= k**p
        ans += 1
        if n == 0:
            break
        p = int(math.floor(math.log(n, k)))
        if p == 0:
            return ans + n
    return ans


for testCases in range(input()):
    n, k = map(int, raw_input().split())
    print steps(n, k)
