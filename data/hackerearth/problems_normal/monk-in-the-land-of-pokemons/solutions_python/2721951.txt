t = int(raw_input())
for i in range(t):
	n = int(raw_input())
	x,total,food,pokemon = [0]*(1000001),0,[],[]
	for j in range(n):
		a,b = map(int,raw_input().split(" "))
		if a != b:
			food.append(a)
			pokemon.append(b)
	m = len(food)
	for j in range(m):
		val = pokemon[j]
		if x[val] != 0:
			x[val] = x[val] - 1
			delt = food[j]
			x[delt] = x[delt] + 1
		else:
			total = total + 1
			delt = food[j]
			x[delt] = x[delt] + 1
	print total
	