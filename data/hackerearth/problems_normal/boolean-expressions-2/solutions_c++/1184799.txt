#include <bits/stdc++.h>
using namespace std;
#define ll long long int
#define MOD 1000000009
#define MAX 305
string operand , optr;
int N,Q,s,e;
string res;
ll T[MAX][MAX],F[MAX][MAX];


ll cal(int s,int e,bool res){

	if(s==e){
		if((res && operand[s] == '1') || (!res && operand[s] == '0'))
			return 1;
		else
			return 0;	
	}

	if(res && T[s][e]!=-1)
		return T[s][e];

	else if(!res && F[s][e]!=-1)
		return F[s][e];

	ll &val = (res ? T[s][e] : F[s][e]);

	val = 0;

	for(int i=s;i<e;i++){
		if(res){
			if(optr[i] == 'a'){
				val = val + cal(s,i,res)*cal(i+1,e,res)%MOD;
				val = val%MOD;
			}else if(optr[i] == 'x'){
				val = val + cal(s,i,res)*cal(i+1,e,!res)%MOD + cal(s,i,!res)*cal(i+1,e,res)%MOD;
				val = val%MOD;
			}else {
				val = val + cal(s,i,res)*cal(i+1,e,res)%MOD + cal(s,i,!res)*cal(i+1,e,res)%MOD + cal(s,i,res)*cal(i+1,e,!res)%MOD;
				val = val%MOD;				
			}
		}else{
			if(optr[i] == 'a'){
				val = val + cal(s,i,res)*cal(i+1,e,res)%MOD + cal(s,i,!res)*cal(i+1,e,res)%MOD + cal(s,i,res)*cal(i+1,e,!res)%MOD;
				val = val%MOD;
			}else if(optr[i] == 'x'){
				val = val + cal(s,i,res)*cal(i+1,e,res)%MOD + cal(s,i,!res)*cal(i+1,e,!res)%MOD;
				val = val%MOD; 
			}else{
				val = val + cal(s,i,res)*cal(i+1,e,res)%MOD;
				val = val%MOD;
			}
		}
	}
	return val%MOD;	
}

int main(){

	
	cin >> operand;
	cin >> optr;
	memset(T,-1,sizeof T);
	memset(F,-1,sizeof F);
	cin >> Q;
	while(Q--){
		cin >> s >> e >> res;
		s--;
		e--;
		if(res[0] == 't')
			cout << cal(s,e,1) << endl;
		else
			cout << cal(s,e,0) << endl;	 
	}
	return 0;
}



