// Shalin
#include <bits/stdc++.h>
#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <math.h>
#include <limits.h>
using namespace std;
#define si(x) scanf("%d",&x)
#define slli(x) scanf("%lld",&x);
#define sc(x) scanf("%c",&x);
#define ss(x) scanf("%s",x);
#define sd(x) scanf("%lf",&x);
#define bitcount __builtin_popcount
#define gcd __gcd
#define llu long long unsigned int
#define lli long long int
#define fi first
#define se second
#define pb push_back
#define mod 1000000007
#define mp make_pair
#define vi vector<int>
#define vlli vector<long long int>
#define pii pair<int,int>

vector< vector<lli> > mult(vector< vector<lli> > &A,vector< vector<lli> > &B)
{
    lli M=A.size(),N=B[0].size(),N1=A[0].size();
    vector< vector<lli> > ans(M,vector <lli> (N,0));
    for (lli i = 0; i < M; ++i)
    {
        for (lli j = 0; j < N; ++j)
        {
            for (lli k = 0; k < N1; ++k)
            {
                ans[i][j]+=(((lli)A[i][k])*((lli)B[k][j]))%mod;
                ans[i][j]%=mod;
            }
        }
    }
    return ans;
}
vector< vector <lli> > fp(vector< vector<lli> > &A,lli b)
{
    if(b==1)
        return A;
    vector< vector<lli> > ans=fp(A,b/2),temp;
    temp=mult(ans,ans);
    if(b%2)
    {
        ans=mult(temp,A);
        return ans;
    }
    return temp;
}

int main()
{
    //freopen("input.txt","r",stdin);
    //freopen("output.txt","w",stdout);
    lli i,j,T;
    slli(T);
    while(T--)
    {
        lli n,k,u,v;
        slli(n);slli(k);slli(u);slli(v);
        vector< vector<lli> > mat;
        for(i=0;i<n;i++)
        {
            vlli temp;
            for(j=0;j<n;j++)
            {
                lli temp1;slli(temp1);
                temp.pb(temp1);
            }
            mat.pb(temp);
        }
        vector< vector<lli> > ans=fp(mat,k);
        printf("%lld\n",ans[u][v]);
    }
    return 0;
}