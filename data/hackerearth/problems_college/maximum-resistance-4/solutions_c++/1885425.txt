	#include <bits/stdc++.h>
    using namespace std;
     
    int main() {
    int t;
    scanf("%d",&t);
    while(t--) {
    string s;
    stack<int> st;
    cin >> s;
    int c = 0, sum = 0,i = 0;
    for(i = s.length() - 1; i >= 0; --i) {
    if(s[i] == 'X') {
    st.push(1);
    c++;
    }
    else{
    if(s[i] == 'A') {
    int a = st.top();	st.pop();
    int b = st.top();	st.pop();
    st.push(a + b);
    }
    else {
    int a = st.top();	st.pop();
    int b = st.top();	st.pop();
    st.push(max(a, b));
    }
    }
    }
    vector<int> v(c);
    for(i = 0; i < c; ++i)	cin>>v[i];
    sort(v.begin(), v.end(), greater<int>());
    i = st.top();
    i -= 1;
    
    for(; i >= 0; --i)	sum += v[i];
   	cout<<sum<<endl;
    }
    return 0;
    }