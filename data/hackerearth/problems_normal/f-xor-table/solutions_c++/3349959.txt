#include <bits/stdc++.h>

using namespace std;

const int M = 1000007;

int a[M], b[M];
char s[M];

int main()
{
	int nt;
	scanf("%d", &nt);
    do {
    	int n, m, p, x;
    	scanf("%d %d %d %d\n%s", &n, &m, &p, &x, s);
    	for (int i = 0; i < m; ++i)
    		a[i] = x^(s[i] == '1');
    	--n;
    	for (int bit = 0; bit < 30; ++bit) 
    		if ((1<<bit) & n) {
    			int shift = (p*(1ll<<bit))%m;
    			for (int i = 0; i < m; ++i) 
    				b[i] = a[i]^a[(i-shift+m)%m];
    			memcpy(a, b, m<<2);
    		}
    	for (int i = 0; i < m; ++i)
    		printf("%d", a[i]^x);
    	printf("\n");
    }
    while (--nt);
    return 0;
}
