#include<iostream>
#include<stdio.h>
#include<string.h>
#include<stdlib.h>
#include<vector>
#include<algorithm>

using namespace std;

int main()
{
    int t;
    scanf("%d",&t);
    for(int ii=1;ii<=t;ii++)
    {
            int n,w,m;
            scanf("%d%d%d",&n,&w,&m);
            int a[n+1][2];
            for(int j=1;j<=n;j++)
            {
                    scanf("%d",&a[j][0]);
                    a[j][1]=j;
            }
            for(int i=0;i<m;i++)
            {
                    int p,q;
                    scanf("%d%d",&p,&q);
                    int xa=a[p][1];
                    int xb=a[q][1];
                    int xc=min(xa,xb);
                    for(int j=1;j<=n;j++)
                    {
                            if((a[j][1]==xa)||(a[j][1]==xb))
                                       a[j][1]=xc;                     
                    }
            }
            int totc=0;
            for(int j=1;j<=n;j++)
            {
                    if(a[j][1]==j)
                    {          
                               vector<int> v;
                               for(int k=j;k<=n;k++)
                               {
                                       if(a[k][1]==j)
                                          v.push_back(a[k][0]);
                               }
                               int l=v.size();
                               int mat[w+1];
                               for(int p=0;p<=w;p++)
                                    mat[p]=0;
                               mat[0]=1;
                               for(int i=0;i<l;i++)
                               {
                                       for(int q=w;q>=0;q--)
                                       {
                                               if((q-v[i])>=0)
                                                     mat[q]+=mat[q-v[i]];         
                                       }
                               }
                         //      for(int p=0;p<=w;p++)
                        //           cout<<mat[p]<<"\t";
                        //       cout<<"\n";
                               totc+=mat[w];    
                     }
            }
            cout<<totc<<"\n"; 
   }
    return 0;
}
