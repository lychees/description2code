#include<bits/stdc++.h>
using namespace std;
#define N '\n'
#define ll long long
#define ii int
#define S string
#define I cin
#define O cout
#define fr(j) for(i=0;i<j;i++)
#define fe(k) for(l=1;l<=k;l++)
#define ft(test) for(;test;--test)

int main()
{
ll test=0,e,i,j,k,x,y,m=0,n=0,q,flag=0,sum,x1,y1,x2,y2,x3,y3,a,b,c,l;
S s,s1;
I>>test;
ft(test)
{
I>>n;
ll arr[n],arr1[n];
fr(n) I>>arr[i];
fr(n) I>>arr1[i];
vector<pair<ll, ll> >vb;
vector<pair<ll, ll> >vg;
set<pair<ll,ll> > seb;
set<pair<ll,ll> > seg;

fr(n)
{
if(i!=(arr1[arr[i]-1]-1)) {vb.push_back(make_pair(i+1,arr1[arr[i]-1]));seb.insert(make_pair(min(i+1,arr1[arr[i]-1]),max(i+1,arr1[arr[i]-1])));}
if(i!=(arr[arr1[i]-1]-1)) {vg.push_back(make_pair(i+1,arr[arr1[i]-1]));seg.insert(make_pair(min(i+1,arr[arr1[i]-1]),max(i+1,arr[arr1[i]-1])));}
}
ll arrbb[n],arrbg[n];
memset(arrbb,0,sizeof(arrbb));memset(arrbg,0,sizeof(arrbg));

fr(vb.size()) arrbb[vb[i].second-1]++;
fr(vg.size()) arrbg[vg[i].second-1]++;

sort(arrbb,arrbb+n);
sort(arrbg,arrbg+n);
x=vb.size()-seb.size()+vg.size()-seg.size();
O<<max(arrbb[n-1],arrbg[n-1])<<" "<<x<<N;



}

return 0;
} 