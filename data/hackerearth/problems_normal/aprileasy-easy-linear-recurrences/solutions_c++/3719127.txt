#include <cstdio>
#include <cstring>
#define mp make_pair
#define vi vector<int>
#define pi pair<int,int>

#define vii vector<pi>
long long mod = 1000000007;
using namespace std;
long long mem[30][5][5];
long long a, b, c, d, e, f, F0, F1, G0, G1, q;
long long H0, H1;
void init() {
	H0 = (e * F0 + f * G0 ) % mod;
	H1 = (e * F1  + f * G1 ) % mod;
	mem[0][0][0] = a, mem[0][0][3] = b, mem[0][1][0] = 1, mem[0][2][1] = d;
	mem[0][2][2] = c, mem[0][3][2] = 1;
	mem[0][4][0] = (e * a) % mod;
	mem[0][4][1] = (f * d) % mod;
	mem[0][4][2] = (f * c) % mod;
	mem[0][4][3] = (e * b) % mod;
	mem[0][4][4] = 1;
	int i, j, k, l;

	for (i = 1; i < 30; i++) {
		for (j = 0; j < 5; j++)
			for (k = 0; k < 5; k++) {
				for (l = 0; l < 5; l++)
					mem[i][j][k] += mem[i - 1][j][l] * mem[i - 1][l][k];
				mem[i][j][k] %= mod;
			}
	}
}
int main() {
#ifndef ONLINE_JUDGE
	freopen("/home/shiva/Learning/1.txt", "r", stdin);
	freopen("/home/shiva/Learning/2.txt", "w", stdout);
#endif
	scanf("%lld %lld %lld %lld %lld %lld %lld %lld %lld %lld", &a, &b, &c, &d, &e, &f, &F0, &F1, &G0, &G1);
	init();
	int q;
	scanf("%d", &q);
	long long H[2] = {H0, (H0 + H1) % mod};
	while (q--) {
		int n;
		scanf("%d", &n);
		if (n <= 1) printf("%lld\n", H[n]);
		else {
			n--;

			long long B[5] = {F1, F0, G1, G0, (H0 + H1) % mod};
			for (int i = 0; i < 30; i++)
				if (n & (1 << i)) {
					long long temp[] = {0, 0, 0, 0, 0};
					for (int j = 0; j < 5; j++) {
						for (int k = 0; k < 5; k++)
							temp[j] += mem[i][j][k] * B[k];
						temp[j] %= mod;
					}
					for (int l = 0; l < 5; l++) B[l] = temp[l];
				}
			printf("%lld\n", B[4]);
		}

	}

}
