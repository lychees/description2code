#include <bits/stdc++.h>
using namespace std;

int main()
{
    vector<int> a[10004];
    int t,n,m,x,y,i,j,level[10004];
    bool v[10004];
    cin>>t;
    while(t--){
    	cin>>n>>m;
    	for(i=1;i<=n;i++){
    		a[i].clear();
    	}
    	memset(v,false,sizeof(v));
    	for(i=0;i<m;i++){
    		cin>>x>>y;
    		a[x].push_back(y);
    		a[y].push_back(x);
    	}
    	queue<int> Q;
    	Q.push(1);
    	level[1]=0;
    	j=0;
    	map<int,int> D;
    	D.clear();
    	D[1]=0;
    	v[1]=true;
    	while(!Q.empty()){
    		int k = Q.front();
    		Q.pop();
    		j=D[k];
    		if(k==n){
    			break;
    		}
    		for(i=0;i<a[k].size();i++){
    			if(!v[a[k][i]]){
    				D[a[k][i]]=j+1;
    				v[a[k][i]] = true;
    				Q.push(a[k][i]);
    			}
    		}
    	}
    	cout<<D[n]<<endl;
    }
    return 0;
}
