#include <bits/stdc++.h>
using namespace std;
int t,n,m,cnt,cur,prv,i,j,k,cj,ck,pj,pk,x,p[1000100],rk[1000100];
char s[1000100];
pair<char,int> a[1000100];
int fs(int i) {
  if (i!=p[i]) p[i]=fs(p[i]);
  return p[i];
}
bool un(int i, int j) {
  if (i==j) return true;
  if (rk[i]<rk[j]) p[i]=j; else {
    p[j]=i;
    if (rk[i]==rk[j]) rk[i]++;
  }
  return false;
}
int main() {
  scanf("%d",&t);
  while (t--) {
    scanf("%d%d",&n,&m);
    for (i=0; i<n; i++) scanf("%s",s+i*m);
    for (cnt=prv=i=0; i<n; i++) {
      cur=cnt; x=i*m;
      for (j=0; j<m; j=k) {
        for (k=j; k<m && s[x+k]==s[x+j]; k++);
        p[cnt]=cnt;
        rk[cnt]=1;
        a[cnt++]=make_pair(s[x+j],k-1);
      }
      for (pj=pk=0, j=prv, k=cur; j<cur && k<cnt; ) {
        cj=a[j].second;
        ck=a[k].second;
        if (a[j].first==a[k].first && max(pj,pk)<=min(cj,ck) && un(fs(j),fs(k))) break;
        if (cj<ck) {
          pj=cj+1; j++;
        } else {
          pk=ck+1; k++;
        }
      }
      if (j<cur && k<cnt) break;
      prv=cur;
    }
    puts(i<n?"NO":"YES");
  }
  return 0;
}
