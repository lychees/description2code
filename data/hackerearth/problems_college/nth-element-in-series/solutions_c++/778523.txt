#include<bits/stdc++.h>
#define lli long long int
#define REP(i,n) for(i=0;i<n;i++)
using namespace std;
typedef vector<vector<lli> > matrix;
const int MOD = 1000000000+7;

matrix mmul(matrix M1, matrix M2){
    matrix R(5);
    int i,j,k;
    REP(i,5){
        R[i].assign(5,0);
        REP(j,5) {
            REP(k,5) R[i][j] = (R[i][j] + M1[i][k]*M2[k][j]) % MOD;
        }
    }
    return R;
}

matrix mpow(matrix M, lli pow){
    if(pow==1) return M;
    int i,j;
    if(pow==0){
        matrix R(5);
        REP(i,5){
            R[i].assign(5,0);
            R[i][i]=1;
        }
        return R;
    }
    matrix R = mpow(M,pow/2);
    matrix M1 = mmul(R,R);
    if(pow %2== 1){
        return mmul(M,M1);
    }
    return M1;
}

int main(){
    int T, F[5], i;
    lli N, Sn;
    cin>>T;
    while(T--){
        REP(i,5) cin>>F[i];
        cin>>N;
        if(N<5) Sn=F[N];
        else{
            matrix Mat(5);
            REP(i,5) Mat[i].assign(5,0);
            Mat[0][1]=1, Mat[1][2]=1, Mat[2][3]=1,Mat[3][4]=1;
            Mat[4][0]=1, Mat[4][1]=2, Mat[4][2]=1,Mat[4][3]=1, Mat[4][4]=1;
            matrix Mtx = mpow(Mat,N-4);
            lli ans = 0;
            REP(i,5){
                ans = (ans + Mtx[4][i]*F[i]) % MOD;
            }
            Sn = ans;
        }
        cout<<Sn<<endl;
    }
}
