#include<bits/stdc++.h>
using namespace std;


long long mod (long long a, long long b)
{
	if(b < 0)
   		return mod(-a, -b);   
	long long ret = a % b;
	if(ret < 0)
		ret+=b;
	return ret;
}

void solve()
{
	long long n,m;
	long long unsigned z;
	cin>>n>>m>>z;
	
	long long in[n+1];
	memset(in,0,sizeof(long long) * (n+1));
	
	for (long long i = 0; i < n; ++i)
	{
		cin>>in[i];
	}
	
	bool flag = false;
	long long cnt = 0;
	for (long long j = n-1;; j--)
	{
		cnt++;
		if(flag == false)
		{
			in[n] += in[j];
			in[n] = mod(in[n],m);
			flag = true;
		}
		else
		{
			in[n] -= in[j];
			in[n] = mod(in[n],m);
			flag = false;
		}
		if(cnt == n)
			break;
	}
	in[n] = mod(in[n],m);

	int ans;
	if((n+1)%2==0)
    {
     	cout<<in[z%(n+1)]<<endl;   
    }
    else
    {
    	if((z/(n+1))%2==0)
        {
            cout<<mod(in[z%(n+1)],m)<<endl;
        }
        else
        {
            long long num=(-1*in[z%(n+1)]);
            cout<<mod(num,m)<<endl;
        }
    }
}

int main()
{
      long long t;
      cin>>t;
      while(t--)
            solve();
      return 0;
}
