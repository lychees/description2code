#include <iostream>
using namespace std;
const long N = 100000;
long long a[N], al[N], ar[N], mod = 1000000007;

int main()
{
	int t;
	cin >> t;
	for(int i =0; i < t; ++i)
	{
		long n;
		cin >> n;
		for(int j = 0; j < n; ++j)
		{
			cin >> a[j];
			al[j] = 0;
			ar[j] = 0;
		}
		for(int j = 0; j < n; ++j)
			al[j] = max(a[j],(j!=0)?al[j-1]:0);

		for(int j = n-1; j >= 0; --j) 
			ar[j] = max(a[j],(j<(n-1))?ar[j+1]:0);
			
		long area = 0;
		for(int j = 0; j < n; ++j)
			area += min(al[j], ar[j])-a[j];
			
		cout << area%mod << endl;
	}
	
    return 0;
}
