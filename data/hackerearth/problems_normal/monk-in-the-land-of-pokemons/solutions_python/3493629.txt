tc = int(raw_input())
assert(tc>0 and tc<11)
while tc>0:
    tc = tc - 1
    n = int(raw_input())
    assert(n>0 and n<=10**5)
    ans = [0]*1000001
    ite, poke = [0]*n, [0]*n
    final = 0
    for i in xrange(n):
        a, b = map(int, raw_input().split(" "))
        assert(a>0 and a<=10**6)
        assert(b>0 and b<=10**6)
        ans[a]+=1
        if (ans[b] == 0):
            final+=1
        else:
            ans[b]-=1
    print final