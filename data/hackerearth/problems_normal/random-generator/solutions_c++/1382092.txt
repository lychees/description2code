#include <iostream>
#include <cstdio>
#define ll long long
#include <algorithm>

using namespace std;

int main()
{
	int t;
	scanf("%d",&t);
	while(t--)
	{
	ll int k,x,p,n,flag=1;
	scanf("%lld%lld%lld",&n,&k,&p);
	ll a[n];
	for(ll int i=0;i<n;i++)
	cin>>a[i];
	sort(a,a+n);
	ll int maxi=a[n-1];
	ll int mini=a[0];
	for(ll int x=mini;x<=maxi;x++)
	{
		ll int lo=lower_bound(a,a+n,x-p)-a;
		ll int hi=upper_bound(a,a+n,x+p)-a;
		if(hi-lo>=k)
		{
			flag=0;
			break;
		}
	}	
	if(!flag) cout<<"NO\n";
	else
	cout<<"YES\n";
	}
	return 0;
}