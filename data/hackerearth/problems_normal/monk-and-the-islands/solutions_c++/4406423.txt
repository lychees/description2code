#include <iostream>
#include <vector>
#include <queue>
#include <algorithm>
using namespace std;

vector<int> v[100005];
int main()
{
    int t;cin>>t;
    while(t--){
    	int n,m;cin>>n>>m;
    	int x,y,i;
    	for(i=0;i<m;i++){
    		cin>>x>>y;
    		v[x].push_back(y);
    		v[y].push_back(x);
    	}
    	queue<int> q;
    	q.push(1);
    	long long dist[10005];
    	fill(dist,dist+10005,1000000);
    	dist[1]=0;
    	while(!q.empty()){
    		int u=q.front();
    		q.pop();
    		for(i=0;i<(int)v[u].size();i++){
    			if(dist[v[u][i]]>dist[u]+1){
    				dist[v[u][i]]=dist[u]+1;
    				q.push(v[u][i]);
    			}
    			//cout<<i<<"  ";
    		}
    		//cout<<dist[u]<<" ";
    	}
    	cout<<dist[n]<<endl;
    	for(i=0;i<100005;i++)	v[i].clear();
    }
    return 0;
}
