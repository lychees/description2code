#include <bits/stdc++.h>
#define M 1000000007
using namespace std;
string s;
int len;
long long dp[67][3][2];
void conv(long long x)
{
    s = "";
    while ( x > 0 ) {
        s += (char)(x%2 + 48);
        x /= 2;
    }
    reverse(s.begin(),s.end());
    len = (int)s.size();
    return;
}
long long f(int idx, int carry, int flag)
{
    if ( idx == -1 ) {
        if ( (!carry) && flag ) return 1;
        return 0;
    }
    if ( dp[idx][carry][flag] != -1 ) return dp[idx][carry][flag];
    long long ans = 0;
    for ( int i = 0; i < 2; i++ ) {
        for ( int j = 0; j < 2; j++ ) {
            for ( int k = 0; k < 2; k++ ) {
                int sum = ((i+j+k) == 3);
                if ( ((i+j+k+carry)%2) == (s[idx]-48) ) ans = (ans + f(idx-1,(i+j+k+carry)/2, flag | sum))%M;
            }
        }
    }
    dp[idx][carry][flag] = ans;
    return ans;
}
int main()
{
    int t;
    long long N;
    cin>>t;
    assert(t<=1000);
    while ( t-- ) {
        cin>>N;
        conv(N);
        for(int i=0;i<=s.length();i++)
        {
        	for(int j=0;j<3;j++)
        	{
        		for(int k=0;k<2;k++)
        		{
        			dp[i][j][k]=-1;
        		}
        	}
        }
        long long ans = f(len-1,0,0);
        printf("%lld\n", ans);
    }
    return 0;
}