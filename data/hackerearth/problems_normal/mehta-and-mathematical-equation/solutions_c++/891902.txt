#include <bits/stdc++.h>
using namespace std;
#define lli long long int
#define md 1000000007
int n;
int A[100];
void func(lli nn)
{
	n=0;
	while(nn!=0)
	{
		n++;
		A[n]=nn&1;
		nn=nn>>1;		
	}
}
int main()
{
	int t;
	cin>>t;
	while(t--)
	{
		lli nn;
		cin>>nn;
		if(nn==0)
		{
			cout<<"0\n";
			continue;
		}
		func(nn);
		lli dp[n+1][6][2];
		for(int i=0;i<6;i++)
			dp[0][i][0]=dp[0][i][1]=0;
		dp[0][0][0]=1;
		for(int i=1;i<=n;i++)
		{
			if(A[i]==1)
			{
				for(int j=0;j<6;j+=2) dp[i][j][0]=dp[i][j][1]=0;
				dp[i][1][0]=(3*(dp[i-1][0][0]+dp[i-1][1][0])+dp[i-1][2][0]+dp[i-1][3][0])%md;
				dp[i][1][1]=(3*(dp[i-1][0][1]+dp[i-1][1][1])+dp[i-1][2][1]+dp[i-1][3][1])%md;
				dp[i][3][0]=(3*(dp[i-1][4][0]+dp[i-1][5][0])+3*(dp[i-1][2][0]+dp[i-1][3][0]))%md;
				dp[i][3][1]=(dp[i-1][0][0]+dp[i-1][0][1]+dp[i-1][1][0]+dp[i-1][1][1]+3*(dp[i-1][4][1]+dp[i-1][5][1])+3*(dp[i-1][2][1]+dp[i-1][3][1]))%md;
				dp[i][5][0]=0;
				dp[i][5][1]=(dp[i-1][4][1]+dp[i-1][5][1]+dp[i-1][4][0]+dp[i-1][5][0])%md;
			}
			else
			{
				for(int j=1;j<6;j+=2) dp[i][j][0]=dp[i][j][1]=0;
				dp[i][0][0]=(dp[i-1][0][0]+dp[i-1][1][0])%md;
				dp[i][0][1]=(dp[i-1][0][1]+dp[i-1][1][1])%md;
				dp[i][2][0]=(3*(dp[i-1][0][0]+dp[i-1][1][0])+3*(dp[i-1][2][0]+dp[i-1][3][0])+dp[i-1][4][0]+dp[i-1][5][0])%md;
				dp[i][2][1]=(3*(dp[i-1][0][1]+dp[i-1][1][1])+3*(dp[i-1][2][1]+dp[i-1][3][1])+dp[i-1][4][1]+dp[i-1][5][1])%md;
				dp[i][4][0]=(3*(dp[i-1][4][0]+dp[i-1][5][0]))%md;
				dp[i][4][1]=(dp[i-1][2][1]+dp[i-1][3][1]+dp[i-1][2][0]+dp[i-1][3][0]+3*(dp[i-1][4][1]+dp[i-1][5][1]))%md;
			}
		}
		cout<<(dp[n][0][1]+dp[n][1][1])%md<<"\n";
	}
	return 0;
}