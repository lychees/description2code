/*
    Author:-Sarthak Taneja
    CSE 2nd year,MNNIT Allahabad
*/
#include <bits/stdc++.h>

using namespace std;

typedef long long ll;
typedef pair< int,int > ii;
typedef vector< ii > vii;
typedef vector< int > vi;

#define sfd(x) scanf("%d",&x)
#define sfs(x) scanf("%s",x)
#define sff(x) scanf("%lf",&x)
#define mod 1000000007
#define MAX 1000000
#define pb push_back
#define mp make_pair
#define fr first 
#define sc second
#define testcases scanf("%d",&t);while(t--)
#define ffor(a,b,c) for(a=b;a<c;a++)
#define rfor(a,b,c) for(a=b;a>=c;a--)
#define abs(a) (((a)>0)?(a):-(a))

int main()
{
	int i,j,t;
	int n;
	int a;
	ll ans=0;

	ll pow2[200005];

	pow2[0]=1;
	ffor(i,1,200001)
	{
		pow2[i]=(pow2[i-1]*2)%mod;
	}

	sfd(n);
	ffor(i,0,n)
	{
		ll mul=pow2[n-1-i];
		sfd(a);
		if(i==0)
		{
			ans=((ans)%mod + (a*mul)%mod)%mod;
		}
		else
		{
			mul=(mul*(pow2[i]+(i*pow2[i-1])%mod)%mod)%mod;
			ans=((ans)%mod + (a*mul)%mod)%mod;
		}
	}

	printf("%lld\n",ans);
	return 0;
}