#include <bits/stdc++.h>
using namespace std;

const int MOD = 1e9+7;

int haha[200013];
int pow2[200013];

int main() {
	pow2[0] = 1;
	for (int i=1;i<200013;i++) pow2[i] = (pow2[i-1]*2)%MOD;
	pow2[-1] = (MOD+1)/2;
	int N;
	cin >> N;
	int tot = 0;
	for (int i=0;i<N;i++) {
		int a;
		cin >> a;
		int mult = ((long long) (i+2)*pow2[i-1])%MOD;
		mult = ((long long) mult*pow2[N-i-1])%MOD;
		tot = (tot+(long long) mult*a)%MOD;
	}
	cout << tot;
	
	return 0;
}