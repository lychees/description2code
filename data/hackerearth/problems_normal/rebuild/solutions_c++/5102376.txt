
#include<bits/stdc++.h>
#define int long long
#define endl '\n'
#define pi pair<long long,long long>
#define mp make_pair
#define mod 1000000007

using namespace std;
int n,m,id[(int)2e5],deg[(int)2e5];
vector<pair<int,pi>> edge;


void dsu_start()
{
    for(int i=1;i<=n;i++)id[i]=i,deg[i]=0;
}

int dsu_root(int x)
{
    while(x!=id[x])
    {
        id[x]=id[id[x]];
        x=id[x];
    }
    return x;
}

void dsu_union(int a,int b)
{
    int p=dsu_root(a);
    int q=dsu_root(b);
    id[p]=id[q];
}

int kruskal()
{
    dsu_start();
    int min_cost=0;
    for(int i=0;i<edge.size();i++)
    {
        int a=-edge[i].second.first,b=-edge[i].second.second,cost=edge[i].first;
        if(dsu_root(a)!=dsu_root(b))
        {
            min_cost+=cost;
            ++deg[a];
            ++deg[b];
            dsu_union(a,b);
        }
    }
    return min_cost;
}

main()
{
    ios_base::sync_with_stdio(false);
    cin.tie(0);
    cout.tie(0);
    int t;
    cin>>t;
    //t=1;
    while(t--)
    {

    cin>>n>>m;
    edge.clear();
    for(int i=0;i<m;i++)
    {
        int u,v,w;
        cin>>u>>v>>w;
        if(u>v)swap(u,v);
        edge.push_back(mp(w,mp(-u,-v)));
    }
    sort(edge.begin(),edge.end());
    cout<<kruskal()<<endl;
    for(int i=1;i<=n;i++)cout<<deg[i]<<" ";
    cout<<endl;
    }
    return 0;
}
