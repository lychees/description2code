#include <iostream>
#include<vector>
#include <algorithm>
using namespace std;

int main()
{
	int T; 
	for (cin >> T; T; T--) {
		int N, K, P; cin >> N >> K >> P;
		vector<int> nums;
		for (int i = 0; i < N; i++) {
			int a; scanf("%d", &a);
			nums.push_back(a);
		}
		sort(nums.begin(), nums.end());
		bool found = false;
		for (int i = K-1; i < N && !found; i++) {
			int lo = nums[i - K +1];
			int hi = nums[i];
			int hi_x = lo + P;
			int lo_x = hi -P;
			//cout << hi_x << " " << lo_x <<"\n";
			if (hi_x - lo_x >= 0) found = true;
		}
		cout << (found ? "NO": "YES")<<"\n";
	}
}
