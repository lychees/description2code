#include <bits/stdc++.h>
using namespace std;
#define MAX(x,y) ((x)>(y)?(x):(y))
int main()
{
	int t,T;
	scanf(" %d",&T);
	assert(T>=1 && T<=100);
	for(t=1;t<=T;t++)
	{
		int i,n;
		int back1,back2;
		scanf(" %d",&n);
	
		assert(n>=0 && n<=200);
   		int inh,inm,wakeh,wakem,openh,openm;
   		scanf(" %d:%d %d:%d %d:%d",&inh,&inm,&wakeh,&wakem,&openh,&openm);
   		
   		assert(inh>=0 && wakeh>=0 && openh>=0 && inh<24 && wakeh<24 && openh<24);
   		assert(inm>=0 && wakem>=0 && openm>=0 && inm<60 && wakem<60 && openm<60);
   		
   		int traveltime,selecttime;
   
   		scanf(" %d %d",&traveltime,&selecttime);
   		assert(traveltime>=0 && selecttime>=0 && traveltime<24*60 && selecttime<24*60);
   		
   		int in=inh*60+inm,wake=wakeh*60+wakem,open=openh*60+openm;
   		
   		int done=-1;
   		int earliest=-1;
   		for(i=0;i<n;i++)
   		{
   			int start,end,a,b;
   			scanf(" %d:%d",&a,&b);
   	
   			assert(a>=0 && b>=0 && a<24 && b<60);
   			start=a*60+b;
   			scanf(" %d:%d",&a,&b);
   			
   			end=a*60+b;
   			assert(a>=0 && b>=0 && a<24 && b<60);
   			
   			assert(end>=start);
   		
   			back1=(MAX(open,wake+traveltime)+selecttime+traveltime);
   			if(back1<start && back1<in)
   			{
   			
   				if(earliest==-1 || earliest>back1)
   				{
   					earliest=back1;
   					done=i+1;
   				}
   			}
   		
   			back2=MAX(open,(MAX(end,wake)+traveltime))+selecttime+traveltime;
   			if(back2<in)
   			{
   			
   				if(earliest==-1 || earliest>back2)
   				{
   					earliest=back2;
   					done=i+1;
   				}
   			}
   		}
   		
   		printf("Case %d: %d\n",t,done);
	}
   
    return 0;
}