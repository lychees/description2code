#include "bits/stdc++.h"
using namespace std;
const int N = 5e4 + 4;
const int M = 1e5 + 5;
int t;
int n , m;
pair < int , pair < int , int > > edges[M];
int a , b , c;
long long sum;
int degree[N];
int parent[N];
int find(int node){
    if(parent[node] == node){
        return node;
    }
    return parent[node] = find(parent[node]);
}
bool join(int a , int b){
    if(find(a) == find(b)){
        return 0;
    }
    parent[find(b)] = find(a);
    return 1;
}
int main(){
    scanf("%d" , &t);
    while(t--){
        scanf("%d %d" , &n , &m);
        for(int i = 1 ; i <= n ; ++i){
            degree[i] = 0;
            parent[i] = i;
        }
        sum = 0;
        for(int i = 1 ; i <= m ; ++i){
            scanf("%d %d %d" , &a , &b , &c);
            if(a > b){
                swap(a , b);
            }
            edges[i] = make_pair(c , make_pair(-a , -b));
        }
        sort(edges + 1 , edges + 1 + m);
        for(int i = 1 ; i <= m ; ++i){
            c = edges[i].first;
            a = -edges[i].second.first;
            b = -edges[i].second.second;
            if(join(a , b)){
                sum += c;
                ++degree[a];
                ++degree[b];
            }
        }
        printf("%lld\n" , sum);
        for(int i = 1 ; i <= n ; ++i){
            printf("%d " , degree[i]);
        }
        printf("\n");
    }
}