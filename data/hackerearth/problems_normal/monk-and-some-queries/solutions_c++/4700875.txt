#include <iostream>
#include <queue>
using namespace std;
int main(){
	int q,n,c;
	priority_queue <int> pq1,pq2;
	int a[100000]= {0};
	cin>>q;
	while(q--){
		scanf("%d",&c);
		switch(c)
		{
			case 1:
			scanf("%d",&n);
			if(a[n] == 0){
				a[n] = 1;
				pq1.push(n);
				pq2.push(-n);
				
			}
			else if(a[n] != 0)
			a[n]++;
			break;
			case 2:
			scanf("%d",&n);
			if(a[n] == 0)
			printf("-1\n");
			else 
			a[n]--;
			break;
			case 3:
			while(a[pq1.top()] == 0)
			{
				if(pq1.empty())
				break;
			pq1.pop();
			}
			if(pq1.size())
			cout<<pq1.top()<<endl;
			else
			printf("-1\n");
			break;
			case 4:
			while(a[-pq2.top()] == 0)
			{
				if(pq2.empty())
				break;
			pq2.pop();
			}
			if(pq2.size())
			cout<<-pq2.top()<<endl;
			else
			printf("-1\n");
			break;
			
		}
		
	}
		return 0;
	
}