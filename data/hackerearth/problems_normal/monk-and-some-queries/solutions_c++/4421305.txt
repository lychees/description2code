#include <iostream>
#include <stdio.h>
using namespace std;
int h[100001];
int main()
{
   int q,t,x,i,j,tmax=-1,tmin=100002;
   scanf("%d",&q);
   for(i=0;i<q;i++)
   {
       scanf("%d",&t);
       if(t==1)
       {
        scanf("%d",&x);
        if(x>tmax)
        {
            tmax=x;
        }
        if(x<tmin)
        {
            tmin=x;
        }
        h[x]++;
       }
       else if(t==2)
       {
            scanf("%d",&x);
            if(h[x]>0) // it was there
            {
                h[x]--;
            }
            else
            {
                printf("-1\n");
            }
       }
       else if(t==3)
       {
           for(j=tmax;j>=1;j--)
           {
              // printf("h[%d]: %d\n",j,h[j]);
               if(h[j]>0)
               {
                   break;
               }
           }
           if(j==0)
           {
               j=-1;
           }
           printf("%d\n",j);
       }
       else // t==4
       {
           for(j=tmin;j<=100000;j++)
           {
              // printf("h[%d]: %d\n",j,h[j]);
               if(h[j]>0)
               {
                   break;
               }
           }
           if(j==0)
           {
               j=-1;
           }
           printf("%d\n",j);
       }
   }
    return 0;
}
