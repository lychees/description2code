#include <bits/stdc++.h>
using namespace std;
#define FL(a,i,n) for(int i=a;i<n;i++)
#define RFL(a,i,n) for (int i=a;i>n;i--)
#define PI(a) printf("%d\n",a)
#define PLLI(a) printf("%lld\n",a)
#define LL long long
#define SI(a) scanf("%d",&a)
#define SII(a,b) scanf("%d%d",&a,&b)
#define SIII(a,b,c) scanf("%d%d%d",&a,&b,&c)
#define SLLI(a) scanf("%lld",&a)
#define W(t) while(t--)
#define PB push_back
#define MP make_pair
#define MOD 1000000007
#define debug1(a)           cout <<#a<<": "<<a<<endl;
#define debug2(a, b)        cout <<#a<<": "<<a<<" | "<<#b<<": "<<b<< endl;
#define debug3(a, b, c)     cout <<#a<<": "<<a<<" | "<<#b<<": "<<b<<" | "<<#c<<": "<<c<<endl;
#define debug4(a, b, c, d)  cout <<#a<<": "<<a<<" | "<<#b<<": "<<b<<" | "<<#c<<": "<<c<<" | "<<#d<<": "<<d<<endl;
#define debug5(a, b, c, d, e) cout <<#a<<": "<<a<<" | "<<#b<<": "<<b<<" | "<<#c<<": "<<c<<" | "<<#d<<": "<<d<<" | "<<#e<<": "<<e<<endl;
LL a[300009];
int main(){
    //ios_base::sync_with_stdio(0);
	LL t,n;
	LL k;
	SLLI(t); W(t){
		
		stack< LL > st;
		LL ans=0;
		SLLI(n); SLLI(k);
		for(LL i=0;i<n;i++) SLLI(a[i]);
		st.push(0);
		
		for(LL i=1;i<n;i++){
			if(a[i]<=a[st.top()])
				st.push(i);
			else if(a[i]>a[st.top()]){
				while(!st.empty() && a[st.top()]<a[i]){
					int tt=st.top();
					st.pop();
					if(st.empty() && a[tt]>k) ans+=(i)+(i-tt-1)*(tt);	///
					else if(a[tt]>k) ans+=(i-st.top()-1) + (tt-st.top()-1)*(i-tt-1);	///
				}
				st.push(i);
			}
		}
		while(!st.empty()){
				LL tt=st.top();
				st.pop();
				if(st.empty() && a[tt]>k) ans+=(n)+(n-tt-1)*(tt);	///
				else if(a[tt]>k) ans+=(n-st.top()-1)+ (tt-st.top()-1)*(n-tt-1);	///
		}
		cout << ans << endl;
	}
    
    return 0;
}