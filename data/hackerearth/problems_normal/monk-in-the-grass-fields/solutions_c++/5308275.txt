#include <bits/stdc++.h>
using namespace std;

int A[202][202], R[202], C[202], SR[404], SC[404];
priority_queue<int, vector<int>, greater<int> > Q;

int main()
{
    int T;
    scanf("%d", &T);
    
    while(T--)
    {
    	int N, K;
    	scanf("%d %d", &N, &K);
    	
    	memset(R, 0, sizeof(R));
    	memset(C, 0, sizeof(C));
    	
    	for(int i=1; i<=N; i++)
    	{
    		for(int j=1; j<=N; j++)
    		{
	    		scanf("%d", &A[i][j]);
	    		
	    		R[i]+= A[i][j];
	    		C[j]+= A[i][j];
    		}
    	}
    	
    	while(!Q.empty())
    		Q.pop();
    	
    	for(int i=1; i<=N; i++)
    		Q.push(R[i]);
    	
    	for(int i=1; i<=K; i++)
    	{
    		int x = Q.top();
    		Q.pop();
    		
    		SR[i] = SR[i-1] + x;
    		Q.push(x+N);
    	}
    	
    	while(!Q.empty())
    		Q.pop();
    	
    	for(int i=1; i<=N; i++)
    		Q.push(C[i]);
    	
    	for(int i=1; i<=K; i++)
    	{
    		int x = Q.top();
    		Q.pop();
    		
    		SC[i] = SC[i-1] + x;
    		Q.push(x+N);
    	}
    	
    	int ans = 2000000009;
    	
    	for(int i=0; i<=K; i++)
    		ans = min(ans, SR[i] + SC[K-i] + i*(K-i));
    	
    	printf("%d\n", ans);
    }
    
    return 0;
}
