#include <iostream>
#include<cstdlib>
#define mod 1000000007
#define ll long long int
using namespace std;

ll fact[1000001];
void preCalculate(){
	fact[0]=1;
	for(int i=1;i<=1000000;i++){
		fact[i]=(i*(fact[i-1]))%mod;
	}
}

int countEle(int i,int j,int n,int m,bool** horses,bool** visited){
	
	int count=1;
	visited[i][j]=1;
	if(i+1<n&&j+2<m&&horses[i+1][j+2]&&!visited[i+1][j+2])count+=countEle(i+1,j+2,n,m,horses,visited);
	if(i+1<n&&j-2>=0&&horses[i+1][j-2]&&!visited[i+1][j-2])count+=countEle(i+1,j-2,n,m,horses,visited);
	if(i+2<n&&j+1<m&&horses[i+2][j+1]&&!visited[i+2][j+1])count+=countEle(i+2,j+1,n,m,horses,visited);
	if(i+2<n&&j-1>=0&&horses[i+2][j-1]&&!visited[i+2][j-1])count+=countEle(i+2,j-1,n,m,horses,visited);
	if(i-1>=0&&j+2<m&&horses[i-1][j+2]&&!visited[i-1][j+2])count+=countEle(i-1,j+2,n,m,horses,visited);
	if(i-1>=0&&j-2>=0&&horses[i-1][j-2]&&!visited[i-1][j-2])count+=countEle(i-1,j-2,n,m,horses,visited);
	if(i-2>=0&&j+1<m&&horses[i-2][j+1]&&!visited[i-2][j+1])count+=countEle(i-2,j+1,n,m,horses,visited);
	if(i-2>=0&&j-1>=0&&horses[i-2][j-1]&&!visited[i-2][j-1])count+=countEle(i-2,j-1,n,m,horses,visited);
	return count;
	
}
int main()
{
    int t=0,q,i,j,n,m;
    cin>>t;
    preCalculate();
    while(t--){
    	cin>>n>>m>>q;
    	bool** horses=(bool**)calloc(n,sizeof(bool*));
    	for(i=0;i<n;i++)horses[i]=(bool*)calloc(m,sizeof(bool));
    	bool** visited=(bool**)calloc(n,sizeof(bool*));
    	for(i=0;i<n;i++)visited[i]=(bool*)calloc(m,sizeof(bool));
    	for(int queens=0;queens<q;queens++){
    		cin>>i>>j;
    		i--;
    		j--;
    		horses[i][j]=1;
    	}
    	ll count=1;
    	for(i=0;i<n-1;i++){
    		for(j=0;j<m;j++){
    			if(horses[i][j]&&!visited[i][j]){
    				count=(count*fact[countEle(i,j,n,m,horses,visited)])%mod;
    			}
    		}
    	}
    	cout<<count<<"\n";
    }
    return 0;
}
