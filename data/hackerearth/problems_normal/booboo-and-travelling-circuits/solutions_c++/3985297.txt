#include<bits/stdc++.h>
using namespace std;
//long long tab[2005][10005];
long long s,w,s1,w1;
int a[2001][10001],b[2001][10001];
int main()
{
	vector<long long int>vp[10005];
	
	
	long long n,m,p,q,r,x,y,z,i,j;
	cin>>n>>m;
	int prime[m+5],count=0;
	memset(prime,0,sizeof(prime));
	prime[1]=1;
	for(int i=2;i<=m;i++)
	{
		if(prime[i]==0)
		{
		count++;
		for(int j=i;j<=m;j+=i)
		{
			if(prime[j]==0)
			{
				prime[j]=i;
				vp[count].push_back(j);
			}
		}
		}
	}
	/*cout<<count<<endl;
	for(int i=1;i<=count;i++)
	{
		for(int j=0;j<vp[i].size();j++)
		cout<<vp[i][j]<<" ";
		cout<<endl;
	}*/
	//long long s[n*m+5],w[n*m+5],a[n+1][m+1],b[n+1][m+1];
	cin>>s>>p>>q>>r>>w>>x>>y>>z;
	for(i = 0; i < (n*m); i++)
	{
    	s1 = ((((p * s)% 1000000003) * s)% 1000000003 + (q * s)% 1000000003 + r)% 1000000003;
    	a[(i/m) + 1][(i%m) + 1] = s1;
    	s=s1;
	}
	for(i = 0; i < (n*m); i++)
	{
        w1 = ((((x * w)% 1000000003) * w)% 1000000003 + (y * w)% 1000000003 + z)% 1000000003;
        b[(i/m) + 1][(i%m) + 1] = w1;
        w=w1;
    }
	long long k;
	long long tab[3][m+5];
	for(i=1;i<=m;i++)
	tab[1][i]=0;
	for(i=2;i<=n;i++)
	{
		for(k=0;k<=count;k++)
		{
			
			long long mini=1e18,mini2=1e18,minind1;
			if(k==0)
			{
				mini=min(mini,tab[1][1]+a[i-1][1]);
				for(j=2;j<=m;j++)
				mini=min(mini,tab[1][j]+b[i-1][j]);
				tab[2][1]=mini;
				mini=1e18;
			}
			for(j=0;j<vp[k].size();j++)
			{
				if(tab[1][vp[k][j]]+b[i-1][vp[k][j]]<mini)
				{
					mini=tab[1][vp[k][j]]+b[i-1][vp[k][j]];
					minind1=j;
				}
				//mini=min(mini,tab[1][vp[k][j]]+b[i-1][vp[k][j]]);
				
			}
			for(j=0;j<vp[k].size();j++)
			{
				if((tab[1][vp[k][j]]+b[i-1][vp[k][j]])<=mini2 && minind1!=j)
				mini2=(tab[1][vp[k][j]]+b[i-1][vp[k][j]]);
			}
			
			for(j=0;j<vp[k].size();j++)
			{
				if((tab[1][vp[k][j]]+b[i-1][vp[k][j]])==mini)	
				tab[2][vp[k][j]]=min(mini2,tab[1][vp[k][j]]+a[i-1][vp[k][j]]);
				else
				tab[2][vp[k][j]]=min(mini,tab[1][vp[k][j]]+a[i-1][vp[k][j]]);
				/*if(j==k)
				{
					mini=min(mini,a[i-1][j]+tab[1][j]);
					
				}
				else if((k==1) || (prime[j]==prime[k]))
				{
					mini=min(mini,(b[i-1][j]+tab[1][j]));
					
				}*/
				
			}
			//tab[2][k]=mini;
			
		}
		 for(k=1;k<=m;k++)
		 {
		 	 tab[1][k]=tab[2][k];
		 	 //cout<<tab[1][i]<<" ";
		 }
		 //cout<<endl;
	}
	/*for(i=1;i<=n;i++)
	{
		for(j=1;j<=m;j++)
		{
			cout<<tab[i][j]<<" ";
		}
		cout<<endl;
	}*/
	long long mini=1e18;
	for(i=1;i<=m;i++)
	{
		mini=min(mini,tab[1][i]);
	}
	cout<<mini<<endl;
	return 0;
}