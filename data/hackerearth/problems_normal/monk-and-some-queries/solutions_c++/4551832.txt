#include <bits/stdc++.h>
using namespace std;

int main()
{
    int q;
    cin>>q;
    int d,x,maxx,min,flag;
    vector<int> v;
    vector<int> :: iterator it;
    while(q--)
    {
    	cin>>d;
    	if(d==1)
    	{
    		cin>>x;
    		v.push_back(x);
    	}
    	else if(d==2)
    	{
    		cin>>x;
    		flag=0;
    		for(it=v.begin();it!=v.end();it++)
    		{
    			if(*it==x){
    			v.erase(it);
    			flag=1;
    			break;}
    		}
    		if(!flag)
    		cout<<"-1"<<endl;
    	}
    	else if(d==3)
    	{
    		maxx=INT_MIN;
    		for(it=v.begin();it!=v.end();it++)
    		{
    			if(*it>maxx){
    			maxx=*it;}
    		}
    		if(v.empty())
    		maxx=-1;
    		cout<<maxx<<endl;
    		
    	}
    	else
    	{	min=INT_MAX;
    		for(it=v.begin();it!=v.end();it++)
    		{
    			if(*it<min){
    			min=*it;}
    		}if(v.empty())
    		min=-1;
    		cout<<min<<endl;
    	}
    }
    return 0;
}
