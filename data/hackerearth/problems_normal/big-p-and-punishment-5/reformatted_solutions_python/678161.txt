# problem 2

def color_it(frndsip_map, studentlist, i, visitlist):
    if len(frndsip_map[i]) > 0:
        for j in frndsip_map[i]:
            if not visitlist[j]:
                studentlist[j-1] = True
                visitlist[j] = True
                color_it(frndsip_map, studentlist, j, visitlist)


def solve(frndsip_map, slappedlist, studentlist, visitlist):
    for i in slappedlist:
        studentlist[i-1] = True
        color_it(frndsip_map, studentlist, i, visitlist)


if __name__ == "__main__":
    T = int(raw_input())

    for i in range(T):
        val = raw_input().split()
        N = int(val[0])
        F = int(val[1])
        S = int(val[2])
        frndsip_map = {}
        studentlist = []
        visitlist = {}
        for i in range(N):
            studentlist.append(False)
            frndsip_map[i+1] = []
            visitlist[i+1] = False

        # print studentlist
        # print frndsip_map

        for i in range(F):
            f = raw_input().split()
            frndsip_map[int(f[0])].append(int(f[1]))

        slappedlist = []
        for i in range(S):
            x = int(raw_input())
            slappedlist.append(x)
            visitlist[x] = True

        # print frndsip_map
        solve(frndsip_map, slappedlist, studentlist, visitlist)
        count = 0
        for k in studentlist:
            if k:
                count += 1
        print count
