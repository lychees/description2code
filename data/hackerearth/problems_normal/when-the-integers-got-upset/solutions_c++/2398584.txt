#include <bits/stdc++.h>
using namespace std;

//__builtin_popcount(y)
int a[15],p[15];
int dp[1<<13][15][15];
int main()
{
    int t,n;
    scanf("%d",&t);
    while(t--)
    {
    	scanf("%d",&n);
    	for(int i=0;i<n;++i) scanf("%d",&a[i]);
    	for(int i=0;i<n;++i) scanf("%d",&p[i]);
    	memset(dp,-1,sizeof(dp));
    	for(int i=0;i<n;++i)
    	{
    		for(int j=0;j<n;++j)
    		{
    			if(i==j) continue;
    			dp[(1<<i)|(1<<j)][i][j]=0;
    		}
    	}
    	for(int st=1;st<(1<<n)-1;++st)
    	{
    		for(int i=0;i<n;++i)
    		{
    			for(int j=0;j<n;++j)
    			{
    				if(dp[st][i][j]==-1) continue;
    				for(int k=0;k<n;++k)
    				{
    					if(st&(1<<k)) continue;
    					int tmp = dp[st][i][j] + (a[i]^a[j]^a[k])*(p[__builtin_popcount(st)]);
    					if(dp[st|(1<<k)][j][k] == -1 || dp[st|(1<<k)][j][k]>tmp)
    						dp[st|(1<<k)][j][k] = tmp;
    				}
    			}
    		}
    	}
    	int ans = INT_MAX,st=(1<<n)-1;
    	for(int i=0;i<n;++i)
    	{
    		for(int j=0;j<n;++j)
    		{
    			if(dp[st][i][j]==-1) continue;
    			ans=min(ans,dp[st][i][j]);
    		}
    	}
    	printf("%d\n",ans);
    }
    return 0;
}
