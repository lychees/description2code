#include <bits/stdc++.h>
using namespace std;
int arr[100005];
priority_queue<int> maxheap;
priority_queue<int, vector<int>, greater<int> > minheap;
int main()
{
	
    int t,c,n;
    cin>>t;
    while(t--){
    	cin>>c;
    	if(c==1){
    		cin>>n;
    		arr[n]++;
    		maxheap.push(n);
    		minheap.push(n);
    	}
    	else if(c==2){
    		cin>>n;
    		if(arr[n]==0)
    			cout<<-1<<endl;
    		else
    			arr[n]--;
    	}
    	else if(c==3){
    		while(!maxheap.empty() && arr[maxheap.top()]==0)
    			maxheap.pop();
    		if(maxheap.empty())
    			cout<<-1<<endl;
    		else
    			cout<<maxheap.top()<<endl;
    	}
    	else{
    		while(!minheap.empty() && arr[minheap.top()]==0)
    			minheap.pop();
    		if(minheap.empty())
    			cout<<-1<<endl;
    		else
    			cout<<minheap.top()<<endl;
    	}
    }
    return 0;
}
