#include<iostream>

using namespace std;
int pr[10000002],l=0;
bool is[6000002];
void seive( )
    {
    int  i, j;
    pr[l++]=2;
    for ( i = 3; i < 3000; i+= 2 )
        {
        if ( !is[i] )
            {
            for ( j = i*i; j < 6000000; j+=i )
                is[j] = 1;
            pr[l++]=i;
        }
    }
    while ( i < 2000000)
        {
        if ( !is[i])
            pr[l++]=i;
        i+=2;
    }
}
int f(int x ){
	if(x==1)
	return 1;
	if(x==2||(x%2!=0&&is[x]==0))
	return -1*x;
	return x;
}
int main()
    {
        seive();
    int t;
    cin >> t;
    while ( t-- )
        {
        long long ans=0;
        int x, y;
        scanf("%d%d",&x,&y);
        while ( x != y )
        {
        	if ( x > y ){
        		ans += f(x);
        		x/=2;
        	}
        	else{
        		ans+= f(y);
        		y/=2;
        	}
        }
        ans+=f(x);
        cout<<ans<<endl;
    }
}