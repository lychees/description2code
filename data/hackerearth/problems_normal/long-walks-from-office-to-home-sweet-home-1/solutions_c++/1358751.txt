#include <bits/stdc++.h>
using namespace std;
#define mod 1000000007
long long  A[51][51];
long long  B[51][51];
long long  C[51][51];

void matrixMul(long long  A[][51], long long  B[][51], long long  n) {
	int i, j, k;
	for(i=0;i<n;i++) {
		for(j=0;j<n;j++) {
			C[i][j] = 0;
			for(k=0;k<n;k++) {
				C[i][j] += (A[i][k]*B[k][j]);
				if(C[i][j] >= mod) {
					C[i][j] = C[i][j]%mod;
				}
			}
		}
	}
	
	for(i=0;i<n;i++) {
		for(j=0;j<n;j++) {
			A[i][j] = C[i][j];
		}
	}
}
void exponent(int n, long long k) {
	while(k) {
		if(k&1) {
			matrixMul(A,B,n);
		}
		matrixMul(B,B,n);
		k = k/2;
	}
}

int main()
{
	int t;
	int n,u,v;
	long long k;
	scanf("%d",&t);
	while(t--) {
		
		cin>>n>>k>>u>>v;
		
		for(int i =0;i<n;i++) {
			for(int j=0;j<n;j++) {
				long long  a;
				cin>>a;
				A[i][j] = a;
				B[i][j] = a;
			}
		}
		k--;
		exponent(n,k);
		cout<<A[u][v]<<"\n";
		
		
	}
}
