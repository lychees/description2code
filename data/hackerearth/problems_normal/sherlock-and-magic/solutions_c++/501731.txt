#include <stdio.h>
#include <iostream>
using namespace std;
int main()
{
	int t,n,x[50],y[50],i,k,l,c,j[50];
	char z[50],e;
	scanf("%d",&t);
	while(t--)
	{
		for(i=0;i<50;i++)
		{
			j[i]=x[i]=y[i]=0;
			z[i]=' ';
		}
		c=i=k=l=0;
		scanf("%d",&n);
		for(i=0;i<n;i++)
		{
			cin>>x[i];
			cin>>y[i];
			x[i]=x[i]*2;
			y[i]=y[i]*2;
			cin>>e;
			z[i]=e;
			j[i]=1;
		}
		for(i=1;i<=4000;i++)
		{
			for(k=0;k<n;k++)
			{
				if(z[k]=='N')
					y[k]++;
				else if(z[k]=='S')
					y[k]--;
				else if(z[k]=='E')
					x[k]++;
				else if(z[k]=='W')
					x[k]--;
			}
			for(k=0;k<n;k++)
			{
				if(j[k]==0)
					continue;
				for(l=0;l<n;l++)
				{
					if(k==l)
						continue;
					if(x[k]==x[l] && y[k]==y[l] &&  j[l]!=0)
					{
						j[k]=0;
						j[l]=0;
					}
				}
			}
		}
		c=0;
		for(i=0;i<n;i++)
		{
			if(j[i]==1)
				c++;
		}
		printf("%d\n",c);
	}
	return 0;
}
