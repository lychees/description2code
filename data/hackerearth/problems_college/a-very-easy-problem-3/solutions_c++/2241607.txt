#include <bits/stdc++.h>
using namespace std;
#define MOD 10007
#define pii pair<int, int>
#define pll pair<long long, long long>
#define vi  vector<int>
#define pb  push_back
#define mp  make_pair
#define M(a,x) memset(a,x,sizeof(a))
#define sci(x) scanf("%d",&x);
#define scl(x) scanf("%lld",&x);
#define scs(x) scanf("%s",x);
#define print(x) printf("%d",x);
#define nl printf("\n")
#define printl(x) printf("%lld",x)
#define F(i,a,n) for(int i=a;i<n;i++)
#define INF 100000000000000000LL
#define LL long long

LL aa[30];
LL a1[30];
LL a2[30];
LL cc[30];
LL c1[30];
LL c2[30];
vector<LL> v1,v2;
void rec(int st, int end, LL cur)
{
    if(st==end) {
        v1.pb(cur);
        return;
    }
    for(LL i=0;i<=c1[st];i++) {
        rec(st+1,end,cur+i*a1[st]);
    }
    //   v1.pb(cur);
    return;
}
void rec2(int st, int end, LL cur)
{
    if(st==end) {
        v2.push_back(cur);
        return ;
    }
    for(LL i=0;i<=c2[st];i++) {
        rec2(st+1,end,cur+i*a2[st]);
    }
    // v2.pb(cur);
    return;
}
int main() {
    int t;sci(t);
    while(t--) {
        v1.clear();
        v2.clear();
        int n;sci(n);
        for(int i=0;i<n;i++) {
            scanf("%lld",&aa[i]);
        }
        for(int i=0;i<n;i++) {
            scanf("%lld",&cc[i]);
        }
        LL req;scanf("%lld",&req);
        int k=0;
        for(int i=0;i<n/2;i++) {
            a1[k]=aa[i];
            c1[k]=cc[i];
            k++;
        }
        rec(0,k,0);
        k=0;
        for(int i=n/2;i<n;i++) {
            a2[k]=aa[i];
            c2[k]=cc[i];
            k++;
        }
        rec2(0,k,0);
        sort(v2.begin(),v2.end());
        int s1=v1.size();
        int s2=v2.size();
        LL ans=0;
/*      for(int i=0;i<v1.size();i++) {
            cout<<v1[i]<<" ";
        }
        cout<<endl;
        for(int i=0;i<v2.size();i++) {
            cout<<v2[i]<<" ";
        }
        cout<<endl;*/
        for(int i=0;i<s1;++i)
        {
            LL r=upper_bound(v2.begin(),v2.end(),req-v1[i])-v2.begin();
            LL l=lower_bound(v2.begin(),v2.end(),req-v1[i])-v2.begin();
            ans+=r-l;
            if(ans<0)
                ans+=MOD;
            ans%=MOD;
        }
        printf("%lld\n",ans);
    }
}