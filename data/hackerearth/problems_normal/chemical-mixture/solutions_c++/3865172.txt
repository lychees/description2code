#include<cstdio>
#include<algorithm>
#include<iostream>

using namespace std;
long long m,n1,n2,a[100],b[100],mask,maska[100],suma,maxx,mark[100],t,sum1;
int main()
{
    scanf("%lld",&t);
    while(t--)
    {
        scanf("%lld %lld %lld",&m,&n1,&n2);
        for (int i=1;i<=n1;i++)scanf("%lld",&a[i]);
        for (int i=1;i<=n2;i++)scanf("%lld",&b[i]);

        sort(a+1,a+n1+1);

        mask=1<<n2;mask--;
        for (int i=1;i<=n2;i++)maska[i]=0;
        for (int i=1;i<=n1;i++)mark[i]=0;
        maxx=0;
        while(mask--)
        {

            suma=0;
            for (int i=n2;i>=1;i--)
                if (maska[i]==1)suma+=b[i];
            suma=m-suma;
            sum1=suma;

            for (int i=n1;i>=1;i--)
                if (a[i]<=suma)suma-=a[i];

            if (suma==0)
                if (sum1>maxx)maxx=sum1;

             for (int i=n2;i>=1;i--)
                if (maska[i]==0){maska[i]=1;break;}
                    else maska[i]=0;
        }
         if (maxx==0)printf("NO");else printf("YES\n");
        for (int i=n1;i>=1;i--)
        if (a[i]<=maxx){maxx-=a[i];mark[i]=1;}
        for (int i=1;i<=n1;i++)if (mark[i]==1)printf("%lld ",a[i]);
        printf("\n");

    }
    return 0;
}
