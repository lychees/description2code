#include <iostream>
#include <bits/stdc++.h>
#define LL long long
#define MAXN 100000
using namespace std;

LL bit[5][5][MAXN+1];
int arr[5][MAXN];
char str[MAXN+10];
int n;
void update(int i,int j,int k,int val)
{
	while(j<=n)
	{
		bit[i][k][j]+=val;
		j+=(j&-j);
	}
}
LL query(int i,int j,int k)
{
	LL sum=0;
	while(j>0)
	{
		sum+=bit[i][k][j];
		j-=(j&-j);
	}
	return sum;
}
LL range(int i,int k,int a,int b)
{
	return query(i,b,k)-query(i,a,k);
}
int main()
{
    int q;
    scanf("%d",&n);
    int exchange[]={0,1,2,3,4};
    for(int i=0;i<5;++i)
    {
    	for(int j=0;j<n;++j)
    	{
    		scanf("%d",&arr[i][j]);
    	}
    }

    scanf("%s",str);
    for(int i=0;i<n;++i)
    {
        for(int k=0;k<5;++k)
            update(str[i]-'A',i+1,k,arr[k][i]);
    }

    scanf("%d",&q);
    char qr[5],X[5],Y[5];
    int x,y;
    while(q--)
    {
    	scanf("%s",&qr);
    	if(qr[1]=='c')
    	{
    		scanf("%d",&x);
    		scanf("%s",Y);
    		for(int k=0;k<5;++k){
                update(str[x-1]-'A',x,k,-arr[k][x-1]);
                update(Y[0]-'A',x,k,arr[k][x-1]);
    		}
    		str[x-1]=Y[0];
    	}
    	else if(qr[1]=='s')
    	{
    		scanf("%d %d",&x,&y);
    		LL ans=0;
    		for(int i=0;i<5;++i)
    		{
    			ans+=range(i,exchange[i],x-1,y);
    		}
    		printf("%lld\n",ans);
    	}
    	else
    	{
    		scanf("%s %s",X,Y);
    		int temp=exchange[X[0]-'A'];
    		exchange[X[0]-'A']=exchange[Y[0]-'A'];
    		exchange[Y[0]-'A']=temp;
    	}

    }
    return 0;
}

