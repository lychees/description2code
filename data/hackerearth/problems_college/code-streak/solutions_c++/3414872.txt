#include <bits/stdc++.h>
#define ll long long int
#define s(a) scanf("%lld",&a)
using namespace std;

ll a[100010];
ll r[100010];
ll vis[100010];

int main(){
    ll n,t,i;
    s(t);
    while(t--){
    	s(n);
    	memset(vis,0,sizeof(vis));
		for(i=0;i<n;i++) {
			s(a[i]);
			s(r[i]);
		}
		ll maxi=0,count=0;
		for(i=0;i<n;i++){
			if(r[i]==1) {
				if(vis[a[i]]==0) {
					vis[a[i]]=1;
					count++;
				}
			}
			if(r[i]==0){
				count=0;
			}
			maxi=max(maxi,count);
		}
		cout << maxi<<endl;
    }
    return 0;
}
