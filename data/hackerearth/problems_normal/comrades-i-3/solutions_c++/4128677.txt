/*input
1
5
0 1 1 2 4
4
3 1
4 2
2 3
1 3
*/
#include <bits/stdc++.h>
#include<stdio.h>
using namespace std;
#define pii pair<long long,long long>
#define F(i,a,b) for(ll i = (ll)(a); i <= (ll)(b); i++)
#define RF(i,a,b) for(ll i = (ll)(a); i >= (ll)(b); i--)
#define PI 3.14159265
#define ll int
#define ff first
#define ss second
#define pb(x) push_back(x)
#define mp(x,y) make_pair(x,y)
#define debug(x) cout << #x << " = " << x << endl
#define INF 1000000009
#define mod 1000000007
ll parent[200005];
vector <ll> g[200005];
ll timein[200005],timeout[200005];
ll c,dp[200005];
bool vis[200005];
void dfs(ll node,ll d)
{
	dp[node]=d;
	timein[node] = c++;
	vis[node]=1;
	ll sz = g[node].size();
	F(i,0,sz-1)
		if(!vis[g[node][i]])
			dfs(g[node][i],d+1);
	timeout[node] = c++;
}
int main() 
{
	std::ios::sync_with_stdio(false);
	ll t;
	scanf("%d",&t);
	while(t--)
	{
		c=0;
		ll n,q;
		//cin>>n;
		scanf("%d",&n);
		F(i,0,n)
			g[i].clear();
		memset(vis,0,sizeof(vis));
		F(i,1,n)
		{
			scanf("%d",&parent[i]);//cin>>parent[i];
			g[parent[i]].pb(i);
		}
		dfs(0,0);
		//cin>>q;
		scanf("%d",&q);
		while(q--)
		{
			ll x,y;
			scanf("%d",&x);
			scanf("%d",&y);
			if(timein[y] <= timein[x] && timeout[y] >= timeout[x])
				printf("%d\n",dp[x]-dp[y]-1);//cout<<timein[y]-timein[x]-1<<endl;
			else
				printf("%d\n",-1);
		}
	}
	return 0;
}