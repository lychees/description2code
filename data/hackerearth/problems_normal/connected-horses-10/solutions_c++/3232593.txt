/*input
2
4 4 4
1 1
1 2
3 1
3 2
4 4 4
1 1
1 2
3 1
4 4
*/
#include <bits/stdc++.h>
#include<stdio.h>
using namespace std;
#define pii pair<long long,long long>
#define F(i,a,b) for(ll i = (ll)(a); i <= (ll)(b); i++)
#define RF(i,a,b) for(ll i = (ll)(a); i >= (ll)(b); i--)
#define PI 3.14159265
#define ll long long
#define ff first
#define ss second
#define pb(x) push_back(x)
#define mp(x,y) make_pair(x,y)
#define INF 1000000009
#define mod 1000000007
//vector <ll> v;
ll n,m,i,j,q,cnt;
ll arr[1010][1010];
ll vis[1010][1010];
ll ans[100056];
void dfs(ll i,ll j)
{
	if(i<1 || i>n || j<1 || j>m)
		return;
	if(arr[i][j]==0)
		return;
	if(vis[i][j]!=0)
		return;
	vis[i][j] = cnt;
	dfs(i-2,j-1);
	dfs(i-2,j+1);
	dfs(i+2,j-1);
	dfs(i+2,j+1);
	dfs(i-1,j-2);
	dfs(i-1,j+2);
	dfs(i+1,j-2);
	dfs(i+1,j+2);
	return;
}
ll factorial[100005];
void fact()
{
	ll val = 1;
	factorial[1]=1;
	F(i,2,100005)
	{
		factorial[i] = ((factorial[i-1])%mod*(i%mod))%mod;
	}
}
int main() 
{
	std::ios::sync_with_stdio(false);
	fact();
	//F(i,1,8)
	//	cout<<factorial[i]<<" ";
	//cout<<endl;
	ll t,a,b;
	cin>>t;
	while(t--)
	{
		cnt = 0;
		memset(arr,0,sizeof(arr));
		memset(vis,0,sizeof(vis));
		memset(ans,0,sizeof(ans));
		cin>>n>>m;
		cin>>q;
		while(q--)
		{
			cin>>a>>b;
			arr[a][b] = 1;
		}
		F(i,1,n)
		{
			F(j,1,m)
			{
				if(arr[i][j]==1 && vis[i][j]==0)
				{
					cnt++;
					dfs(i,j);
				}
			}
		}
		F(i,1,n)
		{
			F(j,1,m)
			{
				//cout<<vis[i][j]<<" ";
				if(vis[i][j]!=0)
					ans[vis[i][j]]++;
			}
			//cout<<endl;
		}
		ll val = 1;
		F(i,1,cnt+1)
		{
			if(ans[i]!=0)
			{
				val = ((val%mod)*(factorial[ans[i]]%mod))%mod; 
			}
		}
		cout<<val<<endl;
	}
	return 0;
}