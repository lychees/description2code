#include <iostream>

using namespace std;

const int MOD = 1e9 + 7;

int main() {
    int testCase;
    cin >> testCase;
    while (testCase--) {
        int n;
        cin >> n;
        int A[n];
        for (int i = 0; i < n; i++)
            cin >> A[i];
        
        int cur = 0;
        long long sum = 0;
        long long answer = 0;
        int i = 0;
        while (i < n) {
            if (A[i] >= A[cur]) {
                answer += sum;
                answer %= MOD;
                sum = 0;
                cur = i;
            }
            else {
                sum += A[cur] - A[i];
                sum %= MOD;
            }
            i++;
        }

        sum = 0;
        cur = n - 1;
        i = n - 1;
        while (i >= 0) {
            if (A[i] >= A[cur]) {
                answer += sum;
                answer %= MOD;
                sum = 0;
                cur = i;
            }
            else {
                sum += A[cur] - A[i];
                sum %= MOD;
            }
            i--;
        }

        answer %= MOD;
        if (answer < 0)
            answer += MOD;
            
        cout << answer << endl;
    }
}
