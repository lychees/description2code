/*
jai shree ram _/\_
A hacker from NITP
*/

#include<bits/stdc++.h>
using namespace std;

#define mod 1000000007
typedef set<string> ss;
typedef vector<int> vs;
typedef map<int,char> msi;
typedef pair<int,int> pa;
typedef long long int ll;

ll power(ll a, ll b, ll MOD)
{
    ll x=1,y=a; 
    while(b > 0)
    {
        if(b%2 == 1)
        {
            x=(x*y);
            if(x>MOD) x%=MOD;
        }
        y = (y*y);
        if(y>MOD) y%=MOD; 
        b /= 2;
    }
    return x;
}
 
ll f[100004];
long long InverseEuler(ll n, ll MOD)
{
    return power(n,MOD-2,MOD);
}
 
ll C(ll n,ll r, ll MOD)
{
    return (f[n]*((InverseEuler(f[r], MOD) * InverseEuler(f[n-r], MOD)) % MOD)) % MOD;
}

ll n,l,i,a[100004],cnt,ans;
char s[100004];
int main()
{
	//freopen("i.in", "r", stdin);
  	//freopen("o.out", "w", stdout);
  	int t;
  	f[0]=f[1]=1;
  	for(i=2;i<=100000;i++)
  	f[i]=(f[i-1]*i)%mod;
	cin>>t;
	while(t--)
	{
		cin>>s>>n;
		n/=2;
		l=strlen(s);
		cnt=0;
		if(n==0)
		{
			for(i=0;i<l;i++)
			if(s[i]=='u')
			cnt++;
			cout<<cnt<<"\n";
			continue;
		}
		a[0]=0;
		if(s[0]=='l')
		a[0]=1;
		for(i=1;i<l;i++)
		{
			if(s[i]=='l')
			a[i]=a[i-1]+1;
			else
			a[i]=a[i-1];
		}
		for(i=0;i<l;i++)
		{
			if(s[i]=='u')
			{
				if(a[i-1]<n || a[l-1]-a[i]<n)
				continue;
				ans=C(a[i-1],n,mod);
				ans=(ans*C(a[l-1]-a[i],n,mod))%mod;
				cnt=(cnt+ans)%mod;
			}
			
		}
		cout<<cnt<<"\n";
	}
	return 0;
}

