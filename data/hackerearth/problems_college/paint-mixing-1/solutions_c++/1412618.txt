

#include <iostream>
#include <stdio.h>
#include <vector>
#include <string>
#include <sstream>
#include <set>
#include <stdlib.h>
#define ll long long
#include <cmath>
#include <map>
#include <list>
#include <algorithm>
#define S(n) scanf("%d", &n)
#define Sll(n) scanf("%lld", &n)
using namespace std;
ll a[110];
ll s[110][110];
ll dp[110][110];
ll cost[110][110];
int main()
{
	int t;
	S(t);
	int n;
	while(t--) {
		S(n);
		int i, j,k;
		int k1;
		S(k1);
		for(i = 0; i < n; i++) {
			Sll(a[i]);
		}
		for(i = 0; i < k1; i++) {
			for(j = 0; j < k1; j++) {
				Sll(cost[i][j]);
			}
		}
		for(i=0;i<n;i++)
		{	
			for(j=i;j<n;j++)
			{
				if(i==j) {
					s[i][j]=a[j];
					//s[j][i] = a[j];
					
				} else {
					s[i][j] = (a[j]+s[i][j-1])%k1;
					//s[j][i] = s[i][j];
				}
			}
		}
		
		for(i = 0; i < n; i++) {
			dp[i][i] = 0;
		}
		int l;
		for(l = 2; l <= n; l++) {
			for(i = 0; i <= n-l+1; i++) {
				j = i+l-1;
				dp[i][j] = 1000000;
				for(k = i; k < j; k++) {
					if (dp[i][j] > dp[i][k] + dp[k+1][j] + cost[s[i][k]][s[k+1][j]] ) {
						dp[i][j] =  dp[i][k] + dp[k+1][j] + cost[s[i][k]][s[k+1][j]];
					}
				}
			}
		}
		printf("%lld\n", dp[0][n-1]);
		//int d,p[100][100][100] = 
		
	}
}

