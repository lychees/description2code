#include<stdio.h>
#include<algorithm>
#include<iostream>

using namespace std;

#define mod 1000000007
int main(){
	int T,N,A[100000],max_right[100000],max_left[100000];
	long long int sum=0;
	int i;
	
	scanf("%d",&T);
	while(T--){
		sum=0;
		scanf("%d",&N);
		for(i=0;i<N;i++) scanf("%d",&A[i]);
		
		//from left, max till now
		max_left[1]=A[0];
		for(i=2;i<N;i++){
			max_left[i]=max(max_left[i-1],A[i-1]);
		}
		
		//from right
		max_right[N-1]=0;
		for(i=N-2;i>=0;i--){
			max_right[i]=max(max_right[i+1],A[i+1]);
		}
		
		for(i=1;i<N-1;i++){
			if(A[i]<max_left[i] && A[i]<max_right[i]){
				//sum= (sum+( min(max_left[i],max_right[i])- A[i]))%mod;
				sum= (sum+( min(max_left[i],max_right[i])- A[i]));
			}
		}
		printf("%lld\n",sum%mod);
			
	}
	return 0;
}