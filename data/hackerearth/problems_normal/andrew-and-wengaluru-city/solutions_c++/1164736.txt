#include<iostream>
#include<cstdlib>
#include<vector>
#include<algorithm>

using namespace std;

void print_array(int *arr,int N)
{
     for(int i=0;i<N;i++)
        cout<<arr[i]<<" ";
     cout<<endl;
}
int main()
{
    int  T,N,*arr,*left_max,*right_max,diff;
    unsigned long long sum = 0,rem = 1000000007;
    cin>>T;
    while(T--)
    {
        cin>>N;
        arr = new int[N];
        left_max = new int[N];
        right_max = new int[N];
        sum = 0;
        for(int i =0;i<N;i++)
            cin>>arr[i];
         left_max[0] = arr[0];
         for(int i= 1;i<N;i++)
         {
            if(arr[i] > left_max[i-1])
                left_max[i] = arr[i];
            else
                left_max[i] = left_max[i-1];
         }
         right_max[N-1] = arr[N-1];
         for(int i = N-2;i>=0;i--)
         {
             if(arr[i] > right_max[i+1])
                right_max[i] = arr[i];
             else
                right_max[i] = right_max[i+1];
         }
         //print_array(arr,N);
         //print_array(left_max,N);
         //print_array(right_max,N);
         for(int i = 1;i<N-1;i++)
         {
            if(left_max[i] > arr[i] && right_max[i] > arr[i])
            {
                if(left_max[i] > right_max[i])
                    diff = right_max[i] - arr[i];
                else
                    diff = left_max[i] - arr[i];
                sum = sum + diff;
                sum = sum%rem;
            }
         }
        cout<<sum<<endl;
    }
}
