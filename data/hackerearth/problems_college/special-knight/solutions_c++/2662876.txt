//Special Knight
#include "bits/stdc++.h"
using namespace std;

int main(int argc, char const *argv[])
{
	int test, height, width, numberOfRocks, r, c;
	cin>> test;
	int temp = test;
	while(test--){
		cin>> height >> width >> numberOfRocks;
		int arr[105][105] = {0};
		arr[0][0] = 1;
		for (int i = 0; i < numberOfRocks; ++i)
		{
			cin>> r >> c;
			arr[r-1][c-1] = -1;
		}
		for (int i = 1; i < height; ++i)
		{
			for (int j = 1; j < width; ++j)
			{
				if(arr[i][j] == -1)
					continue;
				if(i-2 >= 0 && j-1 >= 0 && arr[i-2][j-1] != -1)
					arr[i][j] = (arr[i][j] + arr[i-2][j-1]) % 10007;
				if(i-1 >= 0 && j-2 >= 0 && arr[i-1][j-2] != -1)
					arr[i][j] = (arr[i][j] + arr[i-1][j-2]) % 10007;
			}
		}
		cout<< "Case #" << temp-test << ": " << arr[height-1][width-1] << endl;
	}
	return 0;
}