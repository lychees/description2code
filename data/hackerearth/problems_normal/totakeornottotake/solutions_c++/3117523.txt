#include<bits/stdc++.h>
using namespace std;
const int N=55;
char s[N];
int a[N];
stack<long long int> st;
stack<long long int> ma;
int main()
{
	int t;
	scanf("%d",&t);
	while(t--)
	{
		int b;
		scanf("%d",&b);
		for(int i=0;i<b;i++){
			cin>>s[i];
			if(s[i]=='N'){
				a[i]=-1; continue;
			}
			cin>>a[i];
		}
		long long int max=1,min=1;
		st.push(min);
		ma.push(max);
		for(int i=0;i<b;i++){
			if(s[i]=='+'){
				max+=a[i];
				ma.push(max);
			}
			else if(s[i]=='*'){
				max=max*a[i];
				min=min*a[i];
				st.push(min);
				ma.push(max);
			}
			else if(s[i]=='/'){
				if(min>min/a[i])
				{min=min/a[i];
				st.push(min);
				}
			}
			else if(s[i]=='-'){
				min=min-a[i];
				st.push(min);
			}
			else{
				if(min*-1 > max){
					max=-1*min;
					ma.push(max);
					//st.pop();
					//if(st.empty()) min=1;
					//else min=st.top();
				}
				else if(max*-1 < min){
					min=max*-1;
					st.push(min);
					//ma.pop();
					//if(ma.empty()) max=1; 
					//else max=ma.top();
				}
			}
		}
		cout<<(max>min?max:min)<<endl;
		while (!ma.empty())
  		{
     		ma.pop();
  		}
  		while(!st.empty()){
  			st.pop();
  		}
	}
}