#include<bits/stdc++.h>
using namespace std;
const long long MOD=1E9+7;
long long int arr[50][50];
long long int m[50];
long long int u,v;
long long int n;
void multiply(long long int M[50][50],long long int F[50][50],long long int n)
{
	long long int x[n][n];
	long long d=0,s=0;
	long long int i,j,k;
	for(i=0;i<n;i++)
	{
		for(j=0;j<n;j++)
		{
			s=0;
			for(k=0;k<n;k++)
			{
				d=((long long)M[i][k])*(long long)F[k][j];
				if(d>=MOD)
					d=d%MOD;
				s=s+d;
				if(s>=MOD)
					s=s%MOD;
			}
			x[i][j]=s;
		}
	}
	for(i=0;i<n;i++)
	{
		for(j=0;j<n;j++)
		M[i][j]=x[i][j];
	}
}
void power(long long int M[50][50],long long int l)
{
	if(l==0||l==1)
	return ;
	power(M,l/2);
	multiply(M,M,n);
	if(l%2!=0)
	{
		multiply(M,arr,n);
	}
}
long long int an1(long long int l)
{
	long long int i,j;
	long long answ=0,d=0;
	long long int M[50][50];
	for(i=0;i<n;i++)
	{
			for(j=0;j<n;j++)
			M[i][j]=arr[i][j];
	}
	power(M,l);
	answ=M[u][v];
	return answ;
}
int main()
{
	long long int i,j;
	for(i=0;i<50;i++)
	m[i]=1;
	int t;
	scanf("%d",&t);
	while(t--)
	{
		long long int k;
		scanf("%lld %lld %lld %lld",&n,&k,&u,&v);
		for(i=0;i<n;i++)
		{
			for(j=0;j<n;j++)
			scanf("%lld",&arr[i][j]);
		}
		if(k==0)
		{
			if(u==v)
			printf("1\n");
			else
			printf("0\n");
			continue;
		}
		long long int ans=an1(k);
		printf("%lld\n",ans);
	}
}