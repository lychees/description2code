def elor(lis,i,N):
	if 2*i+1 > N-1:
		return lis[i]
	return max(elor(lis,2*i+1,N),elor(lis,2*i+2,N))+lis[i]

def tlnr(lis,i,N):
	if 2*i+1 > N-1:
		return lis[i]
	return max(tlnr(lis,2*i+1,N),tlnr(lis,2*i+2,N),lis[i]+elor(lis,2*i+1,N)+elor(lis,2*i+2,N))
	
T = int(raw_input())
for _ in xrange(T):
	N = int(raw_input())
	lis = [int(e) for e in raw_input().split()]
	print tlnr(lis,0,N)