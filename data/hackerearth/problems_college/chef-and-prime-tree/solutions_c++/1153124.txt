#include <bits/stdc++.h>
using namespace std;
#define max 5000002
#define ll long long int
ll arr[max];
void sieve()
{
	ll i,j;
	for(i = 2; i < max; i++) {
		if(arr[i] == 1) {
			for(j = 2; i*j < max; j++) {
				arr[i*j] = 0;
			}
		}
	}
}
int main() 
{
	ll t,x,y,i;
	cin>>t;
	for(i = 0; i < max; i++) {
		arr[i] = 1;
	}
	arr[0] = 0;
	arr[1] = 0;
	sieve();
	ll s;
	while(t--) {
		s = 0;
		cin>>x>>y;
		if(x == y) {
			if(arr[x]) s-=x;
			else s+=x;
			cout<<s<<endl;
			continue;
		}
		while(x != y) {
			if(x > y) {
				if(arr[x]) s -= x;
				else s += x;
				x /= 2;
			}
			else {
				if(arr[y]) s -= y;
				else s += y;
				y /= 2;
			}
		}
		if(arr[x]) s-=x;
		else s+=x;
		cout<<s<<endl;
	}
	return 0;
}