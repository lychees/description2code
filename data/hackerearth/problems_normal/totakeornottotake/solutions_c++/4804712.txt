#include <iostream>
using namespace std;
#define ll long long int
int main()
{
    int t;
    cin>>t;
    while(t--)
    {
    	int b;
    	cin>>b;
    	ll ce_max = 1;
    	ll ce_min = 1;
    	int x;
    	for(int i=0;i<b;i++)
    	{
    		char c;
    		cin>>c;
    		if(c=='N')
    		{
    			if( ce_max*-1 < ce_min )
    				ce_min = ce_max*-1;
    			if( ce_min*-1 > ce_max )
    				ce_max = ce_min*-1;
    		}
    		else if(c=='+')
    		{
    			cin>>x;
    			ce_max+=x;
    		}
    		else if(c=='-')
    		{
    			cin>>x;
    			ce_min-=x;
    		}
    		else if(c=='/')
    		{
    			cin>>x;
    			if(ce_min/x < ce_min)
    				ce_min=ce_min/x;
    			// if(ce_max/x > ce_max)
    			// 	ce_max=ce_max/x;
    		}
    		else //multiply
    		{
    			cin>>x;
    			ce_max*=x;
    			ce_min*=x;
    		}
    	}
    	cout<<max(ce_max,ce_min)<<endl;
    }
    return 0;
}
