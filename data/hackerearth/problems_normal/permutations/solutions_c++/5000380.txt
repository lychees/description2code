#include<bits/stdc++.h>
using namespace std;

int visited[100000];
vector<int> adj[1000];
int arr[100000];
set<int> s1;
void dfs(int i)
{
   if(visited[i])
   return;
   visited[i]=1;
   s1.insert(i);
   vector<int>::iterator it;
	for(it=adj[i].begin();it!=adj[i].end();it++)
	{
		if(!visited[*it])
		dfs(*it);
	}
}


int main()
{
	int k,i,j;
	string str;
	cin>>k;
	
	for(i=1;i<=k;i++)
	cin>>arr[i];
	
	for(i=1;i<=k;i++)
	{
		cin>>str;
		//cout<<str<<"\n";
		for(j=1;j<=k;j++)
		{
			if(str[j-1]=='Y')
			{
				adj[i].push_back(j);
			}
		}
	}
//	cout<<"yes\n";
	set<int> s;
	
	for(i=1;i<=k;i++)
	s.insert(i);
	
	for(i=1;i<=k;i++)
	{
		//cout<<"le\n";
		if(!visited[i])
		{
			//cout<<"lop\n";
			s1.clear();
			dfs(i);
			set<int>::iterator it1,it2;
			vector<int> v;
			v.clear();
			for(it1=s1.begin();it1!=s1.end();it1++)
			{
				//cout<<"kel\n";
				v.push_back(arr[*it1]);
			}
			//cout<<"hi\n";
			sort(v.begin(),v.end());
			vector<int>::iterator it=v.begin();
			for(it1=s1.begin();it1!=s1.end();it1++)
			{
				arr[*it1]=*it;
				it++;
			}
		}
	}
	for(i=1;i<=k;i++)
	cout<<arr[i]<<" ";
	return 0;
}