#include <bits/stdc++.h>
using namespace std;
int a[1000008];
int b[500000];
int sum[1000008];
int MAX;
void upd(int pos)
{
	while(pos<MAX)
	{
	  sum[pos]++;
	  pos+=(pos & -pos);
	}
}
void updmin(int pos)
{
	while(pos<MAX)
	{
	  sum[pos]--;
	  pos+=(pos & -pos);
	}
}
int query(int pos)
{
    int result = 0;
    while(pos>0)
    {
        result += sum[pos];
        pos -= (pos & -pos);
    }
    return result;
}
int main()
{
	//("input.txt","r", stdin);
//freopen("out.txt", "w", stdout);
	int i,j,q;
	a[1]=1;a[0]=1;
	for(i=2;i<=sqrt(1000006);i++)
	{
		if(a[i]==0)
		{
		for(j=i*i;j<=1000006;j+=i)
		a[j]=1;
        }
	}
	int t,n,l,r;
	scanf("%d",&t);
	while(t--)
	{
		memset(sum,0,sizeof(sum));
		scanf("%d",&n);
	MAX=n+5;	
	for(i=1;i<=n;i++)
	{       scanf("%d",&b[i]);
              if(!a[b[i]])
              	upd(i);
	}
     scanf("%d",&q);
     char c;
    while(q--)
    {
cin>>c;
if(c=='C')
{
	cin>>l>>r;
	if(!a[b[l]])
		updmin(l);
	b[l]=r;
	if(!a[b[l]])
	upd(l);
	
}
if(c=='A')
{
	cin>>l>>r;
	int ans=query(r)-query(l-1);
	printf("%d\n",ans);
}
    }
	}
	return 0;
}