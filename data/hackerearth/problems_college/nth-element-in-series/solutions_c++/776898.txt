#include<bits/stdc++.h>
using namespace std;

#define ms(x) memset(x,0,sizeof(x))

#define rep(i,a,b) for(i=a;i<b;i++)


#define MOD 1000000007

void multiplication(long long (*M)[6],long long (*A)[6]){
	long long C[6][6];
	ms(C);
	for(int i=1;i<=5;i++){
		for(int j=1;j<=5;j++){
			for(int k=1;k<=5;k++){
				C[i][j]+=(M[i][k]*A[k][j]);
				C[i][j]%=MOD;
			}
		}
	}
	for(int i=1;i<=5;i++)
		for(int j=1;j<=5;j++)
			M[i][j]=C[i][j];
}

void initializationof(long long (*M)[6]){

	M[1][2]=1;
	M[2][3]=1;
	M[3][4]=1;
	M[4][5]=1;
	M[5][1]=1;
	M[5][2]=2;
	M[5][3]=1;
	M[5][4]=1;
	M[5][5]=1;

}

long long a,b,c,d,e;
long long power(long long n){

	long long jaspreetsingh[6][6];
	long long M[6][6];
	ms(M);
	ms(jaspreetsingh);
	initializationof(M);
	for(int i=1;i<=5;i++)
		jaspreetsingh[i][i]=1;

	while(n){

		if(n&1)
			multiplication(jaspreetsingh,M);
		n/=2;
		multiplication(M,M);
	}
	a%=MOD;
	b%=MOD;
	c%=MOD;
	d%=MOD;
	e%=MOD;
	long long ans=(jaspreetsingh[1][1]*a + b*jaspreetsingh[1][2] + c*jaspreetsingh[1][3] + d*jaspreetsingh[1][4] + e*jaspreetsingh[1][5])%MOD;
	return ans;
}

int main(){
	int t;
	cin>>t;
	while(t--){

		long long n;
		cin>>a>>b>>c>>d>>e>>n;
		cout<<(power(n))<<endl;
	}
	return 0;
}
