#include<stdio.h>
#include<time.h>
#include <iostream>
using namespace std;
//#define DEBUG
int main()
{
    clock_t start, end;
double cpu_time_used;

start = clock();

    int t,i,n,m,e1,e2,pe1,pe2,j,maxweight;
    cin>>t;
    while(t--)
    {
        //scanf(" %d %d %d",&n,&maxweight,&m);
        cin>>n>>maxweight>>m;
        int weightkids[31];
        int weight[31];
        int up[31]={0};
        int imme[31]={0};
        i=1;
        while(i<=n)
        {
            //scanf(" %d",&weightkids[i]);
            cin>>weightkids[i];
            weight[i]=1;
            up[i]=i;
            imme[i]=i;
            i++;
        }

        i=0;
        while(i<m)
        {
            //scanf(" %d %d",&e1,&e2);
            cin>>e1>>e2;
            pe1=e1;
            while(up[pe1]!=pe1)
                pe1=up[pe1];
            pe2=e2;
            while(up[pe2]!=pe2)
                pe2=up[pe2];
            if(pe1!=pe2)
            {
                if(weight[pe1]>weight[pe2])
                {
                    up[pe2]=pe1;
                    imme[pe2]=e1;
                    weight[pe1]+=weight[pe2];
                    if(weight[pe2]>1)
                    {
                        j=e2;
                        while(j!=pe2)
                        {
                            up[j]=pe1;
                            j=imme[j];
                        }
                    }
                }
                else
                {
                    up[pe1]=pe2;
                    imme[pe1]=e2;
                    weight[pe2]+=weight[pe1];
                    if(weight[pe1]>1)
                    {
                        j=e1;
                        while(j!=pe1)
                        {
                            up[j]=pe2;
                            j=imme[j];
                        }

                    }
                }
            }
            i++;
        }
        i=1;
        while(i<=n)
        {
            while(up[up[i]]!=up[i])
            {
                up[i]=up[up[i]];
            }
            i++;
        }
        #ifdef DEBUG
        i=1;
        while(i<=n)
            printf("%d ",up[i++]);
        printf("\n");
       // scanf("%d",&i);
       #endif
        long long ways=0;
        long long poss=(1<<(n)),p2;
        long long permut=0;
   //     printf("n is %d poss is %lld",n,poss);
      //  scanf("%lld",&p2);
        for(permut=0;permut<poss;permut++)
        {
     //      printf("%lld\n",permut);
            p2=permut;
            int sumw=0;
            int q=1,grp=-1;
            while(p2)
            {
                if(p2&1)
                {
                    if(up[q]==grp || grp==-1)
                    {
                        sumw+=weightkids[q];
                        grp=up[q];

                    }
                    else
                    {
                        goto nextpermut;
                    }
                }
                q++;
                p2=p2>>1;
            }
            if(sumw==maxweight)
            {
                ways++;
                #ifdef DEBUG
                p2=permut;
                q=1;
                while(p2)
                {
                    if(p2&1)
                    {
                        printf("%d ",q);
                    }
                    q++;
                    p2=p2>>1;
                }
                printf(" sum: %d %lld\n",sumw,permut);
                #endif
            }
            nextpermut:
            ;
        }
        printf("%lld\n",ways);
    }

    return 0;
}
