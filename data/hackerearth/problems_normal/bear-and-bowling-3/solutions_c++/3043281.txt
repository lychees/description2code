#include <bits/stdc++.h>
#include <assert.h>
using namespace std;
typedef long long ll;
typedef long double ld;
#define PB push_back
#define MP make_pair
#define MOD 1000000007LL
int main() {
	ios_base::sync_with_stdio(false);
	ll n; cin >> n;
	if (n == 1) {
		ll x; cin >> x;
		cout << x << endl;
		return 0;
	}
	ll ans = 0;
	for (ll k = 0; k < n; k++) {
		ll x;
		cin >> x;
		ll add = ((k+2) * x)%MOD;
		ans = (ans + add) % MOD;
	}
	for (ll i = 0; i < n-2; i++) {
		ans = (2*ans)%MOD;
	}
	cout << ans << endl;
}