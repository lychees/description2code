#include <bits/stdc++.h>
#define ll long long int

using namespace std;

int a[5000010];

int isp(ll n)
{
	int i;
	if(n==1)
		return 0;
	if(a[n]==0)
		return 0;
	else if(a[n]==1)
		return 1;
	else
	{
	for(i=2;i<=(ll)sqrt(n);i++)
		if(n%i==0)
		{
			a[n]=0;
			break;
		}
	if(a[n]==-1)
		a[n]=1;
	return a[n];
	}
}

int main()
{
	ll q,x,y,ans,x1,y1,i,v;
	for(i=0;i<5000010;i++)
		a[i]=-1;
	cin>>q;
	while(q--)
	{
		ans=0;
		scanf("%lld %lld",&x,&y);
		x1=x;
		y1=y;
		while(x1!=y1)
		{
			if(x1>y1)
			{
				v=isp(x1);
				if(v)
					ans-=x1;
				else
					ans+=x1;
				x1/=2;
			}
			else
			{
				v=isp(y1);
				if(v)
					ans-=y1;
				else
					ans+=y1;
				y1/=2;
			}
		}
		v=isp(x1);
		if(v)
			ans-=x1;
		else
			ans+=x1;
		printf("%lld\n",ans);
	}
	return 0;
}