#include <bits/stdc++.h>
using namespace std;
 
struct node
{
	node* t[26];
	bool is = false;
	int w = 0;
};
 
node* head = new node();
 
void add(string& s, int w)
{
	node* cur = head;
	for (auto c : s) {
		if (cur->t[c - 'a'] == NULL) {
			cur->t[c - 'a'] = new node();
		}
		cur->w = max(cur->w, w);
		cur = cur->t[c - 'a'];
	}
	cur->w = max(cur->w, w);
}
 
int ans(string& s)
{
	node* cur = head;
	for (auto c : s) {
		if (cur->t[c - 'a'] == NULL) {
			return -1;
		}
		cur = cur->t[c - 'a'];
	}
	return cur->w;
}
 
 
int main()
{
	int n, q;
	cin >> n >> q;
	
	while (n--) {
		string s;
		int w;
		cin >> s >> w;
		add(s, w);
	}
	
	while (q--) {
		string s;
		cin >> s;
		cout << ans(s) << endl;
	}
	
}