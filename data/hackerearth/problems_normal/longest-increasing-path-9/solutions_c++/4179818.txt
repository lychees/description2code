#include <bits/stdc++.h>

using namespace std;

long long inf_min=-10000000;

int main()
{
    int t;
    cin>>t;
    while(t--)
	{
		int n,m;
	    cin>>n>>m;
	    vector<vector<int> > a(n+1,vector<int>(m+1,0));
	    vector<vector<int> > dp(n+1,vector<int>(m+1,0));
	    int i,j;
	    dp[1][1]=1;
	    
	    for(i=1;i<=n;i++)
	    {
	    	for(j=1;j<=m;j++)
	    		cin>>a[i][j];
	    }
	    int flag=0;
	    j=1;
	    for(i=2;i<=n;i++)
	    {
	    	if(flag==0 && a[i][j]>a[i-1][j])
	    		dp[i][j]=dp[i-1][j]+1;
	    	else
	    	{
	    		flag=1;
	    		dp[i][j]=inf_min;
	    	}
	    }
	    flag=0;
	    i=1;
	    for(j=2;j<=m;j++)
	    {
	    	if(flag==0 && a[i][j]>a[i][j-1])
	    		dp[i][j]=dp[i][j-1]+1;
	    	else
	    	{
	    		flag=1;
	    		dp[i][j]=inf_min;
	    	}
	    }
	    for(i=2;i<=n;i++)
	    {
	    	for(j=2;j<=m;j++)
	    	{
	    		dp[i][j]=-1;
	    		if(a[i][j]>a[i-1][j])
	    			dp[i][j]=max(dp[i][j],dp[i-1][j]+1);
	    		if(a[i][j]>a[i][j-1])
	    			dp[i][j]=max(dp[i][j],dp[i][j-1]+1);
	    		if(dp[i][j]==-1)
	    			dp[i][j]=inf_min;
	    	}
	    }
	    int max=-1;
	    dp[1][1]=1;
	    for(i=1;i<=n;i++)
	    {
	    	for(j=1;j<=m;j++)
	    	{
	    	//	cout<<dp[i][j]<<" ";
	    		if(max<dp[i][j])
	    			max=dp[i][j];
	    	}
	    //	cout<<endl;
	    }
	    cout<<max<<endl;
	}
    return 0;
}
