#include<bits/stdc++.h>
using namespace std;
#define ll long long
ll modpow(ll a,ll b)
{
	ll res=1;
	while(b)
	{
		if(b&1)
		 res=(res*a)%1000000007;
		 
		 a=(a*a)%1000000007;
		 b>>=1;
	}
	return res;
}
int main()
{
  ll t,n,i,ans,val;
  cin>>t;
  while(t--)
  {
  	ans=1;
  	cin>>n;
  	ll base[n];
  	ll expr[n];
  	for(i=0;i<n;i++)
  	cin>>base[i];
  	for(i=0;i<n;i++)
  	 cin>>expr[i];
  	 
  	 for(i=0;i<n;i++)
  	 {
  	 	val=modpow(base[i],expr[i]+1)-1;
  	 	if(val<0)
  	 	val+=1000000007;
  	 	val*=modpow(base[i]-1,1000000007-2);
  	 	val-=1;
  	 	if(val<0)
  	 	val+=1000000007;
  	 	val%=1000000007;
  	 	ans=(ans*val)%1000000007;
  	 }
  	 cout<<ans<<endl;
  }
 		
}
