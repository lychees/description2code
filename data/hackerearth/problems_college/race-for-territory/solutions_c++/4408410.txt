#include <iostream>
using namespace std;

int main()
{
    int T; cin >> T;
    int gabbar_speed = 0;
    int phoolan_speed = 0;
    bool reached = false;
    for(int i=0; i<T; i++)
    {
    	gabbar_speed = 0;
    	phoolan_speed = 0;
    	int L; cin >> L;
    	int P; cin >> P;
    	char A,B;
    	cout << "Case "; cout << (i+1) << ": ";
    	int gabbar = 0,phoolan = 0;
    	int flag = 0;
    	for(int k=0; k<P; k++)
    	{
    		if(gabbar == L)
                flag = 1;
            else if(phoolan == L)
                flag = 2;
            else if(gabbar == L && phoolan == L)
                flag = 3;

            if(gabbar > L && phoolan > L)
                flag = -1;

            if(flag != 0)
                break;
    		cin >> A >> B;
    		gabbar += gabbar_speed;
    		phoolan += phoolan_speed;
    		switch(A)
    		{
    			case 'F': gabbar_speed++; break;
    			case 'B': gabbar_speed--; break;
    			default: break;
    		}
    		switch(B)
    		{
    			case 'F': phoolan_speed++; break;
    			case 'B': phoolan_speed--; break;
    			default:break;
    		}
     	}
     	if(flag==0)
     	{
     		int g , f;
            g = (L - gabbar) ;
            f = (L - phoolan);

            if(phoolan_speed > 0)
                f = f%phoolan_speed;
            if(gabbar_speed > 0)
                g = g%gabbar_speed;

            if(g == 0)
                flag = 1;
            else if(f == 0)
                flag = 2;
            else if(g == 0 && f == 0)
                flag = 3;

            if(f!=0 && g!=0)
                flag = -1;

     	}
     	if(flag==1)
     	cout <<"GABBAR SINGH"<< endl;
     	else if(flag==2)
     	cout <<"PHOOLAN DEVI" << endl;
     	else if(flag==3)
     	cout << "TIE" << endl;
    	else 
    	cout <<"INVALID" << endl;
    }
    return 0;
}
