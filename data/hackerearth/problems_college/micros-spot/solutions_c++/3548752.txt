//Header
#include<bits/stdc++.h>
using namespace std;
// Global declarations
typedef long long int ll;
typedef vector<int> vi;
typedef vector<char> vc;
typedef pair<int, int> pi;
const int mod = 1e9 + 7;
const int INF = 1 << 29;
// Macros
#define mp make_pair
#define el putchar('\n')
#define sp putchar(' ')
#define Fill(a,val) memset(a,val,sizeof a)
#define all(a) a.begin(),a.end()
#ifndef ONLINE_JUDGE
#define tr(a, it) for (decltype(a.begin()) it = a.begin(); it != a.end(); ++it)
#else 
#define tr(a, it) for (typeof(a.begin()) it = a.begin(); it != a.end(); ++it)
#endif
#define in(n) scanf("%d",&n)
#define inl(n) scanf("%I64d",&n)
#define out(n) printf("%d",n);
#define outl(n) printf("%I64d",n);

int const NN = 1e3 + 3;
int a[NN][NN];
int b[NN][NN];
int r[NN];
int c[NN];

int main(){
	int t;
	in(t);
	while (t--){
		int n, m;
		in(n); in(m);
		for (int i = 1; i <= n; ++i){
			for (int j = 1; j <= m; ++j)
				in(a[i][j]);
		}
		for (int i = 1; i <= n; ++i){
			for (int j = 1; j <= m; ++j)
				in(b[i][j]);
		}
		for (int i = 1; i <= n; ++i){
			int mx = 0;
			for (int j = 1; j <= m; ++j){
				mx = max(mx, b[i][j]);
			}
			r[i] = mx;
		}
		for (int j = 1; j <= m; ++j){
			int mx = 0;
			for (int i = 1; i <= n; ++i){
				mx = max(mx, a[i][j]);
			}
			c[j] = mx;
		}
		int ans = 0;
		for (int i = 1; i <= n; ++i){
			for (int j = 1; j <= m; ++j){
				ans += (r[i] == b[i][j]) && (c[j] == a[i][j]);
			}
		}
		out(ans); el;
	}
	return 0;
}