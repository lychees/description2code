#include <bits/stdc++.h>

using namespace std;
long long int modulo (long long int a,long long int b){
    if(a>=0){
        return a%b;
    }else{
        return b+(a%b);
    }
}
int main(){
    long long int T;cin>>T;
    for(long long int test = 0;test<T;test++){
        long long int n,m,z;cin>>n>>m>>z;
        vector<long long int> resultados;
        long long int last = 0;
        bool suma = true;
        if(n%2==0)suma = false;
        for(long long int i=0;i<n;i++){
            long long int temp;cin>>temp;resultados.push_back(modulo(temp,m));
            if(suma){
                last+=temp;
            }else{
                last-=temp;
            }
            last = modulo(last,m);
            suma=!suma;
        }
        resultados.push_back(last);
        long long int indice = 0;
        if(n%2==0){
            for(long long int i=0;i<=n;i++){
                resultados.push_back(resultados[i]);
                resultados[i] *= -1;
                resultados[i] = modulo(resultados[i],m);
            }
            indice = n+1+z;
            indice = indice%resultados.size();
        }else{
            indice = z%resultados.size();
        }
        cout<<resultados[indice]<<endl;
    }
}
