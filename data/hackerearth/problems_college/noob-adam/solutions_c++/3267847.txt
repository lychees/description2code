#include<bits/stdc++.h>
//zone
using namespace std;
int main()
{
    int t;
    cin >> t;
    int i;
	while(t--)
	{
	    long long int a[100005];
		long long n,k;
		cin>>n>>k;

		for(i = 0 ; i < n ; i++)
        {
            cin >> a[i];
        }
		a[n]=1000000000009;
		long long r=0,pt1=0,pt2=0,sum=0;

        while(pt1 < n && pt2<=n)
        {
            if(k >= a[pt2]-a[pt1])
            {
                pt2++;
            }
            else
                r = r + ((pt2 - ++pt1)*(pt2 - pt1 - 1)/2);
        }
        cout<<r<<endl;
	}
    return 0;
}
