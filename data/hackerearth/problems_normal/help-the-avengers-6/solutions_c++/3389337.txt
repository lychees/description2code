#include<iostream>
#include<vector>
#include<stdio.h>
#include<math.h>
#include<algorithm>
#include<map>
#include<string>
#include <sstream>
#include<queue>
using namespace std;
#define f(i,a,b) for(ll i=a;i<b;i++)
#define ff(i,a,b,c) for(int i=a;i<b;i+=c)
#define w(n) while(n>0)
#define vi vector<int>
#define vll vector<long long int>
typedef long long int ll;
typedef int I;
typedef string S;
ll mod_pow(ll a,ll n,ll b){ll res = 1;while(n){if(n&1) {res = (res*a)%b;}a = (a*a)%b;n >>= 1;}return res%b;}
ll mod_div(ll a,ll b,ll md){ll ans = (a*mod_pow(b,md-2,md))%md; return ans;}
ll mul(ll a,ll b,ll md){ return (ll)(a*b)%md;}
ll gcd(ll n,ll m){if(m<=n && n%m==0)return m;if(n<m)return gcd(m,n);else return gcd(m,n%m);}
ll add(ll a,ll b,ll md){a=((a%md)+(b%md))%md;return a;}
ll sub(ll a,ll b,ll md){return add(a,md-b,md);}
ll digit_sum(ll x){ll sum=0;while(x>0){sum+=x%10;x/=10;}return sum;}
ll mod=1000000000+7;
ll M=32005;
ll bit[32005];
bool prime[1000005];
void precompute()
{
    f(i,0,1000005)prime[i]=true;
    prime[0]=false;prime[1]=false;
    f(i,2,1000005)
    {
        if(prime[i])
        {
            ff(j,2*i,1000005,i)
                prime[j]=false;
        }
    }
}
void init()
{
    f(i,0,M)bit[i]=0;
}
void add(ll i,I val)
{
    while(i<M)
    {
        bit[i]+=val;
        i+=(i & -i);
    }
}
ll get(I i)
{
    if(i==0)return 0;
    ll sum=0;
    w(i)
    {
        sum+=bit[i];
        i-=(i & -i);
    }
    return sum;
}
I main()
{
    precompute();
    I t;
    cin>>t;
    w(t)
    {
        init();
        t--;
        I n;
        cin>>n;
        ll a[n];
        f(i,0,n)cin>>a[i];
        f(i,0,n)
        {
            if(prime[a[i]])
                add(i+1,1);
        }
        I q;
        cin>>q;
        w(q)
        {
            q--;
            char c;
            cin>>c;
            if(c=='A')
                {
                    I l,r;
                    cin>>l>>r;
                    cout<<get(r)-get(l-1)<<endl;
                }
            else if(c=='C')
                {
                    I in;ll x;
                    cin>>in>>x;
                    if(prime[a[in-1]])
                        add(in,-1);
                    a[in-1]=x;
                    if(prime[a[in-1]])
                        add(in,1);
                }
        }
    }
}
