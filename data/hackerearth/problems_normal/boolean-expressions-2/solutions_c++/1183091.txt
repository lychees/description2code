#include<bits/stdc++.h>
#define ll long long
#define ld long double
#define f first
#define s second
#define pb push_back
#define M 1000000009
#define MX 2000005
#define PI 3.141593
using namespace std;
typedef pair<ll,ll> ii;
char str[305],op[305];
ll tr[305][305],fa[305][305];
//BALANCED PARANTHESIS PROBLEM
int main()
{
    ll len;
    scanf("%s%s\n",str,op);
    len=strlen(str);

    for(ll i=0;str[i]!='\0';i++)
    {
        if(str[i]-'0'==0)
            fa[i][i]=1;
        if(str[i]-'0'==1)
            tr[i][i]=1;
    }
    for(ll sz=2;sz<=len;sz++)
    {
        for(ll i=0;i+sz-1<len;i++)
        {
            ll j=i+sz-1;
            for(ll k=i;k<j;k++)
            {
                char ch;
                ch=op[k];
                if(ch=='a')
                {
                    tr[i][j]+=(tr[i][k]*tr[k+1][j])%M;
                    fa[i][j]+=(fa[i][k]*tr[k+1][j]+tr[i][k]*fa[k+1][j]+fa[i][k]*fa[k+1][j])%M;
                }
                tr[i][j]%=M;
                fa[i][j]%=M;
                if(ch=='o')
                {
                    fa[i][j]+=(fa[i][k]*fa[k+1][j])%M;
                    tr[i][j]+=(fa[i][k]*tr[k+1][j]+tr[i][k]*fa[k+1][j]+tr[i][k]*tr[k+1][j])%M;
                }
                tr[i][j]%=M;
                fa[i][j]%=M;
                if(ch=='x')
                {
                    tr[i][j]+=(fa[i][k]*tr[k+1][j]+fa[k+1][j]*tr[i][k])%M;
                    fa[i][j]+=(tr[i][k]*tr[k+1][j]+fa[i][k]*fa[k+1][j])%M;
                }
                tr[i][j]%=M;
                fa[i][j]%=M;
            }
        }
    }
    ll q;
    scanf("%lld\n",&q);
    while(q--)
    {
        ll l,r;
        char st[10];
        scanf("%lld%lld%s",&l,&r,st);
        if(st[0]=='t')
            printf("%lld\n",tr[l-1][r-1]%M);
        else printf("%lld\n",fa[l-1][r-1]%M);
    }

}
