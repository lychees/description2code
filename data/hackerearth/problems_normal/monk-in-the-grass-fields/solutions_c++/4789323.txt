#include <iostream>
#include <cstring>

using namespace std;

#define min(a,b) (a)<(b)?a:b

int main()
{
	int M[200][200] = { 0, };
	int R[200] = { 0, };
	int C[200] = { 0, };
	int SR[400] = { 0, };
	int SC[400] = { 0, };

	int i, j, T, N, K;
	int sum;
	int row_min, col_min;

//	freopen("text.txt", "r", stdin);

	cin >> T;

	while (T > 0)
	{
		cin >> N;
		cin >> K;

		sum = 0;
		row_min = 0;
		col_min = 0;

		memset(R, 0, sizeof(R));
		memset(C, 0, sizeof(C));
		memset(SR, 0, sizeof(SR));
		memset(SC, 0, sizeof(SC));

		for (i = 0; i < N; i++)
		{
			for (j = 0; j < N; j++)
			{
				cin >> M[i][j];
				R[i] += M[i][j];
				C[j] += M[i][j];
			}
		}

		
		for (i = 1; i <= K; i++)
		{
			row_min = 0;
			
			for (j = 1; j < N; j++)
			{
				if (R[j] < R[row_min])
				{
					row_min = j;
				}
			}
			SR[i] = SR[i - 1] + R[row_min];
			R[row_min] += N;
		}
		
		for (i = 1; i <= K; i++)
		{
			col_min = 0;
			for (j = 1; j < N; j++)
			{
				if (C[j] < C[col_min])
				{
					col_min = j;
				}
			}
			SC[i] = SC[i - 1] + C[col_min];
			C[col_min] += N;
		}

		sum = SC[K];

		for (i = 1; i <= K; i++)
		{
			sum = min(sum, SR[i] + SC[K - i] + i*(K - i));
		}

		cout << sum << endl;

		T--;
	}
	
	return 0;
}
