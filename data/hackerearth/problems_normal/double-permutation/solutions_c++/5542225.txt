#include <iostream>
#include <cstdio>
using namespace std;
const int MOD=1000000007;
int N;
int A[200001];
int bit[100001];
void add(int x, int v)
{
    for(; x<=N/2; x+=x&-x)
        bit[x]+=v;
}
int sum(int x)
{
    int ret=0;
    for(; x>0; x-=x&-x)
        ret+=bit[x];
    return ret;
}
int main()
{
    scanf("%d", &N);
    long long p2=1;
    for(int i=2; i<N; i++)
        p2=(p2*2)%MOD;
    long long tmp=(((p2*N)%MOD)*(N==1?1:2))%MOD;
    long long ans=-7LL*N;
    N*=2;
    for(int i=1; i<=N; i++)
        scanf("%d", A+i);
    ans+=3LL*N*(N+1LL)/2LL;
    for(int i=1; i<=N; i++)
    {
        ans-=2*sum(A[i]);
        add(A[i], 1);
    }
    ans%=MOD;
    ans=(ans*p2)%MOD;
    ans=(ans+tmp)%MOD;
    printf("%lld\n", ans);
    return 0;
}