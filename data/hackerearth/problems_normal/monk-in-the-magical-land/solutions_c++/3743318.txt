#include <bits/stdc++.h>
using namespace std;
#define mod 1000000007
#define N 500005
#define ll long long
#define p(t) cout<<t;
#define f(i,n) for(i=0;i<n;i++)
#define g(i,n) for(i=1;i<=n;i++)
#define s(x) scanf("%I64d",&x);
#define pb push_back
#define mp make_pair

ll a[N],r,m,n,b[N],c[N],por[52];
pair<ll,ll>p[N];
ll func(ll i){
  ll j=0,k=1,x=0,y=0;
  ll g=0;
  map<ll,ll>co;
  while(i){
    if(i&1){
 x=x|p[j].first; y=y|p[j].second;
    }
    j++; i=i>>1;
}j=0;
while(x){if(x&1)g=g+c[j]; x=x>>1; j++;}
j=0;
while(y){if(y&1)g=g+c[j+50]; y=y>>1; j++;}
  return g;
}

int main()
{
ios_base::sync_with_stdio(0);
ll k=0,t=0,x,sum=0,q=0,z=0,y=0,l=0,i,j;
cin>>q;
por[0]=1;
g(i,51){por[i]=por[i-1]*2; }
while(q--){

r=0;
    cin>>m>>n>>k;
    f(i,m)cin>>b[i];
    f(i,n)cin>>a[i];
    f(i,n)cin>>c[i];
    f(i,m)p[i].first=p[i].second=0;
    f(i,m){ f(j,n) {if(__gcd(a[j],b[i])>1){
    				if(j<50)p[i].first=p[i].first|por[j];
    				else {z=j-50; p[i].second=p[i].second|por[z];  } }  } }
    for(i=1;i<(1<<m);i++){
        if(__builtin_popcount(i)!=k)continue;
        r=max(r,func(i));
    }
    
    cout<<r<<endl;
  
}
return 0;
}
