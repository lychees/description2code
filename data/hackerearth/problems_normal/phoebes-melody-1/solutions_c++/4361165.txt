#include <bits/stdc++.h>
using namespace std;
int arr[200005];
int arr_left[200005],arr_right[200005];
int main()
{
    int t,n,k;
    cin>>t;
    while(t--){
    	cin>>n>>k;
    	arr_left[0]=0;
    	arr_right[n+1]=n+1;
    	arr[0]=0;arr[n+1]=0;
    	
    	for(int i=1;i<=n;++i){
    		cin>>arr[i];
    		arr_left[i]=i-1;
    		arr_right[i]=i+1;
    	}
    	
    	for(int i=1;i<=n;++i){
    		while(arr_left[i]>=1 && arr[arr_left[i]]>=arr[i])
    			arr_left[i]=arr_left[arr_left[i]];
    	}
    	for(int i=n;i>=1;--i){
    		while(arr_right[i]<=n && arr[arr_right[i]]>=arr[i])
    			arr_right[i]=arr_right[arr_right[i]];
    	}
    	int idx,val,res=0;
    	for(int i=1;i<=n;++i){
    		val=INT_MAX;
    		idx=i-k;
    		while(idx>=1 && arr[idx]>=arr[i]) idx=arr_left[idx];
    		if(idx>=1 && idx<=i-k)
    		val=min(val,abs(i-idx));
    		idx=i+k;
    		while(idx<=n && arr[idx]>=arr[i]) idx=arr_right[idx];
    		if(idx<=n && idx>=i+k)
    		val=min(val,abs(i-idx));
    		if(val!=INT_MAX) res+=val;
    		//cout<<i<<" "<<res<<endl;
    	}
    	cout<<res<<endl;
    		
    }
    return 0;
}
