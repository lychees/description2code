#include<bits/stdc++.h>
using namespace std;

long long int mod(long long int a, long long int b)
{ return (a%b+b)%b; }


int main()
{
	int t;
	scanf("%d",&t);
	while(t--)
	{
		long long int i, n, z, sum = 0, m, a[100005];
		scanf("%lld %lld %lld",&n, &m, &z);
		z++;
		for (i = 1; i <= n; ++i)
			scanf("%lld",&a[i]);
		if(n==1)
		{
			printf("%lld\n", mod(a[1],m));
		}
		else
		{
		for(i = n; i>0; i-=2)
			sum += a[i];
		for(i = n-1; i>0; i-=2)
			sum -= a[i];
		a[0] = sum;
		long long int index, power, ans;
		index = z % (n+1);
		if(n%2 == 0)
			power = (((z-1)/(n+1))%2 == 0)? 1:-1;
		else
			power = 1;
		// cout<<"Index: "<<index<<endl;
		// cout<<"Power: "<<power<<endl;
		// cout<<"Answer: "<<a[index]<<endl;
		ans = mod((a[index] * power),m);
		printf("%lld\n",ans);
	}
	}
	return 0;
}