#include <bits/stdc++.h>
using namespace std;
typedef long long ll;
const ll N = 100001;
const ll INF = 1000000000;
const ll md =1000*1000*1000+7;
vector <ll> a;
vector <ll> ::iterator it;
ll t,x,k,ans,n,p;
int main()
{
  //freopen("input.txt","r",stdin);freopen("output.txt","w",stdout);
  scanf("%lld",&t);
  while(t--)
  {
      scanf("%lld%lld%lld",&n,&k,&p);
      a.assign(n,0);
      for (int i=0;i<n;i++)
        scanf("%lld",&a[i]);
      sort(a.begin(),a.end());
      for (int i=0;i+k-1<a.size();i++)
        if (a[i]+2*p>=a[k+i-1])
        {
             puts("NO");
             goto abc;
        }
        puts("YES");
        continue;
    abc: continue;
  }
    return 0;
}
