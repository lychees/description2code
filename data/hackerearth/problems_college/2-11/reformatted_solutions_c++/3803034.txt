#include <bits/stdc++.h>
#include <stdio.h>
using namespace std;
int adj[37][37];
int main() {
  long long int m;
  scanf("%lld", &m);
  int i, j;
  for (i = 0; i < 26; i++)
    for (j = 0; j < 26; j++)
      scanf("%d", &adj[i][j]);
  int p;
  for (p = 0; p < 26; p++)
    for (i = 0; i < 26; i++)
      for (j = 0; j < 26; j++)
        adj[i][j] = min(adj[i][j], adj[i][p] + adj[p][j]);
  for (i = 0; i < m; i++) {
    string a, b;
    cin >> a;
    cin >> b;
    int lm = a.size();
    long long int add = 0;
    for (j = 0; j < lm; j++) {
      add = add + adj[a[j] - 97][b[j] - 97];
    }
    printf("%lld\n", add);
  }
  return 0;
}