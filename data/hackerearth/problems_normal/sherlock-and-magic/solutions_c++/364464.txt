#include<bits/stdc++.h>
using namespace std;
struct crim
{
	int x,y;
	char d;
}a[60];
int main()
{
	int m,t,n,i,j,k,l,c,far;
	bool flag;
	cin>>t;
	while(t--)
	{
		scanf("%d",&n);
		c=n;
		for(i=0;i<n;i++)
		{
			scanf("%d%d%*c%c",&a[i].x,&a[i].y,&a[i].d);
			a[i].x*=2;
			a[i].y*=2;
		}
		far=5100;
		for(j=1;j<=4010;j++)
		{
			for(i=0;i<n;i++)
			{
			if(a[i].d=='N')
				a[i].y++;
			else if(a[i].d=='W')
				a[i].x--;
			else if(a[i].d=='E')
				a[i].x++;
			else if(a[i].d=='S')
				a[i].y--;
			}
			for(k=0;k<n-1;k++)
			{
				flag=0;
				for(l=k+1;l<n;l++)
				{
					if(a[k].x==a[l].x && a[k].y==a[l].y)
					{
						a[l].x=a[l].y=far++;
						a[l].d='N';
						c--;
						flag=1;
					}
				}
				if(flag)
				{
					a[k].x=a[k].y=far++;
					a[k].d='N';
					c--;
				}
			}
		}
		printf("%d\n",c);
	}
	return 0;
}
