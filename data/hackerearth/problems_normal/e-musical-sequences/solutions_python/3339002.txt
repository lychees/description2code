t = int(raw_input())
while t>0:
	n,m,z = map(int,raw_input().split())
	ar = map(int,raw_input().split())
	x = 0
	i = 1
	while i<=n:
		x += ((-1)**i)*ar[n-i]
		i += 1
	x = -x
	ar.append(x)
	y = 0
	i = 1
	while i<=n:
		y += ((-1)**i)*ar[n-i+1]
		i+=1
	i = z%(2*(n+1))
	if y>0:
		j = i/(n+1)
		ans = (((-1)**j)*ar[i%(n+1)])%m
	else:
		ans = ar[i%(n+1)]%m
	print ans
	t -= 1
		
	