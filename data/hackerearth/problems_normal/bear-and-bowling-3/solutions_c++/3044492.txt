#include <cstdio>
#include <cstring>
#include <algorithm>
using namespace std;
typedef long long LL;

const int M = 1000000007;
inline void add(int &x, int y) {
	x += y;
	if (x >=M) x-= M;
}

int main() {
//	freopen("in.txt", "r", stdin);
//	freopen("out.txt", "w", stdout);
	
	int i, j, k, N;
	scanf("%d", &N);
	int ans = 0;
	for (i = 1; i <= N; i++) {
		scanf("%d", &k);
		add(ans, LL(i + 1) * k % M);
	}
	for (i = 0; i < N - 2; i++) ans = ans * 2 % M;
	if (N < 2) ans = LL(ans) * ((M + 1) / 2) % M;
	printf("%d\n", ans);
	return 0;
}