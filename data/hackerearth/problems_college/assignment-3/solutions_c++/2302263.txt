#include <iostream>
#include <vector>
using namespace std;
 
vector<int> diff[20];
vector<int> same[20];
int ans=0,n;
int arr[20];
void func(int x)
{
	if(x>n){ ans++; return;}
	for(int i=1;i<=3;++i)
	{
		bool fail=false;
		for(int j=0;j<diff[x].size();++j)
		{
			if(i==arr[diff[x][j]]){fail=true; break;} 
		}
		for(int j=0;j<same[x].size();++j)
		{
			if(i!=arr[same[x][j]]){fail=true; break;} 
		}
		if(!fail){arr[x]=i; func(x+1);}
	}
}
int main()
{
    int k,t,a,b;
    scanf("%d %d",&n,&k);
    for(int i=0;i<k;++i)
    {
    	scanf("%d %d %d",&t,&a,&b);
    	if(t==0)
    	{
    		if(a<b) diff[b].push_back(a);
    		else diff[a].push_back(b);
    	} else {
    		if(a<b) same[b].push_back(a);
    		else same[a].push_back(b);
    	}
    }
    func(1);
    printf("%d\n",ans);
    return 0;
}