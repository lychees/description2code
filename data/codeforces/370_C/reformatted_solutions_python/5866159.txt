n, m = (int(s) for s in raw_input().split())

c = sorted([int(s) for s in raw_input().split()])

tot = 0
ans = []
for i in xrange(n):
    ans.append((c[i], c[(i + n / 2) % n]))
    if c[i] != c[(i + n / 2) % n]:
        tot += 1

print tot
for i in ans:
    print i[0], i[1]
