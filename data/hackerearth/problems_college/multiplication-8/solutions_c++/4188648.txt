/* NumeriX
   "Hard Work Beats Talent
   When Talent Doesn't Work Hard"
*/
#include <bits/stdc++.h>
#define ll long long int
#define sii(x) scanf("%d",&x)
#define pii(x) printf("%d\n",x)
#define sll(x) scanf("%lld",&x)
#define pll(x) printf("%lld\n",x)
#define present_set_map(container, element) (container.find(element) != container.end()) 
#define present_vec(container, element) (find(all(container),element) != container.end()) 
#define mp make_pair
#define all(x) x.begin(),x.end()
#define all_rev(x) x.rbegin(),x.rend()
#define pb push_back
#define fr first
#define se second
#define mod 1000000007
using namespace std;

ll arr[1000007];
ll fwd[1000007];
ll bwd[1000007];

int main()
{
    ll n,m,q,index,prod_4wd=1,prod_bwd=1,ans,i;
    scanf("%lld %lld %lld",&n,&m,&q);
    for(i=0;i<n;i++)
        sll(arr[i]);
    for(i=0;i<n;i++)
    {
        prod_4wd=(prod_4wd*arr[i])%m;
        fwd[i]=prod_4wd;
    }
    for(i=n-1;i>=0;i--)
    {
        prod_bwd=(prod_bwd*arr[i])%m;
        bwd[i]=prod_bwd;
    }
    while(q--)
    {
        sll(index);
        index--;
        if(index==0)
            pll(bwd[index+1]%m);
        else if(index==n-1)
            pll(fwd[index-1]%m);
        else
            pll((fwd[index-1]*bwd[index+1])%m);
    }
}