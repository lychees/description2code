#include <iostream>
#include <cstdio>
#include <algorithm>
#include <cstring>
using namespace std;
char str[100][200],result[2000];
int length[100],start[100],rev[100],inc[100];
long long tLength[100];
int n,m;
char calcResult(int n,long long x)
{
    if(x<=tLength[n-1])
	{
		return calcResult(n-1,x);
	}
	else if(x>tLength[n-1]&&x<=2*tLength[n-1])
	{
		return calcResult(n-1,2*tLength[n-1]-x+1);
	}
	else if(x>2*tLength[n-1])
	{
		return str[n-1][x-2*tLength[n-1]-1];
	}
}
int main()
{
	int t,i,j;
	long long x;
	j=2;
	for(i=0;i<100;i++)
	{
		start[i]=j-2;
		rev[i]=start[i]+1;
		inc[i]=2*j;
		j=j*2;
		j-=2;
	}
	scanf("%d",&t);
	while(t--){
		scanf("%d%d",&n,&m);
		for(i=0;i<n;i++)
		{
			scanf("%s",str[i]);
			length[i+1]=strlen(str[i]);
		}
		tLength[0]=0;
		for(i=1;i<=n;i++)
		{
			tLength[i]=2*tLength[i-1]+length[i];
		}
		for(i=0;i<m;i++)
		{
			scanf("%lld",&x);
			x++;
			result[i]=calcResult(n,x);
		}
		result[m]='\0';
		printf("%s\n",result);
	}
    return 0;
}
