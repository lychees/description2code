#include <iostream>
using namespace std;
int a[213][213];
int b[213][213];
int f(long long n,long long m,long long N,long long M){
	if(b[n][m] != -1){return b[n][m];}
	if(n == N-1 && m == M-1){b[n][m]=0;return 0;}
	if(n == N-1 && a[n][m] > a[n][m+1]){b[n][m]=0;return 0;}
	if(n == N-1 && a[n][m] < a[n][m+1]){b[n][m]=1+f(n,m+1,N,M); return b[n][m];}
	if(m == M-1 && a[n][m] > a[n+1][m]){b[n][m]=0;return 0;}
	if(m == M-1 && a[n][m] < a[n+1][m]){b[n][m]=1+f(n+1,m,N,M);return b[n][m];}
	if(a[n][m] < a[n+1][m] && a[n][m] < a[n][m+1]){b[n][m]=max(1+f(n+1,m,N,M),1+f(n,m+1,N,M));return b[n][m];}
	else if(a[n][m] < a[n][m+1]){b[n][m]=1+f(n,m+1,N,M);return b[n][m];}
	else if(a[n][m] < a[n+1][m]){b[n][m]=1+f(n+1,m,N,M);return b[n][m];}
	else {b[n][m]=0;return 0;}
}
void g(long long n){
	for(int i=0;i<n;i++){
		for(int j=0;j<n;j++){
			b[i][j]=-1;
		}
	}
}
int main()
{
    int t;
    long long n,m;
    cin>>t;
    while(t--){
    	cin>>n>>m;
    	g(213);
    	for(int i=0;i<n;i++){
    		for(int j=0;j<m;j++){
    			cin>>a[i][j];
    		}
    	}
    	cout<<1+f(0,0,n,m)<<endl;
    }
    return 0;
}
