#include <iostream>
using namespace std;

int main()
{
	ios_base::sync_with_stdio(false);
    cin.tie(NULL);
    int t;
    cin>>t;
    int n,m;
    while(t>0)
    {
        	t--;
        	
        	cin>>n>>m;
        	char **map= new char*[n];
        	int **energy= new int*[n];
        	for(int i=0;i<n;i++)
        	{
        		map[i]= new char[m];
        		energy[i]= new int[m];
        	}
        	for(int i=0;i<n;i++)
        	{
        		for(int j=0;j<m;j++)
        			{
        				cin>>map[i][j];
        			}
        	}
        	
        	
        	if(map[0][0]=='D')
        		{
        			cout<<"-1"<<endl;
        			continue;
        		}
        	else if(map[0][0]=='T')
        		energy[0][0]=150;
        	else
        		energy[0][0]=0;
        	
        	for(int i=1;i<n;i++)
        	{
        		if(map[i][0]=='D')
        		{
        			energy[i][0]=energy[i-1][0]-100;
        		}
        		else if(map[i][0]=='T')
        		{
        			if(energy[i-1][0]<0)
        				energy[i][0]=energy[i-1][0];
        			else
        				energy[i][0]=energy[i-1][0]+150;
        		}
        		else
        			energy[i][0]=energy[i-1][0];
        	}
        	
        	for(int i=1;i<m;i++)
        	{
        		if(map[0][i]=='D')
        		{
        			energy[0][i]=energy[0][i-1]-100;
        		}
        		else if(map[0][i]=='T')
        		{
        			if(energy[0][i-1]<0)
        				energy[0][i]=energy[0][i-1];
        			else
        				energy[0][i]=energy[0][i-1]+150;
        		}
        		else
        			energy[0][i]=energy[0][i-1];
        	}
        	
        	for(int i=1;i<n;i++)
        	{
        		for(int j=1;j<m;j++)
        		{
        			int max=energy[i-1][j]>energy[i][j-1]?energy[i-1][j]:energy[i][j-1];
        			
        			{
        				if(map[i][j]=='D')
        					energy[i][j]=max-100;
        				else if(map[i][j]=='T')
        					{
        						if(max<0)
        							energy[i][j]=max;
        						else
        							energy[i][j]=max+150;
        					}
        					
        				else
        					energy[i][j]=max;
        			}
        				
        		}
        	}
        	
        	/*for(int i=0;i<n;i++)
        	{
        		for(int j=0;j<m;j++)
        			System.out.print(energy[i][j]+" ");
        		System.out.println();
        	}*/
        
        	if(energy[n-1][m-1]<0)
        		cout<<"-1"<<endl;
        	else
        		cout<<energy[n-1][m-1]<<endl;
        }

}
