#include <iostream>
#include<bits/stdc++.h>
#define ll long long
#define ull unsigned long long
using namespace std;
int main()
{
	ll N,Q,A[100][100],B[100][100],C[100][100],D[100][100],E[100][100],i,j,value;
	cin>>N>>Q;
	for(i=0;i<N;i++)
		for(j=0;j<N;j++)
			cin>>A[i][j];
	while(Q--)
	{
		cin>>value;
		value=value/90-1;
		value=value%4;
		if(value==0)
		{
			for(i=0;i<N;i++)
					for(j=0;j<N;j++)
						B[i][j]=A[N-j-1][i];
			for(i=0;i<N;i++)
			{
				for(j=0;j<N;j++)
					cout<<B[i][j]<<" ";
				cout<<endl;
			}
		}
		else if(value==1)
		{
			for(i=0;i<N;i++)
					for(j=0;j<N;j++)
						B[i][j]=A[N-j-1][i];
				for(i=0;i<N;i++)
					for(j=0;j<N;j++)
						C[i][j]=B[N-j-1][i];
			for(i=0;i<N;i++)
			{
				for(j=0;j<N;j++)
					cout<<C[i][j]<<" ";
				cout<<endl;
			}
		}
		else if(value==2)
		{
			for(i=0;i<N;i++)
					for(j=0;j<N;j++)
						B[i][j]=A[N-j-1][i];
				for(i=0;i<N;i++)
					for(j=0;j<N;j++)
						C[i][j]=B[N-j-1][i];
				for(i=0;i<N;i++)
					for(j=0;j<N;j++)
						D[i][j]=C[N-j-1][i];
			for(i=0;i<N;i++)
			{
				for(j=0;j<N;j++)
					cout<<D[i][j]<<" ";
				cout<<endl;
			}
		}
		else if (value==3)
		{
			for(i=0;i<N;i++)
					for(j=0;j<N;j++)
						B[i][j]=A[N-j-1][i];
				for(i=0;i<N;i++)
					for(j=0;j<N;j++)
						C[i][j]=B[N-j-1][i];
				for(i=0;i<N;i++)
					for(j=0;j<N;j++)
						D[i][j]=C[N-j-1][i];
				for(i=0;i<N;i++)
					for(j=0;j<N;j++)
						E[i][j]=D[N-j-1][i];
			for(i=0;i<N;i++)
			{
				for(j=0;j<N;j++)
					cout<<E[i][j]<<" ";
				cout<<endl;
			}
		}
		else
		{
			for(i=0;i<N;i++)
			{
				for(j=0;j<N;j++)
					cout<<A[i][j]<<" ";
				cout<<endl;
			}
		}
		cout<<endl;
	}
    return 0;
}
