#include <bits/stdc++.h>
using namespace std;
typedef vector< int > vi;
typedef vector< vi > vii;
vii adj(100000),dist(100000);
vi visited,ht;
int n,step = 0,dfsin[100001],dfsout[100002];
void dfs(int s)
{
  visited[s] = 1;
  step++;
  dfsin[s] = step;
  for (int i = 0; i < adj[s].size(); ++i)
  {
    if(visited[adj[s][i]]==0)
     {
           ht[adj[s][i]]= ht[s]+1;
      dfs(adj[s][i]);
    }
  }
  step++;
  dfsout[s] = step;
}
int main()
{
  int t;
  scanf("%d",&t);
  while(t--)
  {
    cin>>n;
    for (int i = 0; i <= n ; ++i)
    {
      adj[i].clear();
    }
    int k;
    for (int i = 1; i <= n; ++i)
    {
      int p;
      cin>>p;
      if(p!=0)
      adj[i].push_back(p); 
    adj[p].push_back(i);
    if(p ==0)
      k = i;
    }
    visited.clear();
    ht.clear();
    for (int i = 0; i <= n; ++i)
    {
      visited.push_back(0);
      ht.push_back(0);
    }
    ht[k] = 0;
    dfs(k);
    int q;
    cin>>q;
    while(q--)
    {
      int x,y;
      cin>>x>>y;
      if(dfsin[y]<dfsin[x]&&dfsout[y]>dfsout[x])
      cout<<ht[x]-ht[y]-1<<endl;
    else
      cout<<-1<<endl;
    }
  }    
    
}