 
#include<bits/stdc++.h>
#define DEBUG if(0)
#define LL                           long long
#define MOD                         (LL)(1e9 + 7)
#define maX(a,b)                     ( (a) > (b) ? (a) : (b))
#define miN(a,b)                     ( (a) < (b) ? (a) : (b))
#define F(i,L,R)                      for (int i = L; i < R; i++)
#define FE(i,L,R)                     for (int i = L; i <= R; i++)
#define FF(i,L,R)                     for (int i = L; i > R; i--)
#define FFE(i,L,R)                      for (int i = L; i >= R; i--)
#define FIT(a,b)                      for (__typeof((b).begin()) (a)=(b).begin(); (a)!=(b).end(); (a)++)

using namespace std;

LL mat[60][60];

void pow(int n,LL p)
{
	LL copy[60][60];

	if(p==1)
		return;

	if (p%2==1)
	{
		F(i,0,n)
		{
			F(j,0,n)
			copy[i][j]=mat[i][j];
		}
	}

	LL temp[60][60];

	F(i,0,n)
	{
		F(j,0,n)
		{	
			temp[i][j]=0;
			F(k,0,n)
			{
				temp[i][j] = (temp[i][j] + mat[i][k]*mat[k][j]%MOD)%MOD;
			}
		}
	}


	F(i,0,n)
		{
			F(j,0,n)
			mat[i][j]=temp[i][j];
		}


	pow(n,p/2);

	if(p%2==1)
	{
			F(i,0,n)
	{
		F(j,0,n)
		{	
			temp[i][j]=0;
			F(k,0,n)
			{
				temp[i][j] = (temp[i][j] + mat[i][k]*copy[k][j]%MOD)%MOD;
			}
		}
	}

	F(i,0,n)
		{
			F(j,0,n)
			mat[i][j]=temp[i][j];
		}

	}





}

int main()
{
	
	int t;
	scanf("%d",&t);
	while(t--)
	{
		int n,u,v; LL k;
		scanf("%d%lld%d%d",&n,&k,&u,&v);
		F(i,0,n)
		{
			F(j,0,n)
			scanf("%lld",&mat[i][j]);
		}
		//cerr<<"hello";

		pow(n,k);

		cout<<mat[u][v]<<endl;


	}	
} 
