#include <bits/stdc++.h>
using namespace std;
#define FOR(i,n) for(int i=0;i<n;i++)
#define ll long long 
#define matrix vector< vector<ll> >
#define MOD 1000000007
const int K=3;

matrix mul(matrix &A,matrix &B)
{
	matrix C(K,vector<ll>(K));
	FOR(i,K) FOR(j,K) FOR(k,K)
	C[i][j]=(C[i][j]+A[i][k]*B[k][j])%MOD;
	return C;
}

matrix _pow(matrix &A, ll p)
{
	if (p == 1)
    return A;
    if (p % 2){
    	matrix y=_pow(A,p-1);
    return mul(A,y);	
    }
    
    matrix X = _pow(A, p/2);
    return mul(X, X);
}

ll solve(ll n,ll f_0,ll f_1,ll A,ll B,ll C)
{
	//if(n<0) return 0;
	vector<ll> f1(K);
	f1[0]=f_0;
	f1[1]=f_1;
	f1[2]=C;
	matrix T(K,vector<ll>(K));
	T[0][0]=0;
	T[0][1]=1;
	T[0][2]=0;
	T[1][0]=B;
	T[1][1]=A;
	T[1][2]=1;
	T[2][0]=0;
	T[2][1]=0;
	T[2][2]=1;
	
	
	if(n==1)
	return f_1;
	if(n==0)
	return f_0;
	
	
	T=_pow(T,n-1);
	ll ans=0;
	
	FOR(i,K)
	ans=(ans+T[0][i]*f1[i])%MOD;
	return ans;
	
}

int main()
{
	long long int t,n,f_0,f_1,a,b,c;
	cin>>t;
	while(t--)
	{
		ll val;
		scanf("%lld",&n);
		scanf("%lld",&f_0);
		scanf("%lld",&f_1);
		scanf("%lld",&a);
		scanf("%lld",&b);
		scanf("%lld",&c);
		printf("%lld \n",solve(n,f_0,f_1,a,b,c));
	}
}
