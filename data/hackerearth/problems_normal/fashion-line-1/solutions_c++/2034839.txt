#include <bits/stdc++.h>
#define ll long long
using namespace std;
ll int a[10010];
ll int myfind_min(ll int l,ll int h,ll int v)
{
	ll int m;
	ll int ans=-1;
	while(l<=h)
	{
		m=((h-l)>>1)+l;
		if(a[m]>=v)
		{
			ans=m;
			h=m-1;
		}
		else
		{
			l=m+1;
		}
	}
	return ans;
}
ll int myfind_max(ll int l,ll int h,ll int v)
{
	ll int m;
	ll int ans=-1;
	while(l<=h)
	{
		m=((h-l)>>1)+l;
		if(a[m]<=v)
		{
			//~ cout<<m<<" a[m] "<<a[m]<<" "<<v<<endl;
			ans=m;
			l=m+1;
		}
		else
		{
			h=m-1;
		}
		//~ cout<<m<<" a[m] "<<a[m]<<" "<<v<<endl;
	}
	return ans;
}
int main()
{
	ll int test;
	scanf("%lld",&test);
	while(test--)
	{
		ll int n,k,l,r;
		scanf("%lld%lld%lld%lld",&n,&k,&l,&r);//n dresses,k-special,atleast & atmost :)
		char dress[n+1],luck[k+1];//dresses & lucky ones
		ll int h[300];
		memset(h,0,sizeof(h));
		scanf("%s%s",dress,luck);
		ll int i;
		for(i=0;i<k;i++)
		{
			h[luck[i]]=1; //Marking as lucky
		}
		for(i=0;i<n;i++)
		{
			if(h[dress[i]]==1)
			{
				a[i]=1;
			}
			else
			{
				a[i]=0;
			}
		}
		//Calculate the prefix-sum
		for(i=1;i<n;i++)
		{
			a[i]+=a[i-1]; //Prefix sum ready
		}
		//Printing the prefix-array
		//~ for(i=0;i<n;i++)
		//~ {
			//~ cout<<a[i]<<" ";
		//~ }
		//~ cout<<endl;
		ll int ans=0;
		int ml,mh,x;//mylow & myhigh
		for(i=0;i<n;i++)
		{
			if(i==0)
			{
				x=0;
			}
			else
			{
				x=a[i-1];
			}
			ml=myfind_min(i,n-1,x+l);
			if(ml==-1)
			{
				continue;
			}
			mh=myfind_max(i,n-1,x+r);
			if(mh==-1)
			{
				continue;
			}
			//~ cout<<i+1<<" "<<ml+1<<" "<<mh+1<<endl;
			ans+=(mh-ml+1);
		}
		printf("%lld\n",ans);
	}
	return 0;
}
