#include<bits/stdc++.h>

using namespace std;

char a[201][201];
int energy[201][201];

int main() {

    int t;
    scanf("%d",&t);

    while(t--) {
        int n,m;
        scanf("%d %d",&n,&m);
    	getchar();
        for(int i=1 ; i<=n ; i++) {
            for(int j=1 ; j<=m ; j++) {
                a[i][j] = getchar();
				getchar();
            }
        }

        if(a[1][1]=='D') {
            printf("-1\n");
            continue;
        }

        if(n==1 && m==1) {
            printf("0\n");
            continue;
        }

        for(int i=0;i<=n;i++) {
            energy[i][0]=INT_MIN;
        }

        for(int j=0;j<=m;j++) {
            energy[0][j]=INT_MIN;
        }

        for(int i=1;i<=n;i++) {
            for(int j=1;j<=m;j++) {
                if(a[i][j]=='T') {
                    if(i==1 && j==1) {
                    	energy[i][j]=150;
                    } else {
                    	energy[i][j]=INT_MIN;

                    	if(energy[i-1][j]>=0)
                    		energy[i][j]=max(energy[i-1][j] + 150 , energy[i][j]);
                    	if(energy[i][j-1]>=0)
                    		energy[i][j]=max(energy[i][j-1] + 150 , energy[i][j]);
                    }
                }
           
                else if(a[i][j]=='D') {
                 		energy[i][j]=INT_MIN;

                    	if(energy[i-1][j]>=100)
                    		energy[i][j]=max(energy[i-1][j] - 100 , energy[i][j]);
                    	if(energy[i][j-1]>=100)
                    		energy[i][j]=max(energy[i][j-1] - 100 , energy[i][j]);
                }
           
                else {
                    energy[i][j]=max(energy[i][j-1] , energy[i-1][j]);
                }
            }
        }
        if(energy[n][m]>=0) {
            printf("%d\n",energy[n][m]);
        } else {
            printf("-1\n");
        }

    }

    return 0;
}
