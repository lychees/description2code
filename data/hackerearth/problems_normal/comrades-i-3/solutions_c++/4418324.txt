#include <bits/stdc++.h>
using namespace std;
#define ll long long

ll visited[100005];
ll dist[100005];
ll dfsin[100005];
ll dfsout[100005];
ll c=-1,step=0;

int dfs(ll x,vector<ll> adj[],int dis){
	dist[x]=dis;
	visited[x]=1;
	dfsin[x]=++step;
	for(ll i=0;i<adj[x].size();i++)
			dfs(adj[x][i],adj,dis+1);
	dfsout[x]=++step;
}

int main(){
    ll t,n,q,x,y;
    scanf("%lld",&t);
    while(t--){
    	memset(visited,0,sizeof(visited));
    	memset(dist,0,sizeof(dist));
    	memset(dfsin,0,sizeof(dfsin));
    	memset(dfsout,0,sizeof(dfsout));
    	step=0;
    	scanf("%lld",&n);
    	vector<ll> adj[n+1];
    	for(ll i=1;i<=n;i++){
    		scanf("%lld",&x);
    		adj[x].push_back(i);
    	}
    	scanf("%lld",&q);
    	dfs(0,adj,1);
    	while(q--){
    		scanf("%lld %lld",&x,&y);
    		if(dfsin[x]>dfsin[y] && dfsout[x]<dfsout[y])
    			printf("%lld\n",max(c,dist[x]-dist[y]-1));
    		else
    			printf("-1\n");
    	}
    }
    return 0;
}
