#include<bits/stdc++.h>
using namespace std;
#define mp make_pair
int i,n,p[1000000],s,me,we,ans,m,c,u,v,x,y,z,l,r;
 pair<int,pair<int,int>> a[1000000];
void initial(){
	for(i=1;i<=n;i++){
		p[i]=i;
	}
}
int root(int s){
	while(s!=p[s]){
		p[s]=p[p[s]];
		s=p[s];
	}
	return s;
}

int men(){
	initial();
	me=0;ans=0;
	for(i=m-1;i>=0;i--){
		c=a[i].first;
		u=a[i].second.first;
		v=a[i].second.second;
		if(c==1||c==3){
			l=root(u);
			r=root(v);
			if(l!=r){
				p[l]=r;
				me++;
			}
			else ans++;
		}
	}
//	printf("men==%d\n",ans);
	return ans;
}
int women(){
	initial();
	we=0;ans=0;
	for(i=m-1;i>=0;i--){
		c=a[i].first;
		u=a[i].second.first;
		v=a[i].second.second;
		if(c==2||c==3){
			l=root(u);
			r=root(v);
			if(l!=r){
				p[l]=r;
				we++;
			}
			else if(c==2)ans++;
		}
	}
//	printf("women==%d\n",ans);
	return ans;
}


int main(){
	scanf("%d %d",&n,&m);
	for(i=0;i<m;i++){
		scanf("%d %d %d",&x,&y,&z);
		a[i]=mp(z,mp(x,y));
	}
sort(a,a+m);
	ans=men()+women();
	if(me!=n-1||we!=n-1)printf("-1");
	else printf("%d",ans);
	
}