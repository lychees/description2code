#include <bits/stdc++.h>
using namespace std;
int main()
{
	int n;
	cin>>n;
	int option=1,x;
	multiset<int > s;
	while(n--)
	{
		 cin>>option;
		 if(option==1)
		 {
		 	cin>>x;
		 	s.insert(x);
		 }
		 if(option==2)
		 {
		 	cin>>x;
		 	if(s.find(x)==s.end())
		 	cout<<"-1\n";
		 	else
		 	s.erase(s.find(x));
		 }
		 if(option==3)
		 {
		 	if(s.size()==0)
		 	cout<<"-1\n";
		    else
		    cout<<*s.rbegin()<<"\n";
		 }
		 if(option==4)
		 {
		 	if(s.size()==0)
		 	cout<<"-1\n";
		    else
		    cout<<*s.begin()<<"\n";
		 }
		 
	}
}