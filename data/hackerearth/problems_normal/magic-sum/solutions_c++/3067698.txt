#include<bits/stdc++.h>
using namespace std;
long long int max_sum;
long long int dfs(int z,int n,vector<int> v){
	long long int d1,d2,t;
	if(z<n){
		d1=dfs(2*z+1,n,v);
		d2=dfs(2*z+2,n,v);
	//	t=v[z]+max(d1,d2);
	    //cout<<max_sum<<"\t";
	    max_sum =max(max_sum, v[z]+d1+d2);
		return v[z]+max(d1,d2);
		
	}
	else return 0;
}
int main(){
   int t;
   cin>>t;
   while(t--){
   	max_sum=-100000000;
   	int n,i,j,k;
   	long long int sum;
   	vector<int > v;
   	cin>>n;
   	for(i=0;i<n;i++){
   	    cin>>j;
		   v.push_back(j);   	
   	}
   dfs(0,n,v);
   cout<<max_sum<<endl;
   
   }
}
