#include <iostream>
#include <cmath>
#include <cstdio>
#include <vector>
#include <cstring>
#define MAX 1000005
using namespace std;
int isspecial [ MAX ] ;
int main()
{	int t ;
	scanf ( "%d" , &t ) ;
	while ( t-- ) {
		int x , y , answer = 0 ;
		scanf ( "%d %d" , &x , &y ) ;
		memset ( isspecial , 1 , sizeof (isspecial ) ) ;
		for ( long long i = 2 ; i * i <= y ; i++ ) {
			long long k = x / ( i * i ) ;
			k *= ( i * i ) ;
			if ( k < x ) k += i * i ;
			while ( k <= y ) {
				isspecial [ k - x ] = 0 ;
				k += i * i ;
			}
		}
	for ( int i = x ; i <= y ; i++ )
		if ( isspecial [ i - x ] ) answer++ ;
		
	printf ( "%d\n" , answer ) ;
	}
    return 0;
}
