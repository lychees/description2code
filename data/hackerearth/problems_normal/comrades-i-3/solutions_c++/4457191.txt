#include<bits/stdc++.h>
using namespace std;
#define ll long long int
#define pb(x) push_back(x)
vector<vector<ll> >adj(100010);
ll k,pre[100010],s[100010],f[100010];
ll dfs(ll i,ll ans)
{
	s[i]=++k;
	pre[i]=ans;
	for(ll j=0;j<adj[i].size();++j)
		dfs(adj[i][j],ans+1);
	f[i]=++k;
}
int main()
{
	ios_base::sync_with_stdio(false);cin.tie(0);
	ll t,n,q,i,x,y;
	scanf("%lld",&t);
	while(t--)
	{
		scanf("%lld",&n);
		for(i=1;i<=n;++i)
			adj[i].clear();
		for(i=1;i<=n;++i)
		{
			scanf("%lld",&x);
			adj[x].pb(i);
		}
		k=0;
		dfs(0,0);
		scanf("%lld",&q);
		while(q--)
		{
			scanf("%lld%lld",&x,&y);
			if(s[x]>s[y] && f[x]<f[y])
				printf("%lld\n",pre[x]-pre[y]-1);
			else
				printf("-1\n");
		}
	}
	return 0;
}