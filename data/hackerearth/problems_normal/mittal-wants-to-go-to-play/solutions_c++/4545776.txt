#include <bits/stdc++.h>
#define pb push_back
#define pr pair<int,int>
#define mp make_pair
#define big 1000000005
#define ultrax_007 ios_base::sync_with_stdio(false);cin.tie(NULL)
using namespace std;


int main(){
	ultrax_007;
	int w;
	cin>>w;
	while(w--){
	int n,m;
	cin>>n>>m;
	int visited[n+1];
	int distance[n+1];
	vector<pr> v[n+1];
	for(int i=0;i<m;i++){
		int x,y,z;
		cin>>x>>y>>z;
		v[x].pb(mp(y,z));
		v[y].pb(mp(x,z));
	}
	for(int i=2;i<=n;i++){
		visited[i]=0;
		distance[i]=big;
	}
	visited[1]=0;
	distance[1]=0;
	priority_queue<pr,vector<pr>,greater<pr> > pq;
	pq.push(mp(0,1));
	while(!pq.empty()){
		int dis=pq.top().first;
		int index=pq.top().second;
		pq.pop();
		if(visited[index]==1)continue;
		visited[index]=1;
		for(int i=0;i<v[index].size();i++){
			if(dis+v[index][i].second<distance[v[index][i].first]){
				distance[v[index][i].first]=dis+v[index][i].second;
				pq.push(mp(distance[v[index][i].first],v[index][i].first));
			}
		}
	}
	int q;
	cin>>q;
	for(int i=0;i<q;i++){
		int x,y;
		cin>>x>>y;
		int k=distance[x];
		if(distance[x]==big){
			cout<<"0"<<endl;
		}else{
			int ans=max(0,y-(2*k));
			cout<<ans<<endl;
		}
	}
	}
	return 0;
}