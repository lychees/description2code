//Program: a
//Author: gary
//Date: 18/10/2014
#include <cstdio>
#include <cstring>
#include <cmath>
#include <iostream>
#include <vector>
#include <set>
#include <map>
#include <queue>
#include <stack>
#include <string>
#include <algorithm>
using namespace std;
#define SZ(x) ( (int) (x).size() )
#define dbg(x) cerr << #x << " = " << x << endl;
#define mp make_pair
#define pb push_back
#define fi first
#define se second
typedef long long ll;
typedef pair<int, int> pii;
// const int INF = 1e9;
const int MAX_N = 5e5+5;

int T, N;
char name[MAX_N][11];
int val[MAX_N];
int mval;
int ft[MAX_N];

void update(int i, int x){  for(; i < MAX_N; i += i & -i) ft[i] += x; }

int getindex(int x){
  int r = 0, n;
  for(int i = 18; i >= 0; i--){
    n = r + (1 << i);
    if(n <= N && ft[n] < x){
      x -= ft[n];
      r = n;
    }
  }
  return r + 1;
}

void answer(int x){
  int i = getindex(x);
  mval = max(mval, val[i]);
  printf("%s %d\n", name[i], mval);
  update(i, -1);
}

int main(){
  scanf("%d", &T);
  while(T--){
    scanf("%d", &N);
    mval = 0;
    memset(ft, 0, sizeof ft);
    for(int i = 1; i <= N; i++) scanf("%s", name[i]);
    for(int i = 1; i <= N; i++) scanf("%d", val + i);
    for(int i = 1; i <= N; i++) update(i, 1);
    for(int i = 0; i < N - 1; i++){
      int x; scanf("%d", &x);
      answer(x);
    }
    answer(1);
  }
  return 0;
}
