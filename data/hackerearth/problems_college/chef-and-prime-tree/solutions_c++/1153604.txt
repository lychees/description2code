#include <bits/stdc++.h>
using namespace std;
long long arr[5005000]={0};
int main()
{
    int i,j,inc=2;
    long long int num=5005000;
    long long int root=sqrt(num)+1;
    for(i=0;i<num;i++)arr[i]=i;
    for(i=2;i<=root;i++){
       if(arr[i]>0) {
          for(j=inc*i;j<=num;j=j+i)
            arr[j]=-1;
           inc++;
      }
    }
    int t;
    arr[1]=-1;
    arr[0]=-1;
    cin>>t;
    while(t--)
    {
    	long long int x,y,ans=0,a,b;
    	cin>>x>>y;
    	a=x;
    	b=y;
    	if(a!=b)
    	{
    		if(arr[x]!=-1)
    			ans-=x;
    		else
    			ans+=x;
    		if(arr[y]!=-1)
    			ans-=y;
    		else
    			ans+=y;
    		
    	}
    	else if(a==b)
    	{
    			if(arr[x]!=-1)
    				ans-=x;
    			else
    				ans+=x;
   		}
   		while(x!=y)
    	{
    		if(x>y)
    		{
    			x/=2;
    			if(arr[x]!=-1)
    				ans-=x;
    			else
    				ans+=x;
    		}
    		else
    		{
    			y/=2;
    			if(arr[y]!=-1)
    				ans-=y;
    			else
    				ans+=y;
    		}
    	}
    	if(a!=b)
    	{
    		if(a==x)
    		{
    			if(arr[x]!=-1)
    				ans+=x;
    			else
    				ans-=x;
    		}
    		if(b==y)
    		{
    			if(arr[y]!=-1)
    				ans+=y;
    			else
    				ans-=y;	
    		}
    		if(x==y && x!=a && y!=b)
    		{
    			if(arr[x]!=-1)
    				ans+=x;
    			else
    				ans-=x;
    		}
    	}	
    	cout<<ans<<endl;
	}
    return 0;
}
