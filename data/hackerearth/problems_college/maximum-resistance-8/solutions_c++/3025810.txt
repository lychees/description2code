

    # include<bits/stdc++.h>
    using namespace std;
    #define REP(a,b) for(int a=0;a<b;a++)
    int ind=0;
    int counter(string s)
    {
    	//cout<<s<<" ";
    	//cout<<ind<<endl;
    	char e=s[ind++];
    	if(e=='X')
    	{
    		return 1;
    	}
    	if(e=='A')
    	{
    		return (counter(s)+counter(s));
    	}
    	if(e=='B')
    	{
    		return max(counter(s),counter(s));
    	}
    	return 0;
    }
    int main()
    {
    	int t;
    	cin>>t;
    	while(t--)
    	{
    		string s;
    		cin>>s;
    		int l=s.length();
    		int n=0,k=0;
    		REP(i,l)
    		{
    			if(s[i]=='X')
    			{
    				n++;
    			}
    		}
    		vector<int> a(n);
    		REP(i,n)
    		{
    			scanf("%d",&a[i]);
    		}
    		sort(a.rbegin(),a.rend());
    		ind=0;
    		int num=counter(s);
    	//	cout<<num<<" ";
    		int sum=0;
    		REP(i,num)
    		{
    			sum+=a[i];
    		}
    		cout<<sum<<endl;
    		a.clear();
    	}
    }


