#include<cstdio>
#define ll long long
using namespace std;

ll modPow( ll N , ll x , ll MOD)
{
	
	 if( N == 0) return 1 ;
	 ll ans = modPow( N/2,x,MOD) ;
	 ans = (1LL*ans*ans)%MOD ;
	 if( (N&1) )
	  ans = (1LL*ans*x)%MOD ;
	 return ans ;
}

// function to calculate sum of n terms of GP  in log(n) time
ll gp_sum( ll N , ll x, ll MOD)
{
	
	 if( N== 0) 
	 	return 1 ;
	 if( !(N&1)) 
	 	return (modPow(N,x,MOD) + gp_sum(N-1,x,MOD))%MOD ;
	 	
	 	return ((1 + 1LL*modPow((N+1)/2,x,MOD)) * gp_sum(N>>1,x,MOD))%MOD ; 
}
	
int main()
{
	
		int q;
		scanf("%d",&q);
		
		while(q--)
		{
			ll n,x,m;
			scanf("%lld %lld %lld",&n,&x,&m);
			ll ans= modPow(n,x,m);
			ll ans1 = gp_sum(n,x,m)-1;
			
			ans1 = (2*ans1)%m; 
			
			ans1%=m;
			
			if(ans1<0)
			ans1+=m ;
			printf("%lld\n",ans1);
		}
		
}
		
		
			

