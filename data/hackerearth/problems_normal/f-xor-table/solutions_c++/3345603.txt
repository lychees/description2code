#include <iostream>
#include <cstdio>
#include <string>

using namespace std;

int n, m, p, x;

string f(string a, long long pw) {
	if (pw == 0) return a;
	
	string b;

	long long k = 0;
	while ((1LL << k) <= pw) ++k;
	--k;

	b = a;
	long long d = p * (1LL << k) % m;
	for (int i = 0; i < m; ++i)
		b[i] = b[i] ^ (a[(i - d + m) % m] - '0');
	return f(b, pw - (1 << k));
}

void solve() {
	cin >> n >> m >> p >> x;
	string a; cin >> a;
	
	string b = f(a, n - 1);
	for (int i = 0; x && i < b.length(); ++i)
		b[i] ^= 1;

	cout << b << endl;
}

int main() {
	int t; cin >> t;
	while (t-->0) solve();
	return 0;
}