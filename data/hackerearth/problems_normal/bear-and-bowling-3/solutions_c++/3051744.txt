#include <iostream>

#define MODULO 1000000007

using namespace std;

long long int exponentiate(long long int a, long long int n, long long int MOD);

int main()
{
	int N;
	int arr[1000000];
	cin>>N;
	for(int i = 0; i<N; i++)
	{
		cin>>arr[i];
	}
	
	long long int firstterm = exponentiate(2, N-1, MODULO);
	long long int commondifference = exponentiate(2, N-2, MODULO);
	long long int ans = 0;
	
	for(int i = 0; i<N; i++)
	{
		ans = (ans + (((firstterm+i*commondifference)%MODULO)*arr[i])%MODULO)%MODULO;
	}
	cout<<ans<<endl;
	
    return 0;
}

long long int exponentiate(long long int a, long long int n, long long int MOD)
{
	if(n==0)
	{
		return 1;
	}
	
	long long int ans = exponentiate(a, n/2, MOD);
	
	ans = (ans*ans)%MOD;
	
	if(n%2)
	{
		ans = (ans*a)%MOD;
	}
	
	return ans;
}
