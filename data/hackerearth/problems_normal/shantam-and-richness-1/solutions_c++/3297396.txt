#include <bits/stdc++.h>
#define ll long long
using namespace std;
ll int a[100010];
int main()
{
	ios_base::sync_with_stdio(false);
	cin.tie(NULL);
	ll int test;
	cin>>test;
	while(test--)
	{
		ll int n,m;
		cin>>n>>m;
		memset(a,0,sizeof(a));
		ll int l,r,c,p,q,s;
		cin>>l>>r>>c>>p>>q>>s;
		a[l]+=c;
		a[r+1]-=c;
		ll int i,t,ans,index;
		for(i=1;i<m;i++)
		{
			/*
			L[i] = (L[i-1] * P + R[i-1]) % N + 1;
			R[i] = (R[i-1] * Q + L[i-1]) % N + 1;
			if(L[i] > R[i])
				swap(L[i] , R[i]);
			C[i] = (C[i-1] * S) % 1000000 + 1;
			*/ 
			t=l;
			l=(l*p +r)%n +1;
			r=(r*q +t)%n +1;
			if(l>r)
			{
				t=l;
				l=r;
				r=t;
			}
			c=(c*s)%1000000 +1;
			a[l]+=c;
			a[r+1]-=c;
		}
		t=0;ans=0;
		for(i=1;i<=n;i++)
		{
			t+=a[i];
			a[i]=t;
			if(a[i]>ans)
			{
				ans=a[i];
				index=i;
			}
		}
		cout<<index<<" "<<ans<<endl;
	}
	return 0;
}
