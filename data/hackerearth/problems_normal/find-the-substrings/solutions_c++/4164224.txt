#include<bits/stdc++.h>
using namespace std;
string str;
int main()
{
		//cout << "Hello World!" << endl;
		int t;
		cin>>t;
		while(t--)
		{
				cin>>str;
				long long int cnt = 0;
				int i;
				int j;
				long long int n = str.size();
				long long int c[3];
				c[0] = c[1] = c[2]=0;
				for(i=0,j=0;i<n&&j<n&&i<=j;)
				{
						if(c[0]*c[1]*c[2] > 0)
						{
								cnt+=n-j+1;
								//cout<<"cnt="<<cnt<<endl;
								c[str[i]-'a']--;
								i++;
						}
						else
						{
								c[str[j]-'a']++;
								j++;	
						}
						//j++;
				}
				while(i<n)
				{
						if(c[0]*c[1]*c[2] > 0)
						{
								cnt+=n-j+1;
								//cout<<"cnt="<<cnt<<endl;
								c[str[i]-'a']--;
								i++;
						}
						else break;
						
				}
				//cout<<"n="<<n<<" ";
				cout<<n*(n+1)/2 - cnt<<"\n"; //cnt="<<cnt<<endl;

		}

		return 0;
}

