#include <bits/stdc++.h>

using namespace std;

int N, M, B, Q;
long long dist[501][2001];
long long dp[501][2001];
vector<pair<int, pair<long long, long long>>> adj[501];
struct node
{
    int u, m;
    long long d;
    bool operator< (const node& other) const
    {
        return d>other.d;
    }
};
priority_queue<node> pq;

int main()
{
    int T;
    scanf("%d", &T);
    while(T--)
    {
        pq=priority_queue<node>();
        scanf("%d%d%d", &N, &M, &B);
        for(int i=1; i<=N; i++)
            for(int j=0; j<=B; j++)
                dist[i][j]=0x3f3f3f3f3f3f3f3f;
        int a, b;
        long long c, d;
        for(int i=0; i<=N; i++)
            adj[i].clear();
        for(int i=0; i<M; i++)
        {
            scanf("%d%d%lld%lld", &a, &b, &c, &d);
            adj[a].push_back(make_pair(b, make_pair(c, d)));
        }
        dist[1][0]=0;
        pq.push((node){1, 0LL, 0LL});
        while(!pq.empty())
        {
            int u=pq.top().u;
            long long m=pq.top().m;
            long long d=pq.top().d;
            pq.pop();
            if(d!=dist[u][m])
                continue;
            for(auto& it: adj[u])
            {
                int v=it.first;
                long long x=it.second.first;
                long long y=it.second.second;
                if(m+x<=B && d+y<dist[v][m+x])
                {
                    dist[v][m+x]=d+y;
                    pq.push((node){v, m+x, d+y});
                }
            }
        }
        for(int i=1; i<=N; i++)
        {
            dp[i][0]=dist[i][0];
            for(int j=1; j<=B; j++)
                dp[i][j]=min(dp[i][j-1], dist[i][j]);
        }
        scanf("%d", &Q);
        while(Q--)
        {
            scanf("%d%lld", &a, &c);
            printf("%lld\n", dp[a][c]==0x3f3f3f3f3f3f3f3f?-1:dp[a][c]);
        }
    }
    return 0;
}
