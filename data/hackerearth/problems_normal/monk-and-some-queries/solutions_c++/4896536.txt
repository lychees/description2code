#include <bits/stdc++.h>

using namespace std;

#define INF (1<<29)

int cnt[100001];
int length = 0;

int main() {
    int N;
    cin >> N;
    priority_queue<int> maximum;
    priority_queue<int> minimum;
    for (int i = 0; i < N; i++) {
    	int t;
    	cin >> t;
    	if (t == 1) {
    		int x;
    		cin >> x;
    		cnt[x]++;
    		maximum.push(x);
    		minimum.push(-x);
    	}
    	if (t == 2) {
    		int x;
    		cin >> x;
    		if (cnt[x] == 0)
    			cout << -1 << endl;
    		else
    			cnt[x]--;
    	}
    	if (t == 3) {
    		while (!maximum.empty() && cnt[maximum.top()] == 0) {
    			maximum.pop();
    		}
    		if (!maximum.empty())
    			cout << maximum.top() << endl;
    		else
    			cout << -1 << endl;
    	}
    	if (t == 4) {
	   		while (!minimum.empty() && cnt[-minimum.top()] == 0) {
	    		minimum.pop();
	    	}
	    	if (!minimum.empty())
	    		cout << -minimum.top() << endl;
	    	else
	    		cout << -1 << endl;
    	}
    }
    return 0;
}
