#include<bits/stdc++.h>
#define MAX 100100
#define mod 1000000007
#define MS0(x) memset(x, 0, sizeof(x))
#define ll long long int
#define in(x) scanf("%I64d", &x)
#define ind(x) scanf("%d", &x)
#define F first 
#define S second 
#define mp make_pair
#define pb push_back
#define pid pair<int,double>
#define pii pair<int,int> 
#define p_q priority_queue
using namespace std;
string to_string(int x)
{
    string s="";
    while(x!=0)
    {
        int d=x%10;
        s+=d+'0';
        x/=10;
    }
    reverse(s.begin(),s.end());
    return s;

}
int main() 
{

 ios_base::sync_with_stdio(false);
 cin.tie(NULL);
 int t,tc;
 cin>>tc;
 for(t=0;t<tc;t++)
 {
 	int i,n,m,z;
 	cin>>n>>m;
 	int vis[5005]={0};
 	vector<int> v[5005];
 	int x[40005],y[40005];
 	for(i=1;i<=m;i++)
 	{
 		cin>>x[i]>>y[i];
 	}
 	for(i=0;i<(n-1);i++)
 	{
 		cin>>z;
 		v[x[z]].push_back(y[z]);
 		v[y[z]].push_back(x[z]);
 	}
 	queue<int>q;
 	q.push(x[z]);
 	while(!q.empty())
 	{
 		int k=q.front(),i;
 		q.pop();
 		vis[k]=1;
 		for(i=0;i<v[k].size();i++)
 		{
 			if(vis[v[k][i]]==0)
 			q.push(v[k][i]);
 		}
 	}
 	int c=0;
 	for(i=1;i<=n;i++)
 	{
 		if(vis[i]==1)
 		c++;
 	}
 	
 	if(c==n)
 	cout<<"YES"<<"\n";
 	else
 	cout<<"NO"<<"\n";
 }
	return 0;
}