#include <stdio.h>
#define lli long long int
#define MOD 1000000007

lli F[50];
lli G[50];
lli H[50];

lli pot(lli base, lli p) {
	lli res = 1;
	while(p > 0) {
		res *= base;
	}
	return res;
}

int main(void) {
	int a, b, c, d, e, f;
	int q;
	int n;

	scanf(" %d %d %d %d %d %d", &a, &b, &c, &d, &e, &f);

	/*brute
	F[0] = F[1] = 0;
	G[0] = 0;
	G[1] = 1;
	H[0] = 0;
	H[1] = f;
	for (int i = 2; i < 50; i++) {
		F[i] = a * F[i - 1] * G[i - 2] + b * G[i - 1] * F[i - 2];
		G[i] = c * G[i - 1] * F[i - 2] + d * pot(3, F[i - 1]);
		H[i] = e * F[i] + f * G[i];
	}
	for (int i = 0; i < 50; i++) {
		printf("i = %d, f = %lld, g = %lld, h = %lld\n", i, F[i], G[i], H[i]);
	} */

	scanf(" %d", &q);
	while(q--) {
		scanf(" %d", &n);
		if (n == 0) {
			printf("0\n");
		} else if (n == 1) {
			printf("%lld\n", (1LL * f) % MOD);
		} else if (n >= 2) {
			lli res = f + (((1LL * (n - 1) * d) % MOD) * f) % MOD;
			res %= MOD;
			printf("%lld\n", res);
		}
	}
	return 0;
}
	