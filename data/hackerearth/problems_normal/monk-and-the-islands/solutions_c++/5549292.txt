#include<bits/stdc++.h>
#define ll long long
#define fill(a,v) memset(a,v,sizeof(a))
using namespace std;
int main()
{
    ll t;
    cin>>t;
    while(t--)
{

 ll n,i,x,y,m;
 cin>>n>>m;
 vector<ll>v[n+1];
    for(i=0;i<m;i++)
    {
     cin>>x>>y;
     v[x].push_back(y);
     v[y].push_back(x);
    }

queue<ll>q;
    ll dist[100005];
    fill(dist,-1);
    q.push(1);
    dist[1]=0;
    while(!q.empty())
    {
      ll p=q.front();
       q.pop();
      for(i=0;i<v[p].size();i++)
      {
        if(dist[v[p][i]]==-1)
         {
          q.push(v[p][i]);
           dist[v[p][i]]=dist[p]+1;
         }
      }
    }
    cout<<dist[n]<<endl;
}
    return 0;
    }
