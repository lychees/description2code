#include <bits/stdc++.h>
using namespace std;

int main()
{
   // cout << "Hello World!" << endl;
   multiset<int> s;
   multiset<int>::iterator I;
   int q;
   scanf("%d",&q);
   while(q--)
   {
   	int ty,x;
   	scanf("%d",&ty);
   	if(ty==1)
   	{
   		scanf("%d",&x);
   		s.insert(x);
   	}
   	else if(ty==2)
   	{
   		scanf("%d",&x);
   		I = s.find(x);
   		if(I==s.end())printf("-1\n");
   		else s.erase(I);
   	}
   	else if(ty==4)
   	{
   		if(s.size()==0)printf("-1\n");
   		else printf("%d\n",*s.begin());
   	}
   	else {
   		if(s.size()==0)printf("-1\n");
   		else {
   			I = s.end();
   			I--;
   			printf("%d\n",*I);
   		}
   	}
   }
    return 0;
}
