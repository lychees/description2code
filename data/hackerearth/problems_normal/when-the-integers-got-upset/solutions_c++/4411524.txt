#include <bits/stdc++.h> 
using namespace std;
int a[20];
int z[20];
int DP[5000][20][20];


int counter(int x)
{
  int c=0;

  while(x!=0)
  {
    x=x&x-1;
    c++;
  }
  return c;
}
int main()
{
  int n;int x,p,q,r;int i;int pi,qi,ri,t;
  cin >> t;

  while(t--)
  {

  cin >> n ;
  
  for(i=1;i<=n;i++)cin >> a[i];
  for(i=1;i<=n;i++)cin >> z[i];

  memset(DP,0,sizeof(DP));
  
  x=1<<n;
  x--;

  for(i=x;i>=0;i--)
  {
    for(pi=0;pi<=n;pi++)
    {
      for(qi=0;qi<=n;qi++)
      {
        if(i==x){
          DP[i][pi][qi]=0;continue;
        }

  
        DP[i][pi][qi]=1000000000;

        if(qi==0 && pi!=0)continue;
        if(pi!=0 && !(1<<(pi-1)&i))continue;
        if(qi!=0 && !(1<<(qi-1)&i))continue;

        for(ri=1;ri<=n;ri++)
        {
          if((1<<(ri-1))&i)continue ;
          DP[i][pi][qi]=min(DP[i][pi][qi],((pi==0)?0:a[pi]^a[qi]^a[ri])*z[counter(i)+1] + DP[i|(1<<(ri-1))][qi][ri]);
        }

        
    }

  }

}


  cout << DP[0][0][0] << endl; 

}

  return 0;
}



