#include <iostream>
using namespace std;

#define MAX 100000
#define MOD 1000000007

int A[MAX];
int leftm[MAX];

int main()
{
	int t,N;
	int leftmax,rightmax,curr;
	int ans;
	
    cin >> t;
    
    while(t--){
    	cin >> N;
    	for(int i = 0;i < N;i++)
    		cin >> A[i];
    		
    	leftmax = 0;
    	for(int i = 0;i < N;i++){
    		leftm[i] = leftmax;
    		leftmax = max(A[i],leftmax);
    	}
    	ans = 0;
    	rightmax = 0;
    	for(int i = N - 1;i >= 0;i--){
    		curr = min(leftm[i],rightmax);
    		if(curr > A[i])
    			ans = (ans + curr-A[i])%MOD;
    		rightmax = max(A[i],rightmax);
    	}
    	cout << ans << endl;
    	
    }
    return 0;
}
