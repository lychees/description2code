noOfTestCases = int(raw_input())


def summary(porder, persons, transactions):
    for t in transactions:
        persons[t['payee']] += (t['amount'] /
                                len(t['paidTo'])) * len(t['paidTo'])
        for p in t['paidTo']:
            persons[p] -= (t['amount'] / len(t['paidTo']))

    for personName in porder:
        if (persons[personName] > 0):
            print personName + " is owed " + str(persons[personName])
        elif (persons[personName] < 0):
            amount = abs(persons[personName])
            print personName + " owes " + str(amount)
        else:
            print personName + " neither owes nor is owed"


for caseNo in range(1, noOfTestCases + 1):
    noOfPersons, noOfTransactions = raw_input().split(" ")
    noOfPersons, noOfTransactions = int(noOfPersons), int(noOfTransactions)
    persons = {}
    porder = []
    for pno in range(1, noOfPersons + 1):
        p = raw_input()
        persons[p] = 0
        porder.append(p)

    transactions = []

    for tno in range(1, noOfTransactions + 1):
        transaction = {}
        transaction['payee'] = raw_input()
        transaction['amount'] = int(raw_input())
        splitCount = int(raw_input())

        transaction['paidTo'] = []

        for s in range(1, splitCount + 1):
            transaction['paidTo'].append(raw_input())

        transaction['paidTo'].append(transaction['payee'])

        transactions.append(transaction)

    summary(porder, persons, transactions)
