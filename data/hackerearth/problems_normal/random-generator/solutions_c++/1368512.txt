#include <bits/stdc++.h>
using namespace std;
#define int long long
vector <int> d;
int bin (int a)
{
	int lo=0, hi=d.size()-1; 
	while (hi>lo)
	{
		int mid=(lo+hi)/2; 
		if (d[mid]>a)
		{
			hi=mid-1; 
		}
		else
		{
			if (mid==d.size()-1) return mid; 
			if (d[mid+1]<=a)
			{
				lo=mid+1; 
			}
			else return mid; 
		}
	}
	return lo; 
}
main()
{
    int a; cin >> a;
    for (int g=0; g<a; g++)
    {d.clear(); 
    	int N, K, P; cin >> N >> K >> P; 
    	for (int y=0; y<N; y++)
    	{
    		int e; cin >> e; d.push_back(e); 
    	}
    	sort(d.begin(), d.end()); 
    	int rr=1; 
    	for (int y=0; y<d.size(); y++)
    	{
    		int upper=d[y]+2*P; 
    		int r=bin(upper); 
    		if (r-y+1>=K)
    		{
    			cout << "NO" << '\n';rr=0; break; 
    		}
    	}
    	if (rr) cout <<"YES" << '\n'; 
    }
    return 0;
}
