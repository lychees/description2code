#include <bits/stdc++.h>
#define sc(x) scanf("%d",&(x))
#define scc(x) scanf("%c",&(x))

using namespace std;
typedef long long ll;
const long long mod = 1000000007ll;
char s1[]="_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#";
char s2[]="#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_#_";
char s3[]="12121212121212121212121212121212";
char s[32];
char a[2001][2001];
char b[2001][2001];
int flag=0;
void horizontal_match(int no,int idx,int n){
	flag=0;
	if(no==1){for(int j=0;j<32;j++)s[j]=s1[j];}
	else {for(int j=0;j<32;j++)s[j]=s2[j];}
	int i=0;
	while(i<=n-32){
		if(flag==0){
			int g=0;
			for(int j=0;j<32;j++){
				if(a[idx][i+j]!=s[j]){g=1;i+=max(1,j);break;}
			}
			if(g==0){b[idx][i]=no+'0';flag=1;i+=2;}//cout<<"idx "<<idx<<" i "<<i<<endl;
		}
		else if(flag==1){
			int g=0;
			for(int j=30;j<32;j++){
				if(a[idx][i+j]!=s[j]){g=1;i+=max(1,j);break;}
			}
			if(g==0){b[idx][i]=no+'0';flag=1;i+=2;}
			else if(g==1){flag=0;}
		}
	}
}

void vertical_match(int idx,int n){
	flag=0;
	for(int j=0;j<32;j++)s[j]=s3[j];	
	int i=0;
	while(i<=n-32){
		if(flag==0){
			int g=0;
			for(int j=0;j<32;j++){
				if(b[i+j][idx]!=s[j]){g=1;i+=max(1,j);break;}
			}
			if(g==0){a[i][idx]='1';flag=1;i+=2;}//cout<<"idx "<<idx<<" i "<<i<<endl;
		}
		else if(flag==1){
			int g=0;
			for(int j=30;j<32;j++){
				if(b[i+j][idx]!=s[j]){g=1;i+=max(1,j);break;}
			}
			if(g==0){a[i][idx]='1';flag=1;i+=2;}
			else if(g==1){flag=0;}
		}
	}
}


int main(){
	//freopen("input.txt","r",stdin);
	int n,m;
	int count=0;
	sc(n);sc(m);
	char c;
	//printf("%s\n",s1);
	for(int i=0;i<n;i++){
		scc(c);
		for(int j=0;j<m;j++){
			scc(a[i][j]);
			b[i][j]='0';
		}
	}
	for(int i=0;i<n;i++){
		horizontal_match(1,i,n);
		horizontal_match(2,i,n);
	}
	for(int i=0;i<n;i++){
		for(int j=0;j<m;j++){
			a[i][j]='0';
		}
	}
	for(int i=0;i<m;i++){
		vertical_match(i,n);
	}
	for(int i=0;i<n;i++){
		for(int j=0;j<m;j++){
			if(a[i][j]=='1')count++;
		}
	}
	cout<<count<<endl;
	

	

}	