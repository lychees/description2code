#include <iostream>
using namespace std;
int pr[5000000],h[5000000]={0};
void generate_primes()
{
        int i,j,k,f,n;
        pr[0]=2;
        k=1;
        h[2]=1;
        for(i=3;i<=5*1000000;i+=2)
        {
            f=0;
            for(j=0;pr[j]*pr[j]<=i;j++)
            {
            
                if(i%pr[j]==0)
                {   f=1;
                    break;
                } 
                
            }
            if(f==0)
            {
                pr[k++]=i;
                h[i]=1;
            }
        }
}
 
int main()
{
	long long q,x,y;
	generate_primes();
	scanf("%lld",&q);
	while(q--)
	{
	 scanf("%lld%lld",&x,&y);
	//	xc=x;yc=y;
		long long ans=0;
		while(x!=y)
		{
			if(x>y)
			{
				if(h[x]==1)
				ans-=x;
				else
				ans+=x;
				x=x/2;
			    
			}
			else 
			{
				
				if(h[y]==1)
				ans-=y;
				else
				ans+=y;
				y/=2;
			
			}
		}
		
				if(h[x]==1)
				ans-=x;
				else
				ans+=x;
				printf("%lld\n",ans);
	}
 return 0;
}
