#include <iostream>
#define MOD 1000000007
#define LL long long
using namespace std;

int n;
int bit[100001];
LL pow2[100001];
void update(int i,int v)
{
	while(i<=n)
	{
		bit[i]+=v;
		i+=(i&-i);
	}
}
int query(int i)
{
	int ret=0;
	while(i>0)
	{
		ret+=bit[i];
		i-=(i&-i);
	}
	return ret;
}
bool check[100001];
int arr[200001];
int main()
{
    scanf("%d",&n);
    pow2[0]=1;
    int d=0;
    LL ans=0;
    for(int i=1;i<=n;++i)
    {
    	pow2[i]=(pow2[i-1]*2)%MOD;
    }
    for(int i=1;i<=2*n;++i)
    {
    	scanf("%d",&arr[i]);
    	if(!check[arr[i]])
    	{
    		int big=query(n)-query(arr[i]);
    		int small=query(arr[i]-1);
    		if(n>1) ans+=(pow2[n-2]*(small+3*big))%MOD;
    		if(ans>=MOD) ans-=MOD;
    		//printf("%d %d %d\n",big,small,d);
    		check[arr[i]]=1;
    	} else {
    		int big=query(n)-query(arr[i]);
    		int small=query(arr[i]-1);
    		ans+=pow2[n-1];
    		if(ans>=MOD) ans-=MOD;
    		if(n>1) ans+=(pow2[n-2]*(small+3*big))%MOD;
    		if(ans>=MOD) ans-=MOD;
    		//printf("%d %d %d\n",big,small,d);
    	}
    	update(arr[i],1);
    	//printf("%lld\n",ans);
    }
    printf("%lld\n",ans);
    return 0;
}
