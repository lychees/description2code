#include <iostream>
using namespace std;

typedef long long LL;
#define MAX_N 1000010
LL c[MAX_N][3];
void comb()
{
    for(LL i=0; i<MAX_N ;++i)
        for(LL j=0; j<3 && j<=i ; ++j)
        {
            if(i ==0 || j==0)
                c[i][j] = 1;
            else
                c[i][j] = c[i-1][j-1] + c[i-1][j];
        }
}
#define min(a,b) ((a<b)?(a):(b))
int main()
{
    LL t;
    cin >> t ;
    comb();
    while(t--)
    {
    	string s;
    	cin >> s;
    	LL i;
    	LL ia=-1, ib=-1, ic=-1;
    	LL all = 0;
    	for(i =0; i<s.length(); ++i)
    	{
    		if(s[i] == 'a')
    		{
    		    ia = i;
    			if(ib == -1 || ic == -1)
    				continue;
    			all += min(ib,ic)+1 ;
    		}
    		if(s[i] == 'b')
    		{
    		    ib= i;
    			if(ia == -1 || ic == -1)
    				continue;
    			all += min(ia,ic)+1 ;
    		}
    		if(s[i] == 'c')
    		{
    		    ic = i;
    			if(ia == -1 || ib == -1)
    				continue;
    			all += min(ia,ib)+1 ;
    		}
    	}

    	//cout << all << endl;
    	cout << c[s.length()+1][2] - all << endl;
    	}
    return 0;
}
