#include <bits/stdc++.h>
#define SI set<int> 
#define VI vector<int> 
#define ull unsigned long long 
#define inint(a) scanf("%d",&a)
#define input(a) cin>>a
#define ll long long 
#define print(a) cout<<a
#define printn(a) cout<<a<<"\n"
#define f first
#define s second
#define len(s) s.length()
#define range(a,b,n) for(int i=a;i<b;i+=n)
using namespace std;
int f;
int visited[5005];
int v[5005][5005];
int n,m;
void dfs(int x){
	visited[x]=1;
	//cout<<x<<" visited. ";
	for(int i=1;i<=n;i++){
		if(v[x][i]==1){
		if(!visited[i]){
			dfs(i);
		} 
		//else f=-1;
		}
	}
}
int main()
{
    //cout << "Hello World!" << endl;
    int t;
    inint(t);
    while(t--){
    	
    	memset(visited,0,sizeof visited);
    	
    	inint(n);
    	inint(m);
    	for(int i=0;i<=n;i++){
    		for(int j=0;j<=n;j++)
    			{v[i][j]=0;}
    	}
    	vector<pair<int,int> > no(m);
    	for(int i=0;i<m;i++){
    		int a,b;
    		inint(a);
    		inint(b);
    		no[i]=make_pair(a,b);
    	}
    	//f=0;
    	for(int i=0;i<n-1;i++){
    		int p;
    		inint(p);
    		int a=no[p-1].f,b=no[p-1].s;
    		//cout<<a<<" "<<b<<"\n";
    		v[a][b]=1;
    		v[b][a]=1;
    	}
    	dfs(1);
    	int flag=0;
    	for(int i=1;i<=n;i++){
    		if(!visited[i]){flag=1;break;}
    	}
    	//cout<<f<<" "<<flag<<"\n";
    	if(flag)cout<<"NO\n";
    	else cout<<"YES\n";
    }
    return 0;
}
