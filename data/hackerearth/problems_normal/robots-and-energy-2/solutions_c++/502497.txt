#include <iostream>
#include <map>
#define MOD 1000000007

using namespace std;

map<string,int> ma;
int n,m,arr[11][11],c,x1,x2,y1,y2,d;
long long adj[110][110];
long long res[110][110];

int uni(string str)
{
	ma.clear();
	int l = str.size();
	for(int i=0;i<l;i++) {
		for(int j=i;j<l;j++) {
			int a=i,b=j;
			string s;
			s = "";
			bool f = 1;
			while(a <= j) {
				s += str[a];
				f &= (str[a]==str[b]);
				a++,b--;
			}
			if(f) {
				ma[s]++;
				//cout << s << " " << ma[s] << endl;
			}
		}
	}
	return ma.size();
}

void multiply(long long x[][110],long long y[][110],int t)
{
	int l = n*m;
	long long resi[110][110] = {0};
	for(int i=0;i<l;i++) {
		for(int j=0;j<l;j++) {
			resi[i][j] = 0;
			for(int k=0;k<l;k++) {
				resi[i][j] = (resi[i][j] + x[i][k]*y[k][j])%MOD;
			}
		}
	}
	
	if(t==1) for(int i=0;i<l;i++) for(int j=0;j<l;j++) res[i][j] = resi[i][j];
	else for(int i=0;i<l;i++) for(int j=0;j<l;j++) adj[i][j] = resi[i][j];
}

int main()
{
	string str;
    cin >> n >> m;
    for(int i=0;i<n;i++) for(int j=0;j<m;j++) {
    	cin >> str;
    	arr[i][j] = uni(str);
    	//cout << str << " " << arr[i][j] << endl;
    	adj[i*m+j][i*m+j]=1;
    }
    
    cin >> c;
    for(int i=0;i<c;i++) {
    	cin >> x1 >> y1 >> x2 >> y2;
    	adj[x1*m+y1][x2*m+y2]++;
    	adj[x2*m+y2][x1*m+y1]++;
    }
    
    cin >> d;
    for(int i=0;i<n;i++) for(int j=0;j<m;j++) res[i*m+j][i*m+j]=1;
    while(d) {
    	if(d&1) multiply(res,adj,1);
    	multiply(adj,adj,2);
    	d >>= 1;
    }
    
    for(int i=0;i<n;i++) {
    	for(int j=0;j<m;j++) {
    		long long ans = 0;
    		for(int k=0;k<n;k++) {
    			for(int l=0;l<m;l++) {
    				ans = (ans + (arr[k][l]*res[i*m+j][k*m+l])%MOD)%MOD;
    			}
    		}
    		cout << ans << " ";
    	}
    	cout << endl;
    }
    return 0;
}
