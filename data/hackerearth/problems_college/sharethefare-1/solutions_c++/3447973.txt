#include <bits/stdc++.h>

using namespace std;

map < string , int > paid;
map < string , int >  correct;
map < int , string > order;

int main()
{
    int t , n ,  m , q, amount, money;
    string s , c;

    cin >> t;

    while(t--){

        cin >> n >> q;

        correct.clear();
        paid.clear();
        order.clear();

        for(int i = 0; i < n; i++){

            cin >> s;
            order[i] = s;
        }

        for(int i = 0; i < q; i++){

            cin >> s;
            cin >> amount >> m;
            money = amount / (m + 1) + amount % (m + 1);
            paid[s] += amount;
            correct[s] += money;

            money = amount / (m + 1);

            for(int j = 0; j < m; j++){

                cin >> s;
                correct[s] += money;
            }
        }

        for(int i = 0; i < n; i++){

            s = order[i];
            amount = correct[s] - paid[s];

            if(amount == 0) cout << s << " neither owes nor is owed\n";
            else if (amount > 0) cout << s << " owes " << amount << "\n";
            else cout << s << " is owed " << -amount << "\n";
        }

    }

    return 0;
}
