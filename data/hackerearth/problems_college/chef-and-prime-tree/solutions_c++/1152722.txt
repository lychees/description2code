/*
*/
 
//#pragma comment(linker, "/STACK:16777216")
#include <fstream>
#include <iostream>
#include <string>
#include <complex>
#include <math.h>
#include <set>
#include <vector>
#include <map>
#include <queue>
#include <stdio.h>
#include <stack>
#include <algorithm>
#include <list>
#include <ctime>
#include <memory.h>
#include <ctime> 
 
#define y0 sdkfaslhagaklsldk
#define y1 aasdfasdfasdf
#define yn askfhwqriuperikldjk
#define j1 assdgsdgasghsf
#define tm sdfjahlfasfh
#define lr asgasgash
 
#define eps 1e-11
//#define M_PI 3.141592653589793
#define bs1 1000000007ll
#define bs2 1000000009ll
#define P1 173
#define P2 187
#define bsize 256
#define right adsgasgadsg
#define free adsgasdg
 
using namespace std;

long pr[1<<23];
long a,b,tests,res;

long mov(long x)
{
 if (pr[x])res+=x;
 else res-=x;
 x/=2;return x;
}

int main(){
//freopen("lesson.in","r",stdin);
//freopen("lesson.out","w",stdout);
//freopen("C:/input.txt","r",stdin);
//freopen("C:/output.txt","w",stdout);
ios_base::sync_with_stdio(0);
//cin.tie(0);

pr[1]=1; // WTF
for (int i=2;i<=1000000;i++)
 if (pr[i]==0)
  for (int j=i*2;j<=5000000;j+=i)
   pr[j]=1;

cin>>tests;
for (;tests;--tests)
{
 cin>>a>>b;
 res=0;
 while (a!=b)
 {
  if (a>b)
  {
   a=mov(a);
  } 
  else
  {
   b=mov(b);
  }
 }
 if (pr[a]==0)res-=a;
 else res+=a;
 cout<<res<<endl;
}

cin.get();cin.get();
return 0;}
