#include<bits/stdc++.h>
#define ll long long
using namespace std;

int main()
{
    ll q,q1,x;
    cin>>q;
    priority_queue<ll>pq;
    priority_queue<int,vector<int>,greater<int> >pq1;
    map<ll,ll>m;
    while(q--)
    {
    	cin>>q1;
    	if(q1==1)
    	{
    	  cin>>x;
    	  m[x]++;
    	  pq.push(x);
    	  pq1.push(x);
    	  continue;
    	} 
    	if(q1==2)
    	{
    		cin>>x;
    		if(m[x])
    			m[x]--;
    		else
    		   cout<<"-1\n";
    	continue;
    	}
    	else if(q1==3)
    	{
    		while(pq.size() && m[pq.top()] == 0) {
				pq.pop();
			}
			if(pq.size()) {
				cout<<pq.top()<<endl;
			}
			else {
				cout<<"-1\n";
			}
    	continue;	
    	}
    	else
    	{
    	while(pq1.size() && m[pq1.top()] == 0) {
				pq1.pop();
			}
			if(pq1.size()) {
			 cout<<pq1.top()<<endl;
			}
			else {
				cout<<"-1\n";
			}
			continue;
    	}
    }
    return 0;
}
