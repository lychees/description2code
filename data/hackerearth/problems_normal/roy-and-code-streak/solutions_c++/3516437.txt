#include<iostream>
#include<cstdio>
#include<set>
#include<string>
using namespace std;
int main()
{
    int i,j,k;
    int n;
    int t;
    scanf("%d",&t);
    while(t--)
    {
       set<int> god;
       scanf("%d",&n);
       int a[n][2];
       k=n;
       i=0;
       while(k--)
       {
          scanf("%d %d",&a[i][0],&a[i][1]);
          i++;
       }
       int ma=0;
       //printf("hey..\n");
       for(i=0;i<n;i++)
       {
         set<int> s;
         set<int>:: iterator it;
         if(a[i][1]==1)
         {
             int ct=0;
             j=i;
             while(a[j][1]!=0&&j<n)
             {
                s.insert(a[j][0]);
                j++;
             }
              int ini = god.size();
                 god.insert(s.begin(),s.end());
                 int fina = god.size();
                 ct=fina-ini;
             if(ct>ma)
             ma=ct;
             i=j;
             //s.clear();
         }
       }
       printf("%d\n",ma);
    }
}
