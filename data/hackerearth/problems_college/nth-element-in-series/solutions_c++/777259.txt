//BIG OH

#include<cstdio>
#include<algorithm>
#include<cmath>
#include<sstream>
#include<iostream>
#include<vector>
#include<stdlib.h>
#include<cstring>
#include<stack>
#include<queue>

using namespace std;
#define ll long long
#define mod 1000000007
#define gc getchar_unlocked

int read() {int nm=0;char ch=gc(); while(ch<'0'||ch>'9') ch=gc(); while(ch>='0'&&ch<='9') {nm=(nm<<1)+(nm<<3)+ch-'0';ch=gc();} return nm;}
typedef vector<vector<ll> > dp;
int a,b,c,d,e;
const int K = 5;
#define fr(i,n) for (int i = 1; i <= n; i++)
dp mul(dp A, dp B)
{
    dp ab(K+1, vector<ll>(K+1));
    fr(i, K) fr(j, K) fr(k, K)
        ab[i][j] = (ab[i][j] + A[i][k] * B[k][j]) % mod;
    return ab;
}

dp pow(dp A, int p)
{
    if (p == 1)
        return A;
    if (p % 2)
        return mul(A, pow(A, p-1));
    dp temp = pow(A, p/2);
    return mul(temp, temp);
}
int  call(int N)
{
    vector<ll> cd(K+1);
   cd[1] = a;
   cd[2] = b;
   cd[3]= c;
   cd[4]= d;
   cd[5]= e;
   dp T(K+1, vector<ll>(K+1));
    T[1][1] = 0, T[1][2] = 1; T[1][3]=0;T[1][4]=0;T[1][5]=0;
    T[2][1] = 0, T[2][2] = 0; T[2][3]=1; T[2][4]=0;T[2][5]=0;
    T[3][1] = 0, T[3][2] = 0; T[3][3]=0; T[3][4]=1;T[3][5]=0;
    T[4][1] = 0, T[4][2] = 0; T[4][3]=0; T[4][4]=0;T[4][5]=1;
    T[5][1] = 1, T[5][2] = 2; T[5][3]=1; T[5][4]=1;T[5][5]=1;

    T = pow(T, N);
    ll ans = 0;
    ans=0;
    fr(i, K)
     {
        ans = (ans + T[1][i] * cd[i]) % mod;
  
    }
    return ans;
}
int main()
{
    int t;
   t=read();
    while(t--)
    {
        a=read();
        b=read();c=read();d=read();e=read();
        int n;
        n=read();
        if(n==0)
         cout<<a<<endl;
        else if(n==1)
         cout<<b<<endl;
        else if(n==2)
         cout<<c<<endl;
        else if(n==3)
         cout<<d<<endl;
        else if(n==4)
        cout<<e<<endl;
        else
        printf("%d\n",call(n));
    }
}