#include <bits/stdc++.h>

using namespace std;

int solve(int a[][502],int m,int n)
{
	int maxy = 0;
	for(int i = 1;i <= m;i++)
	{
		for(int j = 1;j <= n;j++)
		{
			if(a[i][j] == 1)
			{
				if(a[i-1][j-1] == 0)
					a[i][j] = 1;
				else
				{
					int x = a[i-1][j-1];
					int ti = i,tj = j,flag = 0;
					int k = 1;
					while(k <= x)
					{
						if(ti-k > 0)
						{
							if(a[ti-k][j] != 0)
							{
								flag = 1;
								goto endwhile;
							}
						}
						if(tj-k > 0)
						{
							if(a[i][tj-k] != 0)
							{
								flag = 1;
								goto endwhile;
							}
						}
						k++;
					}
					endwhile:
					{}
					if(flag == 1)
						a[i][j] = k;
					else
						a[i][j] = a[i-1][j-1] + 1;
				}
				maxy = max(maxy,a[i][j]);
			}
		}
	}
	return maxy;
}

int main()
{
	int t;
	scanf("%d",&t);
	while(t--)
	{
		int m,n;
		scanf("%d %d",&m,&n);
		int a[502][502];
		for(int i = 0;i <= m;i++)
		{
			for(int j = 0;j <= n;j++)
			{
				if(i == 0 || j == 0)
					a[i][j] = 0;
				else
					scanf("%d",&a[i][j]);
			}
		}
		printf("%d\n",solve(a,m,n));
	}
	return 0;
}