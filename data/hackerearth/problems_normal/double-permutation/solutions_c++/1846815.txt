#include <cstdio>

using namespace std;

const int N = 200010, mod = 1000000007;
int n, a[N];
long long s, p, q;
bool f[N];

struct BIT
{
    int t[N];

    void upd(int i, int v)
    {
        for (; i <= n; i += i & -i) t[i] += v;
    }

    int get(int i)
    {
        int s = 0;
        for (; i; i -= i & -i) s += t[i];
        return s;
    }
};

BIT bit0, bit1;

int main()
{
    scanf("%d", &n);
    if (n == 1)
    {
        printf("1");
        return 0;
    }
    for (int i = 1; i <= 2 * n; i++) scanf("%d", &a[i]);
    p = 1;
    for (int i = 1; i <= n - 2; i++) p = p * 2 % mod;
    q = p * 2 % mod;
    for (int i = 2 * n; i; i--)
    {
        if (!f[a[i]])
        {
            f[a[i]] = true;
            bit0.upd(a[i], 1);
        } else
        {
            bit0.upd(a[i], -1);
            bit1.upd(a[i], 1);
            s = (s + q) % mod;
        }
        s = (s + p * (3 * bit0.get(a[i] - 1) + bit0.get(n) - bit0.get(a[i]))) % mod;
        s = (s + q * (3 * bit1.get(a[i] - 1) + bit1.get(n) - bit1.get(a[i]))) % mod;
    }
    printf("%lld", s);
    return 0;
}
