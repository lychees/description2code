#include<iostream>
#define max 100005
using namespace std;

long long arr[max];
long long diffLeft[max];
long long diffRight[max];

long long min(long long a,long long b){
	if(a>b) return b;
	else return a;
}

int main(){
	int t;
	long long n,element;
	cin >> t;
	while(t--){
		cin >> n;
		for(int i=0;i<n;i++){
			cin >> element;
			arr[i]=element;
		}
		
		long long maxLeft = arr[0];
		
		for(int i=1;i<n;i++){
			
			if(arr[i]>maxLeft) maxLeft =arr[i];
			
			if(arr[i]<maxLeft) diffLeft[i]= (maxLeft-arr[i]);
			
			else diffLeft[i]=0;
			
		}
		
		long long maxRight = arr[n-1];

		for(int i=n-2;i>=0;i--){
			
			if(arr[i]>maxRight) maxRight =arr[i];
			
			if(arr[i]<maxRight) diffRight[i]= (maxRight-arr[i]);
			
			else diffRight[i]=0;
			
		}
		long long sum=0;
		
		if(n==1 || n==2) sum=0;
		
		else{
			
		for(int i=1;i<n-1;i++){
			sum += min(diffLeft[i],diffRight[i]);
			sum=sum%(1000000007);
		}
		}
		cout<<sum<<endl;
		
	}return 0;
}