#include <bits/stdc++.h>

using namespace std;
#define MAXN 33000
int N,Q,x,y,arr[MAXN],ft[MAXN];
char C[5];

void update(int index,int val){
    for (int i=index;i<MAXN;i+=(i & -i))
        ft[i]+=val;
}

int sum(int index){
    int sum = 0;
    for (int i=index;i;i-=(i & -i))
        sum+=ft[i];
    return sum;
}

int main()
{
    bool prime[1000005];
    memset(prime,true,sizeof prime);
    prime[0]=prime[1]=false;
    for (int i=2;i<1000005;i++){
        if (prime[i]){
            for (int j=i+i;j<1000005;j+=i){
                prime[j]=false;
            }
        }
    }
    int T;
    scanf("%d",&T);
    while (T--){
        memset(ft,0,sizeof ft);
        scanf("%d",&N);
        for (int i=1;i<=N;i++){
                scanf("%d",&arr[i]);
                if (prime[arr[i]])
                    update(i,1);
        }
        scanf("%d",&Q);
        while (Q--){
            scanf("%s",&C);
            if (C[0]=='C'){
                scanf("%d%d",&x,&y);
                if (prime[arr[x]])
                    update(x,-1);
                arr[x]=y;
                if (prime[y])
                    update(x,1);
            }
            else {
                scanf("%d%d",&x,&y);
                printf("%d\n",sum(y)-sum(x-1));
            }
        }
    }
}
