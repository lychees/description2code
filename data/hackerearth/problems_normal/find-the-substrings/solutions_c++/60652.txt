#include <iostream>
#include <cstdio>
using namespace std;
char s[1000002];
int main()
{
    int t;
    scanf("%d",&t);
    while(t--)
    {
    	int a_prev=-1;
    	int b_prev=-1;
    	int c_prev=-1;
    	long long sol=0;
    	bool isa=false;
    	bool isb=false;
    	bool isc=false;
    	int star_indx=0;
    	scanf("%s",s);
    	int i;
    	for(i=0;s[i]!='\0';++i)
    	{
    		
    		if(isa==true&&isb==true&&s[i]=='c')
    		{
    			
    			if(s[i-1]=='a')
    			{
    				isb=false;
    				int k=(i-star_indx);
    				sol+=(long long)(k)*(long long)(k+1)/2;
    				star_indx=b_prev+1;
    			long long z=i-star_indx;
    				sol-=z*(z+1)/2;
    			}
    			else
    			{
    			    isa=false;
    				int k=(i-star_indx);
    				sol+=(long long)(k)*(long long)(k+1)/2;
    				star_indx=a_prev+1;	
    				long long z=i-star_indx;
    				sol-=z*(z+1)/2;
    			}
    		}
    		else if(isc==true&&isb==true&&s[i]=='a')
    		{
    			if(s[i-1]=='c')
    			{
    				isb=false;
    				int k=(i-star_indx);
    				sol+=(long long)(k)*(long long)(k+1)/2;
    				star_indx=b_prev+1;
    				long long z=i-star_indx;
    				sol-=z*(z+1)/2;
    			}
    			else
    			{
    			    isc=false;
    				int k=(i-star_indx);
    				sol+=(long long)(k)*(long long)(k+1)/2;
    				star_indx=c_prev+1;	
    				long long z=i-star_indx;
    				sol-=z*(z+1)/2;
    			}
    		}
    		else if(isa==true&&isc==true&&s[i]=='b')
    		{
    			if(s[i-1]=='a')
    			{
    				isc=false;
    				int k=(i-star_indx);
    				sol+=(long long)(k)*(long long)(k+1)/2;
    				
    				star_indx=c_prev+1;
    				long long z=i-star_indx;
    				sol-=z*(z+1)/2;
    			}
    			else
    			{
    			    isa=false;
    				int k=(i-star_indx);
    				sol+=(long long)(k)*(long long)(k+1)/2;
    			
    				star_indx=a_prev+1;
    				long long z=i-star_indx;
    				sol-=z*(z+1)/2;
    			}
    		}
    		if(s[i]=='a')
    		{
    			isa=true;
    			a_prev=i;
    		}
    		else if(s[i]=='b')
    		{
    			isb=true;
    			b_prev=i;
    		}
    		else
    		{
    		isc=true;
    		c_prev=i;
    	}
    	}
    	int k=(i-star_indx);
    	sol+=(long long)(k)*(long long)(k+1)/2;
    				printf("%lld\n",sol);
    	
    	
    }
    return 0;
}
