import sys
t = int(raw_input())
for i in xrange(t):
    noOfPeople, noOfQuery = map(int, sys.stdin.readline().split())
    K = []
    V = []
    for i in xrange(noOfPeople):
        name = raw_input()
        K.append(name)
        V.append(0)
    owesArray = dict(zip(K, V))
    owedArray = owesArray.copy()
    for i in xrange(noOfQuery):
        paidBy = str(raw_input())
        bill = int(raw_input())
        currentValue = owedArray[paidBy]
        owedArray[paidBy] = bill+currentValue
        noOfPresent = int(raw_input())
        amountPerHead = bill/(noOfPresent+1)
        bill = bill - amountPerHead*noOfPresent
        remaining = owesArray[paidBy]
        owesArray[paidBy] = remaining+bill
        for j in xrange(noOfPresent):
            name = str(raw_input())
            previous = owesArray[name]
            owesArray[name] = amountPerHead+previous
    for i in K:
        currentAmount = owedArray[i]-owesArray[i]
        if (currentAmount > 0):
            print i, "is owed", currentAmount
        if (currentAmount == 0):
            print i, "neither owes nor is owed"
        if (currentAmount < 0):
            print i, "owes", abs(currentAmount)
