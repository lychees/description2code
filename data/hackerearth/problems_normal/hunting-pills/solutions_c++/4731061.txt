#include<bits/stdc++.h>
using namespace std;
const int MAX=20001;

int n;
int color[MAX];

int mini(vector <int> adj[], int p, int *j, int z[])
{

//cout<<"HI"<<p;
color[p]=1;

int u=p;


		for(int i=0;i<adj[u].size();i++)
            {
			int y=adj[u][i];
			if(color[y]==0)
                {
				//cout<<"no"<<y;
                mini(adj,y,j,z);

                }
            }

int temp=*j;
z[temp]=u;
*j=temp+1;
}

int mi(vector <int> adj[], int p,int *j)
{
    color[p]=*j;

int u=p;


		for(int i=0;i<adj[u].size();i++)
            {
			int y=adj[u][i];
			if(color[y]==0)
                {
				//cout<<"no"<<y;
                mi(adj,y,j);

                }
            }



	}


int main()
{
int t;
cin>>t;
for(int k=0;k<t;k++)
{
	int m;
    cin>>n>>m;
    int a,b,y[n];
    vector <int> v[n];

    vector <int> va[n];
    for(int i=0;i<n;i++)
        {
            color[i]=0;
        }
    for(int i=0;i<n;i++)
    {
    	cin>>y[i];
    }
    for(int i=0;i<m;i++)
    {
        cin>>a>>b;
        v[a].push_back(b);
		va[b].push_back(a);
	}
    int j=0,z[n];
    for(int i=0;i<n;i++)
        {
            if(color[i]==0)
            {

                mini(va,i,&j,z);
            }
        }
j=1;
for(int i=0;i<n;i++)
        {
            color[i]=0;
        }
for(int i=n-1;i>=0;i--)
        {
            if(color[z[i]]==0)
            {
             mi(v,z[i],&j);
            j++;

            }
             }
            int ma=0,me=0,su=0;
while(j>=0)
{
	for(int i=0;i<n;i++)
{
    if(color[i]==j)
    {
    	su+=y[i];
    }
}
    if(su>ma)
    {
    	ma=su;
    }
    
su=0;
j--;
}
cout<<ma<<endl;
}


}
