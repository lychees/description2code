#include <bits/stdc++.h>
#include <cstdio>
#include <string>
#include <vector>
#include <algorithm>
#include<cstdlib>

using namespace std;

int visited[1001],llistt[1001],cnt;
int sett[1001];
int n,id;
void add(int u,int v)
	{
	int i,temp;
	if(sett[u]==0 && sett[v]==0)
		{
		sett[u]=id;
		sett[v]=id;
		id++;
		}

	else if(sett[u]==0 && sett[v]!=0)
		sett[u]=sett[v];

	else if(sett[u]!=0 && sett[v]==0)
		sett[v]=sett[u];

	else
		{
		temp=sett[u];
		for(i=1;i<=n;i++)
			{
			if(sett[i]==temp)
				sett[i]=sett[v];
			}	
		}

	}

int main()
{
 int t,m,i,j,k,u,v;
 int a[1001],neww[1001];
 t = 1;

 for(i=0;i<t;i++)
 {
	scanf("%d",&n);

	for(j=1;j<=n;j++)
	{
		scanf("%d",&a[j]);
		sett[j]=0;
	}

	id=1;

	for(j=1;j<=n;j++) {
                      string s;
		cin>>s;
		for(int k=1;k<=n;k++) {
                if ( s[k-1] == 'Y' ) add(j,k);
        }
  }


	for(j=1;j<id;j++)
		{
		cnt=0;
		for(k=1;k<=n;k++)
			{
			if(sett[k]==j)
				{
				llistt[cnt]=k;
				neww[cnt]=a[k];	
				cnt++;
				}
			}
		if(cnt>1)
			{
			sort(neww,neww+cnt);
			for(k=0;k<cnt;k++)
				a[llistt[k]]=neww[k];	
			}	
		}

	for(j=1;j<n;j++)
		printf("%d ",a[j]);
	printf("%d\n",a[n]);
	}
return 0;
}