#include <bits/stdc++.h>

using namespace std;

const int MAX_M = 1000007;

int a[MAX_M], b[MAX_M];

int main()
{
	int nt;
	scanf("%d", &nt);
    do {
    	int n, m, p, x;
    	scanf("%d %d %d %d", &n, &m, &p, &x);
    	for (int i = 0; i < m; ++i) {
    		char c = getchar();
    		while (!isdigit(c))
    			c = getchar();
    		a[i] = x^(c == '1');
    	}
    	--n;
    	for (int bit = 0; bit < 30; ++bit) 
    		if ((1<<bit) & n) {
    			int shift = (p*(1ll<<bit))%m;
    			for (int i = 0; i < m; ++i) 
    				b[i] = a[i]^a[(i-shift+m)%m];
    			memcpy(a, b, m<<2);
    		}
    	for (int i = 0; i < m; ++i)
    		putchar('0' + (a[i]^x));
    	putchar('\n');
    }
    while (--nt);
    return 0;
}
