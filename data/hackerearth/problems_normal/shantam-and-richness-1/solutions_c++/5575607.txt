#include<iostream>
#include<vector>
using namespace std;

int main()
{
	int t,n,m;
	long long int l,r,c,p,q,s,temp;
    cin>>t;
    while(t--){
    	cin>>n>>m;
    	vector<long long int> vec(n+2,0);
    	cin>>l>>r>>c>>p>>q>>s;
    	if(l>r){
    		temp=l;
    		l=r;
    		r=temp;
    	}
    	vec[l]+=c;
    	vec[r+1]-=c;
    	for(int i=1;i<m;i++){
    		temp=l;
    		l=(l*p+r)%n + 1;
    		r=(r*q+temp)%n + 1;
    	  if(l>r){
    		temp=l;
    		l=r;
    		r=temp;
    	  }
    	  c=(c*s)%1000000 + 1;
    	  vec[l]+=c;
    	  vec[r+1]-=c;
    	}
    	for(int i=1;i<=n;i++){
    		vec[i]+=vec[i-1];
    	}
    	long long int ans=0;
    	int ind=0;
    	for(int i=1;i<=n;i++){
    		if(vec[i]>ans){
    			ans=vec[i];
    			ind=i;
    		}
    	}
    	cout<<ind<<" "<<ans<<endl;
    }
    return 0;
}
