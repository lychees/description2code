#include <bits/stdc++.h>

using namespace std;

int N, K, P;
long long A[100001];

void solve()
{
    scanf("%d%d%d", &N, &K, &P);
    for(int i=0; i<N; i++)
        scanf("%lld", A+i);
    sort(A, A+N);
    for(int i=0; i<N; i++)
        if(upper_bound(A, A+N, 0LL+A[i]+2LL*P)-A-i>=K)
        {
            printf("NO\n");
            return;
        }
    printf("YES\n");
}

int main()
{
    int T;
    scanf("%d", &T);
    while(T--)
        solve();
    return 0;
}
