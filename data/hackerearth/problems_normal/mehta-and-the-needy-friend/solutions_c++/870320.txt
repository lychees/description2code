#include<stdio.h>
#include<iostream>
#include<string.h>
#include<queue>
#include<algorithm>
#include<string>
#include<map>
#include<set>
#include<fstream>
#include<cmath>
#include<iomanip>
#include<time.h>
#include<stack>
using namespace std;
#define ll long long
#define ull unsigned long long
#define inf 2000000007
#define mod 1000000007
#define pii pair<int,int>
#define vi vector<int>
#define VS vector<string>
#define all(x) x.begin(),x.end()
#define mp make_pair
#define pb push_back
#define x first
#define y second
#define N 500010
#define pi 3.14159265358979323846
#define DBG(vari) cerr<<#vari<<"="<<(vari)<<endl;
#define FOREACH(i,t) for(__typeof(t.begin()) i=t.begin();i!=t.end();i++)

ll dp[20][2][2][2][2];
void cal(int x,int &a,int &b,int &c,int &d)
{
	a=b=c=d=0;
	if(x==2)a=1;
	if(x==3)b=1;
	if(x==5)c=1;
	if(x==6)a=b=1;
	if(x==7)d=1;
	if(x==8)a=1;
}
ll fun(ll n)
{
	int bit[20]={0},m=0,i,j;
	while(n)
	{
		bit[m++]=n%10,n/=10;
	}
	ll ans=0;
	for(i=m-1;i>=0;i--)ans+=dp[i][0][0][0][0];
	//DBG(ans)
	int a=0,b=0,c=0,d=0,ok=1;
	for(i=m-1;i>=0;i--)
	{
		int a1,b1,c1,d1;
		for(j=1;j<bit[i];j++)
		{
			cal(j,a1,b1,c1,d1);
			(a1+=a)%=2;(b1+=b)%=2,(c1+=c)%=2,(d1+=d)%=2;
			ans+=dp[i][a1][b1][c1][d1];
		}
		if(bit[i]==0){ok=0;break;}
		cal(bit[i],a1,b1,c1,d1);
		(a+=a1)%=2;(b+=b1)%=2,(c+=c1)%=2,(d+=d1)%=2;
	}
	if(a==0&&b==0&&c==0&&d==0&&ok)ans++;
	return ans;
}
void find(ll n)
{
	ll ans=0;
	int i,j;n--;
	for(i=1;i<=18;i++)
	{
		if(dp[i][0][0][0][0]<n)n-=dp[i][0][0][0][0];
		else break;
	}
	int a=0,b=0,c=0,d=0;
	for(j=i;j>=1;j--)
	{
		int a1,b1,c1,d1;
		for(int k=1;k<=9;k++)
		{
			cal(k,a1,b1,c1,d1);
			(a1+=a)%=2;(b1+=b)%=2,(c1+=c)%=2,(d1+=d)%=2;
			if(dp[j-1][a1][b1][c1][d1]<n)n-=dp[j-1][a1][b1][c1][d1];
			else {ans=ans*10+k,
			a=a1,b=b1,c=c1,d=d1;break;}
		}
	}
	cout<<ans<<"\n";
}
bool check(int n)
{
	int b[20],m=1;
	while(n)m*=(n%10),n/=10;
	if(m==0)return 0;
	int x=sqrt(m);
	if(x*x==m)return 1;
	return 0;
}
int main()
{
    //freopen("input.txt","r",stdin);
    //freopen("output.txt","w",stdout);
    int i,T,n=0,k,j,m=0;
	dp[0][0][0][0][0]=1;
	ll v;
	for(i=1;i<=18;i++)
	for(int a=0;a<2;a++)
	for(int b=0;b<2;b++)
	for(int c=0;c<2;c++)
	for(int d=0;d<2;d++)
	if((v=dp[i-1][a][b][c][d]))
	{
		for(j=1;j<=9;j++)
		{
			int a1,b1,c1,d1;
			cal(j,a1,b1,c1,d1);
			(a1+=a)%=2;(b1+=b)%=2,(c1+=c)%=2,(d1+=d)%=2;
			dp[i][a1][b1][c1][d1]+=v;
		}
	}
	scanf("%d",&T);
	while(T--)
	{
		ll l,r;cin>>l>>r>>k;
		ll A=fun(l-1);
		ll B=fun(r);
		//DBG(A)DBG(B)
		if(A+k>B){puts("-1");continue;}
		find(A+k);
		int cnt=0;
		/*for(i=l;i<=r;i++)
		{
			if(check(i))cerr<<i<<" ",cnt++;
		}
		DBG(cnt)*/
	}
    return 0;
}