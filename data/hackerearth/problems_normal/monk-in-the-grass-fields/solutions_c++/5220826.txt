#include <bits/stdc++.h>
using namespace std;
int main()
{
    int t; cin>>t;
    while(t--)
    {
        int n,k,x; cin>>n>>k;
        int row[n+1],col[n+1],rm=0,cm=0,dr[k+1],dc[k+1];
        for(int i=0;i<=n;i++)
        	row[i]=0,col[i]=0,dr[i]=0,dc[i]=0;
        for(int i=1;i<=n;i++)
        {
            for(int j=1;j<=n;j++)
                cin>>x,row[i]+=x,col[j]+=x;
        }
        for(int i=1;i<=k;i++)
        {
            x=1;
            for(int j=2;j<=n;j++)
                if(row[x]>row[j]) x=j;
            dr[i]=dr[i-1]+row[x];
            row[x]+=n;
            x=1;
            for(int j=2;j<=n;j++)
                if(col[x]>col[j]) x=j;
            dc[i]=dc[i-1]+col[x];
            col[x]+=n;
        }
        int minans=INT_MAX;
        for(int i=0;i<=k;i++)
            minans=min(minans,dr[i]+dc[k-i]+(i*(k-i)));
        cout<<minans<<endl;
    }
}