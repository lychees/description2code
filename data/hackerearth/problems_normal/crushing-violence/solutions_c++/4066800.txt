#include <iostream>
using namespace std;
#include<cstring>
#define ll long long
int main()
{
    ll t,i,j,k,n,p=0;
    ll cb[1000006];
    ll cg[1000006];
    ll db[1000006];
    ll dg[1000006];
    ll bb[1000006];
    ll bg[1000006];
    ll mx=0;
    
    cin>>t;
    while(t--){
    	p=0;
    	cin>>n;
    	mx=0;
    	memset(db,0,sizeof(ll)*(n+1));
    	memset(dg,0,sizeof(ll)*(n+1));
    	memset(bb,0,sizeof(ll)*(n+1));
    	memset(bg,0,sizeof(ll)*(n+1));
    	for(i=1;i<=n;i++){
    		cin>>cb[i];
    		dg[cb[i]]++;
    	}
    	for(i=1;i<=n;i++){
    		cin>>cg[i];
    		db[cg[i]]++;
    	}
    	for(i=1;i<=n;i++){
    		if(cg[cb[i]]==i){
    			bg[cb[i]]+=db[i]-1;
    		}
    		else{
    			bg[cb[i]]+=db[i];
    		}
    		if(cg[cb[i]]!=i && cg[cb[cg[cb[i]]]]==i){
    			p++;
    		}
    		if(mx<	bg[cb[i]]){
    			mx=	bg[cb[i]];
    		}
    	}
    	for(i=1;i<=n;i++){
    		if(cb[cg[i]]==i){
    			bb[cg[i]]+=dg[i]-1;
    		}
    		else{
    			bb[cg[i]]+=dg[i];
    		}
    		
    		if(cb[cg[i]]!=i && cb[cg[cb[cg[i]]]]==i){
    			p++;
    		}
    		if(mx<	bb[cg[i]]){
    			mx=	bb[cg[i]];
    		}
    	}
    	cout<<mx<<" ";
    	cout<<p/2<<endl;
    }
    return 0;
}
