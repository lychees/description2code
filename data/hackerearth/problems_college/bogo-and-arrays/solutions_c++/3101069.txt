#include<bits/stdc++.h>
using namespace std;
pair <long long int,long long int> ans[1000006],ans1[1000006];
int main()
{   int t;
cin>>t;
while(t--)
{
    vector<long long int>in1,in2 ;
   long long  int n ,q,a,target,i,target1;
   char l,r;
   //fastRead_int(&n),fastRead_int(&q);
    scanf("%lld %lld",&n,&q);
   long long  int val;
    for( i = 0;i<n;++i)
    {
        scanf("%lld",&val),in1.push_back(val),in2.push_back(val);
        
    }
    
    vector<long long int> out1( in1.size(),in1.size()+1) ;
 
    stack<long long int> s1, s2;
    s1.push( in1[0] );
    s2.push( 0 );
    for ( size_t j = 1; j < in1.size(); ++j )
    {
        while ( !s1.empty() && in1[j] > s1.top() )
        {
            size_t out1_j = s2.top();
            out1[ out1_j ] =  j+1;
            s1.pop();
            s2.pop();
 
        }
        s1.push( in1[j] );
        s2.push( j );
    }
    //for ( int i = 0;i<n;++i )
      //  cout << out1[i] << " ";
       // cout<<endl;
  reverse(in2.begin(),in2.end());
  vector<long long int> out2( in2.size(),0) ;
 
    stack<long long int> s3, s4;
    s3.push( in2[0] );
    s4.push( 0 );
    for ( size_t k = 1; k < in2.size(); ++k )
    {
        while ( !s3.empty() && in2[k] >= s3.top() )
        {
            size_t out2_k = s4.top();
            out2[ out2_k ] = n-k;
            s3.pop();
            s4.pop();
 
        }
        s3.push( in2[k] );
        s4.push( k );
    }
    reverse(out2.begin(),out2.end());
   /* for(i=0;i<n;i++)
    {
    	cout<<out1[i]<<" "<<out2[i]<<endl;
    }*/
    long long int sum=0;
    for (  i = 0;i<n;++i )
    {
    	ans[i].first=in1[i];
    	ans[i].second=(out1[i]-(i+1))*((i+1)-(out2[i]));
    if(q<ans[i].first)
     sum+=ans[i].second;
    	
    }
    cout<<sum<<endl;
}
}