#include <iostream>
#include <set>

using namespace std;

int main()
{
	//freopen("input.txt", "r", stdin);
    int queries, query, element;
    cin >> queries;
    multiset <int> elements;
    while (queries--) {
        cin >> query;
        switch (query) {
            case 1: cin >> element;
                    elements.insert(element);
                    break;
            case 2: cin >> element;
                    if (elements.find(element) != elements.end())
                        elements.erase(elements.find(element));
                    else cout << -1 << endl;
                    break;
            case 3: if (!elements.empty())
            			cout << *(elements.rbegin()) << endl;
            		else cout << -1 << endl;
                    break;
            case 4: if (!elements.empty())
            			cout << *elements.begin() << endl;
            		else cout << -1 << endl;
                    break;
        }
    }
    return 0;
}
