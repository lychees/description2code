#include<bits/stdc++.h>
 
using namespace std;
string s;
int topp;
int do_it() {
  topp++;
  if (s[topp] == 'X') {
    return 1;
  }
  if (s[topp] == 'A') {
    int x = do_it();
    int y = do_it();
    return x + y;
  }
  int x = do_it();
  int y = do_it();
  return (x > y ? x : y);
}
 
int func(string str, vector <int> array) {
  s = str;
  topp = -1;
  int counter = do_it();
  sort(array.begin(), array.end());
  int n = array.size();
  int accu = 0;
  for (int i = n - counter; i < n; i++) {
    accu += array[i];
  }
  return accu;
}
int main(){
	int t;
	cin>>t;
	while(t--){
		string s;
		cin>>s;
		int counter=0;
		for(int i=0;i<s.size();i++)if (s[i]=='X')counter++;
		vector<int>arr(counter);
		for(int i=0;i<counter;i++)cin>>arr[i];
		cout<<func(s ,arr)<<"\n";
	}
	return 0;
}