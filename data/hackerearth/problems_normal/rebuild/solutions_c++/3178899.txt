#include <bits/stdc++.h>

#define FO(i,a,b) for (int i = (a); i < (b); i++)
#define sz(v) int(v.size())

using namespace std;

int t;
tuple<int,int,int> e[100005];
int n, m;
int l[50005];
int d[50005];

int gl(int i) {
    return i==l[i] ? i : l[i]=gl(l[i]);
}

int main() {
    scanf("%d", &t);
    FO(z,0,t) {
        scanf("%d%d", &n, &m);
        FO(i,0,m) {
            int a, b, c; scanf("%d%d%d", &a, &b, &c);
            if (a > b) swap(a,b);
            // smallest c
                // largest a 
                    // largest b
            e[i] = make_tuple(c, -a, -b);
        }
        FO(i,1,n+1) d[i] = 0, l[i] = i;
        sort(e,e+m);
        long long r = 0;
        FO(i,0,m) {
            int a, b, c; tie(c,a,b) = e[i]; a = -a; b = -b;
            if (gl(a) != gl(b)) {
                r += c;
                d[a]++; d[b]++;
                l[gl(a)] = gl(b);
            }
        }
        printf("%lld\n", r);
        FO(i,1,n+1) printf("%d%c", d[i], " \n"[i==n]);
    }
}
