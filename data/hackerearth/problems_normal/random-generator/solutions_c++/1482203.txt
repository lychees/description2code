//https://www.hackerearth.com/problem/algorithm/random-generator/

#include <stdio.h>
#include <algorithm>

int main()
{
	int t, n, k, p;
	int a[100002];
	scanf("%d", &t);
	while(t--)
	{
		scanf("%d %d %d", &n, &k, &p);
		int i = 0;
		while(i<n)
			scanf("%d", &a[i++]);

		std::sort(a, a+n);

		int res = 0;

		for(int i = 0; i<n-k+1; i++)
		{
			int j = i+k-1;
			for(; j>i; j--)
			{
				if(a[j] > a[i] + 2*p)
					break;
			}
			if(i == j)
			{
				res = 1;
				break;
			}
		}

		if(res)
			printf("NO\n");
		else
			printf("YES\n");

	}

	return 0;
}