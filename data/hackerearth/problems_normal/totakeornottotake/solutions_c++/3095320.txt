#include <iostream>
#include <algorithm>
using namespace std;

int main()
{
	ios_base::sync_with_stdio(0);
	cin.tie(0);
	
	int  t, n ;
	long long  neg, pos, val ;
	string  str ;
	
	for( cin>>t; t--; )
	{
		neg = pos = 1LL ;
		for( cin>>n; n--; )
		{
			cin >> str ;
			if( str == "N" )
			{
				if( -neg < pos )
					neg = -pos ;
				if( -neg > pos )
					pos = -neg ;
				continue;
			}
			cin >> val ;
			if( str == "+" )
				pos += val ;
			if( str == "-" )
				neg -= val ;
			if( str == "*" )
			{
				if( neg < 0 )
					neg *= val ;
				pos *= val ;
			}
			if( str == "/" )
			{
				if( neg > 0 )
					neg /= val ;
			}
		}
		cout << pos << endl ;
	}
	
    return 0;
}