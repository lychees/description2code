#include <iostream>
#include<string.h>
#define LL long long int
#define mod 1000000007
LL a[3][3],b[3][3],A,B,C;
using namespace std;
void multiply()
{
    LL i,j,k;
    LL c[3][3]={0};
    for(i=0;i<3;i++)
        for(j=0;j<3;j++)
        for(k=0;k<3;k++)
        c[i][j]=(c[i][j]+a[i][k]*b[k][j])%mod;
    for(i=0;i<3;i++)
        for(j=0;j<3;j++)
        a[i][j]=c[i][j];
}

void pow(LL n)
{
    LL i,j; 
    if(n==1)
        return ;
    pow(n/2);
    for(i=0;i<3;i++)
        for(j=0;j<3;j++)
        b[i][j]=a[i][j];
    //cout<<n<<endl;
    multiply();
    if(n%2)
    {
        memset(b,0,sizeof(b));
        b[0][0]=A; 
        b[0][1]=B;
        b[0][2]=C;
        b[1][0]=1;
        b[2][2]=1;
        multiply();
    }
}

int main()
{
    int t;
    cin>>t;
    while(t--)
    {
        LL n,f0,f1;
        cin>>n>>f0>>f1>>A>>B>>C;
        if(n==1)cout<<f0<<endl;
        else if(n==2)cout<<f1<<endl;
        else
        {
         memset(a,0,sizeof(a));
        a[0][0]=A;
        a[0][1]=B;
        a[0][2]=C;
        a[1][0]=1;
        a[2][2]=1;
        pow(n-2);
        cout<<(a[0][0]*f1+a[0][1]*f0+a[0][2])%mod<<endl;
        }
    }
    return 0;
}
