#include <iostream>

using namespace std;
const int MOD = 1000000007;
typedef unsigned long long ull;

ull power(ull p, ull a) {
	if(a == 0) return 1;
	ull temp = power(p, a >> 1);
	temp = (temp*temp)%MOD;
	if(a&1)
		return (temp*p)%MOD;
	return temp;
}

ull sum(ull p, ull a) {
	if(a == 0) return 1;
	if(a == 1) return p;
	ull s = sum(p, a >> 1);
	ull pw = power(p, a >> 1);
	ull pwsq = (pw*pw)%MOD;
	
	if(a%2 == 0) 
		return (s*(1+pw))%MOD;
	return (s*(1+pw) + pwsq*p)%MOD;
}

int main(void) {
	int t;
	cin >> t;
	while(t--) {
		int n;
		cin >> n;
		ull p[n];
		ull a[n];
		for(int i = 0; i < n; i++)
			cin >> p[i];
		for(int i = 0; i < n; i++)
			cin >> a[i];
		ull ans = 1;
		for(int i = 0; i < n; i++) {
			ans = (ans*sum(p[i], a[i]))%MOD;
		}
		cout << ans << endl;
	}
	return 0;
}
