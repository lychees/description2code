#include<iostream>
#include<algorithm>
using namespace std;
int main()
{
	int t;
	cin>>t;
	while(t--)
	{
		int n,boys[100000+10],girl[100000+10];
		int boy_beated[100000+10]={0};
		int girl_beated[100000+10]={0};
		cin>>n;
		for(int i=1;i<=n;i++) cin>>boys[i];
		for(int i=1;i<=n;i++) cin>>girl[i];
		
		
		for(int i=1;i<=n;i++)
		{
			if(girl[boys[i]]!=i) boy_beated[ girl[boys[i]]]++;
			if(boys[girl[i]]!=i) girl_beated[boys[girl[i]]]++;
		}
	    int maxi=-1;
	    for(int i=1;i<=n;i++) maxi= max(maxi,max(boy_beated[i],girl_beated[i]));
	    
	    int pairs=0;
	    
	    for(int i=1;i<=n;i++)
	    {
	    	int beated_boy = girl[boys[i]];
	    	if(beated_boy!=i&&i==girl[boys[beated_boy]]) pairs++;
	    	int beated_girl=boys[girl[i]];
	    	if(beated_girl!=i&&i==boys[girl[beated_girl]]) pairs++;
		}
		cout<<maxi<<" "<<pairs/2<<" "<<endl;
	}
	return 0;
		
}