#include <bits/stdc++.h>
using namespace std;
#define lld long long int
#define mod 1000000007;
lld prepower[62];
string turn (string m, lld k)
{
	int tmp=m.size();
	k%=tmp;
	string aa;
	for (int i=0;i<tmp;++i)
		aa.push_back(m[(tmp-k+tmp+i)%tmp]);
	return aa;
}

string duplicate (string z, lld n, lld p)
{
    lld i,s;
	if(n==0)
		return z;

	for (i=0;i<50;++i)
		if (prepower[i]>n)
			break;

	s=prepower[i-1];

	string ans;
	string q=turn(z,p*s);
	int k=z.size();
	for (int i=0;i<k;++i)
	{
		if (z[i]!=q[i])
			ans.push_back('1');
		else
			ans.push_back('0');
	}


	return duplicate(ans,n-s,p);
}
void sexy()
{
    prepower[0]=1;
	for (int i=1;i<62;++i)
		prepower[i]=2*prepower[i-1];
}
int main()
{
	int t;
	sexy();
    cin>>t;
	while (t--)
	{
	    lld n,m,p,x;
        cin>>n>>m>>p>>x;
		string str;

		cin >> str;

		string finans,tmppp;

		finans = duplicate(str,n-1,p);

		if (x==1)
		{
			for(int i=0;i<m;i++)
				tmppp.push_back('1');

                string ans;
                int k=finans.size();
            for (int i=0;i<k;++i)
            {
                if (finans[i]!=tmppp[i])
                    ans.push_back('1');
                else
                    ans.push_back('0');
            }
            finans=ans;
		}
		cout<<finans<<endl;
	}

	return 0;
}
