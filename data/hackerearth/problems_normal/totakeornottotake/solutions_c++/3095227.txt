#include <bits/stdc++.h>

using namespace std;

#define icin(x) scanf("%d",&x)
#define mp make_pair
typedef long long LL;

const int maxn=int(1e6)+1;
int v[maxn];

int main(){
  int t;
  icin(t);
  while(t--){
    int b,val;
    icin(b);
    LL mini=1,maxi=1,tmp;
    char c;
    for(int i=0;i<b;i++){
      cin>>c;
      if(c=='N'){
        LL tmp1=-maxi,tmp2=-mini;
        mini=min(mini,tmp1);
        mini=min(mini,tmp2);
        maxi=max(maxi,tmp1);
        maxi=max(maxi,tmp2);
      }
      else{
        icin(val);
        if(c=='+'){
          maxi=maxi+val;
        }
        if(c=='-'){
          mini=mini-val;
        }
        if(c=='/'){
          LL tmp1=maxi/val,tmp2=mini/val;
          mini=min(mini,min(tmp1,tmp2));
          maxi=max(maxi,max(tmp1,tmp2));
        }
        if(c=='*'){
          LL tmp1=maxi*val,tmp2=mini*val;
          mini=min(mini,min(tmp1,tmp2));
          maxi=max(maxi,max(tmp1,tmp2));
        }
      }
    }
    printf("%lld\n",maxi);
  }
  return 0;
}