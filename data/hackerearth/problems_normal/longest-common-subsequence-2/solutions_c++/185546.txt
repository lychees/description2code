#include <bits/stdc++.h>
using namespace std;
#define lli long long int
#define md 1000000007
int main()
{
	int t;
	cin>>t;
	while(t--)
	{
		lli kk,k,n;
		cin>>kk>>n;
		lli num=1;k=kk;
		if(k==1)
		{
			cout<<"0\n";
			continue;
		}
		if(k==2 && n==2)
		{
			cout<<"1\n";
			continue;
		}
		if(kk<n)
			cout<<"0\n";
		else if(kk==n)
			cout<<((kk-1)/2)%md<<"\n";
		else
		{
			while(k!=0)
			{
				lli tmp=k%n;
				num=num*(1+tmp);
				k=k/n;
			}
			num=kk+1-num;
			num=(num+1)/2;
			num%=md;
			cout<<num<<"\n";
		}
	}
	return 0;
}