#include<cstdio>
#include<iostream>
#include<algorithm>
#include<cstring>
#include<cmath>
#include<cstdlib>
#include<map>
#include<ctime>
using namespace std;
const __int128 modul=1000000007;
long long n,sol,q,t,f,k,dist,br,pr,w,pok,p,pomoc,y,koren,prost[6000000+100];
__int128 niz[100];
__int128 step (__int128 e, __int128 x,__int128 modul)
{
    __int128 s;
    if (x==0)return 1;
    else
    {
        s=step(e,x/2,modul);
        s=s*s;
        s%=modul;
        if (x%2==1){s*=e;s%=modul;}
        return s;
    }
}
bool check(__int128 x)
{
    if (x<2)return false;
    if (x!=2&&x%2==0)return false;
    if (x==2||x==3||x==5)return true;
    __int128 temp=x-1;
    while(temp%2==0)
    {
        temp/=2;
    }

    for (int i=1;i<=15;i++)
    {
        bool o=false;
        __int128 br=niz[i];
        if (br>=x-1)continue;
        __int128 res=step(br,temp,x);
        if (res==1 || res==x-1 )continue;
        while(temp!=x-1)
        {
            temp*=2;
            res=step(br,temp,x);
            if (res==1||res==x-1)o=true;
        }
        if (o==true)continue;
        return false;
    }
    for (int i=1;i<=15;i++)
    {
        bool o=false;
        __int128 br=rand()%(x-3);br+=2;
        if (br>=x-1)continue;
        __int128 res=step(br,temp,x);
        if (res==1 || res==x-1 )continue;
        while(temp!=x-1)
        {
            temp*=2;
            res=step(br,temp,x);
            if (res==1||res==x-1)o=true;
        }
        if (o==true)continue;
        return false;
    }
    return true;
}
int main()
{
    ios_base::sync_with_stdio(false);
	cin.tie(NULL);
	srand (time(NULL));
	niz[1]=2;niz[2]=3;niz[3]=31;niz[4]=73;niz[5]=61;niz[7]=1662803;niz[6]=13;niz[8]=23;niz[9]=5;niz[10]=11;niz[11]=17;niz[12]=19;
	niz[13]=23;niz[14]=37;niz[15]=29;

  //  printf("%lld",step(100000000000,100000000001,1000000000123));
    scanf("%lld %lld",&n,&q);

    pok=1;
    while(q--)
    {
        scanf("%lld %lld %lld",&t,&f,&k);
        if  (t==1)
        {
                bool h=check(f+k);
                if (h==true)
                {
                    sol+=k;
                    dist+=abs(pok-f);
                    dist%=modul;
                    pok=f;
                }

        }
        if (t==2)
        {
            br=f+k;
            koren=sqrt(br);
            if (koren*koren==br)
            {
                sol-=k;
                dist+=abs(pok-f);
                dist%=modul;
                pok=f;
            }
        }
    }
    printf("%lld %lld\n",dist,sol);
    return 0;
}

