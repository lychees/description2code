for _ in range(int(raw_input())):
	t=[]
	for x in range(7):
		s=map(int,raw_input().split())
		y=1
		while y<len(s):
			t.append(s[y+1]-s[y])
			y+=2
	t=sorted(t)
	x=0
	ans=0
	while x<0.75*len(t):
		ans+=t[x]
		x+=1
	print 604800-ans