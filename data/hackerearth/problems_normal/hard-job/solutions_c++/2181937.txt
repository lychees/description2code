#include <bits/stdc++.h>

using namespace std;

# define pb push_back
# define mp make_pair
# define FORN( a , b , c ) for ( int a = b ; a <= c ; ++ a )
# define FORNBACK( a , b , c ) for ( int a = b ; a >= c ; -- a )

const int N = 500014 ;
const int MAX = N * 3 ;

int pos [ N ] ;
int AIB [ MAX + 14 ] ;

inline void update ( int poz , int val )
{
    for ( ; poz <= MAX ; poz += poz & -poz ) AIB [ poz ] += val ;
}
inline int sum ( int poz )
{
    int S = 0 ;
    for ( ; poz ; poz -= poz & -poz )
        S += AIB [ poz ] ;
    return S ;
}

int main()
{
    ios :: sync_with_stdio ( false ) ;

    //freopen( "input" , "r" , stdin ) ;
    //freopen( "output" , "w" , stdout ) ;
    int n ;
    cin >> n ;
    int m ;
    cin >> m ;
    int start = N + n - 1 ;
    FORN ( i , 0 , n - 1 )
    {
        int x ;
        cin >> x ;
        pos [ x ] = N + i ;
        update ( N + i , 1 ) ;
    }
    int st = N ;
    int dr = start ;
    long long CET = 0 ;
    while ( m -- )
    {
        int x ;
        char c ;
        cin >> x ;
        cin >> c ;
        int A = sum ( pos [ x ] ) ;
        int B = sum ( start ) ;
        CET = CET + min ( A - 1 , B - A ) ;

        update ( pos [ x ] , -1 ) ;

        if ( c == 'l' )
        {
            -- st ;
            pos [ x ] = st ;
            update ( st , 1 ) ;
        }
        else {
            ++ dr ; ++ start ;
            pos [ x ] = dr ;
            update ( dr , 1 ) ;
        }
    }
    cout << CET << '\n' ;
    return 0 ;
}
