#include<bits/stdc++.h>

using namespace std;

#define LL long long int
#define sd(x) scanf("%d", &x)
#define MP make_pair
#define PB push_back
#define vi vector<int>
#define F first
#define S second
#define INF 1000000000
#define MOD 1000000007
#define D double
#define LD long double

#define N 1123456

LL a[5][5], b[5][5], c[5][5];

void mul(LL a[5][5], LL b[5][5], LL d[5][5]){
	int i, j, k;
	for(i = 0; i < 5; i++){
		for(j = 0; j < 5; j++){
			c[i][j] = 0;
			for(k = 0; k < 5; k++){
				c[i][j] += a[i][k] * b[k][j];
				c[i][j] %= MOD;
			}
		}
	}
	for(i = 0; i < 5; i++){
		for(j = 0; j < 5; j++){
			d[i][j] = c[i][j];
		}
	}
}

void fillAB(){
	int i, j;
	a[0][0] = 1;
	a[1][0] = 1;
	a[2][0] = 1;
	a[3][0] = 2;
	a[4][0] = 1;
	for(i = 0; i < 5; i++){
		for(j = 1; j < 5; j++){
			a[i][j] = (i == j - 1 ? 1 : 0);
		}
	}
	for(i = 0; i < 5; i++){
		for(j = 0; j < 5; j++){
			b[i][j] = (i == j ? 1 : 0);
		}
	}
}

void PowerMod(int n){
	while(n > 0){
		if(n & 1){
			mul(b, a, b);
		}
		mul(a, a, a);
		n /= 2;
	}
}

void print(LL b[5][5]){
	for(int i = 0; i < 5; i++){
		for(int j = 0; j < 5; j++){
			printf("%lld ", b[i][j]);
		}
		cout<<endl;
	}
}

int main(){
	int t, n, i;
	LL f[5];
	LL ans;
	sd(t);
	while(t--){
		for(i = 0; i < 5; i++){
			cin>>f[i];
		}
		sd(n);
		if(n < 5){
			printf("%lld\n", f[n] % MOD);
			continue;
		}
		fillAB();
		PowerMod(n - 4);
		//print(b);
		ans = 0;
		for(i = 0; i < 5; i++){
			ans += f[i] * b[4 - i][0];
			ans %= MOD;
		}
		printf("%lld\n", ans);
	}
    return 0;
}
