#include <bits/stdc++.h>
#define ii pair<int,int>
using namespace std;

int main()
{
	ios_base::sync_with_stdio(0);
	cin.tie(NULL);
    vector<ii > a[10004];
    int t,n,m,x,y,i,j,D[10004],c,q;
    cin>>t;
    while(t--){
    	cin>>n>>m;
    	for(i=1;i<=n;i++){
    		a[i].clear();
    		D[i]= 1e9;
    	}
    	for(i=0;i<m;i++){
    		cin>>x>>y>>c;
    		a[x].push_back(ii(y,c));
    		a[y].push_back(ii(x,c));
    	}
    	D[1]=0;
    	set<ii > Q;
    	Q.insert(ii(0,1));
    	while(!Q.empty()){
    		ii top = *Q.begin();
    		Q.erase(Q.begin());
    		x=top.first;
    		y=top.second;
    		for(i=0;i<a[y].size();i++){
    			int v2= a[y][i].first;
    			c = a[y][i].second;
    			if(D[v2]> D[y] + c){
    				if(D[v2] != 1e9){
    					Q.erase(Q.find(ii(D[v2],v2)));
    				}
    				D[v2] = D[y] + c;
    				Q.insert(ii(D[v2],v2));
    			}
    		}
    	}
    	cin>>q;
    	while(q--){
    		cin>>x>>y;
    		int t = y - 2*D[x];
    		if(t<0){
    			cout<< 0 <<endl;
    		}
    		else{
    			cout<< t <<endl;
    		}
    	}
    }
    return 0;
}
