#include <iostream>
#include <stack>
#include <cstring>
#include <algorithm>
using namespace std;

stack<int> st;
char str[5000];
int e[20000];

int main() {
	int T, i, ct, a;
	cin >> T;
	while(T--) {
		cin >> str;
		i = strlen(str) - 1;
		ct = 0;
		for(; i >= 0; --i) {
			switch(str[i]) {
			case 'X':
				++ct;
				st.push(1);
				break;
			case 'A':
				a = st.top();
				st.pop();
				a += st.top();
				st.pop();
				st.push(a);
				break;
			default:
				a = st.top();
				st.pop();
				a = max(a, st.top());
				st.pop();
				st.push(a);
			}
		}
		for(i = 0; i < ct; ++i)
			cin >> e[i];
		sort(e, e + ct, std::greater<int>());
		int sum = 0;
		for(i = 0; i < st.top(); ++i)
			sum += e[i];
		st.pop();
		cout << sum << endl;
	}
	return 0;
}