#include <iostream>
#include <cmath>

#define MOD 1000000007

using namespace std;

long long int water_trapped(int *heights, int n);

int main()
{
	int T;
	int i;
	int n;
	int heights[100009];
	cin>>T;
	while(T--)
	{
		cin>>n;
		for(i=0; i<n; i++)
		{
			cin>>heights[i];
		}
		
		cout<<water_trapped(heights, n)<<endl;
	}
	
	return 0;
}

long long int water_trapped(int *heights, int n)
{
	int i=0;
	int j=n-1;
	
	if(n<2)
	return 0;
	
	long long int ans=0;
	
	int *left=new int[n];
	int *right=new int[n];
	
	left[0]=0;
	
	for(i=1; i<n; i++)
	{
		left[i]=max(left[i-1], heights[i-1]);
	}
	
	right[n-1]=0;
	
	for(i=n-2; i>=0; i--)
	{
		right[i]=max(right[i+1], heights[i+1]);
	}
	
	for(i=0; i<n; i++)
	{
		if(min(left[i], right[i])-heights[i]>0)
		{
			ans=(ans+min(left[i], right[i])-heights[i])%MOD;
		}
	}
	
	return ans;
}