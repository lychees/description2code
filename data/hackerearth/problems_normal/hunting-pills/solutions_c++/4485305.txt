//Sinha Saab
//NARUTO Fan



#include <cstdio>
#include <iostream>
#include <algorithm>
#include <string.h>
#include <vector>
#include <set>
#include <map>
#include <stack>
#include <list>
#include <math.h>

#define ll long long int
#define maxN 100
#define maxVal 100000000
#define minVal -100000000
#define mod 1000000007LL

#define gcd(a,b) __gcd(a,b)

using namespace std;

int n,m;
int sleep[maxN+5];
vector<int> g[maxN+5],h[maxN+5];
int visit[maxN+5];
int cnt[maxN+5];
stack<int> s;

void topoSort(int u)
{
	int i,v;
	visit[u]=1;
	for(i=0;i<(int)g[u].size();i++)
	{
		v=g[u][i];
		if(visit[v]==0)
			topoSort(v);
	}
	s.push(u);
}

void scc(int u,int x)
{
	int i,v;
	visit[u]=1;
	cnt[x]+=sleep[u];
	for(i=0;i<(int)h[u].size();i++)
	{
		v=h[u][i];
		if(visit[v]==0)
			scc(v,x);
	}
}

int main()
{
    int t,i,u,v,ans;
    scanf("%d",&t);
    while(t--)
    {
    	scanf("%d%d",&n,&m);
    	for(i=1;i<=n;i++)
    	{
    		g[i].clear();
    		h[i].clear();
    		visit[i]=0;
    		cnt[i]=0;
    		scanf("%d",&sleep[i]);
    	}
    	while(m--)
    	{
    		scanf("%d%d",&u,&v);
    		g[u+1].push_back(v+1);
    		h[v+1].push_back(u+1);
    	}
    	for(i=1;i<=n;i++)
    		if(visit[i]==0)
    			topoSort(i);
    	for(i=1;i<=n;i++)
    		visit[i]=0;
    	ans=0;
    	while(!s.empty())
    	{
    		u=s.top();
    		if(visit[u]==0)
    		{
    			scc(u,u);
    			ans=max(ans,cnt[u]);
    		}
    		s.pop();
    	}
    	printf("%d\n",ans);
    }
    return 0;
}