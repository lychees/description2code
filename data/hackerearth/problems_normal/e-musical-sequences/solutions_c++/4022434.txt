#include <iostream>
#include <vector>
using namespace std;

int main()
{
    long long int p1,p2,t,n,m,z,sign,result;
    cin>>t;
    while(t--)
    {
    	cin>>n>>m>>z;
    	vector<long long int> ai(n+1,0);
    	for(p1=0;p1<n;p1++)
    		cin>>ai[p1];
    	sign=1;
    	for(p1=n-1;p1>=0;p1--)
    	{
    		ai[n]+=sign*ai[p1];
    		sign*=-1;
    	}
    	//for(p1=0;p1<=n;p1++)
    		//ai[p1]=((ai[p1]%m)+m)%m;
    	ai[n]=(ai[n]%m+m)%m;
    	if(n%2!=0||(z/(n+1))%2==0)
    	{
    		result=ai[z%(n+1)];
    		cout<<(result%m+m)%m<<endl;
    	}
    	else
    	{
    		result=ai[z%(n+1)]*-1;
    		
    		//cout<<result;
    		//cout<<"odd-";
    		cout<<(result%m+m)%m<<endl;
    	}
    }
    return 0;
}
