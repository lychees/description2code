#include <bits/stdc++.h>
#define ll long long 
using namespace std;

int main()
{
   ll n;
   multiset<ll> s;
   
   cin>>n;
   for(ll i=0;i<n;i++)
   {
   	ll temp;
   	cin>>temp;
   	switch(temp)
   	{
   		case 1:
   		cin>>temp;
   		s.insert(temp);
   		break;
   		case 2:
   		cin>>temp;
   		if(s.find(temp)!=s.end())
   		s.erase(s.find(temp));
   		else
   		cout<<"-1\n";
   		break;
   		case 3:
   		if(!s.empty())
   		cout<<*(s.rbegin())<<"\n";
   		else
   		cout<<"-1\n";
   		break;
   		case 4:
   		if(!s.empty())
   		cout<<*s.begin()<<"\n";
   		else
   		cout<<"-1\n";
   	}
   }
    return 0;
}
