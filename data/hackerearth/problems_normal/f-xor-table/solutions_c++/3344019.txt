#include <cstdio>
#include <cstring>
#include <vector>
using namespace std;
char str[1001000],temp[1001000];
int main()
{
	int t,n,m,p,x;
	long long val,j,power;
	scanf("%d",&t);
	while(t--){
		scanf("%d%d%d%d",&n,&m,&p,&x);
		scanf("%s",str);
		n--;
		power=1;
		strcpy(temp,str);
		while(n){
			if(n%2==1){
				for(j=0;j<m;j++){
					val=j+power*(m-p);
					val%=m;
					temp[j]='0'+((str[j]-'0')^(str[val]-'0')^x);
				}
				temp[m]='\0';
				strcpy(str,temp);
			}
			n/=2;
			power=(power*2)%m;
		}
		printf("%s\n",str);
	}
    return 0;
}
