#include <bits/stdc++.h>
using namespace std;

#define MAX 100001
#define MOD 1000000007
#define Read(x) freopen(x, "r", stdin)
#define Write(x) freopen(x, "w", stdout)
#define Mem(x, val) memset((x), (val), sizeof(x))
#define All(x) x.begin(), x.end()
#define pb push_back
#define Ins insert
#define rep(i,n) for(__typeof(n) i=0; i<(n); i++)
#define repi(i,n) for(__typeof(n) i=0; i<=(n); i++)

typedef long long int lli;
typedef unsigned long long ulli;
typedef vector<int> vii;
typedef string st;

int main()
{
    //Write("2.txt");
    int test;
    cin >> test;
    while(test--)
    {
        lli N, M, L[MAX], R[MAX], C[MAX], Arr[MAX], P, Q, S;
        Mem(L, 0); Mem(R, 0); Mem(C, 0);
        cin >> N >> M >> L[0] >> R[0] >> C[0] >> P >> Q >> S;
        for(lli i = 1; i < M; i++)
        {
            L[i] = (1LL * L[i-1] * P + R[i-1]) % N + 1;
            R[i] = (1LL * R[i-1] * Q + L[i-1]) % N + 1;
            C[i] = (1LL * C[i-1] * S) % (1000000) + 1;
            if(L[i] > R[i])
                swap(L[i] , R[i]);
            //cout << L[i] << ' ' << R[i] << endl;
        }
        lli Start[MAX], End[MAX];
        Mem(Start, 0); Mem(End, 0); Mem(Arr, 0);
        for(lli i = 0; i < M; i++)
        {
            Start[L[i]] += C[i];
            End[R[i]] += C[i];
            //cout << Start[L[i]] << ' ' << End[R[i]] << endl;
        }
        lli Sum = 0;
        for(lli i = 0; i <= N; i++)
        {
            Sum += Start[i];
            Arr[i] = Sum;
            Sum -= End[i];
        }
        //cout << Sum << endl;
        lli Pos = 0;
        for(lli i = 1; i <= N; i++)
            if(Arr[Pos] < Arr[i])
                Pos = i;
        cout << Pos << ' ' << Arr[Pos] << endl;
    }
    return 0;
}
