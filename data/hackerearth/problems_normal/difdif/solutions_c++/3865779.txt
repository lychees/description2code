#include<bits/stdc++.h>
#define MAX(a,b) (a>b?a:b)
#define MIN(a,b) (a<b?a:b)
#define UP upper_bound
#define LB lower_bound
#define LL long long 
#define Pi 3.14159265358
#define si size()
#define en end()
#define be begin()
#define fi first
#define se second
#define pb push_back
#define mp make_pair
#define ii set<int>::iterator
#define Tree int ind, int L, int R
#define Left 2*ind,L,(L+R)/2
#define Right 2*ind+1,(L+R)/2+1,R
using namespace std;
string s;
const LL m7=1000000007;
LL Hash[100001];
pair < LL , LL > cur[100001];
LL res[100001];
LL xar[100001];
LL n, m, k, i, j, ans, h1, h2, mnn, mxx, g;
main(){
	   cin>>s;
	   n=s.si;
	   xar[0]=1;
	   for(i=1;i<n;i++)xar[i]=(xar[i-1]*1ll*29)%m7;
	   mnn=123123123123ll;
	   for(i=0;i<n;i++)
	     mnn=min(mnn,1ll*s[i]);
	   for(i=0;i<n;i++)
	    {
	     cur[i]=mp(s[i]-mnn,-i);
		 res[i]=cur[i].fi;	
		}  
	   sort(cur,cur+n);
	   for(mxx=1;(mxx>>1)<n;mxx<<=1)
	    {
	     for(i=0;i<n;i++)
		   res[i]=res[i]*(n+1)+res[i+mxx];
		 for(i=0;i<n;i++)
		   cur[i]=mp(res[i],-i);
		 sort(cur,cur+n);
		 res[-cur[0].se]=0;
		 g=0;
		 for(i=1;i<n;i++)
		  {
		   if(cur[i].fi!=cur[i-1].fi)g++;
		   res[-cur[i].se]=g;	
		  }   
		}
	   for(i=0;i<n;i++)cur[i].se=-cur[i].se;
	   //for(i=0;i<n;i++)
	   // {
	   //  for(j=cur[i].se;j<n;j++)cout<<s[j];
	//	 cout<<endl;	
	//	}	
		//system("pause");
	   Hash[0]=s[0]-'a'+1; k=29;	
       for(i=1;i<n;i++)Hash[i]=(Hash[i-1]+(s[i]-'a'+1)*k)%m7, k=(k*1ll*29)%m7;
       for(i=0;i<n;i++)
        {
         if(i==0)ans+=n-cur[i].se;
		 else
		  {
		   LL l=1, r=min(n-cur[i].se,n-cur[i-1].se), mid=cur[i].se+(n-cur[i-1].se), q=0;
		   //cout<<mid<<" oeee";
		   //system("pause");
		   while(l<=r)
		    {
		     q=(l+r)/2;
			 h1=((Hash[cur[i].se+q-1]-((cur[i].se!=0)?Hash[cur[i].se-1]:0))%m7+m7)%m7;
			 h2=((Hash[cur[i-1].se+q-1]-Hash[cur[i-1].se-1])%m7+m7)%m7;
			/* if(i==3){
			 cout<<Hash[cur[i-1].se+q-1]<<" "<<Hash[cur[i].se+q-1]<<" "<<h1<<" "<<h2<<endl;
			 cout<<q<<" "<<h1<<" "<<h2<<endl;
		        }*/
			 if(cur[i].se<cur[i-1].se)h1=(h1*xar[cur[i-1].se-cur[i].se])%m7;
			 else h2=(h2*xar[cur[i].se-cur[i-1].se])%m7;	
		//	 cout<<q<<" "<<h1<<" "<<h2<<endl;
		///	 system("pause");
			 if(h1==h2)l=q+1;
			 else mid=cur[i].se+q-1, r=q-1;
			}
		  // cout<<mid<<endl;		
		   ans+=n-mid;	//cout<<mid<<" "<<n-mid<<endl;
		  }	
		}
	   cout<<ans;	
	   }