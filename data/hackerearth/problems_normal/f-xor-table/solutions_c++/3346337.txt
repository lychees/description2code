#include <iostream>
#include <cstdio>
#include <cstdlib>
#include <string>
#include <cstring>
#include <set>
#include <map>
#include <queue>
#include <deque>
#include <stack>
#include <vector>
#include <ctime>
#include <cassert>
#include <cmath>
#include <iomanip>
#include <algorithm>
#include <iomanip>
#include <fstream>
using namespace std;
#define fname ""
#define F first
#define S second
#define pb push_back
#define mp make_pair
#define ll long long
#define ull unsigned long long
const int INF = (int)1e9+7, mod = (int)1e9+9, pw = 31, N = (int)1e5+123, M = (int)1e6+123;
//int a[M][M];
int n, m, t, p, x;
int nxt[M], prv[M];
int tt[M], na[M];
int main ()
{
    ios_base::sync_with_stdio(0);cin.tie(NULL);
    /*
#ifndef ONLINE_JUDGE
    freopen("in","r",stdin);
    freopen("out","w",stdout);
#endif
*/
    cin>>t;
    while(t--){
        cin>>n>>m>>p>>x;
        for(int i=0; i<m; i++){
            char xx;
            cin >> xx;
//          a[1][i] = xx - '0';
            nxt[i] = (i + p) % m;
            prv[i] = (i - p) % m;
            if (prv[i] < 0) prv[i] += m;
//          tt[i] = a[1][i];
            tt[i] = xx - '0';
        }
/*
        for(int i=2; i<=n; i++){
            for(int j=0; j<m; j++){
                a[i][j] = a[i - 1][j] ^ x ^ a[i - 1][(j - p + m) % m];
            }
//          cout << "after #" << i << ": ";
 
            for(int j=0; j<m; j++){
                cout << a[i][j];
            }
            cout << endl;
            if (i > 6) {
                for (int j = 0; j < m; ++ j) {
//                  int now = (a[i - 3][j] ^ a[i - 3][prv[j]] ^ a[i - 3][prv[prv[j]]] ^ a[i - 3][prv[prv[prv[j]]]] ^ x);
//                  int now = (a[i - 4][j] ^ a[i - 4][prv[prv[prv[prv[j]]]]] ^ x);
                    int now = (a[i - 5][j] ^ a[i - 5][prv[j]] ^ a[i - 5][prv[prv[prv[prv[j]]]]] ^ a[i - 5][prv[prv[prv[prv[prv[j]]]]]]);
                    now ^= x;
                    if (a[i][j] != now) {                          
//                      cout << a[i - 2][j] << " " << a[i - 2][prv[prv[j]]] << " " << endl;
                        cout << i << " " << j << endl;
                        cout << a[i][j];
                        cout << "NO";
                        return 0;
                    }
                }
            }
        }
       
        cout << endl;
        for(int i=0; i<m; i++)
            cout<<a[n][i];
        cout<<"\n";
*/
        --n;
        for (int i = 30; i >= 0; -- i) {
            if (n & (1 << i)) {
                for (int j = 0; j < m; ++ j) {
                    int pos = (j - (((1LL << i) * 1ll * p) % m)) % m;
                    if (pos < 0) pos += m;
                    na[j] = (tt[j] ^ tt[pos]);
                }
                for (int j = 0; j < m; ++ j) {
                    tt[j] = na[j];
                }
            }
        }
        for (int j = 0; j < m; ++ j) {
            cout << (tt[j] ^ x);
        }
        cout << endl;
    }
   
    return 0;
}