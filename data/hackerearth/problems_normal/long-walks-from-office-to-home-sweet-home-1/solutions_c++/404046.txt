#include <cstdio>
#include <iostream>
#include <algorithm>
#include <cmath>
#include <vector>
#include <set>
#include <utility>
#include <stack>
#include <queue>
#include <string>
#include <cstring>
#include <cstdlib>
#include <map>
using namespace std;
typedef long long int ll;
#define inf 1000000007
#define iit(n) scanf("%lld",&n)
#define oit(n) printf("%lld",n)
#define pb(n) push_back(n)
#define REP(i,j,n) for(i=j;i<n;i++)
#define READ(x) freopen(x, "r", stdin)
#define WRITE(x) freopen(x, "w", stdout)
#define mp make_pair
typedef vector<vector<ll> > matrix;
ll d;
matrix mul(const matrix &a, const matrix &b)
{
	matrix c(d,vector<ll> (d,0));
	for(size_t i = 0; i < c.size(); i++)
		for(size_t j = 0; j < c[i].size(); j++)
			for(size_t k = 0; k < a[i].size(); k++)
				c[i][j] = (c[i][j]+(a[i][k]*b[k][j]))%inf;
				
	return c;
}

matrix expo(const matrix &m, ll n)
{
	if(n == 0 || n == 1 || n < 1)
		return m;
	matrix c = expo(m,n/2);
	c = mul(c,c);
	if(n&1)
		c = mul(c,m);
	return c;
}
int main()
{
	int tc;
	cin>>tc;
	while(tc--) {
		ll k,u,v;
		cin>>d>>k>>u>>v;
		matrix a(d,vector<ll> (d,0));
		for(int i=0;i<d;i++) {
			for(int j=0;j<d;j++) {
				cin>>a[i][j];
			}
		}
		a=expo(a,k);
		cout<<a[u][v]<<"\n";
	}
}