#include<iostream>
#include<vector>
#include<string>
using namespace std;
#define mod 1000000007
struct spe{
	long long int val;
	int digit;
};
int main()
{
    int n,l,r,temp,countt,q;
    string type;
    cin>>n;
    vector<spe> vec(n+1);
    vector<vector<int> > bit(n+1,vector<int> (11,0));
    for(int i=1;i<=n;i++) cin>>vec[i].val;
    for(int i=1;i<=n;i++){
    	vector<int> visit(10,0);
    	temp=vec[i].val;
    	while(temp!=0){
    		visit[temp%10]=1;
    		temp/=10;
    	}
    	countt=0;
    	for(int j=0;j<10;j++){
    		if(visit[j]==1)
    		countt++;
    	}
    	vec[i].digit=countt;
    	temp=i;
    	for(;temp<=n;temp+=(temp&-temp)) bit[temp][countt]++;
    }
    	cin>>q;
    	while(q--){
    		int ans=0;
    		cin>>type>>l>>r;
    	if(type=="ADD"||type=="MUL"||type=="REP"){
    		if(type=="ADD")
    			vec[l].val=(vec[l].val+r)%mod;
    		else if(type=="MUL")
    			vec[l].val=(vec[l].val*r)%mod;
    		else
    		    vec[l].val=r%mod;
    	temp=l;
        for(;temp<=n;temp+=(temp&-temp)) bit[temp][vec[l].digit]--;
    	temp=vec[l].val;
    	vector<int> visit(10,0);
    	while(temp!=0){
    		visit[temp%10]=1;
    		temp/=10;
    	   }
    	countt=0;
    	for(int i=0;i<10;i++){
    		if(visit[i]==1)
    		countt++;
    	   }
       	temp=l;
    	for(;temp<=n;temp+=(temp&-temp)) bit[temp][countt]++;
        vec[l].digit=countt;
          }
        else{
        vector<long long int> ans(11,0);
        temp=r;
        for(;temp>0;temp-=(temp&-temp)){
        	for(int i=0;i<=10;i++){
        		ans[i]+=bit[temp][i];
        	}
        }
        temp=l-1;
        for(;temp>0;temp-=(temp&-temp)){
        	for(int i=0;i<=10;i++){
        		ans[i]-=bit[temp][i];
        	}
        }
        if(type=="MAX"){
        	temp=10;
        	while(ans[temp]==0)
        	temp--;
        	cout<<temp<<" "<<ans[temp]<<endl;
        }
        else{
        	temp=1;
        	while(ans[temp]==0)
        	temp++;
        	cout<<temp<<" "<<ans[temp]<<endl;
        }
      }
    }
    
    return 0;
}
