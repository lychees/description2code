#include <bits/stdc++.h>
#define PB push_back
#define MP make_pair
#define LL long long
#define MAXN 100001
#define M 1000000007
#define F first
#define S second
#define sc(x) scanf("%d",&x)
#define scl(x) scanf("%lld",&x)
using namespace std;

int a[MAXN + 1];

int main(){
    int n, t, i, j, k, p, g;
    cin>>t;
    while(t--){
        cin>>n>>k>>p;
        for(i=1;i<=n;i++)
            sc(a[i]);
        sort(a + 1, a + n + 1);
        g = 0;
        for(i=k;i<=n;i++){
            j = (i + 1) - k;
            if(a[i] - a[j] <= (2 * p)){
                g = 1;
                break;
            }
        }
        if(g == 0)
            printf("YES\n");
        else
            printf("NO\n");
    }
}
