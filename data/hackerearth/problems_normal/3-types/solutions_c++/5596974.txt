#include <bits/stdc++.h>
using namespace std;
#define ii pair<int,int>
int n,m,pr[4][1010];
vector<ii> a[4];
int parent(int u, int t){
	if(pr[t][u]==0) return u;
	return pr[t][u] = parent(pr[t][u],t);
}
int main(){
	//freopen("in.in","r",stdin);
	memset(pr,0,sizeof(pr));
	cin >> n >> m;
	for(int i = 1; i <= m; i++){
		int u,v,c; cin >> u >> v >> c;
		a[c].push_back(ii(u,v));
	}
	int curcnt = n;
	int cnt = 0;
	for(int i = 0; i < a[3].size(); i++){
		int u = a[3][i].first;
		int v = a[3][i].second;
		int pu = parent(u,3);
		int pv = parent(v,3);
		if(pu==pv) continue;
		curcnt--;
		cnt++;
		pr[3][pu] = pv;
	}
	for(int i = 1; i <= 2; i++){
		int cur = curcnt;
		for(int j = 0; j < a[i].size(); j++){
			int u = parent(a[i][j].first,3);
			int v = parent(a[i][j].second,3);
			int pu = parent(u,i);
			int pv = parent(v,i);
			if(pu==pv) continue;
			cur--;
			cnt++;
			pr[i][pu] = pv;
		}
		if(cur!=1){
			cout << -1;
			return 0;
		}
	}
	cout << m-cnt;
}