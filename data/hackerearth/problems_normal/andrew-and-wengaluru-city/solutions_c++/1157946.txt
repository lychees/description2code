#include <iostream>
using namespace std;

int main()
{
    
    int T;
    long N;
    cin>>T;
    while(T--)
    {
	    cin>>N;
	    
	    long *A = new long[N];
	    
	    for(int i=0;i<N;i++)
	       cin>>A[i];
	       
	    long global_waterHist = 0;
	    
	    
	    
	    int h1 = A[0];
	    int i;
	    //int h2 = -1;
	    
	    
	    long waterSubHist = 0;
	    
	    
	    int processed_index = 0;
	    
	    
	    for(i=1;i<N;i++)
	    {
	    	if(processed_index == i-1 && A[i] >= h1 )
	    	{
	    		processed_index = i;
	            h1 = A[i]; 
	            waterSubHist = 0;
	    	}
	        else if(A[i] < h1)
	    		waterSubHist += h1 - A[i];      
	        else
	        {
	    		processed_index = i;
	    		global_waterHist += waterSubHist;
	    		h1 = A[i]; 	    	
	    		waterSubHist = 0;
	    	}	    	   	
	    }
	    
	   // cout << global_waterHist <<endl;
	    
	    h1 = A[N-1];
	    
	    int backward_processed_index = N-1;
	    waterSubHist = 0;
	    for(i=N-2;i>=processed_index;i--)
	    {
	    	if(backward_processed_index == i+1 && A[i] >= h1 )
	    	{
	    		backward_processed_index = i; 
	            h1 = A[i]; 
	            waterSubHist = 0;
	    	}
	        else if(A[i] < h1)
	    		waterSubHist += h1 - A[i];
	        else
	    	{
	    		//processed_index = i;
	    		backward_processed_index = i;
	    		global_waterHist += waterSubHist;
	    		h1 = A[i]; 	 
	    		waterSubHist = 0;
	    	}	  
	    }	
	    
	   	 cout << global_waterHist % 1000000007 <<endl;
	    	
	      delete []A;	
	    }
	    
	   
	
    
    
    
    
    
    return 0;
}
