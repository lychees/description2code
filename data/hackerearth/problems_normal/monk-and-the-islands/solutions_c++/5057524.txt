#include <bits/stdc++.h>

using namespace std;

const int N = int(1e4)+1;
const int M = int (1e5)+1;
vector<int> g[N];
int dist[N];
int vis[N];

int main()
{
	int t; 
	cin >> t;
	while(t--)
	{
		int n,m;
		cin >> n >> m;
		for(int i=0;i<m;i++)
		{
			int u,v;
			cin >> u >> v;
			g[u].push_back(v);
			g[v].push_back(u);
		}
		queue<int> Q;
		Q.push(1);
		vis[1]=1;
		dist[1]=0;
		while(!Q.empty())
		{
			int u = Q.front();
			Q.pop();
			for(int i=0;i<g[u].size();i++)
				if(!vis[g[u][i]])
				{
					dist[g[u][i]]=dist[u]+1;
					Q.push(g[u][i]);
					vis[g[u][i]]=1;
				}
		}
		cout << dist[n] << endl;
		for(int i=1;i<=n;i++)
		{
			g[i].clear();
			vis[i]=0;
		}
	}
	return 0;
}