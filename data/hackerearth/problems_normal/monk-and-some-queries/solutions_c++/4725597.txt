#include <iostream>
#include <map>
using namespace std;

int main()
{
    int Q,N,X;
    cin>>N;
    map<int,int>mp;
    int count=0;
    while(N--)
    {
    	cin>>Q;
    	if(Q == 1)
    	{
    		cin>>X;
    		if(mp.find(X) != mp.end())
    		{
    			mp[X] += 1;
    		}
    		else
    		{
    			mp.emplace(X,1);
    		}
    	}
    	else if(Q == 2)
    	{
    		cin>>X;
    		if(mp.find(X) != mp.end())
    		{
    			mp[X] -= 1;
    			if(mp[X] == 0)
    			{
    				mp.erase(X);
    			}
    		}
    		else
    		{
    			cout<<"-1\n";
    		}
    	}
    	else if(Q == 3)
    	{
    		if(!mp.empty())
    			cout<<(--mp.end())->first<<endl;
    		else
    			cout<<"-1\n";
    	}
    	else if(Q == 4)
    	{
    		if(!mp.empty())
    			cout<<(mp.begin())->first<<endl;
    		else
    			cout<<"-1\n";
    	}
    }
    return 0;
}
