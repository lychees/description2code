#include<bits/stdc++.h>
#define ll long long
#define maxi 2147483647
#define INF 1e16
#define si(x) scanf("%d",&x)
#define sl(x) scanf("%ld",&x)
#define sll(x) scanf("%lld",&x)
#define ss(x) scanf("%s",x)
#define pi(x) printf("%d\n",x)
#define pl(x) printf("%ld\n",x)
#define pll(x) printf("%lld\n",x)
#define ps(x) printf("%s\n",x)
#define iter(i,a,b) for(int i=a; i<b; i++)
#define ited(i,a,b) for(int i=a;i>b;i--)
#define mp make_pair 
#define pb push_back 
#define max(a,b) a>b?a:b
#define min(a,b) a<b?a:b
//#define pop pop_back 
#define mod 1000000007
using namespace std;
typedef struct fuckers
{
	int l,r,id;
} fk;
bool cmp(fk s1,fk s2)
{
	if(s1.r>=s2.r)
		return false;
	return true;
}
int n;
ll bit[100001];
void updte(int in)
{
	for(int j=in;j<=n;j+=j&(-j))
		bit[j]+=1;
}
ll find(int in)
{
	ll an=0;
	for(int j=in;j>0;j-=j&(-j))
		an+=bit[j];
	return an;
}
int main()
{
	int m,d;
	si(n);si(m);si(d);
	int a[n+1],ind[100001],mine[n+1],maxe[n+1];
	iter(i,1,100001)
		ind[i]=0;
	iter(i,1,n+1)
	{
		si(a[i]);
		ind[a[i]]=i;
		mine[i]=max(1,a[i]-d);
		maxe[i]=min(a[i]+d,n);
	}
	//printf("hey");
	fk cht[m];
	iter(i,0,m)
	{
		si(cht[i].l);si(cht[i].r);
		cht[i].id=i;
	}
	//printf("hey");
	sort(cht,cht+m,cmp);
	int k=0;
	ll ans[m];
	iter(i,1,n+1)
	{
		for(int j=mine[i];j<=maxe[i];j++)
			if(ind[j]!=0 && ind[j]<=i)
				updte(ind[j]);
		for(;k<m && cht[k].r==i;k++)
		{
			int x=cht[k].l,y=cht[k].r,z=cht[k].id;
			if(x>1)
				ans[z]=find(y)-find(x-1);
			else
				ans[z]=find(y);
		}
	}
	iter(i,0,m)
		pll(ans[i]);
	return 0;
}
