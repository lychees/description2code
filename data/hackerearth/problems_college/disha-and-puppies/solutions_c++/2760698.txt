#include <bits/stdc++.h>
using namespace std;
bool dp[100005][1005];

int main() {
	// your code goes here
	int t;
	cin>>t;
	while(t--)
	{
		int n,k;
		cin>>n>>k;
		int m=2*k+1;
		int A[n+1];
		A[0]=0;
		for(int i=1;i<=n;i++)
		cin>>A[i];
		
	//	memset(dp,0,sizeof(dp));
		
		for(int i=0;i<=n;i++)
		dp[0][i]=true;
		for(int i=1;i<=m;i++)
		dp[i][0]=false;
		
		bool b,a;
		for(int i=1;i<=m;i++){
			for(int j=1;j<=n;j++){
				
				 a=dp[i][j-1];
				if(i>=A[j])b=dp[i-A[j]][j-1];
				else b=false;
				dp[i][j]=a||b;
				
			}
		}
		/*	cout<<"------------------------------------------------"<<endl;
			for(int i=0;i<=m;i++)
			{
			cout<<i<<" ";
			for(int j=0;j<=n;j++)
			cout<<dp[i][j]<<" ";
			cout<<endl;
			}
		cout<<"------------------------------------------------"<<endl;*/
		int ans;
		if(dp[k][n]==true){cout<<"Yes"<<endl;}
		else
		{
			for(int i=k;i>=1;i--)
			{
			if(dp[k-i][n])ans=k-i;
			if(dp[k+i][n])ans=k+i;
			}
			printf("No\n");
			cout<<ans<<endl;
		}
		
	}
	
	return 0;
}