#include<bits/stdc++.h>
using namespace std;
main()
{
	ios_base::sync_with_stdio(0);cin.tie(0);
	long long int t,count,b,c,sum,i;
	stack<int> a;
	cin>>t;
	while(t--)
	{
		count=0;sum=0;
		string s;
		cin>>s;
		int x=s.length()-1;
		for( i=x;i>=0;i--)
		{
			if(s[i]=='X')
			{
				count++;
				a.push(1);
			}
			else if(s[i]=='A')
			{
				b=a.top(); a.pop();
				c=a.top(); a.pop();
				a.push(b+c);
			}
			else
			{
				b=a.top(); a.pop();
				c=a.top(); a.pop();
				a.push(max(b,c));
			}
		}
		vector<int> c(count);
		for(i=0;i<count;i++)
		{
			cin>>c[i];
		}
		sort(c.begin(),c.end(),greater<int>());
		i=a.top();
		i--;
		for(;i>=0;i--)
		{
			sum+=c[i];
		}
		cout<<sum<<endl;
	}
}