#include<bits/stdc++.h>
using namespace std;
long long arr[10006];
long long brr[10006];
vector<int>v[10006];
int N,M;
int pr[10006];
void pre()
{
	pr[0]=1;
	pr[1]=1;
	for(int i=2;i*i<=M;i++)
	{
		if(!pr[i])
		{
			//pr[i]=i;
			//v[i].push_back(i);
			for(int j=i*i;j<=M;j+=i)
			{
				if(pr[j]==0)
				{
					pr[j]=i;
					v[i].push_back(j);
				}
			}
		}
	}	
	for(int i=2;i<=M;i++)
	{
		if(!pr[i])
		{
			pr[i]=i;
			v[i].push_back(i);
		}
	}
}
const long long MOD=1E9+3;
long long A[10005];
long long B[10005];

int main()
{
	
	scanf("%d %d",&N,&M);
	pre();
	long long s,p,q,r;
	long long w,x,y,z;
	scanf("%lld %lld %lld %lld",&s,&p,&q,&r);
	scanf("%lld %lld %lld %lld",&w,&x,&y,&z);
	int i,j;
	long long s1,s2;
	for(i=1;i<=N-1;i++)
	{
		for(j=1;j<=M;j++)
		{
			s1=(p*s)%MOD;
			s1=(s1*s)%MOD;
			s2=(q*s)%MOD;
			s2=(s2+r)%MOD;
			s1=(s1+s2)%MOD;
			s=s1;
			A[j]=s;
			s1=(x*w)%MOD;
			s1=(s1*w)%MOD;
			s2=(y*w)%MOD;
			s2=(s2+z)%MOD;
			s1=(s1+s2)%MOD;
			w=s1;
			B[j]=w;
		}
		for(j=1;j<=M;j++)
		{
			brr[j]=arr[j];
			//printf("%lld ",brr[j]);
		}
		//printf("\n");
		for(j=1;j<=M;j++)
		{
			arr[j]=brr[j]+A[j];
		}
		for(j=2;j<=M;j++)
		{
			arr[1]=min(arr[1],brr[j]+B[j]);
		}
		long long maxi=1E16;
		int ind1;
		for(j=2;j<=M;j++)
		{
			if(v[j].size()!=0)
			{
				maxi=1E16;
				for(int k=0;k<v[j].size();k++)
				{
					if(brr[v[j][k]]+B[v[j][k]]<maxi)
					{
						maxi=brr[v[j][k]]+B[v[j][k]];
						ind1=k;
					}
				}
				for(int k=0;k<v[j].size();k++)
				{
					if(k!=ind1)
					arr[v[j][k]]=min(arr[v[j][k]],maxi);
				}
				maxi=1e16;
				for(int k=0;k<v[j].size();k++)
				{
					if(k!=ind1&&brr[v[j][k]]+B[v[j][k]]<maxi)
					{
						maxi=brr[v[j][k]]+B[v[j][k]];
					}
				}
				arr[v[j][ind1]]=min(arr[v[j][ind1]],maxi);
			}
		}
	}
	long long answ=1e16;
	for(j=1;j<=M;j++)
	answ=min(answ,arr[j]);
	printf("%lld\n",answ);
	return 0;
}