def findsum(arr,i):
	if 2*i > len(arr):
		return arr[i-1]
	return	max(arr[i-1]+findsum(arr,2*i),arr[i-1]+findsum(arr,2*i+1))

def findmax(arr,i=1):
	if 2*i > len(arr):
		return arr[i-1]
	return max(findmax(arr,2*i),findmax(arr,2*i+1),arr[i-1]+findsum(arr,2*i)+findsum(arr,2*i+1))

t=int(raw_input())


for asfdsg in xrange(t):
	n=int(raw_input())
	arr=[int(e) for e in raw_input().split(' ')]
	print findmax(arr)