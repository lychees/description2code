#include <iostream>
#include <vector>
using namespace std;

struct criminal
{
	int x,y,s;
	char d;	
};

int main()
{
	int n,m,x,y;
	char d;
	vector<criminal> c;
	criminal a;
	
	cin >> m;
	
	while(m--)
	{
		cin >> n;
		
		for(int i=0; i<n; i++)
		{
			cin >> x >> y >> d;
			a.x=2*x, a.y=2*y, a.d=d, a.s=1;
			c.push_back(a);
		}
		
		for(int t=0; t<4003; t++)
		{
			for(int i=0; i<n; i++)
			{
				if(c[i].s!=0)
				{
					if(c[i].d == 'E')
						c[i].x += 1;
					
					else if(c[i].d == 'W')
						c[i].x -= 1;
						
					else if(c[i].d == 'N')
						c[i].y += 1;
					
					else if(c[i].d == 'S')
						c[i].y -= 1;		
				}
			}
			
			for(int i=0; i<n; i++)
			{
				int flag = 0;
				
				if(c[i].s!=0)
				{
					for(int j=i+1; j<n; j++)
					{
						if(c[j].s!=0 && c[i].x==c[j].x && c[i].y==c[j].y)
						{
							flag = 1;
							c[j].s = 0;
						}	
					}
					
					if(flag)
						c[i].s = 0;
				}
			}
		}
		
		int ctr=0;
		for(int i=0; i<n; i++)
			if(c[i].s!=0)
				ctr++;
				
		cout << ctr << "\n";

		c.clear();
	}
	
	return 0;
}