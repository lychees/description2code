#include <iostream>
using namespace std;
struct rack
{
	int s,e,v;
};
int main() {
	int t;
	cin>>t;
	while(t--)
	{
		int n,m;
		cin>>n>>m;
		rack a[n];
		int b[m];
		for(int i=0;i<n;i++)
		{
			cin>>a[i].s>>a[i].e>>a[i].v;
			if(i>=1)
			{
				rack te=a[i];
				int j=i;
				while(te.s<a[j-1].s&&j>0)
				{
					a[j]=a[j-1];
					j--;
				}
				a[j]=te;
			}
		}
		for(int i=0;i<m;i++)
		{
			cin>>b[i];
		}
		long long s=0;
		for(int i=0;i<n;i++)
		{
			int f=0;
			for(int j=a[i].s;f==0&&j<a[i].e;j++)
			{
				if(b[j]-1<0)
				{
					for(int k=a[i].s;k<j;k++)
					b[k]++;
					f=1;
				}
				else
				{
					b[j]--;
				}
			}
			if(f==0)
			s+=a[i].v;
		}
		cout<<s<<endl;
	}// your code goes here
	return 0;
}