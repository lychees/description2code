    #include <iostream>
    using namespace std;
     
    typedef long long int llint;
    llint search(llint x,llint* a,int l,int h)
    {
    	int m = (l+h)/2;
    	while(l!=m)
    	{
    		if(a[m] <=x )
    			l = m;
    		else
    			h = m;
    		m = (l+h)/2;
    	}
    	return l;
    }
    int main()
    {
        int t;
        cin>>t;
        while(t>0)
        {
        	llint n,k;
        	cin>>n>>k;
        	llint* a;
        	a = new llint[n+1];
        	for(int i=0;i<n;i++)
        	{
        		cin>>a[i];
        	}
        	a[n] = 10000000000;
        	long long int res = 0;
    		int i=0,j=0;
    		while(i<n && j<= n)
    		{
    			if(a[i]+k >= a[j])
    			{
    				j++;
    			}
    			else
    			{
    				i++;
    				long long int temp = j-i;
    				res+=(temp*(temp-1))/2;
    			}
    		}
        	cout<<res<<endl;
        	t--;
        }
        return 0;
    }