t=int(raw_input())
while t!=0:
    t-=1
    count=0
    a=[]
    x=[]
    z=[]
    n=int(raw_input())
    for i in range(0,n):
        z=raw_input()
        z=map(int,z.split())
        a.append(z[0])
        x.append(z[1])
    z=[0]*1000000
    z.append(0)
    for i in range(0,n):
        z[a[i]]+=1
        if z[x[i]]!=0:
           z[x[i]]=z[x[i]]-1
        else:
            count+=1
    print count