#include <bits/stdc++.h>
#define ll long long
#define mod 1000000007
using namespace std;
ll int n,k,m; //n balls,initial color,modulo m;
ll int a[1010];
ll int dp[1010][1010];
ll int ans=0;
ll int mysqr(ll int x)
{
	return (x*x)%mod;
}
ll int mypow(ll int x,ll int nn)
{
	ll int ans=1;
	if(nn==0)
	return 1;
	if(nn==1)
	return x;
	if(!(nn&1))     //n is even
	return mysqr(mypow(x,nn>>1));
	return (x * mysqr(mypow(x,(nn-1)>>1)))%mod;
}
ll int mycal(ll int c,ll int x)
{
	if(x==(n+1))
	{
		return c;
	}
	if(dp[c][x]==-1)
	{
		ll int t;
		t=mycal((c*a[x])%m,x+1);
		t=(t+mycal(c,x+1))%mod;
		dp[c][x]=t;
	}
	return dp[c][x];
}
int main()
{
	ios_base::sync_with_stdio(false);
	cin.tie(NULL);
	ll int test;
	cin>>test;
	while(test--)
	{
		cin>>n>>k>>m;
		ll int den=mypow(mypow(2ll,n),mod-2);
		ll int ans;
		ll int i,j;
		for(i=0;i<1010;i++)
		{
			for(j=0;j<1010;j++)
			dp[i][j]=-1;
		}
		for(i=1;i<=n;i++)
		cin>>a[i];
		ans=mycal(k%m,1);
		//~ cout<<ans<<endl;
		ans=(ans-(k%m)+k)%mod;
		ans=(ans*den)%mod;
		cout<<ans<<endl;
	}
	return 0;
}
