#include <bits/stdc++.h>
using namespace std;

#define rep(i, from, to) for (int i = from; i < int(to); ++i)
#define trav(a, x) for (auto& a : x)
#define all(x) x.begin(), x.end()
#define sz(x) (int)(x).size()
typedef long long ll;
typedef pair<int, int> pii;
typedef vector<int> vi;

const ll mod = 1000000007;

struct FT {
	int n;
	vi s;
	FT(int _n) : n(_n) {
		s.assign(n, 0);
	}
	void update(int pos, int dif) {
		for (; pos < n; pos |= pos + 1)
			s[pos] += dif;
	}
	int query(int pos) {
		int count = 0;
		for (; pos >= 0; pos = (pos & (pos + 1)) - 1)
			count += s[pos];
		return count;
	}
};

int main() {
	cin.sync_with_stdio(false);
	int N; cin >> N;
	FT f(N);
	ll res = 0;
	rep(i,0,2*N) {
		int a; cin >> a; --a;
		int lt = f.query(a-1);
		int eq = f.query(a) - lt;
		int gt = f.query(N-1) - lt - eq;
		res += gt*3 + eq*2 + lt;
		f.update(a, 1);
	}
	res %= mod;
	rep(i,0,N) {
		res *= 2;
		res %= mod;
	}
	if (res & 1) res += mod; res /= 2;
	if (res & 1) res += mod; res /= 2;
	cout << res << endl;
}
