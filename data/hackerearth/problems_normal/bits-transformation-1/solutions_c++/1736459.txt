#include <bits/stdc++.h>
using namespace std;
#define vi vector<int>
#define pb push_back
#define mp make_pair
#define all(x) x.begin(),x.end()
#define inf 1000000007
#define mod 1000000007
#define x first
#define y second
#define DBG(x) cerr<<(#x)<<"="<<x<<"\n";
#define ll long long
#define N 2005

char s[N],t[N];
int a,b,c,d,n,dp[N][N][3],f[N],w[N],v[2][N];
int id(int x){
	if(s[x]=='?')return 2;
	return s[x]-'0';
}
int solve(int l,int r,int k){
	if(r==n+1)return 0;
	//cerr<<l<<" "<<r<<" "<<k<<": ";
	int &ret=dp[l][r][k];
	if(ret+1)return ret;
	if(l==n+1){
		return ret=solve(l,r+1,k)+(t[r]-'0'!=k?(k==0?a:b):0);
	}
	ret=inf;
	
	int K=t[r]-'0';
	if(l==r){
		if(k==2){
			ret=solve(l+1,r+1,id(l+1))+c;
			int x=v[K][l];
			if(x!=-1){
				ret=min(ret,solve(x,r+1,1-K)+d*(x-l)+c*(f[x]-f[l-1]));
			}
		}
		else{
			if(K==k)ret=solve(l+1,r+1,id(l+1));
			else{
				ret=solve(l+1,r+1,id(l+1))+(k==0?a:b);
				int x=v[K][l];
				if(x!=-1)ret=min(ret,solve(x,r+1,1-K)+d*(x-l)+c*(f[x]-f[l]));
				int y=w[l];
				if(y==-1||(x!=-1&&y>x));
				else ret=min(ret,solve(y,r+1,1-K)+d*(y-l)+c);
			}
		}
	}
	else{
		if(K==k)ret=solve(l,r+1,k);
		else{
			ret=solve(l,r+1,k)+(k==0?a:b);
			int x=v[K][l];
			if(x!=-1)ret=min(ret,solve(x,r+1,1-K)+d*(x-r)+c*(f[x]-f[l]));
			int y=w[l];
			if(y==-1||(x!=-1&&y>x));
			else ret=min(ret,solve(y,r+1,1-K)+d*(y-r)+c);	
		}
	}
	//cerr<<l<<" "<<r<<" "<<k<<": ret="<<ret<<"\n";
	return ret;
}
int main()
{
	int T,i,j,k,m;
	//clock_t start=clock();
	scanf("%d",&T);
	while(T--){
		scanf("%d%d%d%d%d%s%s",&n,&a,&b,&c,&d,s+1,t+1);
		s[n+1]='0';
		//puts(s+1);
		for(i=1;i<=n;i++){
			f[i]=f[i-1]+(s[i]=='?');
		}
		w[n]=v[0][n]=v[1][n]=-1;
		for(i=n-1;i>=1;i--){
			if(s[i+1]=='?')w[i]=i+1;else w[i]=w[i+1];
			if(s[i+1]=='0')v[0][i]=i+1;else v[0][i]=v[0][i+1];
			if(s[i+1]=='1')v[1][i]=i+1;else v[1][i]=v[1][i+1];
		}
		for(i=0;i<=n+1;i++)
			for(j=0;j<=n+1;j++)
				for(k=0;k<3;k++)dp[i][j][k]=-1;
		int ans=solve(1,1,s[1]=='?'?2:s[1]-'0');

		printf("%d\n",ans);
	}
	//cout<<(clock()-start)/CLOCKS_PER_SEC*1000<<"ms\n";
	return 0;
}