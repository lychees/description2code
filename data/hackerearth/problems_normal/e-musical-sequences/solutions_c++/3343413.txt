#include <iostream>
#include<math.h>
using namespace std;

int main()
{
	long long int t;
	cin>>t;
	while(t--)
	{
		long long int i,ans;
		long long int m;
		unsigned long long int z,j,k,n,ul=1;
		// unsigned long double j,k;
		cin>>n>>m>>z;
		long long int a[n+1];
		a[n]=0;
		j=z%(n+ul);
		k=z/(n+ul);
		
		if(n&1)//odd
		{
		for(i=0;i<n;i++)
		{
			cin>>a[i];
			a[n]+=pow(-1,i)*a[i];
			a[n]%=m;
		}
		ans=a[j]%m;
		}
		else//even
		{
		for(i=0;i<n;i++)
		{
			cin>>a[i];
			a[n]+=pow(-1,i+1)*a[i];
			a[n]%=m;
		}
		if(k&1)
		ans=-a[j];
		else
		ans=a[j];
		ans=ans%m;
		}
		if(ans<0)
		ans+=m;
		cout<<ans<<endl;
		
	}
  
    return 0;
}
