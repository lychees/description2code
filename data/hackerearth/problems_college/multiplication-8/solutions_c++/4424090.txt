#include<iostream>
using namespace std;
int prod[100005],prod2[100005],a[100005];
int main()
{
	int n,m,q,ind,i;
    //scanf("%d %ld %ld",&n,&m,&q);
    cin >> n >> m >> q;
    for(i=1;i<=n;i++){
    	cin >> a[i];
    }
    prod[0] = 1;
    prod2[n+1] = 1;
    for(i = 1;i <= n;i++){
    	prod[i] = (prod[i-1]*a[i])%m;
    }
    for(i = n;i > 0;i--){
    	prod2[i] = (prod2[i+1]*a[i])%m;
    }
    while(q--){
    	cin >> ind;
    	cout << (prod[ind-1]*prod2[ind+1])%m << endl;
    }
    return 0;
}
