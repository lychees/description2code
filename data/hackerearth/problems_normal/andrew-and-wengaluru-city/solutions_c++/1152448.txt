#include <iostream>
#include <cstdio>
using namespace std;

long long int rainDrop(long long int a[],long long int len,long long int flag,long long int *temp,long long int size)
{
   long long int start,rain,tempend,i; 
   
   if(flag==0)
       start = 0;
   else
      start = size-1;
      
   while (start != len && a[start] == 0) { 
        if(flag==0)
            start++;
        else
            start--;
   }  
   
    rain=0;tempend=start;
    if(flag==0)
    {
        long long int tempsum=0;
       // printf("L-R ");
        for(i=start;i<len;i++)
        {
            
            if (a[tempend] <=a[i]) 
            {   
               rain += tempsum;  
             //  printf("%d ",rain);
               tempsum = 0;  
               tempend = i;  
             } 
             else 
             {   
               tempsum += (a[tempend] - a[i]);
             //  printf("%d ",rain);
             }    
        }
        
      // printf("\n");
    }
    else
    {    long long int tempsum=0;
        //  printf("R-L ");
         for(i=start;i!=len;i--)
        {
           
            if (a[tempend] <=a[i]) 
            { 
               rain += tempsum;  
            //   printf("%d ",rain);
               tempend = i;  
               tempsum = 0;  
             } 
             else 
             {  
               tempsum += (a[tempend] - a[i]);
            //   printf("%d ",rain);
             }     
        }
    }
    
   *temp=tempend;
    return rain;     
}

int main()
{
   
   long long int test,n;
   scanf("%d",&test);
   
   while(test--)
   {
   		long long int temp,ans=0,input[100010];
   		scanf("%lld",&n);
   		
   		for(long long int i=0;i<n;i++)
   		{
   			scanf("%lld",&input[i]);
   		}
   		
   		ans = rainDrop(input, n, 0,&temp,n); 
   
   		ans += rainDrop(input, temp-1, 1,&temp,n);  
   
   		printf("%lld\n",ans%1000000007);
   }
   
   
   return 0;
}
