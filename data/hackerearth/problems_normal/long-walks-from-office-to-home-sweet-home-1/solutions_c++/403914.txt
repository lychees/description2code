#include<bits/stdc++.h>
#define ll long long
using namespace std;
typedef vector<ll>row;
typedef vector<row>matrix;
#define lld I64d
#define pb push_back
#define sz size

ll N;

matrix mul(const matrix &a, const matrix &b)
{
	matrix c = matrix(N,(row(N,0)));
	for(size_t i = 0; i < c.size(); i++)
		for(size_t j = 0; j < c[i].size(); j++)
			for(size_t k = 0; k < a[i].size(); k++)
				c[i][j] = (c[i][j]+(a[i][k]*b[k][j]))%1000000007;
				
	return c;
}

matrix pow(const matrix &m, ll n)
{
	if(n <= 1)
		return m;
	matrix temp = pow(m,n/2);
	temp = mul(temp, temp);
	if(n & 1 == 1)
		temp = mul(temp, m);
	return temp;
}

int main() {
	int t;
	ll k,u,v,s;
	cin>>t;
	while(t--) {
		cin>>s>>k>>u>>v;
		N = s;
		matrix x = matrix(N, row(N, 0));
		for(int i = 0; i < N; i++) {
			for(int j = 0 ;j < N ; j++) {
				cin>>x[i][j];
			}
		}
		matrix ans = pow(x, k);
		cout<<ans[u][v]<<"\n";
	}
	return 0;
}