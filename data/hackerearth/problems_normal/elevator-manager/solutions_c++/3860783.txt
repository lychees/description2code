#include<bits/stdc++.h>
#define ll long long int
#define mod 1000000007
#define MAX 10000007
using namespace std;

bool isPrime[MAX+2];

void seive_N_logN(ll N)
{
    ///calculate prime upto N in NlogN time
    memset(isPrime,true,sizeof isPrime);

    isPrime[1]=false;
    for (ll i = 4; i<= N; i=i+2)
        isPrime[i]=false;

    for (ll i = 3; i * i<= N; i=i+2)
    {
        if (isPrime[i])
        {
            for (ll j = i * i; j <= N; j += i)
                isPrime[j] = false;
        }
    }
}

ll mulmod(ll a , ll b , ll mo)
{
    ll q = ((long double) a * (long double) b / (long double) mo);
    ll res = a * b - mo * q;
    return ((res % mo) + mo) % mo;
}
/*
ll mulmod(ll a,ll b,ll c)
{
    ///this function calculates (a*b)%c taking into account that a*b might overflow
    ll x = 0,y=a%c;
    while(b > 0)
    {
        if(b%2 == 1)
        {
            x = (x+y)%c;
        }
        y = (y*2)%c;
        b /= 2;
    }
    return x%c;
}
*/
ll bigmod (ll a, ll b, ll c)
{
    ll res = 1;
    while (b > 0)
    {
        if (b % 2 == 1)
        {
            //res = (res * a) % c;
            res=mulmod(res,a,c);
        }
        //a = (a * a) % c;
        a=mulmod(a,a,c);
        b=b/2;
    }
    return res;
}

bool miller(ll a,ll d , ll n)
{
    ll x = bigmod(a , d , n);
    if(x == 1 || x == n - 1)
    {
        return 1;
    }
    while(d != n - 1)
    {
        //x = (x*x)%n;
        x=mulmod(x,x,n);
        d *= 2;
        if(x == 1)
        {
            return 0;
        }
        if(x == n - 1)
        {
            return 1;
        }
    }
    return 0;
}

bool isPrimes(ll n)
{
    if(n<2)
    {
        return false;
    }
    if(n!=2 && n%2==0)
    {
        return false;
    }
    ll d=n-1;
    while(d%2==0)
        d=d/2;
    for(ll i=1; i<20; i++)
    {
        ll a=rand()%(n-1)+1;

        if(!miller(a,d,n))
            return false;
    }
    return true;
}


int main()
{
    ll t,n,q,i,j,ans,people,y,x,f,k;
    //freopen("input.txt","r",stdin);
    while(scanf("%lld %lld",&n,&q)!=EOF)
    {
        x=1;
        people=0;
        ans=0;

        for(i=1; i<=q; i++)
        {
            scanf("%lld %lld %lld",&t,&f,&k);

            if(t==1)
            {
                y=f+k;
                if(isPrimes(y))
                {
                    ans+=abs(f-x);
                    ans=ans%mod;
                    x=f;
                    people+=k;
                }
            }
            if(t==2)
            {
                y=f+k;
                j=sqrt(y+0.5);
                if(j*j==y)
                {
                    ans+=abs(f-x);
                    ans=ans%mod;
                    x=f;
                    people-=k;
                }
            }
            //cout<<ans<<" "<<people<<endl;
        }
        printf("%lld %lld\n",ans,people);
    }
    return 0;
}

