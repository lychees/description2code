#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
const int sz = 100010;
ll cache[sz];

map<ll, ll> m;
std::map<ll, ll>::iterator it;
int main() {

	ll n, hi, li;
	int negcnt = 0;
	int negvalue = INT_MIN;
	cin >> n;
	m[0] = 0;
	for (int i = 0; i < n; ++i) {
		cin >> hi >> li;
		if (hi > 0) {
			it = m.lower_bound(li);
			if (m.find(li) == m.end())
				--it;
			ll val = it->second + hi;
			m[li] = val;
			it = m.lower_bound(li);
			++it;
			while (it != m.end() && it->second <= val) {
				m.erase(it++);
			}
		} else {
			++negcnt;
			negvalue = max(negvalue * 1LL, hi);
		}
	}
	if (negcnt == n) {
		cout << negvalue;
	} else {
		ll res = 0;
		for (it = m.begin(); it != m.end(); ++it) {
			res = max(res, it->second);
		}
		cout << res << endl;
	}
	return 0;
}
