#include <iostream>
#include <bits/stdc++.h>
#define ll long long
#define MOD 1000000007
using namespace std;
vector<int>v[100005];
int in[100005],out[100005],n=1,h[100005];
void dfs(int s,int he){
	h[s]=he;
	in[s]=n++;
	for(int j=0;j<v[s].size();j++)
	dfs(v[s][j],he+1);
	out[s]=n++;
}
int main()
{
    ios::sync_with_stdio(false);cin.tie(0);cout.tie(0);
    int t,no,q;
    cin>>t;
    //cout<<t<<endl;
    while(t--){
    	cin>>no;
    	//cout<<no<<endl;
    	for(int i=1;i<=no;i++){
    	v[i].clear();
    	in[i]=0;
    	out[i]=0;
    	h[i]=0;
    	}
    	n=1;
    	int x,y,c;
    	for(int i=1;i<=no;i++){
    		cin>>x;
    		v[x].push_back(i);
    		if(x==0)
    		c=i;
    	}
    	dfs(c,1);
    	/*for(int i=1;i<=no;i++){
    		cout<<in[i]<<" "<<out[i]<<" "<<h[i]<<"\n";
    	}*/
    	cin>>q;
    	while(q--){
    		cin>>x>>y;
    		if(in[x]>in[y] and out[x]<out[y]){
    			cout<<h[x]-h[y]-1<<"\n";
    		}
    		else{
    			cout<<"-1\n";
    		}
    		//cout<<in[y]<<" "<<in[x]<<" "<<out[y]<<" "<<out[x]<<"\n";
    	}
    }
    return 0;
}
