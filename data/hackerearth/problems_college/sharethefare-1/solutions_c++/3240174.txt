#include <iostream>
#include <cstring>
#include <map>

using namespace std;

string per[51];
map<string, int> expenses, paid;

int main()
{
    int t;
    cin>>t;
    
    while(t--) {
    	int p, tr;
    	cin>>p>>tr;
    	for(int i = 0; i < p; ++i) {
    		string str;
    		cin>>str;
    		expenses[str] = 0;
    		paid[str] = 0;
    		per[i] = str;
    	}
    	
    	for(int i = 0; i < tr; ++i) {
    		string paidby;
    		cin>>paidby;
    		int amt;
    		cin>>amt;
    		int people;
    		cin>>people;
    		paid[paidby] += amt;
    		people += 1;
    		int each = amt/people;
    		int payby = each;
    		if(amt%people != 0) {
    			payby = amt - (each*(people-1));
    		}
    		expenses[paidby] += payby;
    		for(int j = 0; j < people-1; ++j) {
    			string person;
    			cin>>person;
    			expenses[person] += each;
    		}
    	}
    	for(int i = 0; i < p; ++i) {
    		int amt = expenses[per[i]] - paid[per[i]];
    		if(amt > 0) {
    			cout<<per[i]<<" owes "<<amt<<"\n";
    		}
    		else
    		if(amt < 0) {
    			cout<<per[i]<<" is owed "<<(-amt)<<"\n";
    		}
    		else
    			cout<<per[i]<<" neither owes nor is owed\n";
    	}
    	paid.clear();
    	expenses.clear();
    }
    
    return 0;
}
