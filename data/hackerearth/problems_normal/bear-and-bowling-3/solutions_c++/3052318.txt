#include<iostream>
#include<algorithm>
#define MOD 1000000007
using namespace std;

long long a[200005];

long long myPow(long long n) {
    if(n<=0) return 1;
    if(n==1) return 2;
    long long temp=myPow(n/2);
    if(n%2==1) {
        return ((temp*temp)%MOD*2)%MOD;
    }
    return (temp*temp)%MOD;
}

int main()
{
    long long i,j,n,m,temp,ans=0;
    cin>>n;
    for(i=1;i<=n;i++) {
        cin>>a[i];
        ans=(ans+((a[i]*myPow(n-i))%MOD*(((i-1)*myPow(i-2))%MOD+myPow(i-1))%MOD)%MOD)%MOD;
    }
    cout<<ans;
    return 0;
}
