#include <iostream>
#include<vector>
#include<limits.h>
#include<queue>
using namespace std;
#define MOD7 1000000007;
vector<int>g[100001];
int main() 
{
    int t;
    cin>>t;
    while(t--)
    {
        int n,m,x,y;
        cin>>n>>m;
        for(int i=0;i<=n;i++)
        	g[i].clear();
        while(m--)
        {
            cin>>x>>y;
            g[x].push_back(y);
            g[y].push_back(x);
        }
        vector<int>dis(n+1,INT_MAX);
        vector<int>visited(n+1,0);
        queue<int>q;
        q.push(1);
        dis[1]=0;
        while(!q.empty())
        {
            int t=q.front();
            q.pop();
            if(visited[t])
                continue;
            visited[t]=1;
            for(vector<int>::iterator z=g[t].begin();z!=g[t].end();z++)
            {
                dis[*z]=min(dis[*z],dis[t]+1);
                //cout<<t<<" "<<*z<<" "<<dis[*z]<<endl;
                if(*z!=n)
                    q.push(*z);
                
            }
        }
        cout<<dis[n]<<endl;
    }
	return 0;
}
