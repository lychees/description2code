// hackerearth - may easy 2016 - chemical mixtures
#include <bits/stdc++.h>
using namespace std;
#define lli long long int

vector <lli> w, a, best_res, res;

int main()
{
	ios::sync_with_stdio(0);
	lli t, m, i, n1, n2, e, best_sum, bitmask, s, total, cur_sum, j, pos;
	bool solved;
	cin >> t;
	while(t --)
	{
		cin >> m >> n1 >> n2;
		w.clear();
		a.clear();
		for(i = 1; i <= n1; i ++)
		{
			cin >> e;
			a.push_back(e);
		}
		for(i = 1; i <= n2; i ++)
		{
			cin >> e;
			w.push_back(e);
		}
		sort(a.begin(), a.end());
        solved = 0;
        best_res.clear();
        best_sum = -1;
        for(j = 0; j < (1 << n2); j ++)
        {
        	s = 0;
        	bitmask = j;
        	pos = w.size() - 1;
        	while(bitmask)
        	{
        		if(bitmask & 1)
        			s += w[pos];
                bitmask >>= 1;
                pos --;
        	}
        	total = m - s;
        	res.clear();
        	for(i = n1 - 1; i >= 0; i --)
        	{
        		if(a[i] <= total)
        		{
        			res.push_back(a[i]);
        			total -= a[i];
        			if(! total)
        				break;
        		}
        	}
        	if(! total)
        	{
                cur_sum = m - s;
                if(cur_sum > best_sum)
                {
                	best_sum = cur_sum;
                	best_res = res;
                	solved = 1;
                }
        	}
        }
        if(! solved)
        	cout << "NO \n";
        else
        {
        	cout << "YES \n";
        	sort(best_res.begin(), best_res.end());
        	for(i = 0; i < best_res.size(); i ++)
        		cout << best_res[i] << ' ';
        	cout << '\n';
        }
	}
	return 0;
}