//Pranet Verma
#include <bits/stdc++.h>
using namespace std;
long long at[100011];
int main() {
    int t;
    scanf("%d", &t);
    while (t--) {
        int n, m;
        long long l, r, c, p, q, s;
        scanf("%d %d", &n, &m);
        scanf("%lld %lld %lld %lld %lld %lld", &l, &r, &c, &p, &q, &s);
        while (m--) {
            at[l] += c;
            at[r + 1] -= c;
            long long nl = (l * p + r) % n + 1;
            long long nr = (r * q + l) % n + 1; 
            if (nl > nr)
                swap(nl, nr);
            c = c * s % 1000000 + 1;
            l = nl;
            r = nr;
        }
        pair<long long, int> ans;
        for (int i = 1; i <= n; ++i) {
            at[i] += at[i - 1];
            ans = max(ans, {at[i], -i});
        }
        for (int i = 1; i <= n + 1; ++i)
            at[i] = 0;
        printf("%d %lld\n", -ans.second, ans.first);
    }     
}