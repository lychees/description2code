#include <iostream>
#define MOD 1000000009
using namespace std;

long long f[300][300];
long long t[300][300];
int main()
{
    string s,op,res;
    int q,l,r;
    cin>>s>>op;
    int n=s.length();
    for(int i=0;i<n;++i)
    {
    	f[i][i]=(s[i]=='0')?1:0;
    	t[i][i]=(s[i]=='1')?1:0;
    }
    for(int gap=1;gap<n;++gap)
    {
    	for(int i=0,j=gap;j<n;++i,++j)
    	{
    		f[i][j]=0;
    		t[i][j]=0;
    		for(int k=i;k<j;++k)
    		{
    			long long tik=(t[i][k]+f[i][k])%MOD;
    			long long tkj=(t[k+1][j]+f[k+1][j])%MOD;
    			if(op[k]=='a')
    			{
    				t[i][j]=(t[i][j]+(t[i][k]*t[k+1][j])%MOD)%MOD;
    				f[i][j]=(f[i][j]+(tik*tkj)%MOD-(t[i][k]*t[k+1][j])%MOD)%MOD;
    				if(f[i][j]<0) f[i][j]+=MOD;
    			}
    			else if(op[k]=='o')
    			{
    				f[i][j]=(f[i][j]+(f[i][k]*f[k+1][j])%MOD)%MOD;
    				t[i][j]=(t[i][j]+(tik*tkj)%MOD-(f[i][k]*f[k+1][j])%MOD)%MOD;
    				if(t[i][j]<0) t[i][j]+=MOD;
    			}
    			else
    			{
    				t[i][j]=(t[i][j]+(t[i][k]*f[k+1][j])%MOD + (f[i][k]*t[k+1][j])%MOD)%MOD;
    				f[i][j]=(f[i][j]+(f[i][k]*f[k+1][j])%MOD + (t[i][k]*t[k+1][j])%MOD)%MOD;
    			}
    			
    		}
    	}
    }
    scanf("%d",&q);
    while(q--)
    {
    	cin>>l>>r>>res;
    	if(res=="true")
    		printf("%lld\n",t[l-1][r-1]);
    	else
    		printf("%lld\n",f[l-1][r-1]);
    }
    return 0;
}
