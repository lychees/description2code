mod = 10**9 + 7
n = input()
arr = map(int , raw_input().split())
ans = 0
for i in range(0 , n):
    ans = (ans + arr[i] * (i + 2)) % mod
print (ans * pow(2 , (n - 3 + mod) % (mod - 1) , mod)) % mod