/*    SHUBHAM SINHA    */
 
 
 
#include <cstdio>
#include <iostream>
#include <algorithm>
#include <string.h>
#include <vector>
#include <set>
#include <map>
#include <queue>
#include <list>
#include <math.h>
 
#define ll unsigned long long
#define maxN 100000
#define maxVal 100000000
#define minVal -100000000
#define mod 1000000007LL
 
#define gcd(a,b) __gcd(a,b)
 
using namespace std;
 
int a[maxN+5];
vector<int> g[maxN+5];
int in[maxN+5];
int out[maxN+5];
int timer;
int height[maxN+5];

void dfs(int u,int h)
{
	int i,v;
	in[u]=timer;
	timer++;
	height[u]=h;
	for(i=0;i<(int)g[u].size();i++)
	{
		v=g[u][i];
		dfs(v,h+1);
	}
	out[u]=timer;
	timer++;
}

int main()
{
    int t,i,n,x,y,q,r;
    scanf("%d",&t);
    while(t--)
    {
    	scanf("%d",&n);
    	for(i=1;i<=n;i++)
    	{
    		in[i]=0;
    		out[i]=0;
    		height[i]=0;
    		g[i].clear();
    	}
    	for(i=1;i<=n;i++)
    	{
    		scanf("%d",&a[i]);
    		if(a[i]==0)
    		{
    			r=i;
    			continue;
    		}
    		g[a[i]].push_back(i);
    	}
    	timer=0;
    	dfs(r,1);
    	scanf("%d",&q);
    	while(q--)
    	{
    		scanf("%d%d",&x,&y);
    		//check if y is superior of x
    		if(in[y]<in[x]&&out[x]<out[y])
    			printf("%d\n",height[x]-height[y]-1);
    		else
    			printf("-1\n");
    	}
    }
    return 0;
}