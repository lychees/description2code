#include<iostream>
#include<algorithm>
#include<math.h>
typedef long int _l____________i;
using namespace std;
int main()
{
  int ______________________________________________;
  cin>>______________________________________________;
  while(______________________________________________--)
  {
    _l____________i ______________=0;
    int arr[2000],k=0;
    // variables
     _l____________i ___=0,aa=604800;
    for(int i=0;i<7;i++)
    {

        _l____________i ____________________________;
        cin>>____________________________;
        ______________+=____________________________;
        for(int j=0;j<____________________________;j++)
        {
            int encoding,s;
            cin>>encoding>>s;
            arr[k++]=abs(encoding-s);

        }

    }
    ______________=ceil(______________*(.75));
    sort(arr,arr+k);
    for(int mo=0;mo<______________;mo++)
        {
            ___=___+arr[mo];
         }
    cout<<aa-___<<endl;
  }
  return 0;
}
