#include <iostream>
#include<bits/stdc++.h>
using namespace std;

int main()
{
	long long t , n , f[1000010] , m[1000010] , i , ans , a , b;
    cin >> t;
    while(t--)
    {
    	cin >> n;
    	memset(f , 0 , sizeof(f));
    	memset(m , 0 , sizeof(m));
    	for(i = 0; i < n; i++)
    	{
    		cin >> a;
    		cin >> b;
    		if(a != b)
    		{
    			f[a]++;
    			f[b]--;
    		}
    		if(m[b] > f[b])
    		{
    			m[b] = f[b];
    		}
    	}
    	ans = 0;
    		for(i = 1;  i < 1000010; i++)
    		{
    			ans += m[i];
    			
    		}
    		
    		cout << -ans << endl;
    }
    return 0;
}
