//basics toh mat bhool bhai
#include<bits/stdc++.h>
#include<algorithm>
using namespace std;
#define fr(i,a,b) for(int i=a;i<b;i++)
#define frn(i,a,b) for(int i=a;i>b;i--)
#define si(x) scanf("%d",&x)
#define sll(x)  scanf("%lld",&x)
#define pln printf("\n")
#define pi(x) printf("%d",x)
#define pll(x) printf("%lld",x)
#define mp make_pair
#define pb push_back
#define x first
#define y second
typedef long long ll;
ll MOD=1000000007;
ll pw(ll a,ll b){
  ll r=1;
  while(b>0){
     if(b&1){
       r=(r*a)%MOD;
        }
     b=b>>1;
     a=(a*a)%MOD;
  }
return (r)%MOD;
}
int lvl[100010]={};
int st[100010]={};
int ed[100010]={};
vector<int>rev[100010];
int n,y;
int t;
int ans;
int tim;
void dfs1(int u,int dep){
   lvl[u]=dep;
   st[u]=tim++;
   fr(i,0,rev[u].size()){
      dfs1(rev[u][i],dep+1);
   }
   ed[u]=tim++;
}

int main(){
    si(t);
    while(t--){
         si(n);
         int u,v;
         int s;
         fr(i,1,n+1){
         //  g[i].clear();
           rev[i].clear();
           lvl[i]=0;
           st[i]=0;
           ed[i]=0;
         }
         fr(i,1,n+1){
             si(v);
           // g[i].pb(v);
             rev[v].pb(i);
            //if(v==0)s=i;
         }
         tim=0;
          
         dfs1(0,0);
         int q;
         si(q);
         while(q--){
               si(u),si(v);
               ans=-1;
             // printf("st u v = %d %d\n ed u v= %d %d\n",st[u],st[v],ed[u],ed[v]);
               if(st[v]<st[u] && ed[v]>ed[u]){
               //	cout<<"in here\n";
                ans=lvl[u]-lvl[v]-1;
               }
                  pi(ans);pln;
         }


    }


return 0;
}
