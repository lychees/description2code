#include<bits/stdc++.h>
using namespace std;
#define rep(i,n) for(int i=0;i<n;i++)
#define ll long long int
#define pi pair<ll,ll>
#define pii pair<pi,int>
#define f first
#define s second
#define mod 1000000007
#define pb push_back
ll n,l,T,k;
ll dp[3334][3334]={0};
ll tdp[3334][3334];

ll sdp[3334][3334];
int main(){
	 // freopen("0.in","r",stdin),freopen("0.out","w",stdout);


    cin >> n >> l >> T >> k;
    if(l==1){
        if(T==n){
             ll ans=1;
             rep(i,n){
                ans*=k;
                ans%=mod;
             }
             cout<<ans;
        }
        else{
            cout<<0;
        }
        return 0;
    }
    for(int i=1;i<=T;i++){
    	if( i+l-1 < 3334 )
            dp[i+l-1][i]=k;
    }
    for(int i=1;i<l;i++){
        if(i==1){
            dp[i][0]=k;
            sdp[i][0] = k;
        }
        else{
            dp[i][0]=dp[i-1][0]*k;
            dp[i][0]%=mod;
            sdp[i][0] = (sdp[i-1][0] + dp[i][0]) % mod;
        }
    }

    for(int i=2;i<=n;i++){
        for(int t=0;t<=T;t++){
            if(t==0 and i<l) continue;
            tdp[i][t]+=tdp[i-1][t-1]+dp[i-1][t-1];
            tdp[i][t]%=mod;

            dp[i][t]+=tdp[i-l+1][t]*(k-1);
            dp[i][t]%=mod;

            dp[i][t] += ((sdp[i-1][t] - sdp[max(1, (int)(i-l+1)) -1][t] +mod) * (k-1))%mod;
			dp[i][t]%=mod;

            sdp[i][t]  = (sdp[i-1][t] + dp[i][t])%mod;

        }
    }
    cout<<dp[n][T]%mod;
}
