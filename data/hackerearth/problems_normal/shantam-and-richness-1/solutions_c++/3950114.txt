#include <cstdio>
#include <vector>
 
int main()
{
    int t;
    scanf("%d", &t);
    while ( t-- )
    {
        int n, m;
        scanf("%d %d", &n, &m);
 
        int l, r, c, p, q, s;
        scanf("%d %d %d %d %d %d", &l, &r, &c, &p, &q, &s);
 
        std::vector<int> li(m); li[0] = l;
        std::vector<int> ri(m); ri[0] = r;
        std::vector<int> ci(m); ci[0] = c;
        const int MOD = 1000000;
        for ( int i = 1; i < m; ++i )
        {
            li[i] = (1ULL*li[i - 1]*p + ri[i - 1])%n + 1;
            ri[i] = (1ULL*ri[i - 1]*q + li[i - 1])%n + 1;
            if ( ri[i] < li[i] )
                std::swap(li[i], ri[i]);
            ci[i] = (1ULL*ci[i - 1]*s)%MOD + 1;
        }
 
        std::vector<unsigned long long> add(n + 1);
        std::vector<unsigned long long> rem(n + 1);
        for ( int i = 0; i < m; ++i )
        {
            add[li[i]] += ci[i];
            rem[ri[i]] += ci[i];
        }
 
        unsigned long long val = 0;
        unsigned long long result = 0;
        int ind = -1;
        for ( int i = 1; i <= n; ++i )
        {
            val += add[i];
 
            if ( val > result )
            {
                result = val;
                ind = i;
            }
 
            val -= rem[i];
        }
 
        printf("%d %llu\n", ind, result);
    }
 
    return 0;
}