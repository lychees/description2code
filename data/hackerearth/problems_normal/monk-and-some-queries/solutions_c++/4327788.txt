#include <bits/stdc++.h>
using namespace std;
#define ll long long
#define pii pair<int,int>
#define pll pair<ll,ll>
#define mp make_pair
#define ff first
#define ss second
#define pb push_back
#define pf pop_front
#define IOS ios::sync_with_stdio(false)
multiset <int> s;
int main(){

	int q , x , i , j , k , type;
    cin >> q;
    while(q--){
        cin >> type;
        if(type==1){
            cin >> x;
            s.insert(x);
        }
        else if(type==2){
            cin >> x;
            if(s.find(x)==s.end())cout << "-1" << endl;
            else{
                s.erase(s.find(x));
            }
        }
        else if(type==3){
            if(s.size()==0)cout << "-1" << endl;
            else
            cout << *(s.rbegin()) << endl;
        }
        else{
            if(s.size()==0)cout << "-1" << endl;
            else
            cout << *s.begin() << endl;
        }
    }
	return 0;
}