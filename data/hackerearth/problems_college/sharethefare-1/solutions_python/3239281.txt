from collections import OrderedDict

t = int(raw_input())
for i in range(t):
	[n,q] = map(int, raw_input().split())
	payment = OrderedDict()
	for j in range(n):
		payment[raw_input()] = 0
	for j in range(q):
		paid_by = raw_input()
		amount = int(raw_input())
		div = int(raw_input())
		amount -= (amount % (1+div))
		payment[paid_by] += (amount - (amount/(1+div)))
		for k in range(div):
			payment[raw_input()] -= (amount/(1+div))
	for name, amount in payment.iteritems():
		if amount == 0:
			print name + " neither owes nor is owed"
		elif amount > 0:
			print name + " is owed " + str(amount)
		else:
			print name + " owes " + str(-amount)