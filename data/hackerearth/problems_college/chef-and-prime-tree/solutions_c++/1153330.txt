#include<iostream>
#include<vector>
#include<algorithm>
using namespace std;
int isprime[10000001]={0},primei=2,primej;


void prime(){
isprime[0]=1;isprime[1]=1;
for(primei=2;primei*primei<=10000000;primei++)
{
if(isprime[primei]==1)
continue;
for(primej=primei*2;primej<=10000000;primej+=primei)
isprime[primej]=1;
}}

int main(){
prime();
int q;
cin>>q;
while(q--)
{long long int ans=0;
	int x,y;
	
	cin>>x>>y;
	while(x!=y)
	{
		
		if(x>y)
		{
			if(isprime[x])
			ans+=x;
			else
			ans-=x;
			x/=2;
		}
		if(y>x)
		{if(isprime[y])
			ans+=y;
			else
			ans-=y;
			y/=2;
			
		}
	}
	if(isprime[y])
			ans+=y;
			else
			ans-=x;
	cout<<ans<<endl;
	
}
return 0;
}
