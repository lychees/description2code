#include <bits/stdc++.h>
using namespace std;
#define MOD 1000000007
#define ll long long 
#define FOR(i,n) for(int i=0;i<n;i++)
#define matrix vector< vector<ll> >

matrix mul(matrix &A,matrix &B,int N)
{
	matrix C(N,vector<ll>(N));
	FOR(i,N) FOR(j,N) FOR(k,N)
	C[i][j]=(C[i][j]+A[i][k]*B[k][j])%MOD;
	return C;
}

matrix _pow(matrix &A,ll p,int N)
{
	if(p==1) return A;
	if(p&1)
	{
		matrix y=_pow(A,p-1,N);
		return mul(y,A,N);
	}
	matrix X=_pow(A,p/2,N);
	return mul(X,X,N);
}

int main()
{
    //cout << "Hello World!" << endl;
    int t,n,u,v;
    ll k;
    cin>>t;
    while(t--)
    {
    	cin>>n>>k>>u>>v;
    	matrix map(n, vector<ll>(n));
    	for(int i =0;i<n;i++)
    	{
    		for(int j =0;j<n;j++)
    		{
    			scanf("%lld",&map[i][j]);
    		}
    	}
    	map=_pow(map,k,n);
    	cout<<map[u][v]<<endl;
    	
    }
    return 0;
}
