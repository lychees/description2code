#include<bits/stdc++.h>
using namespace std;

int arr[5000001] = {0};
void sieve()
{
	int limit = 5000000;
	for(int i=2;i<=limit;i++) arr[i] = 1;
	for(int i=2;i<=limit;i++)
	{
		if(!arr[i]) continue;
		int j = 2*i;
		while(j<=limit)
		{
			arr[j] = 0;
			j+=i;
		}
	}
}

int level(int a)
{
	int ret = 0;
	while(a)
	{
		ret++;
		a/=2;
	}
return ret;
}

int main()
{
	sieve();
	int t;
	cin>>t;
	while(t--)
	{
		int x,y;
		cin>>x>>y;
		long long int ans = 0;
		int l1 = level(x),l2 = level(y);
		while(l1 != l2)
		{
			if(l2 > l1)
			{
				l2--;
				if(arr[y]) ans -= y; else ans += y;
				y/=2;
			}
			else
			{
				l1--;
				if(arr[x]) ans -= x; else ans += x;
				x/=2;
			}
		}
		while(x!=y)
		{
			if(arr[y]) ans -= y; else ans += y;
			if(arr[x]) ans -= x; else ans += x;
			y/=2;
			x/=2;
		}
		if(arr[x]) ans -= x; else ans += x;
		cout<<ans<<endl;
	}
	return 0;
}