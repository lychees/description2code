/*
jai shree ram _/\_
A hacker from NITP
*/

#include<bits/stdc++.h>
using namespace std;

#define mod 1000000007
typedef set<string> ss;
typedef vector<int> vs;
typedef map<int,char> msi;
typedef pair<int,int> pa;
typedef long long int ll;

ll i, j, ans,n,k,rp,R[2][100002];
string s;
int main()
{
	//freopen("i.in", "r", stdin);
  	//freopen("o.out", "w", stdout);
  	int t;
	cin>>t;
	while(t--)
	{
		cin>>s;
		n=s.length();
  		s = "@" + s + "#";
		ans=0;
  		for(j = 0; j <= 1; j++)
  		{
    		R[j][0] = rp = 0; i = 1;
    		while(i <= n)
   			{
     			while(s[i - rp - 1] == s[i + j + rp]) rp++;
      			R[j][i] = rp;
      			k = 1;
      			while((R[j][i - k] != rp - k) && (k < rp))
      			{
        			R[j][i + k] = min(R[j][i - k],rp - k);
        			k++;
      			}
      			rp = max(rp - k,0LL);
      			i += k;
    		}
  		}
  		for(j=0;j<=1;j++)
  		{
  			for(i=1;i<=n;i++)
  			{
  				if(j==0)
  				ans=(ans+(R[j][i]*(R[j][i]+1))%mod)%mod;
  				else
  				{
  					//cout<<j<<" "<<R[j][i]<<"\n";
  					k=(R[j][i]+1)*2;
  					ans=(ans+k*(k+1)/2-(R[j][i]+1)*(R[j][i]+2))%mod;
  				}
  				//cout<<i<<" "<<ans<<"\n";
  			}
  		}
  		cout<<ans<<"\n";
	}
	return 0;
}

