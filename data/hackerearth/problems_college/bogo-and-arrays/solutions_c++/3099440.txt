#include <bits/stdc++.h>

using namespace std;

#define icin(x) scanf("%d",&x)
#define lcin(x) scanf("%lld",&x)
#define mp make_pair
#define pb push_back

#define MOD (LL(1e9)+7)

typedef long long LL;
typedef vector<int> vi;
typedef vector<vi> vvi;
typedef pair<int,int> pii;

const int maxn=int(2e6);

int v[maxn];
LL dp1[maxn],dp2[maxn];
stack<int> s;

int main(){
  int t;
  icin(t);
  while(t--){
    int n,k;
    icin(n);
    icin(k);
    for(int i=0;i<n;i++){
      icin(v[i]);
    }
    
    while(!s.empty())s.pop();
    s.push(0);
    dp1[0]=0;
    for(int i=1;i<n;i++){
      while(!s.empty() && v[s.top()]<v[i])s.pop();
      if(s.empty()) dp1[i]=0;
      else dp1[i]=s.top()+1;
      s.push(i);
    }
    
    while(!s.empty())s.pop();
    s.push(n-1);
    dp2[n-1]=n-1;
    for(int i=n-2;i>=0;i--){
      while(!s.empty() && v[s.top()]<=v[i])s.pop();
      if(s.empty())
        dp2[i]=n-1;
      else
        dp2[i]=s.top()-1;
      s.push(i);
    }

    LL ans=0;
    for(int i=0;i<n;i++){
      if(v[i]>k){
        ans += (i-dp1[i]+1)*(dp2[i]-i+1);
      }
      // i=dp2[i]+1;
    }
    printf("%lld\n",ans);
  }
  return 0;
}