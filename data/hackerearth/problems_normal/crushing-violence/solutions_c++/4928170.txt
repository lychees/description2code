#include<iostream>
#include<unordered_map>

using namespace std;
#define IOS ios_base::sync_with_stdio(false);cin.tie(0)

int main() {
  IOS;
  unordered_map<int, int> boyBeatTimes;
  unordered_map<int, int>girlBeatTimes;
  unordered_map<int, int> boyToGirl;
  unordered_map<int, int>girlToBoy;
  int t, n;

  cin >> t;
  while (t--) {
    boyBeatTimes.clear();
    girlBeatTimes.clear();
    boyToGirl.clear();
    girlToBoy.clear();
    cin >> n;
    int crush;
    for (int i = 0; i < n; i++) {
      cin >> crush;
      boyToGirl[i] = crush-1;
    }

    for (int i = 0; i < n; i++) {
      cin >> crush;
      girlToBoy[i] = crush-1;
    }
    int pairs = 0;
    int max = 0;
    for (int i = 0; i < n; i++) {
      int girl = boyToGirl[i];
      int boy = girlToBoy[girl];
      if (boy == i) {
        continue;
      }
      else {
        boyBeatTimes[boy]++;
        if (boyBeatTimes[boy]>max) {
          max = boyBeatTimes[boy];
        }
        int gFind = boyToGirl[boy];
        if (girlToBoy[gFind] == i) {
          pairs++;
        }
      }

    }

    for (int i = 0; i < n; i++) {
      int boy = girlToBoy[i];
      int girl = boyToGirl[boy];
      if (girl == i) {
        continue;
      }
      else {
        girlBeatTimes[girl]++;
        if (girlBeatTimes[girl]>max) {
          max = girlBeatTimes[girl];
        }

        int bFind = girlToBoy[girl];
        if (boyToGirl[bFind] == i) {
          pairs++;
        }
      }
    }

    cout << max << " " << pairs/2 << "\n";

  }

  return 0;
}
