#include<bits/stdc++.h>
using namespace std;
#define MOD 1000000006
#define MOD2 1000000007
#define ll long long int
ll modular_pow(ll base, ll exponent)
{
    ll result = 1;
    while (exponent > 0)
    {
        if (exponent&1)
 		{
		    result = (result*base);
            if(result>=MOD2)result=result%MOD2;
        }
        exponent=exponent>>1;
        base=(base*base) ;
        if(base>=MOD2)
		base=base%MOD2;
    }
    return result;
}
int main()
{
	int n;
	long long int temp,a,b;
	a=b=1;
	scanf("%d",&n);
	for(int i=0;i<n;i++)
	{
		scanf("%lld",&temp);
		a=a*temp;
		if(a>=MOD)a=a%MOD;
	}
	for(int i=0;i<n;i++)
	{
		scanf("%lld",&temp);
		b=b*temp;
		if(b>=MOD)b=b%MOD;
	}
	b--;
	if(b==-1)b=MOD-1;	
	long long int num=modular_pow(2,a)-1;
	a=a+b;
	if(a>=MOD)a=a-MOD;
	long long int den=modular_pow(2,a);
	num=num*modular_pow(den,MOD2-2);
	num=num%MOD2;
	printf("%lld\n",num);
	return 0;
}