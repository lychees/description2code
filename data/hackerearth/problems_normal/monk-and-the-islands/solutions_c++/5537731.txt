#include <stdio.h>
#include<math.h>
#include<vector>
#include<iostream>
#include<stdlib.h>
#include<stack>
#include<climits>
#include<algorithm>
#include <sstream>
#include<bits/stdc++.h>
#define SSTR( x ) static_cast< std::ostringstream & >( \
        ( std::ostringstream() << std::dec << x ) ).str()
using namespace std;
const int MAX = 100006;
const int INF = 0x3f3f3f3f;
typedef pair< int, int > pin;
vector < pin > a[MAX];
long long d[MAX];
void dij(int start)
{
    int u,v,i,c,w;
    priority_queue< pin , vector < pin > ,greater < pin > > q;
    memset(d,0x3f,sizeof(d));
    q.push(pin(0,start));
    d[start]=0;
    while(!(q.empty()))
    {
        u=q.top().second;
        c=q.top().first;
        q.pop();
        if(d[u]<c)
        {
            continue;
        }
        for(int i=0; i<a[u].size(); i++)
        {
            v=a[u][i].first;
            w=a[u][i].second;
            if(d[v]>d[u]+w)
            {
                d[v]=d[u]+w;
                q.push(pin(d[v],v));
            }
        }
    }
}


int main()
{
    int t;
    cin>>t;
    while(t--)
    {
        int n,m;
        cin>>n>>m;
        int u,v;
        for(int i = 1; i <= n; i++)
            a[i].clear();
        for(int i = 0; i < m; i++)
        {
            scanf("%d %d", &u, &v);
            a[u].push_back(pin(v, 1));
            a[v].push_back(pin(u, 1));
        }
        dij(1);
        printf("%d\n",d[n]);
    }
    return 0;
}
