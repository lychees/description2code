#!/usr/bin/python

import sys
from Queue import PriorityQueue

t = int(raw_input())
for iteration in range(t):
	Qr = PriorityQueue()
	Qc = PriorityQueue()
	n, k = map(int, raw_input().strip().split(" "))
	grid = [map(int, raw_input().strip().split(" ")) for _ in range(n)]
	for i in range(n):
		row_sum = 0
		col_sum = 0
		for j in range(n):
			row_sum += grid[i][j]
			col_sum += grid[j][i]
		Qr.put(row_sum)
		Qc.put(col_sum)

	rows = [0]
	cols = [0]
	for i in range(1,k+1):
		lowR = Qr.get()
		lowC = Qc.get()
		rows.append(rows[i-1]+lowR)
		cols.append(cols[i-1]+lowC)
		Qr.put(lowR+n)
		Qc.put(lowC+n)

	discomfort = sys.maxint
	for i in range(k+1):
		discomfort = min(rows[i]+cols[k-i]+i*(k-i),discomfort)
	print discomfort