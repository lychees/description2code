#include<stdio.h>
#include<iostream>
#include<bits/stdc++.h>
using namespace std;

typedef long long ll;

ll a[1100];
const ll N=1000000000000000LL;
const ll MOD = 1000000007;
char s[110];
int l;
int m;
vector<ll> ss[1100];
bool com(ll n, int x, char c)
{
 //   printf("%lld %d\n",n,x);
    while(x>l)
    {
//        int idx = upper_bound(ss[x-l].begin(),ss[x-l].end(),n)-ss[x-l].begin()-1;
//        if(idx)
//        n-=ss[x-l][idx-1];
//        x=idx+x-l;

     //   printf("x=%d\n",x);
       for(int i=x-l;i<=x-1;i++)
        {
            n-=a[i];
            if(n<=0)
            {
                n+=a[i];
                x = i;
                break;
            }
        }
    }
    if(s[x]=='-')
    {
        s[x]=c;
        return true;
    }
    else
        return s[x]==c;
}
bool cal(ll n, ll x, char c)
{
    int p=x%l;
    while(p+l<=x&&p<m)
        p+=l;
    int st = p;
    if(p>=m)
    {
        for(int i=p-l;i<=p-1;i++)
        {
            n-=a[i];
            if(n<=0)
            {
                n+=a[i];
                st = i;
                break;
            }
        }
    //    if(st==m)
     //       exit(1);
    }
  //  printf("%lld %d %d\n",n,st,m);
    return com(n,st,c);
}

ll precal()
{
    int i;
    for(i=1;i<=l;i++)
        a[i]=1;
    for(i=l+1;;)
    {
        ll sum=0;
        for(int j=0;j<l;j++)
            sum += a[i-l+j];
        a[i]=sum;
        if(sum>=N)
            break;
        else
            i++;
    }
    m=i;
    for(int i=1;i<m;i++)
    {
        ll s=0;
        for(int j=i;j<i+l&&j<=m;j++)
        {
            s+=a[j];
            ss[i].push_back(s);
        }
    }
    return a[m];
}
int main()
{
    int nc;
    scanf("%d%d",&l,&nc);
    precal();
    for(int i=1;i<=l;i++)
        s[i]='-';
    ll ans=1;
    while(nc--)
    {
        ll n,x;
        char str[200];
        scanf("%lld%lld%s",&n,&x,str);
        if(n>N||x>N)
            return 1;
        if(!cal(n,x,str[0]))
        {
            ans=0;
        }
    }
   // exit(1);
    for(int i=1;i<=l;i++)
            if(s[i]=='-')
            {
              //  printf("i = %d\n",i);
                ans=(ans*62)%MOD;
            }
    printf("%lld\n",ans);
    return 0;
}
