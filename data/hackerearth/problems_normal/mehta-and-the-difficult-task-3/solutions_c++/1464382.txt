#include <iostream>
#define p 16
#define mod 1000000007ULL
#define ull unsigned long long
using namespace std;

ull A[p][p]={0};
ull M[p][p]={0};

void multiply(ull a[p][p],ull b[p][p])
{
ull c[p][p];
for(int i=0;i<p;i++)
{
for(int j=0;j<p;j++)
{
c[i][j]=0;
for(int k=0;k<p;k++)
c[i][j]=(c[i][j]+(a[i][k]*b[k][j])%mod)%mod;
}
}
for(int i=0;i<p;i++)
{
for(int j=0;j<p;j++)
a[i][j]=c[i][j];
}
}

void exponent(ull n)
{
while(n)
{
if(n&1)
multiply(M,A);
n/=2;
multiply(A,A);
}
}

int is_power_of_two(int x)
{
return x && (!(x&(x-1)));
}


void init()
{
for(int i=0;i<p;i++)
{
for(int j=0;j<p;j++)
{
A[i][j]=is_power_of_two(i^j);
M[i][j]=0;
}
M[i][i]=1;A[i][i]=6;
}    	
}

int main()
{
    int t;
    cin>>t;
    while(t--)
    {
    init();
	ull n;int a,b,c,d;
	cin>>n>>a>>b>>c>>d;
	int mask=8*a+4*b+2*c+d;
	if(n!=1)
	{
    exponent(n-1);
    ull res=(M[mask][0]*6)%mod;
    for(int i=1;i<16;i++)
    {
    if(is_power_of_two(i))
    res=(res+M[mask][i])%mod;
    }
    cout<<res<<"\n";
	}
	else
	{
	if(mask==0)
	cout<<6<<"\n";
	else if(is_power_of_two(mask))
	cout<<1<<"\n";
	else
	cout<<0<<"\n";
	}
    }
    return 0;
}
