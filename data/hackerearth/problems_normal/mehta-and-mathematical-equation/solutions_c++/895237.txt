#include<stdio.h>
#include<iostream>
#include<string.h>
#include<queue>
#include<algorithm>
#include<string>
#include<map>
#include<set>
#include<fstream>
#include<cmath>
#include<iomanip>
#include<time.h>
#include<stack>
using namespace std;
#define ll long long
#define ull unsigned long long
#define inf 2000000007
#define mod 1000000007
#define pii pair<int,int>
#define vi vector<int>
#define VS vector<string>
#define all(x) x.begin(),x.end()
#define mp make_pair
#define pb push_back
#define x first
#define y second
#define N 1000010
#define pi 3.14159265358979323846
#define DBG(vari) cerr<<#vari<<"="<<(vari)<<endl;
#define FOREACH(i,t) for(__typeof(t.begin()) i=t.begin();i!=t.end();i++)

int dp[62][2],m,b[62];
int dfs(int x,int c)
{
	if(x==m)return c==0;
	int &ret=dp[x][c];
	if(ret+1)return ret;
	if(b[x]==c)
	{
		return ret=(3LL*dfs(x+1,1)%mod+dfs(x+1,0))%mod;
	}
	if(c==0)
	{
		return ret=(3LL*dfs(x+1,0)%mod);
	}
	if(c==1)
	{
		return ret=(3LL*dfs(x+1,1)%mod);
	}
}
int cal(ll n)
{
	if(n&1)return (n+1)/2%mod*(n%mod)%mod;
	else return n/2%mod*((n+1)%mod)%mod;
}
int main()
{
    //freopen("input.txt","r",stdin);
    //freopen("output.txt","w",stdout);
    int i,T,k,j,ca=0;
	scanf("%d",&T);
	while(T--)
	{
		ll n;cin>>n;
		ll x=n;m=0;
		while(x)b[m++]=x%2,x/=2;
		memset(dp,-1,sizeof(dp));
		int ans=dfs(0,0);
		ans=cal(n+1)-ans;
		if(ans<0)ans+=mod;
		printf("%d\n",ans);
	}
    return 0;
}