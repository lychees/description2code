#include <bits/stdc++.h>

using namespace std;

#define ll long long
#define lld I64d
#define ff first
#define ss second
#define mpa make_pair
#define pb push_back
#define sz size
#define mm 1000000007
#define gc getchar()

typedef vector<ll>row;
typedef vector<row>matrix;

int N;

matrix mul(const matrix &a, const matrix &b)
{
	matrix c = matrix(N,(row(N,0)));
	for(size_t i = 0; i < c.size(); i++)
		for(size_t j = 0; j < c[i].size(); j++)
			for(size_t k = 0; k < a[i].size(); k++)
				c[i][j] = (c[i][j]+(a[i][k]*b[k][j]))%mm;
				
	return c;
}

matrix pow(const matrix &m, ll n)
{
	if(n == 0 || n == 1 || n < 1)
		return m;
	matrix c = pow(m,n/2);
	c = mul(c,c);
	if(n&1)
		c = mul(c,m);
	return c;
}


void solve()
{
	ll K;
	int U;
	int V;
	
	scanf("%d%lld%d%d", &N, &K, &U, &V);
	
	matrix mat = matrix(N, row(N, 0));
	for(int i = 0; i < N; ++i) {
		for(int j = 0 ; j < N; ++j) {
			scanf("%lld", &mat[i][j]);
		}
	}
	
	matrix ma = pow(mat, K);
	printf("%lld\n", ma[U][V]);
}

int main()
{
	int T;
	scanf("%d", &T);
	while(T--)
		solve();
	return 0;
}
