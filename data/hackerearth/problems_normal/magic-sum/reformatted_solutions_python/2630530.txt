def rec(i):
    global lis
    if 2*i+1 > len(lis)-1:
        return lis[i], lis[i]
    l = rec(2*i+1)
    r = rec(2*i+2)
    return max(l[0], r[0], l[1]+r[1]+lis[i]), max(l[1], r[1])+lis[i]


T = int(raw_input())
for _ in xrange(T):
    N = int(raw_input())
    lis = [int(e) for e in raw_input().split()]
    print rec(0)[0]
