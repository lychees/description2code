#include <bits/stdc++.h>
 
using namespace std;
 
typedef long long ll;
const ll MOD = ll(1e9) + 7;
const ll MAX = ll(1e15);

int main() {
  ios::sync_with_stdio(false);
  cin.tie(nullptr);
  srand(1223);
  ll L, C;
  cin >> L >> C;
  vector<char> fixed(L, '_');
  vector<ll> seq(L,1);
  while(true) {
    const ll s = accumulate(seq.end() - L, seq.end(), 0LL);
    seq.push_back(s);
    //cerr << s << endl;
    if(s > MAX) {
      break;
    }
  }
  while(C-->0) {
    ll n, x;
    char ch;
    cin >> n >> x >> skipws >> ch;
    assert(n >= 1 && x >= 1);
    const ll mod = x % L;
    x=min(x,(ll)seq.size());
    while (x % L != mod)
    	++x;
    --n,--x;
    while (x >= L) {  
      ll sum = 0;
      for(ll i = x-L;;++i) {
        sum += seq[i];
        if (n < sum) {
          x = i;
          n -= sum - seq[i];
          break;
        }
      }
    }
    assert(n == 0);
    if(fixed[x] != '_' && fixed[x] != ch) {
      //cerr << x << ' ' << ch << endl;
      cout << "0\n";
      return 0;
    }
    fixed[x] = ch;
  }
  ll res = 1;
  for(auto ch : fixed)
    if(ch == '_')
      res = res * 62 % MOD;
  cout << res << endl;
  return 0;
}
