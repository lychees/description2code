#include <iostream>
#include<set>
using namespace std;

int main()
{
    multiset<int> A;
    multiset<int>::iterator it;
    int q,cond,x;
    cin>>q;
    while(q--)
    {
	    cin>>cond;
	    switch(cond)
	    {
	    	case 1: cin>>x;
	    	        A.insert(x);
	    	        break;
	    	case 2: cin>>x;
	    	        it=A.find(x);
	    	        if(it==A.end()) cout<<"-1\n";
	    	        else
	    	        	A.erase(it);
	    	        break;
	    	case 3: if(A.size()!=0)
	    	        cout<<*(A.rbegin())<<"\n";
	    	        else
	    	        cout<<"-1\n";
	    	        break;
	    	case 4: if(A.size()!=0)
	    	        cout<<*(A.begin())<<"\n";
	    	        else
	    	        cout<<"-1\n";
	    	        break;
	    	        
	    }
    }
    return 0;
}
