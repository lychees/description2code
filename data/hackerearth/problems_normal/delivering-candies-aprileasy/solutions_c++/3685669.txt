#include<bits/stdc++.h>
using namespace std;
#define inf 655555
#define mpa make_pair
#define pb push_back

#define ll unsigned long long
#define pp pair<ll,ll>
ll mod=1e17+7;
class prio
{
	public:
		int operator() (const pair<ll,ll> &p1,const pair<ll,ll>& p2)
		{
			return p1.second>p2.second;
		}
};
ll a[100005];
ll d[100005];


int main()
{
	priority_queue<pp,vector<pp >,prio >q;
	ios_base::sync_with_stdio(0);
	ll n,m,s,i,j,u,v,w;
	cin>>n>>m>>s;
	for(ll i=1;i<=n;i++) cin>>a[i];
	vector< pp >g[n+1];
	while(m--){
    cin>>u>>v>>w;
	g[u].pb(pp(v,w));
	g[v].pb(pp(u,w));
	}
	for(i=1;i<=n;i++) d[i]=mod;
	d[s]=0;
	q.push(pp(s,d[s]));
	while(!q.empty())
	{
		u=q.top().first;
		q.pop();
		for(ll i=0;i<g[u].size();i++)
		{
			v=g[u][i].first;
			w=g[u][i].second;
			if(d[v]>d[u]+w){   
			    d[v]=d[u]+w;
				q.push(pp(v,d[v]));
			}
		}
	}
	ll csum=0,c=0;
	for(i=1;i<=n;i++) if(d[i]!=mod) csum+=(d[i]*a[i]),c+=a[i];
	for(i=1;i<=n;i++){
		ll ans=0;
		ll t=csum-d[i]*a[i];
		ll t1=c-a[i];
		if(d[i]!=mod) ans=(t+t1*d[i]);
			  
	    if(ans<0) ans=0;
	    cout<<ans<<" ";
       
	   	
	}
	
	
	
}
	
	

	
	



