#include<iostream>

using namespace std;

long long maxmagic=-1;

long long a[600];

long long maxsum(int i, int N){
	long long l,r;
	l=r=-1;
//	cout<<"i="<<i<<"\n";
	if(2*i < N){
		 l=maxsum(2*i,N);
		 r=maxsum(2*i+1,N);
	}
	else{
		if(maxmagic<a[i]) maxmagic=a[i];
		return a[i];
	}
	//if(l+a[i]>maxmagic){
//		maxmagic=l+a[i];
//	}
	if(r+l+a[i]>maxmagic){
		maxmagic=r+a[i]+l;
	}
	if(l>r) return l+a[i];
	else return r+a[i];

}


int main(){

	int T;
	cin>>T;
	int N;
	//long a[600];
	while(T--){
		cin>>N;
		for(long i=1;i<=N;++i){
			cin>>a[i];
		}
		maxmagic=-100000000;
		maxsum(1,N);
		cout<<maxmagic<<"\n";
		
	}


}