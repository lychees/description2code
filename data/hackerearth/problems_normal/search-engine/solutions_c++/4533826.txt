#include <bits/stdc++.h>
using namespace std;

struct trie{
	trie* next[26];
	int weight;
	trie(){
		for(int i=0;i<26;i++)
			next[i]=NULL;
		weight=0;
	}
};

void insert(string &s,int w, trie* root){
	for(auto c:s){
		int index=c-'a';
		if(root->next[index]==NULL)
			root->next[index]=new trie();
		root->next[index]->weight=max(root->next[index]->weight,w);
		root=root->next[index];
	}
}

int search(string &s, trie* root){
	int ans=-1;
	for(auto c:s){
		int index=c-'a';
		if(root->next[index]==NULL)
			return -1;
		ans=root->next[index]->weight;
		root=root->next[index];
	}
	return ans;
}

int main(){
    int n,q,w;
    string s;
    trie* root=new trie();
    cin>>n>>q;
    while(n--){
    	cin>>s>>w;
    	insert(s,w,root);
    }
    while(q--){
    	cin>>s;
    	cout<<search(s,root)<<endl;
    }
    return 0;
}
