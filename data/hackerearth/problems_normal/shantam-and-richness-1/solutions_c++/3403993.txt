#include <stdio.h>
#include <malloc.h>
#include <math.h>

long long int swap(long long int *l, long long int *r,long long int i)
{
	long long int temp = l[i]; 
	l[i] = r[i];
	r[i] = temp;
}



 int main()
{
	long long int t,n,m,i,j,k,l,r,c,p,q,s,*L,*R,*C,*start,*end;
	long long int *ans;

	L = (long long int *)malloc(sizeof(long long int)*100005);
	R = (long long int *)malloc(sizeof(long long int)*100005);
	C = (long long int *)malloc(sizeof(long long int)*100005);
	start = (long long int *)malloc(sizeof(long long int)*100005);
	end = (long long int *)malloc(sizeof(long long int)*100005);
	ans = (long  long int *)malloc(sizeof(long long int)*100005);
	
	scanf("%lld",&t);
	
	for(j=0;j<t;j++)
	{	
	        //long long int *st;
	        
		
	        
			scanf("%lld%lld",&n,&m);
			scanf("%lld%lld%lld%lld%lld%lld",&l,&r,&c,&p,&q,&s);	
		    
		    for(i=0;i<=100005;i++)
		    {
	          ans[i] = 0;
	          start[i] = 0;
	          end[i] = 0;
			}
	       /// st = constructSt(ans,n);
	        
	        //for(long long int itr=0; itr<20;itr++)
		      // prlong long intf(" %d ", st[itr] );
	        
		    
		    L[1] = l;
		    R[1] = r;
		    C[1] = c;
		    
		    //for(k=L[1];k<=R[1];k++)
			//{
			//		ans[k] = ans[k] + C[1];
			//}
			
		//	updateSt(st,ans,L[1],R[1],C[1],0,n-1,0);
		    
		    for(i=2;i<=m;i++)
		    {
		    	L[i] = (((L[i-1] * p)%n + R[i-1]) % n + 1);
				R[i] = (((R[i-1] * q)%n + L[i-1]) % n + 1);
				if(L[i] > R[i])
    				swap(L , R,i);
			 C[i] = (C[i-1] * s) % 1000000 + 1;
				
				//for(k=L[i];k<=R[i];k++)
				//{
				//	ans[k] = ans[k] + C[i];
				//}
				
			    //updateSt(st,ans,L[i],R[i],C[i],0,n-1,0);
			
			}
			
		
			//prlong long intf("hello\n");
			
			for(i=1;i<=m;i++)
			{
				start[L[i]] = start[L[i]] + C[i];
			    end[R[i]] = end[R[i]] + C[i];
			}
			
			long long int sum=0;
			
			//prlong long intf("hello\n");
			
			for(i=1;i<=n;i++)
			{
				
				sum = sum + start[i];
				ans[i] = sum;
				sum = sum - end[i];
			}
			
			//prlong long intf("hello\n");
			
			//for(long long int itr=0; itr<20;itr++)
		      // prlong long intf(" %d ", st[itr] );
	        
			
			long long int mx = 0;
			long long int index;
			
			
			for(i=1;i<=n;i++)
			{
			    if(ans[i]>mx)
				{
					mx = ans[i];
					index = i;
			    } 	
			}
		
		 //   for(long long long long int itr=1; itr<=n;itr++)
		   //    prlong long long long intf(" %d ", st[itr] );
			
			printf("%lld %lld\n",index,mx);
	    
	}
	
	
	return 0;
}