 
#include <bits/stdc++.h>
#define ll long long int
#define MOD 1000000007
 
using namespace std;
int solve(){
  int k, l, s;
  scanf("%d%d%d",&k,&l,&s);
  vector<int> keyprob(255,0);
  {
    string keys;
    cin >> keys;
    //scanf("%s", &keys);
    for(int o=0;o<keys.size();o++)
      keyprob[keys[o]]++;
  }
  string target;
  cin >> target;
  //scanf("%s", &target);
  int overlap = 1;
  for(int i=1;i<target.size();i++){
    bool ok = 1;
    for(int j=i;j<target.size();j++){
      if(target[j]!=target[j-i]){
        ok = 0;
        break;
      }
    }
    if(ok){
      break;
    }
    overlap++;
  }
  int bstart = 1 + (s-l)/overlap;
  double prob = 1;
  for(int c=0;c<target.size();c++){
    prob = prob*keyprob[target[c]]/k;
  }
  if(prob == 0){
    printf("0.0");
    return 0;
  }
  prob = prob*(s-l+1);
  // int u = 0;
  // cout << bstart <<"*" <<prob <<"+";
  double ans = (bstart-prob);
  int numberofdecimals = 7;
		float pp=ans*1000000;
		while(((long long )pp)%10==0&&numberofdecimals>1){
			numberofdecimals--;
			pp/=10;
		}
		printf("%.*f", numberofdecimals, ans);
}
 
 
int main(){
  int t;
  scanf("%d",&t);
  for(int i=0;i<t;i++){
    printf("Case #%d: ",i+1);
    solve();
    printf("\n");
  }
}