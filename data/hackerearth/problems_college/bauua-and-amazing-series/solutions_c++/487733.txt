#include<bits/stdc++.h>
using namespace std;
void multiply(long long int f[3][3], long long int m[3][3]);
long long int ft(long long int n);
void power(long long int f[3][3],long long int n);
long long int i,j,k,l,m,n,t,ans,x,y,a,b,c;
#define mod 1000000007
int main()
{

    cin >> t;
       while(t--)
         {
            cin >> n >> x >> y >> a >>  b >> c;
            n--;
            if(n==0)
              ans=x%mod;
            else if(n==1)
              ans=y%mod;
            else
            ans=ft(n);
            while(ans<0)
                ans+=mod;
            cout << ans << "\n";
         }
    return 0;
}
void multiply(long long int f[3][3],long long int m[3][3])
{
    long long int p[3][3],i,j,k;
       for(i=0;i<3;i++)
       {
           for(j=0;j<3;j++)
           {
            p[i][j]=0;
               for(k=0;k<3;k++)
               {
                   p[i][j]=((p[i][j])+(f[i][k]*m[k][j])%mod)%mod;
               }
           }
       }
              for(i=0;i<3;i++)
              {
                  for(j=0;j<3;j++)
                  f[i][j]=p[i][j];
              }
    return;
}
void power(long long int f[3][3],long long int n)
{
    long long int m[3][3]={{a,b,c},{1,0,0},{0,0,1}};
            if(n==0||n==1)
                return;
             power(f,n/2);
            multiply(f,f);
            if(n%2==1)
            multiply(f,m);
}
long long int ft(long long int n)
{

    long long int f[3][3]={{a,b,c},{1,0,0},{0,0,1}};
         power(f,n-1);
    return (((f[0][0]*y)%mod+(f[0][1]*x)%mod)%mod+f[0][2])%mod;
}