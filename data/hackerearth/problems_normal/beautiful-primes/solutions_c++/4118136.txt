#include<bits/stdc++.h>
using namespace std;
#define ll long long int
#define MOD 1000000007
#define MAX 100005
ll modexp(ll a, ll b)
{ll res=1;while(b){if(b&1)res=(res*a)%MOD;a=(a*a)%MOD;b/=2;}return res;}
int primes[MAX];
int powers[MAX];
int main()
{
    //cout << "Hello World!" << endl;
    int t;
    int n;
    int i;
    scanf("%d",&t);
    while(t--)
    {
    	scanf("%d",&n);
    	for(i=0;i<n;++i)
    		scanf("%d",primes+i);
    	for(i=0;i<n;++i)
    		scanf("%d",powers+i);
    	ll sum = 1;
    	ll tmp;
    	for(i=0;i<n;++i)
    	{
    		tmp = (primes[i] * (modexp(primes[i],powers[i]) - 1)) % MOD;
    		tmp = (tmp * modexp(primes[i]-1,MOD-2)) % MOD;
    		sum = (sum*tmp)%MOD;
    	}
    	if(sum<0) sum+=MOD;
    	printf("%lld\n",sum);
    }
    return 0;
}
