#include <bits/stdc++.h>

using namespace std;
long long int a[100000] = {0};
long long int pos[100000] = {0};
long long int n,bit[100000] = {0};

void update(long long int pos)
{
    for (;pos <= n;pos += pos & -pos)
    {
        bit[pos]++;
    }
}

long long int query(int pos)
{
    long long int sum = 0;
    for ( ;pos > 0;pos -= pos & -pos)
        sum += bit[pos];

    return sum;
}

bool comp(const pair<pair<long long int,long long int>,long int> &a,const pair<pair<long long int,long long int>,long long int> &b)
{
    return a.first.second <= b.first.second;
}

int main()
{
    long long int m,d;
    cin >> n >> m >> d;
    for (int i = 1;i <= n;i++)
    {
        cin >> a[i];
        pos[a[i]] = i;
    }

    pair <pair<long long int,long long int>,long long int> q[m+1];
    long long int ans[m+1];
//    pair <pair<int,int>,int> :: iterator it;

    for (int i = 1;i <= m;i++)
    {
       long long int l,r;
        cin >> l >> r;
        q[i].first.first = l;
        q[i].first.second = r;
        q[i].second = i;
    }
    sort(q+1,q+m+1,comp);

    /*for (int i = 1;i <= m;i++)
    {
        cout << q[i].first.first << "   " << q[i].first.second << endl;
    }*/

    long int j = 1;
    long long int o = 1;
    for (int i = 1;i <= n;i++)
    {

        //cout << "max is  : " << max(1,a[i]-d) << "  and min is :  " << min(n,a[i]+d) << " and i is : " << i << endl;
        for (int k = max(o,a[i]-d);k <= min(n,a[i]+d);++k)
        {
            if (pos[k] != 0 && pos[k] <= i)
                update(pos[k]);
        }

        //cout << "after " << i << "th iteration : " << endl;
        //for (int l = 1; l<=n;l++)
          //  cout << bit[l] << "  ";

        //cout << endl << endl << endl;
        while(j <= m && (q[j].first.second == i))
        {
            //cout << "pra";
            ans[q[j].second] = query(q[j].first.second) - query(q[j].first.first - 1);
            j++;
          //  cout << q[j].first.first << "   ans[q] is : " << q[j].first.second << " and anwers is " << ans[q[j].second] << endl;
        }
       // cout << endl;
    }


    //cout << endl << endl << endl;

    /*for (int i = 1;i <= n;i++)
        cout << bit[i] << "   ";

    cout << endl << endl;*/

    for (int i = 1; i <= m;i++)
        cout << ans[i] << endl;

}
