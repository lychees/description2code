#include<bits/stdc++.h>
using namespace std;

typedef long long int LL;

#define scll(Q)   	scanf("%lld",&Q);
#define sci(Q)   	scanf("%d",&Q);
#define sc(Q)		scanf("%s",&Q);
#define prll(Q)   	printf("%lld\n",Q);
#define pri(Q)    	printf("%d\n",Q);
#define pr(Q)   	printf("%s\n",Q);

long long power(long long a, long long pow)
{
	long long int result=1,bit;
	while(pow){
			bit=pow%2;
			if(bit){
				result=(result*a)%1000000;
				a=(a*a)%1000000;						
			}
			else{
				a=(a*a)%1000000;
			
			}
			pow=pow/2;
			
	}
	return result;
}


int main()
{
	int t;
	LL n,m,z,a[100009],i,j,fin,o,p,q,ans,temp;
	sci(t);
	while(t--){
		fin=0;
		scll(n);scll(m);scll(z);
		for(j=0;j<n;j++)	scll(a[j]);
	
		
		for(i=1;i<=n;i++){
			temp=fmod((power(-1,i+1)*a[j-i]),m);
			if(temp<0)	temp=m+temp;

			fin+=temp;
		//	cout<<fin<<endl;
		};
		
		a[j]=fin;
		if(n%2==0)
			ans=fmod((power(-1,z/(n+1)))*a[z%(n+1)],m);
		else
			ans=fmod(a[z%(n+1)],m);
	
		if(ans<0)	ans=m+ans;
		
		cout<<ans<<endl;
	}




	return 0;
}

