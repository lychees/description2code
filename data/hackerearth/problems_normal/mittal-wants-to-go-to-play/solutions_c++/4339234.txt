#include <bits/stdc++.h>
using namespace std;


class ComparisonClass {
    public:
    bool operator() (pair<int,int> a, pair<int,int> b) {
        return a.second>b.second;
    }
};

int main()
{
    int T;int n,m,q,a,b,c,k,src=1;
    cin>>T;
    while(T-->0)
    {
        int n,m,q,a,b,c,k,src=1;
    	cin>>n>>m;
    	vector<pair<int,int> > listgr[n+1];
    	
    	int dist[n+1],visited[n+1];
    	priority_queue< pair<int,int> ,vector<pair<int,int> >,ComparisonClass> pq;
    	dist[src] = 0;
    	pq.push(make_pair(src,0));
    	for(int i=1;i<=n;i++)
        {
            if(i!=src)
                dist[i] = 1000000009;
            visited[i] = 0;
        }
    	for(int i=0;i<m;i++)
    	{
    		cin>>a>>b;
    		cin>>c;
    		listgr[a].push_back(make_pair(b,c));
    		listgr[b].push_back(make_pair(a,c));
    	}
        int u,d,x;
        while(!pq.empty())
        {
            u = pq.top().first;
            
            pq.pop();
            if(visited[u])
            	continue;
            visited[u] = 1;
            for(int i = 0; i < listgr[u].size(); i++)
            {
            	x = listgr[u][i].first;
            	d = listgr[u][i].second;
                if(dist[u]+d<dist[x])
                {
                    dist[x] = d + dist[u];
                    pq.push(make_pair(x,dist[x]));
                }
            }
            
        }
    	cin>>q;
    	for(int i=1;i<=q;i++)
    	{
    		cin>>n>>k;

    		k = k-2*dist[n];
    		if(k<0)
    			cout<<"0"<<endl;
    		else cout<<k<<endl;
    	}
        while(!pq.empty())
            pq.pop();
    }
}
