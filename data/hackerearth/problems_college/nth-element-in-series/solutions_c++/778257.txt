#include <iostream>
#include <vector>
#define mod 1000000007
#define lld unsigned long long int
using namespace std;
lld a[5][5]={{1,1,1,2,1},{1,0,0,0,0}, {0,1,0,0,0},{0,0,1,0,0},{0,0,0,1,0}};

vector< vector<lld> >  Exp( int n ){
  vector< vector<lld > > v(5),c1(5),c2(5),d(5);
  lld i,j,k;
  if( n==1 ){
    for(i=0;i<5;i++)
      for(j=0;j<5;j++)
	v[i].push_back(a[i][j]);
    return v;
  }
  c1 = Exp(n/2);
  for(i=0;i<5;i++){
    d[i].clear();
    for(j=0;j<5;j++){
      d[i].push_back(0);
      for(k=0;k<5;k++){
	d[i][j]+=(c1[i][k]*c1[k][j])%mod;
	d[i][j]%=mod;
      }
    }
  }


  for( i=0;i<5;i++ ){
    for(j=0;j<5;j++)
      d[i][j]%=mod;
  }
  if( n%2== 0 )
    return d;
  for(i=0;i<5;i++){
    c2[i].clear();
    for(j=0;j<5;j++)
      c2[i].push_back(a[i][j]);
  }
  vector<vector<lld> > f(5);
  for(i=0;i<5;i++){
    f[i].clear();
    for(j=0;j<5;j++){
      f[i].push_back(0);
      for(k=0;k<5;k++){
	f[i][j]+=(d[i][k]*c2[k][j])%mod;
	f[i][j]%=mod;
      }
    }
  }
  for( i=0;i<5;i++ ){
    for(j=0;j<5;j++)
      f[i][j]%=mod;
  }
  return f;
}
lld f[5];

lld fun( int n ){
  int i,j,k;
  if( n<5 ){
    return f[n];
  }
  vector< vector<lld> > v= Exp(n-4);
  lld sm =0;
  for(i=0;i<5;i++){
    sm += (v[0][i]*f[4-i])%mod;
    sm%=mod;
  }
  return sm;
}

int main(){
  int i,j,k,t,n;
  lld zz[5],ans;
  cin>>t;
  while(t--){
    for(i=0;i<5;i++)
      cin>>f[i];
    cin>>n;
    ans = fun(n);
    cout<<ans<<endl;
  }
  
}